# Comparing `tmp/MCPoly-0.5.1.3.tar.gz` & `tmp/MCPoly-0.6b1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "MCPoly-0.5.1.3.tar", last modified: Thu Jun 29 15:19:39 2023, max compression
+gzip compressed data, was "MCPoly-0.6b1.tar", last modified: Thu Aug  3 09:36:39 2023, max compression
```

## Comparing `MCPoly-0.5.1.3.tar` & `MCPoly-0.6b1.tar`

### file list

```diff
@@ -1,69 +1,69 @@
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.734040 MCPoly-0.5.1.3/
--rw-r--r--   0 cxs454     (503) staff       (20)     1091 2023-05-03 15:22:57.000000 MCPoly-0.5.1.3/LICENSE
--rw-r--r--   0 cxs454     (503) staff       (20)       17 2023-05-04 08:23:11.000000 MCPoly-0.5.1.3/MANIFEST.in
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.726254 MCPoly-0.5.1.3/MCPoly/
--rw-r--r--   0 cxs454     (503) staff       (20)    12292 2023-06-29 15:19:33.000000 MCPoly-0.5.1.3/MCPoly/.DS_Store
--rw-r--r--   0 cxs454     (503) staff       (20)      178 2023-05-15 14:05:30.000000 MCPoly-0.5.1.3/MCPoly/__init__.py
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.728041 MCPoly-0.5.1.3/MCPoly/lmpset/
--rw-r--r--   0 cxs454     (503) staff       (20)     5719 2023-06-18 16:08:00.000000 MCPoly-0.5.1.3/MCPoly/lmpset/DATAtoXYZ.py
--rw-r--r--   0 cxs454     (503) staff       (20)     4361 2023-06-12 14:51:59.000000 MCPoly-0.5.1.3/MCPoly/lmpset/DATAtomolTXT.py
--rw-r--r--   0 cxs454     (503) staff       (20)      169 2023-06-17 16:42:13.000000 MCPoly-0.5.1.3/MCPoly/lmpset/__init__.py
--rw-r--r--   0 cxs454     (503) staff       (20)    55548 2023-06-05 13:00:53.000000 MCPoly-0.5.1.3/MCPoly/lmpset/chain.py
--rw-r--r--   0 cxs454     (503) staff       (20)    16310 2023-06-03 14:28:50.000000 MCPoly-0.5.1.3/MCPoly/lmpset/infchain.py
--rw-r--r--   0 cxs454     (503) staff       (20)    53042 2023-06-18 16:59:51.000000 MCPoly-0.5.1.3/MCPoly/lmpset/mould.py
--rw-r--r--   0 cxs454     (503) staff       (20)     5402 2023-06-19 16:17:41.000000 MCPoly-0.5.1.3/MCPoly/lmpset/rebuild.py
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.729076 MCPoly-0.5.1.3/MCPoly/moldraw/
--rw-r--r--   0 cxs454     (503) staff       (20)     8966 2023-05-26 12:59:21.000000 MCPoly-0.5.1.3/MCPoly/moldraw/C_selection.py
--rw-r--r--   0 cxs454     (503) staff       (20)      128 2023-05-29 06:59:26.000000 MCPoly-0.5.1.3/MCPoly/moldraw/__init__.py
--rw-r--r--   0 cxs454     (503) staff       (20)    64145 2023-05-26 10:41:02.000000 MCPoly-0.5.1.3/MCPoly/moldraw/bind_selection.py
--rw-r--r--   0 cxs454     (503) staff       (20)    24385 2023-05-29 07:03:41.000000 MCPoly-0.5.1.3/MCPoly/moldraw/gui.py
--rw-r--r--   0 cxs454     (503) staff       (20)   181892 2023-05-26 12:59:34.000000 MCPoly-0.5.1.3/MCPoly/moldraw/molecule.py
--rw-r--r--   0 cxs454     (503) staff       (20)    98156 2023-05-26 10:40:13.000000 MCPoly-0.5.1.3/MCPoly/moldraw/sub_selection.py
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.730484 MCPoly-0.5.1.3/MCPoly/orcaset/
--rw-r--r--   0 cxs454     (503) staff       (20)    10729 2023-06-24 15:26:07.000000 MCPoly-0.5.1.3/MCPoly/orcaset/XYZtoINP.py
--rw-r--r--   0 cxs454     (503) staff       (20)      158 2023-05-11 15:49:25.000000 MCPoly-0.5.1.3/MCPoly/orcaset/__init__.py
--rw-r--r--   0 cxs454     (503) staff       (20)    20688 2023-06-27 14:13:27.000000 MCPoly-0.5.1.3/MCPoly/orcaset/gui.py
--rw-r--r--   0 cxs454     (503) staff       (20)     7792 2023-06-27 14:07:19.000000 MCPoly-0.5.1.3/MCPoly/orcaset/mgui.py
--rw-r--r--   0 cxs454     (503) staff       (20)     4842 2023-05-02 16:29:09.000000 MCPoly-0.5.1.3/MCPoly/orcaset/multiorca.py
--rw-r--r--   0 cxs454     (503) staff       (20)     2310 2023-06-27 14:02:40.000000 MCPoly-0.5.1.3/MCPoly/orcaset/orca.py
--rw-r--r--   0 cxs454     (503) staff       (20)    24620 2023-06-29 15:10:43.000000 MCPoly-0.5.1.3/MCPoly/orcaset/ssgui.py
--rw-r--r--   0 cxs454     (503) staff       (20)     9044 2023-06-09 09:20:04.000000 MCPoly-0.5.1.3/MCPoly/orcaset/ssorca.py
--rw-r--r--   0 cxs454     (503) staff       (20)     2145 2023-05-09 08:28:02.000000 MCPoly-0.5.1.3/MCPoly/orcaset/view3dchoose.py
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.731467 MCPoly-0.5.1.3/MCPoly/sscurve/
--rw-r--r--   0 cxs454     (503) staff       (20)     1193 2023-05-02 16:03:26.000000 MCPoly-0.5.1.3/MCPoly/sscurve/YModulus.py
--rw-r--r--   0 cxs454     (503) staff       (20)      133 2023-06-27 15:58:50.000000 MCPoly-0.5.1.3/MCPoly/sscurve/__init__.py
--rw-r--r--   0 cxs454     (503) staff       (20)    12770 2023-06-22 12:33:27.000000 MCPoly-0.5.1.3/MCPoly/sscurve/gui.py
--rw-r--r--   0 cxs454     (503) staff       (20)    12736 2023-06-27 15:58:34.000000 MCPoly-0.5.1.3/MCPoly/sscurve/gui2.py
--rw-r--r--   0 cxs454     (503) staff       (20)     5843 2023-05-19 09:04:58.000000 MCPoly-0.5.1.3/MCPoly/sscurve/multiple.py
--rw-r--r--   0 cxs454     (503) staff       (20)     5162 2023-06-27 15:58:01.000000 MCPoly-0.5.1.3/MCPoly/sscurve/multiple2.py
--rw-r--r--   0 cxs454     (503) staff       (20)    13033 2023-06-27 15:58:20.000000 MCPoly-0.5.1.3/MCPoly/sscurve/single.py
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.732020 MCPoly-0.5.1.3/MCPoly/status/
--rw-r--r--   0 cxs454     (503) staff       (20)       62 2023-05-18 16:46:40.000000 MCPoly-0.5.1.3/MCPoly/status/__init__.py
--rw-r--r--   0 cxs454     (503) staff       (20)     6192 2023-06-18 16:33:35.000000 MCPoly-0.5.1.3/MCPoly/status/echart.py
--rw-r--r--   0 cxs454     (503) staff       (20)    15750 2023-05-18 16:45:20.000000 MCPoly-0.5.1.3/MCPoly/status/gui.py
--rw-r--r--   0 cxs454     (503) staff       (20)    24351 2023-06-29 14:46:46.000000 MCPoly-0.5.1.3/MCPoly/status/status.py
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.732313 MCPoly-0.5.1.3/MCPoly/version/
--rw-r--r--   0 cxs454     (503) staff       (20)       23 2023-05-04 08:03:54.000000 MCPoly-0.5.1.3/MCPoly/version/__init__.py
--rw-r--r--   0 cxs454     (503) staff       (20)       35 2023-06-28 15:45:03.000000 MCPoly-0.5.1.3/MCPoly/version/version.py
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.732588 MCPoly-0.5.1.3/MCPoly/view3d/
--rw-r--r--   0 cxs454     (503) staff       (20)       22 2023-04-30 18:16:37.000000 MCPoly-0.5.1.3/MCPoly/view3d/__init__.py
--rw-r--r--   0 cxs454     (503) staff       (20)     1970 2023-05-09 13:30:17.000000 MCPoly-0.5.1.3/MCPoly/view3d/view3d.py
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.732858 MCPoly-0.5.1.3/MCPoly/vis/
--rw-r--r--   0 cxs454     (503) staff       (20)       18 2023-05-15 14:05:55.000000 MCPoly-0.5.1.3/MCPoly/vis/__init__.py
--rw-r--r--   0 cxs454     (503) staff       (20)     2112 2023-06-27 13:59:22.000000 MCPoly-0.5.1.3/MCPoly/vis/vis.py
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.726974 MCPoly-0.5.1.3/MCPoly.egg-info/
--rw-r--r--   0 cxs454     (503) staff       (20)     4201 2023-06-29 15:19:39.000000 MCPoly-0.5.1.3/MCPoly.egg-info/PKG-INFO
--rw-r--r--   0 cxs454     (503) staff       (20)     1330 2023-06-29 15:19:39.000000 MCPoly-0.5.1.3/MCPoly.egg-info/SOURCES.txt
--rw-r--r--   0 cxs454     (503) staff       (20)        1 2023-06-29 15:19:39.000000 MCPoly-0.5.1.3/MCPoly.egg-info/dependency_links.txt
--rw-r--r--   0 cxs454     (503) staff       (20)      143 2023-06-29 15:19:39.000000 MCPoly-0.5.1.3/MCPoly.egg-info/requires.txt
--rw-r--r--   0 cxs454     (503) staff       (20)        7 2023-06-29 15:19:39.000000 MCPoly-0.5.1.3/MCPoly.egg-info/top_level.txt
--rw-r--r--   0 cxs454     (503) staff       (20)     4201 2023-06-29 15:19:39.733869 MCPoly-0.5.1.3/PKG-INFO
--rw-r--r--   0 cxs454     (503) staff       (20)     3837 2023-06-29 14:06:33.000000 MCPoly-0.5.1.3/README.md
--rw-r--r--   0 cxs454     (503) staff       (20)       38 2023-06-29 15:19:39.734093 MCPoly-0.5.1.3/setup.cfg
--rw-r--r--   0 cxs454     (503) staff       (20)     1033 2023-06-29 15:19:26.000000 MCPoly-0.5.1.3/setup.py
-drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-06-29 15:19:39.733631 MCPoly-0.5.1.3/tests/
--rw-r--r--   0 cxs454     (503) staff       (20)     9627 2023-06-18 17:38:10.000000 MCPoly-0.5.1.3/tests/test_lmpset.py
--rw-r--r--   0 cxs454     (503) staff       (20)      799 2023-05-03 10:12:20.000000 MCPoly-0.5.1.3/tests/test_moldraw.py
--rw-r--r--   0 cxs454     (503) staff       (20)     3931 2023-06-24 15:32:23.000000 MCPoly-0.5.1.3/tests/test_orcaset.py
--rw-r--r--   0 cxs454     (503) staff       (20)     3535 2023-05-19 13:19:19.000000 MCPoly-0.5.1.3/tests/test_sscurve.py
--rw-r--r--   0 cxs454     (503) staff       (20)     5241 2023-06-24 15:37:07.000000 MCPoly-0.5.1.3/tests/test_status.py
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.626496 MCPoly-0.6b1/
+-rw-r--r--   0 cxs454     (503) staff       (20)     1091 2023-05-03 15:22:57.000000 MCPoly-0.6b1/LICENSE
+-rw-r--r--   0 cxs454     (503) staff       (20)       17 2023-05-04 08:23:11.000000 MCPoly-0.6b1/MANIFEST.in
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.612878 MCPoly-0.6b1/MCPoly/
+-rw-r--r--   0 cxs454     (503) staff       (20)    12292 2023-08-03 09:29:49.000000 MCPoly-0.6b1/MCPoly/.DS_Store
+-rw-r--r--   0 cxs454     (503) staff       (20)      178 2023-05-15 14:05:30.000000 MCPoly-0.6b1/MCPoly/__init__.py
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.616560 MCPoly-0.6b1/MCPoly/lmpset/
+-rw-r--r--   0 cxs454     (503) staff       (20)     4521 2023-08-01 13:02:48.000000 MCPoly-0.6b1/MCPoly/lmpset/DataToMolTxt.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     5629 2023-08-01 13:02:18.000000 MCPoly-0.6b1/MCPoly/lmpset/DataToXyz.py
+-rw-r--r--   0 cxs454     (503) staff       (20)      169 2023-08-01 13:03:51.000000 MCPoly-0.6b1/MCPoly/lmpset/__init__.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    61558 2023-08-02 09:55:27.000000 MCPoly-0.6b1/MCPoly/lmpset/chain.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    17539 2023-07-30 13:44:18.000000 MCPoly-0.6b1/MCPoly/lmpset/infchain.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    65198 2023-08-01 14:57:17.000000 MCPoly-0.6b1/MCPoly/lmpset/mould.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     5878 2023-08-02 10:17:59.000000 MCPoly-0.6b1/MCPoly/lmpset/rebuild.py
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.618519 MCPoly-0.6b1/MCPoly/moldraw/
+-rw-r--r--   0 cxs454     (503) staff       (20)     9610 2023-07-31 16:11:29.000000 MCPoly-0.6b1/MCPoly/moldraw/C_selection.py
+-rw-r--r--   0 cxs454     (503) staff       (20)      128 2023-05-29 06:59:26.000000 MCPoly-0.6b1/MCPoly/moldraw/__init__.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    69228 2023-07-31 16:10:26.000000 MCPoly-0.6b1/MCPoly/moldraw/bind_selection.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    28721 2023-08-01 09:49:46.000000 MCPoly-0.6b1/MCPoly/moldraw/gui.py
+-rw-r--r--   0 cxs454     (503) staff       (20)   196832 2023-08-01 09:32:54.000000 MCPoly-0.6b1/MCPoly/moldraw/molecule.py
+-rw-r--r--   0 cxs454     (503) staff       (20)   107123 2023-07-31 16:33:06.000000 MCPoly-0.6b1/MCPoly/moldraw/sub_selection.py
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.621102 MCPoly-0.6b1/MCPoly/orcaset/
+-rw-r--r--   0 cxs454     (503) staff       (20)    11456 2023-08-02 10:46:26.000000 MCPoly-0.6b1/MCPoly/orcaset/XyzToInp.py
+-rw-r--r--   0 cxs454     (503) staff       (20)      158 2023-08-01 13:04:20.000000 MCPoly-0.6b1/MCPoly/orcaset/__init__.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    28316 2023-08-01 13:05:52.000000 MCPoly-0.6b1/MCPoly/orcaset/gui.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     9275 2023-08-01 13:06:55.000000 MCPoly-0.6b1/MCPoly/orcaset/mgui.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     5023 2023-08-02 13:16:21.000000 MCPoly-0.6b1/MCPoly/orcaset/multiorca.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     2451 2023-08-02 13:14:49.000000 MCPoly-0.6b1/MCPoly/orcaset/orca.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    28970 2023-08-01 13:07:58.000000 MCPoly-0.6b1/MCPoly/orcaset/ssgui.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     9506 2023-08-01 13:08:23.000000 MCPoly-0.6b1/MCPoly/orcaset/ssorca.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     2201 2023-07-30 16:27:16.000000 MCPoly-0.6b1/MCPoly/orcaset/view3dchoose.py
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.623013 MCPoly-0.6b1/MCPoly/sscurve/
+-rw-r--r--   0 cxs454     (503) staff       (20)     1251 2023-08-01 10:15:53.000000 MCPoly-0.6b1/MCPoly/sscurve/YModulus.py
+-rw-r--r--   0 cxs454     (503) staff       (20)      133 2023-06-27 15:58:50.000000 MCPoly-0.6b1/MCPoly/sscurve/__init__.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    13840 2023-08-01 15:03:05.000000 MCPoly-0.6b1/MCPoly/sscurve/gui.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    14203 2023-08-01 15:03:31.000000 MCPoly-0.6b1/MCPoly/sscurve/gui2.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     6041 2023-08-02 15:33:51.000000 MCPoly-0.6b1/MCPoly/sscurve/multiple.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     5481 2023-08-02 15:47:17.000000 MCPoly-0.6b1/MCPoly/sscurve/multiple2.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    14234 2023-08-02 15:37:11.000000 MCPoly-0.6b1/MCPoly/sscurve/single.py
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.624081 MCPoly-0.6b1/MCPoly/status/
+-rw-r--r--   0 cxs454     (503) staff       (20)       62 2023-05-18 16:46:40.000000 MCPoly-0.6b1/MCPoly/status/__init__.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     6418 2023-08-03 08:36:11.000000 MCPoly-0.6b1/MCPoly/status/echart.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    17630 2023-08-01 10:21:43.000000 MCPoly-0.6b1/MCPoly/status/gui.py
+-rw-r--r--   0 cxs454     (503) staff       (20)    26789 2023-08-03 08:38:09.000000 MCPoly-0.6b1/MCPoly/status/status.py
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.624386 MCPoly-0.6b1/MCPoly/version/
+-rw-r--r--   0 cxs454     (503) staff       (20)       23 2023-05-04 08:03:54.000000 MCPoly-0.6b1/MCPoly/version/__init__.py
+-rw-r--r--   0 cxs454     (503) staff       (20)       33 2023-08-03 09:30:49.000000 MCPoly-0.6b1/MCPoly/version/version.py
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.624655 MCPoly-0.6b1/MCPoly/view3d/
+-rw-r--r--   0 cxs454     (503) staff       (20)       22 2023-04-30 18:16:37.000000 MCPoly-0.6b1/MCPoly/view3d/__init__.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     2006 2023-07-29 16:17:26.000000 MCPoly-0.6b1/MCPoly/view3d/view3d.py
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.625204 MCPoly-0.6b1/MCPoly/vis/
+-rw-r--r--   0 cxs454     (503) staff       (20)       18 2023-05-15 14:05:55.000000 MCPoly-0.6b1/MCPoly/vis/__init__.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     2159 2023-08-01 10:27:30.000000 MCPoly-0.6b1/MCPoly/vis/vis.py
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.613664 MCPoly-0.6b1/MCPoly.egg-info/
+-rw-r--r--   0 cxs454     (503) staff       (20)     4243 2023-08-03 09:36:39.000000 MCPoly-0.6b1/MCPoly.egg-info/PKG-INFO
+-rw-r--r--   0 cxs454     (503) staff       (20)     1330 2023-08-03 09:36:39.000000 MCPoly-0.6b1/MCPoly.egg-info/SOURCES.txt
+-rw-r--r--   0 cxs454     (503) staff       (20)        1 2023-08-03 09:36:39.000000 MCPoly-0.6b1/MCPoly.egg-info/dependency_links.txt
+-rw-r--r--   0 cxs454     (503) staff       (20)      143 2023-08-03 09:36:39.000000 MCPoly-0.6b1/MCPoly.egg-info/requires.txt
+-rw-r--r--   0 cxs454     (503) staff       (20)        7 2023-08-03 09:36:39.000000 MCPoly-0.6b1/MCPoly.egg-info/top_level.txt
+-rw-r--r--   0 cxs454     (503) staff       (20)     4243 2023-08-03 09:36:39.626301 MCPoly-0.6b1/PKG-INFO
+-rw-r--r--   0 cxs454     (503) staff       (20)     3881 2023-08-03 09:35:56.000000 MCPoly-0.6b1/README.md
+-rw-r--r--   0 cxs454     (503) staff       (20)       38 2023-08-03 09:36:39.626550 MCPoly-0.6b1/setup.cfg
+-rw-r--r--   0 cxs454     (503) staff       (20)     1031 2023-08-03 09:31:07.000000 MCPoly-0.6b1/setup.py
+drwxr-xr-x   0 cxs454     (503) staff       (20)        0 2023-08-03 09:36:39.626079 MCPoly-0.6b1/tests/
+-rw-r--r--   0 cxs454     (503) staff       (20)    10373 2023-08-02 10:22:55.000000 MCPoly-0.6b1/tests/test_lmpset.py
+-rw-r--r--   0 cxs454     (503) staff       (20)      808 2023-08-01 13:29:55.000000 MCPoly-0.6b1/tests/test_moldraw.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     4222 2023-08-02 10:45:57.000000 MCPoly-0.6b1/tests/test_orcaset.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     7227 2023-08-02 15:46:43.000000 MCPoly-0.6b1/tests/test_sscurve.py
+-rw-r--r--   0 cxs454     (503) staff       (20)     6630 2023-08-03 08:40:20.000000 MCPoly-0.6b1/tests/test_status.py
```

### Comparing `MCPoly-0.5.1.3/LICENSE` & `MCPoly-0.6b1/LICENSE`

 * *Files identical despite different names*

### Comparing `MCPoly-0.5.1.3/MCPoly/.DS_Store` & `MCPoly-0.6b1/MCPoly/.DS_Store`

 * *Files 13% similar despite different names*

```diff
@@ -1,38 +1,38 @@
 00000000: 0000 0001 4275 6431 0000 2800 0000 0800  ....Bud1..(.....
 00000010: 0000 2800 0000 100c 0000 0108 0000 200b  ..(........... .
 00000020: 0000 0000 0000 0000 0000 0000 0000 0800  ................
 00000030: 0000 0800 0000 0000 0000 0000 0000 0000  ................
-00000040: 0000 0000 0000 0003 0000 0001 0000 0021  ...............!
+00000040: 0000 0000 0000 0003 0000 0001 0000 0023  ...............#
 00000050: 0000 0003 0000 1000 006c 0064 0072 0061  .........l.d.r.a
 00000060: 0077 6277 0000 0000 0000 0000 0000 0000  .wbw............
 00000070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0000 0000 0000 0002 0000 0001 0000 0004  ................
 00000110: 0000 0007 006d 006f 006c 0064 0072 0061  .....m.o.l.d.r.a
-00000120: 0077 6277 7370 626c 6f62 0000 00b7 6270  .wbwspblob....bp
+00000120: 0077 6277 7370 626c 6f62 0000 00b8 6270  .wbwspblob....bp
 00000130: 6c69 7374 3030 d601 0203 0405 0607 0807  list00..........
 00000140: 080b 085d 5368 6f77 5374 6174 7573 4261  ...]ShowStatusBa
 00000150: 725b 5368 6f77 546f 6f6c 6261 725b 5368  r[ShowToolbar[Sh
 00000160: 6f77 5461 6256 6965 775f 1014 436f 6e74  owTabView_..Cont
 00000170: 6169 6e65 7253 686f 7753 6964 6562 6172  ainerShowSidebar
 00000180: 5c57 696e 646f 7742 6f75 6e64 735b 5368  \WindowBounds[Sh
-00000190: 6f77 5369 6465 6261 7208 0908 095f 1017  owSidebar...._..
-000001a0: 7b7b 3634 2c20 3232 347d 2c20 7b39 3230  {{64, 224}, {920
-000001b0: 2c20 3433 367d 7d09 0815 232f 3b52 5f6b  , 436}}...#/;R_k
-000001c0: 6c6d 6e6f 8900 0000 0000 0001 0100 0000  lmno............
-000001d0: 0000 0000 0d00 0000 0000 0000 0000 0000  ................
-000001e0: 0000 0000 8a68 6f77 546f 6f6c 6261 725b  .....howToolbar[
+00000190: 6f77 5369 6465 6261 7208 0908 095f 1018  owSidebar...._..
+000001a0: 7b7b 3534 332c 2036 3433 7d2c 207b 3932  {{543, 643}, {92
+000001b0: 302c 2034 3336 7d7d 0908 1523 2f3b 525f  0, 436}}...#/;R_
+000001c0: 6b6c 6d6e 6f8a 0000 0000 0000 0101 0000  klmno...........
+000001d0: 0000 0000 000d 0000 0000 0000 0000 0000  ................
+000001e0: 0000 0000 008b 6f77 546f 6f6c 6261 725b  ......owToolbar[
 000001f0: 5368 6f77 5461 6256 6965 775f 1014 436f  ShowTabView_..Co
 00000200: 6e74 6169 0000 0000 0000 0000 0000 0000  ntai............
 00000210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -250,30 +250,30 @@
 00000f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001000: 0000 0000 0000 0000 0000 0018 0000 0007  ................
+00001000: 0000 0000 0000 0000 0000 001a 0000 0007  ................
 00001010: 006d 006f 006c 0064 0072 0061 0077 7653  .m.o.l.d.r.a.wvS
 00001020: 726e 6c6f 6e67 0000 0001 0000 0007 006f  rnlong.........o
 00001030: 0072 0063 0061 0073 0065 0074 496c 6f63  .r.c.a.s.e.tIloc
-00001040: 626c 6f62 0000 0010 0000 018b 0000 002e  blob............
+00001040: 626c 6f62 0000 0010 0000 0180 0000 002d  blob...........-
 00001050: ffff ffff ffff 0000 0000 0007 006f 0072  .............o.r
 00001060: 0063 0061 0073 0065 0074 6277 7370 626c  .c.a.s.e.tbwspbl
 00001070: 6f62 0000 00b8 6270 6c69 7374 3030 d601  ob....bplist00..
 00001080: 0203 0405 0607 0807 080b 085d 5368 6f77  ...........]Show
 00001090: 5374 6174 7573 4261 725b 5368 6f77 546f  StatusBar[ShowTo
 000010a0: 6f6c 6261 725b 5368 6f77 5461 6256 6965  olbar[ShowTabVie
 000010b0: 775f 1014 436f 6e74 6169 6e65 7253 686f  w_..ContainerSho
 000010c0: 7753 6964 6562 6172 5c57 696e 646f 7742  wSidebar\WindowB
 000010d0: 6f75 6e64 735b 5368 6f77 5369 6465 6261  ounds[ShowSideba
-000010e0: 7208 0908 095f 1018 7b7b 3637 342c 2033  r...._..{{674, 3
-000010f0: 3832 7d2c 207b 3932 302c 2034 3336 7d7d  82}, {920, 436}}
+000010e0: 7208 0908 095f 1018 7b7b 3534 332c 2036  r...._..{{543, 6
+000010f0: 3433 7d2c 207b 3932 302c 2034 3336 7d7d  43}, {920, 436}}
 00001100: 0908 1523 2f3b 525f 6b6c 6d6e 6f8a 0000  ...#/;R_klmno...
 00001110: 0000 0000 0101 0000 0000 0000 000d 0000  ................
 00001120: 0000 0000 0000 0000 0000 0000 008b 0000  ................
 00001130: 0007 006f 0072 0063 0061 0073 0065 0074  ...o.r.c.a.s.e.t
 00001140: 6963 7670 626c 6f62 0000 0194 6270 6c69  icvpblob....bpli
 00001150: 7374 3030 de01 0203 0405 0607 0809 0a0b  st00............
 00001160: 0c0d 0e0f 1011 0f12 0f13 1314 1516 1718  ................
@@ -309,16 +309,16 @@
 00001340: 7370 626c 6f62 0000 00b8 6270 6c69 7374  spblob....bplist
 00001350: 3030 d601 0203 0405 0607 0807 080b 085d  00.............]
 00001360: 5368 6f77 5374 6174 7573 4261 725b 5368  ShowStatusBar[Sh
 00001370: 6f77 546f 6f6c 6261 725b 5368 6f77 5461  owToolbar[ShowTa
 00001380: 6256 6965 775f 1014 436f 6e74 6169 6e65  bView_..Containe
 00001390: 7253 686f 7753 6964 6562 6172 5c57 696e  rShowSidebar\Win
 000013a0: 646f 7742 6f75 6e64 735b 5368 6f77 5369  dowBounds[ShowSi
-000013b0: 6465 6261 7208 0908 095f 1018 7b7b 3637  debar...._..{{67
-000013c0: 332c 2031 3330 7d2c 207b 3932 302c 2034  3, 130}, {920, 4
+000013b0: 6465 6261 7208 0908 095f 1018 7b7b 3534  debar...._..{{54
+000013c0: 332c 2036 3433 7d2c 207b 3932 302c 2034  3, 643}, {920, 4
 000013d0: 3336 7d7d 0908 1523 2f3b 525f 6b6c 6d6e  36}}...#/;R_klmn
 000013e0: 6f8a 0000 0000 0000 0101 0000 0000 0000  o...............
 000013f0: 000d 0000 0000 0000 0000 0000 0000 0000  ................
 00001400: 008b 0000 0007 0073 0073 0063 0075 0072  .......s.s.c.u.r
 00001410: 0076 0065 7653 726e 6c6f 6e67 0000 0001  .v.evSrnlong....
 00001420: 0000 0006 0073 0074 0061 0074 0075 0073  .....s.t.a.t.u.s
 00001430: 496c 6f63 626c 6f62 0000 0010 0000 0267  Ilocblob.......g
@@ -327,16 +327,16 @@
 00001460: 626c 6f62 0000 00b8 6270 6c69 7374 3030  blob....bplist00
 00001470: d601 0203 0405 0607 0807 080b 085d 5368  .............]Sh
 00001480: 6f77 5374 6174 7573 4261 725b 5368 6f77  owStatusBar[Show
 00001490: 546f 6f6c 6261 725b 5368 6f77 5461 6256  Toolbar[ShowTabV
 000014a0: 6965 775f 1014 436f 6e74 6169 6e65 7253  iew_..ContainerS
 000014b0: 686f 7753 6964 6562 6172 5c57 696e 646f  howSidebar\Windo
 000014c0: 7742 6f75 6e64 735b 5368 6f77 5369 6465  wBounds[ShowSide
-000014d0: 6261 7208 0908 095f 1018 7b7b 3637 342c  bar...._..{{674,
-000014e0: 2033 3832 7d2c 207b 3932 302c 2034 3336   382}, {920, 436
+000014d0: 6261 7208 0908 095f 1018 7b7b 3534 332c  bar...._..{{543,
+000014e0: 2036 3433 7d2c 207b 3932 302c 2034 3336   643}, {920, 436
 000014f0: 7d7d 0908 1523 2f3b 525f 6b6c 6d6e 6f8a  }}...#/;R_klmno.
 00001500: 0000 0000 0000 0101 0000 0000 0000 000d  ................
 00001510: 0000 0000 0000 0000 0000 0000 0000 008b  ................
 00001520: 0000 0006 0073 0074 0061 0074 0075 0073  .....s.t.a.t.u.s
 00001530: 7653 726e 6c6f 6e67 0000 0001 0000 0007  vSrnlong........
 00001540: 0076 0065 0072 0073 0069 006f 006e 496c  .v.e.r.s.i.o.nIl
 00001550: 6f63 626c 6f62 0000 0010 0000 02d5 0000  ocblob..........
@@ -345,16 +345,16 @@
 00001580: 626c 6f62 0000 00b8 6270 6c69 7374 3030  blob....bplist00
 00001590: d601 0203 0405 0607 0807 080b 085d 5368  .............]Sh
 000015a0: 6f77 5374 6174 7573 4261 725b 5368 6f77  owStatusBar[Show
 000015b0: 546f 6f6c 6261 725b 5368 6f77 5461 6256  Toolbar[ShowTabV
 000015c0: 6965 775f 1014 436f 6e74 6169 6e65 7253  iew_..ContainerS
 000015d0: 686f 7753 6964 6562 6172 5c57 696e 646f  howSidebar\Windo
 000015e0: 7742 6f75 6e64 735b 5368 6f77 5369 6465  wBounds[ShowSide
-000015f0: 6261 7208 0908 095f 1018 7b7b 3637 332c  bar...._..{{673,
-00001600: 2031 3330 7d2c 207b 3932 302c 2034 3336   130}, {920, 436
+000015f0: 6261 7208 0908 095f 1018 7b7b 3339 392c  bar...._..{{399,
+00001600: 2033 3233 7d2c 207b 3932 302c 2034 3336   323}, {920, 436
 00001610: 7d7d 0908 1523 2f3b 525f 6b6c 6d6e 6f8a  }}...#/;R_klmno.
 00001620: 0000 0000 0000 0101 0000 0000 0000 000d  ................
 00001630: 0000 0000 0000 0000 0000 0000 0000 008b  ................
 00001640: 0000 0007 0076 0065 0072 0073 0069 006f  .....v.e.r.s.i.o
 00001650: 006e 6c67 3153 636f 6d70 0000 0000 0000  .nlg1Scomp......
 00001660: 0000 0000 0007 0076 0065 0072 0073 0069  .......v.e.r.s.i
 00001670: 006f 006e 6d6f 4444 626c 6f62 0000 0008  .o.nmoDDblob....
@@ -365,58 +365,58 @@
 000016c0: 7068 3153 636f 6d70 0000 0000 0000 0000  ph1Scomp........
 000016d0: 0000 0007 0076 0065 0072 0073 0069 006f  .....v.e.r.s.i.o
 000016e0: 006e 7653 726e 6c6f 6e67 0000 0001 0000  .nvSrnlong......
 000016f0: 0006 0076 0069 0065 0077 0033 0064 496c  ...v.i.e.w.3.dIl
 00001700: 6f63 626c 6f62 0000 0010 0000 0041 0000  ocblob.......A..
 00001710: 009e ffff ffff ffff 0000 0000 0006 0076  ...............v
 00001720: 0069 0065 0077 0033 0064 6277 7370 626c  .i.e.w.3.dbwspbl
-00001730: 6f62 0000 00b7 6270 6c69 7374 3030 d601  ob....bplist00..
+00001730: 6f62 0000 00b8 6270 6c69 7374 3030 d601  ob....bplist00..
 00001740: 0203 0405 0607 0807 080b 085d 5368 6f77  ...........]Show
 00001750: 5374 6174 7573 4261 725b 5368 6f77 546f  StatusBar[ShowTo
 00001760: 6f6c 6261 725b 5368 6f77 5461 6256 6965  olbar[ShowTabVie
 00001770: 775f 1014 436f 6e74 6169 6e65 7253 686f  w_..ContainerSho
 00001780: 7753 6964 6562 6172 5c57 696e 646f 7742  wSidebar\WindowB
 00001790: 6f75 6e64 735b 5368 6f77 5369 6465 6261  ounds[ShowSideba
-000017a0: 7208 0908 095f 1017 7b7b 3436 2c20 3430  r...._..{{46, 40
-000017b0: 317d 2c20 7b39 3230 2c20 3433 367d 7d09  1}, {920, 436}}.
-000017c0: 0815 232f 3b52 5f6b 6c6d 6e6f 8900 0000  ..#/;R_klmno....
-000017d0: 0000 0001 0100 0000 0000 0000 0d00 0000  ................
-000017e0: 0000 0000 0000 0000 0000 0000 8a00 0000  ................
-000017f0: 0600 7600 6900 6500 7700 3300 6476 5372  ..v.i.e.w.3.dvSr
-00001800: 6e6c 6f6e 6700 0000 0100 0000 0300 7600  nlong.........v.
-00001810: 6900 7349 6c6f 6362 6c6f 6200 0000 1000  i.sIlocblob.....
-00001820: 0000 af00 0000 9eff ffff ffff ff00 0000  ................
-00001830: 0000 0300 7600 6900 7362 7773 7062 6c6f  ....v.i.sbwspblo
-00001840: 6200 0000 b762 706c 6973 7430 30d6 0102  b....bplist00...
-00001850: 0304 0506 0708 0708 0b08 5d53 686f 7753  ..........]ShowS
-00001860: 7461 7475 7342 6172 5b53 686f 7754 6f6f  tatusBar[ShowToo
-00001870: 6c62 6172 5b53 686f 7754 6162 5669 6577  lbar[ShowTabView
-00001880: 5f10 1443 6f6e 7461 696e 6572 5368 6f77  _..ContainerShow
-00001890: 5369 6465 6261 725c 5769 6e64 6f77 426f  Sidebar\WindowBo
-000018a0: 756e 6473 5b53 686f 7753 6964 6562 6172  unds[ShowSidebar
-000018b0: 0809 0809 5f10 177b 7b34 362c 2034 3031  ...._..{{46, 401
-000018c0: 7d2c 207b 3932 302c 2034 3336 7d7d 0908  }, {920, 436}}..
-000018d0: 1523 2f3b 525f 6b6c 6d6e 6f89 0000 0000  .#/;R_klmno.....
-000018e0: 0000 0101 0000 0000 0000 000d 0000 0000  ................
-000018f0: 0000 0000 0000 0000 0000 008a 0000 0003  ................
-00001900: 0076 0069 0073 7653 726e 6c6f 6e67 0000  .v.i.svSrnlong..
-00001910: 0001 0000 0000 0000 0000 0000 0000 0000  ................
-00001920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000019a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000019b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000019c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000019d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000019e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000017a0: 7208 0908 095f 1018 7b7b 3534 332c 2036  r...._..{{543, 6
+000017b0: 3433 7d2c 207b 3932 302c 2034 3336 7d7d  43}, {920, 436}}
+000017c0: 0908 1523 2f3b 525f 6b6c 6d6e 6f8a 0000  ...#/;R_klmno...
+000017d0: 0000 0000 0101 0000 0000 0000 000d 0000  ................
+000017e0: 0000 0000 0000 0000 0000 0000 008b 0000  ................
+000017f0: 0006 0076 0069 0065 0077 0033 0064 7074  ...v.i.e.w.3.dpt
+00001800: 624c 7573 7472 0000 0046 0053 0079 0073  bLustr...F.S.y.s
+00001810: 0074 0065 006d 002f 0056 006f 006c 0075  .t.e.m./.V.o.l.u
+00001820: 006d 0065 0073 002f 0044 0061 0074 0061  .m.e.s./.D.a.t.a
+00001830: 002f 0055 0073 0065 0072 0073 002f 0063  ./.U.s.e.r.s./.c
+00001840: 0078 0073 0034 0035 0034 002f 0044 0065  .x.s.4.5.4./.D.e
+00001850: 0073 006b 0074 006f 0070 002f 0044 0065  .s.k.t.o.p./.D.e
+00001860: 0063 006f 006d 0050 006f 006c 0079 002f  .c.o.m.P.o.l.y./
+00001870: 0063 006f 0064 0065 002f 004d 0043 0050  .c.o.d.e./.M.C.P
+00001880: 006f 006c 0079 002f 004d 0043 0050 006f  .o.l.y./.M.C.P.o
+00001890: 006c 0079 002f 0000 0006 0076 0069 0065  .l.y./.....v.i.e
+000018a0: 0077 0033 0064 7074 624e 7573 7472 0000  .w.3.dptbNustr..
+000018b0: 0006 0076 0069 0065 0077 0033 0064 0000  ...v.i.e.w.3.d..
+000018c0: 0006 0076 0069 0065 0077 0033 0064 7653  ...v.i.e.w.3.dvS
+000018d0: 726e 6c6f 6e67 0000 0001 0000 0003 0076  rnlong.........v
+000018e0: 0069 0073 496c 6f63 626c 6f62 0000 0010  .i.sIlocblob....
+000018f0: 0000 00af 0000 009e ffff ffff ffff 0000  ................
+00001900: 0000 0003 0076 0069 0073 6277 7370 626c  .....v.i.sbwspbl
+00001910: 6f62 0000 00b8 6270 6c69 7374 3030 d601  ob....bplist00..
+00001920: 0203 0405 0607 0807 080b 085d 5368 6f77  ...........]Show
+00001930: 5374 6174 7573 4261 725b 5368 6f77 546f  StatusBar[ShowTo
+00001940: 6f6c 6261 725b 5368 6f77 5461 6256 6965  olbar[ShowTabVie
+00001950: 775f 1014 436f 6e74 6169 6e65 7253 686f  w_..ContainerSho
+00001960: 7753 6964 6562 6172 5c57 696e 646f 7742  wSidebar\WindowB
+00001970: 6f75 6e64 735b 5368 6f77 5369 6465 6261  ounds[ShowSideba
+00001980: 7208 0908 095f 1018 7b7b 3534 332c 2036  r...._..{{543, 6
+00001990: 3433 7d2c 207b 3932 302c 2034 3336 7d7d  43}, {920, 436}}
+000019a0: 0908 1523 2f3b 525f 6b6c 6d6e 6f8a 0000  ...#/;R_klmno...
+000019b0: 0000 0000 0101 0000 0000 0000 000d 0000  ................
+000019c0: 0000 0000 0000 0000 0000 0000 008b 0000  ................
+000019d0: 0003 0076 0069 0073 7653 726e 6c6f 6e67  ...v.i.svSrnlong
+000019e0: 0000 0001 0000 0000 0000 0000 0000 0000  ................
 000019f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -517,132 +517,132 @@
 00002040: 0000 0000 000b 005f 005f 0070 0079 0063  ......._._.p.y.c
 00002050: 0061 0063 0068 0065 005f 005f 496c 6f63  .a.c.h.e._._Iloc
 00002060: 626c 6f62 0000 0010 0000 011d 0000 009e  blob............
 00002070: ffff ffff ffff 0000 0000 0006 006c 006d  .............l.m
 00002080: 0070 0073 0065 0074 496c 6f63 626c 6f62  .p.s.e.tIlocblob
 00002090: 0000 0010 0000 00af 0000 002e ffff ffff  ................
 000020a0: ffff 0000 0000 0006 006c 006d 0070 0073  .........l.m.p.s
-000020b0: 0065 0074 6277 7370 626c 6f62 0000 00b7  .e.tbwspblob....
+000020b0: 0065 0074 6277 7370 626c 6f62 0000 00b8  .e.tbwspblob....
 000020c0: 6270 6c69 7374 3030 d601 0203 0405 0607  bplist00........
 000020d0: 0807 080b 085d 5368 6f77 5374 6174 7573  .....]ShowStatus
 000020e0: 4261 725b 5368 6f77 546f 6f6c 6261 725b  Bar[ShowToolbar[
 000020f0: 5368 6f77 5461 6256 6965 775f 1014 436f  ShowTabView_..Co
 00002100: 6e74 6169 6e65 7253 686f 7753 6964 6562  ntainerShowSideb
 00002110: 6172 5c57 696e 646f 7742 6f75 6e64 735b  ar\WindowBounds[
 00002120: 5368 6f77 5369 6465 6261 7208 0908 095f  ShowSidebar...._
-00002130: 1017 7b7b 3634 2c20 3232 347d 2c20 7b39  ..{{64, 224}, {9
-00002140: 3230 2c20 3433 367d 7d09 0815 232f 3b52  20, 436}}...#/;R
-00002150: 5f6b 6c6d 6e6f 8900 0000 0000 0001 0100  _klmno..........
-00002160: 0000 0000 0000 0d00 0000 0000 0000 0000  ................
-00002170: 0000 0000 0000 8a00 0000 0600 6c00 6d00  ............l.m.
-00002180: 7000 7300 6500 746c 7376 4362 6c6f 6200  p.s.e.tlsvCblob.
-00002190: 0003 1162 706c 6973 7430 30d8 0102 0304  ...bplist00.....
-000021a0: 0506 0708 090a 0b12 5556 570a 5f10 1276  ........UVW._..v
-000021b0: 6965 774f 7074 696f 6e73 5665 7273 696f  iewOptionsVersio
-000021c0: 6e5f 100f 7368 6f77 4963 6f6e 5072 6576  n_..showIconPrev
-000021d0: 6965 7757 636f 6c75 6d6e 735f 1011 6361  iewWcolumns_..ca
-000021e0: 6c63 756c 6174 6541 6c6c 5369 7a65 7358  lculateAllSizesX
-000021f0: 7465 7874 5369 7a65 5a73 6f72 7443 6f6c  textSizeZsortCol
-00002200: 756d 6e58 6963 6f6e 5369 7a65 5f10 1075  umnXiconSize_..u
-00002210: 7365 5265 6c61 7469 7665 4461 7465 7314  seRelativeDates.
-00002220: 0000 0000 0000 0000 0000 0000 0000 0001  ................
-00002230: 09ae 0c15 1d22 262b 3035 3a3e 4347 4b4f  ....."&+05:>CGKO
-00002240: d40d 0e0f 100a 1213 1457 7669 7369 626c  .........Wvisibl
-00002250: 6559 6173 6365 6e64 696e 6755 7769 6474  eYascendingUwidt
-00002260: 685a 6964 656e 7469 6669 6572 0908 1101  hZidentifier....
-00002270: 2c54 6e61 6d65 d410 1617 1819 1a12 1255  ,Tname.........U
-00002280: 7769 6474 6859 6173 6365 6e64 696e 6757  widthYascendingW
-00002290: 7669 7369 626c 6558 7562 6971 7569 7479  visibleXubiquity
-000022a0: 1023 0808 d410 0e0f 0d1e 1220 0a5c 6461  .#......... .\da
-000022b0: 7465 4d6f 6469 6669 6564 0810 b509 d410  teModified......
-000022c0: 0e0f 0d23 1220 125b 6461 7465 4372 6561  ...#. .[dateCrea
-000022d0: 7465 6408 08d4 100e 0f0d 2712 290a 5473  ted.......'.).Ts
-000022e0: 697a 6508 1061 09d4 100e 0f0d 2c0a 2e0a  ize..a......,...
-000022f0: 546b 696e 6409 1073 09d4 100e 0f0d 310a  Tkind..s......1.
-00002300: 3312 556c 6162 656c 0910 6408 d410 0e0f  3.Ulabel..d.....
-00002310: 0d36 0a38 1257 7665 7273 696f 6e09 104b  .6.8.Wversion..K
-00002320: 08d4 100e 0f0d 3b0a 1312 5863 6f6d 6d65  ......;...Xcomme
-00002330: 6e74 7309 08d4 100e 0f0d 3f12 4112 5e64  nts.......?.A.^d
-00002340: 6174 654c 6173 744f 7065 6e65 6408 10c8  ateLastOpened...
-00002350: 08d4 100e 0f0d 4412 4112 5a73 6861 7265  ......D.A.Zshare
-00002360: 4f77 6e65 7208 08d4 100e 0f0d 4812 4112  Owner.......H.A.
-00002370: 5f10 0f73 6861 7265 4c61 7374 4564 6974  _..shareLastEdit
-00002380: 6f72 0808 d410 1617 184c 2012 1259 6461  or.......L ..Yda
-00002390: 7465 4164 6465 6408 08d4 1816 1710 1251  teAdded........Q
-000023a0: 1253 0810 d208 5f10 1069 6e76 6974 6174  .S...._..invitat
-000023b0: 696f 6e53 7461 7475 7308 2340 2a00 0000  ionStatus.#@*...
-000023c0: 0000 0054 6e61 6d65 2340 3000 0000 0000  ...Tname#@0.....
-000023d0: 0009 0008 0019 002e 0040 0048 005c 0065  .........@.H.\.e
-000023e0: 0070 0079 008c 009d 009e 00ad 00b6 00be  .p.y............
-000023f0: 00c8 00ce 00d9 00da 00db 00de 00e3 00ec  ................
-00002400: 00f2 00fc 0104 010d 010f 0110 0111 011a  ................
-00002410: 0127 0128 012a 012b 0134 0140 0141 0142  .'.(.*.+.4.@.A.B
-00002420: 014b 0150 0151 0153 0154 015d 0162 0163  .K.P.Q.S.T.].b.c
-00002430: 0165 0166 016f 0175 0176 0178 0179 0182  .e.f.o.u.v.x.y..
-00002440: 018a 018b 018d 018e 0197 01a0 01a1 01a2  ................
-00002450: 01ab 01ba 01bb 01bd 01be 01c7 01d2 01d3  ................
-00002460: 01d4 01dd 01ef 01f0 01f1 01fa 0204 0205  ................
-00002470: 0206 020f 0210 0212 0213 0226 0227 0230  ...........&.'.0
-00002480: 0235 023e 0000 0000 0000 0201 0000 0000  .5.>............
-00002490: 0000 0059 0000 0000 0000 0000 0000 0000  ...Y............
-000024a0: 0000 023f 0000 0006 006c 006d 0070 0073  ...?.....l.m.p.s
-000024b0: 0065 0074 6c73 7670 626c 6f62 0000 026c  .e.tlsvpblob...l
-000024c0: 6270 6c69 7374 3030 d801 0203 0405 0607  bplist00........
-000024d0: 0809 0a0b 1a45 4647 0a5f 1012 7669 6577  .....EFG._..view
-000024e0: 4f70 7469 6f6e 7356 6572 7369 6f6e 5f10  OptionsVersion_.
-000024f0: 0f73 686f 7749 636f 6e50 7265 7669 6577  .showIconPreview
-00002500: 5763 6f6c 756d 6e73 5f10 1163 616c 6375  Wcolumns_..calcu
-00002510: 6c61 7465 416c 6c53 697a 6573 5874 6578  lateAllSizesXtex
-00002520: 7453 697a 655a 736f 7274 436f 6c75 6d6e  tSizeZsortColumn
-00002530: 5869 636f 6e53 697a 655f 1010 7573 6552  XiconSize_..useR
-00002540: 656c 6174 6976 6544 6174 6573 1400 0000  elativeDates....
-00002550: 0000 0000 0000 0000 0000 0000 0109 d90c  ................
-00002560: 0d0e 0f10 1112 1314 151e 2328 2d32 363b  ..........#(-26;
-00002570: 3f58 636f 6d6d 656e 7473 556c 6162 656c  ?XcommentsUlabel
-00002580: 5776 6572 7369 6f6e 5b64 6174 6543 7265  Wversion[dateCre
-00002590: 6174 6564 5473 697a 655c 6461 7465 4d6f  atedTsize\dateMo
-000025a0: 6469 6669 6564 546b 696e 6454 6e61 6d65  difiedTkindTname
-000025b0: 5e64 6174 654c 6173 744f 7065 6e65 64d4  ^dateLastOpened.
-000025c0: 1617 1819 1a0a 1c1d 5776 6973 6962 6c65  ........Wvisible
-000025d0: 5961 7363 656e 6469 6e67 5577 6964 7468  YascendingUwidth
-000025e0: 5569 6e64 6578 0809 1101 2c10 07d4 1617  Uindex....,.....
-000025f0: 1819 1a0a 2122 0809 1064 1005 d416 1718  ....!"...d......
-00002600: 191a 0a26 2708 0910 4b10 06d4 1617 1819  ...&'...K.......
-00002610: 1a1a 2b2c 0808 10b5 1002 d416 1718 190a  ..+,............
-00002620: 1a30 3109 0810 6110 03d4 1617 1819 0a1a  .01...a.........
-00002630: 2b35 0908 1001 d416 1718 190a 0a39 3a09  +5...........9:.
-00002640: 0910 7310 04d4 1917 1816 3c1a 1c0a 1000  ..s.......<.....
-00002650: 0809 d416 1718 191a 1a42 4308 0810 c810  .........BC.....
-00002660: 0808 2340 2a00 0000 0000 0054 6e61 6d65  ..#@*......Tname
-00002670: 2340 3000 0000 0000 0009 0008 0019 002e  #@0.............
-00002680: 0040 0048 005c 0065 0070 0079 008c 009d  .@.H.\.e.p.y....
-00002690: 009e 00b1 00ba 00c0 00c8 00d4 00d9 00e6  ................
-000026a0: 00eb 00f0 00ff 0108 0110 011a 0120 0126  ............. .&
-000026b0: 0127 0128 012b 012d 0136 0137 0138 013a  .'.(.+.-.6.7.8.:
-000026c0: 013c 0145 0146 0147 0149 014b 0154 0155  .<.E.F.G.I.K.T.U
-000026d0: 0156 0158 015a 0163 0164 0165 0167 0169  .V.X.Z.c.d.e.g.i
-000026e0: 0172 0173 0174 0176 017f 0180 0181 0183  .r.s.t.v........
-000026f0: 0185 018e 0190 0191 0192 019b 019c 019d  ................
-00002700: 019f 01a1 01a2 01ab 01b0 01b9 0000 0000  ................
-00002710: 0000 0201 0000 0000 0000 0049 0000 0000  ...........I....
-00002720: 0000 0000 0000 0000 0000 01ba 0000 0006  ................
-00002730: 006c 006d 0070 0073 0065 0074 7653 726e  .l.m.p.s.e.tvSrn
-00002740: 6c6f 6e67 0000 0001 0000 0007 006d 006f  long.........m.o
-00002750: 006c 0064 0072 0061 0077 496c 6f63 626c  .l.d.r.a.wIlocbl
-00002760: 6f62 0000 0010 0000 011d 0000 002e ffff  ob..............
-00002770: ffff ffff 0000 6e74 6169 6e65 7253 686f  ......ntainerSho
+00002130: 1018 7b7b 3534 332c 2036 3433 7d2c 207b  ..{{543, 643}, {
+00002140: 3932 302c 2034 3336 7d7d 0908 1523 2f3b  920, 436}}...#/;
+00002150: 525f 6b6c 6d6e 6f8a 0000 0000 0000 0101  R_klmno.........
+00002160: 0000 0000 0000 000d 0000 0000 0000 0000  ................
+00002170: 0000 0000 0000 008b 0000 0006 006c 006d  .............l.m
+00002180: 0070 0073 0065 0074 6c73 7643 626c 6f62  .p.s.e.tlsvCblob
+00002190: 0000 0311 6270 6c69 7374 3030 d801 0203  ....bplist00....
+000021a0: 0405 0607 0809 0a0b 1255 5657 0a5f 1012  .........UVW._..
+000021b0: 7669 6577 4f70 7469 6f6e 7356 6572 7369  viewOptionsVersi
+000021c0: 6f6e 5f10 0f73 686f 7749 636f 6e50 7265  on_..showIconPre
+000021d0: 7669 6577 5763 6f6c 756d 6e73 5f10 1163  viewWcolumns_..c
+000021e0: 616c 6375 6c61 7465 416c 6c53 697a 6573  alculateAllSizes
+000021f0: 5874 6578 7453 697a 655a 736f 7274 436f  XtextSizeZsortCo
+00002200: 6c75 6d6e 5869 636f 6e53 697a 655f 1010  lumnXiconSize_..
+00002210: 7573 6552 656c 6174 6976 6544 6174 6573  useRelativeDates
+00002220: 1400 0000 0000 0000 0000 0000 0000 0000  ................
+00002230: 0109 ae0c 151d 2226 2b30 353a 3e43 474b  ......"&+05:>CGK
+00002240: 4fd4 0d0e 0f10 0a12 1314 5776 6973 6962  O.........Wvisib
+00002250: 6c65 5961 7363 656e 6469 6e67 5577 6964  leYascendingUwid
+00002260: 7468 5a69 6465 6e74 6966 6965 7209 0811  thZidentifier...
+00002270: 012c 546e 616d 65d4 1016 1718 191a 1212  .,Tname.........
+00002280: 5577 6964 7468 5961 7363 656e 6469 6e67  UwidthYascending
+00002290: 5776 6973 6962 6c65 5875 6269 7175 6974  WvisibleXubiquit
+000022a0: 7910 2308 08d4 100e 0f0d 1e12 200a 5c64  y.#......... .\d
+000022b0: 6174 654d 6f64 6966 6965 6408 10b5 09d4  ateModified.....
+000022c0: 100e 0f0d 2312 2012 5b64 6174 6543 7265  ....#. .[dateCre
+000022d0: 6174 6564 0808 d410 0e0f 0d27 1229 0a54  ated.......'.).T
+000022e0: 7369 7a65 0810 6109 d410 0e0f 0d2c 0a2e  size..a......,..
+000022f0: 0a54 6b69 6e64 0910 7309 d410 0e0f 0d31  .Tkind..s......1
+00002300: 0a33 1255 6c61 6265 6c09 1064 08d4 100e  .3.Ulabel..d....
+00002310: 0f0d 360a 3812 5776 6572 7369 6f6e 0910  ..6.8.Wversion..
+00002320: 4b08 d410 0e0f 0d3b 0a13 1258 636f 6d6d  K......;...Xcomm
+00002330: 656e 7473 0908 d410 0e0f 0d3f 1241 125e  ents.......?.A.^
+00002340: 6461 7465 4c61 7374 4f70 656e 6564 0810  dateLastOpened..
+00002350: c808 d410 0e0f 0d44 1241 125a 7368 6172  .......D.A.Zshar
+00002360: 654f 776e 6572 0808 d410 0e0f 0d48 1241  eOwner.......H.A
+00002370: 125f 100f 7368 6172 654c 6173 7445 6469  ._..shareLastEdi
+00002380: 746f 7208 08d4 1016 1718 4c20 1212 5964  tor.......L ..Yd
+00002390: 6174 6541 6464 6564 0808 d418 1617 1012  ateAdded........
+000023a0: 5112 5308 10d2 085f 1010 696e 7669 7461  Q.S...._..invita
+000023b0: 7469 6f6e 5374 6174 7573 0823 402a 0000  tionStatus.#@*..
+000023c0: 0000 0000 546e 616d 6523 4030 0000 0000  ....Tname#@0....
+000023d0: 0000 0900 0800 1900 2e00 4000 4800 5c00  ..........@.H.\.
+000023e0: 6500 7000 7900 8c00 9d00 9e00 ad00 b600  e.p.y...........
+000023f0: be00 c800 ce00 d900 da00 db00 de00 e300  ................
+00002400: ec00 f200 fc01 0401 0d01 0f01 1001 1101  ................
+00002410: 1a01 2701 2801 2a01 2b01 3401 4001 4101  ..'.(.*.+.4.@.A.
+00002420: 4201 4b01 5001 5101 5301 5401 5d01 6201  B.K.P.Q.S.T.].b.
+00002430: 6301 6501 6601 6f01 7501 7601 7801 7901  c.e.f.o.u.v.x.y.
+00002440: 8201 8a01 8b01 8d01 8e01 9701 a001 a101  ................
+00002450: a201 ab01 ba01 bb01 bd01 be01 c701 d201  ................
+00002460: d301 d401 dd01 ef01 f001 f101 fa02 0402  ................
+00002470: 0502 0602 0f02 1002 1202 1302 2602 2702  ............&.'.
+00002480: 3002 3502 3e00 0000 0000 0002 0100 0000  0.5.>...........
+00002490: 0000 0000 5900 0000 0000 0000 0000 0000  ....Y...........
+000024a0: 0000 0002 3f00 0000 0600 6c00 6d00 7000  ....?.....l.m.p.
+000024b0: 7300 6500 746c 7376 7062 6c6f 6200 0002  s.e.tlsvpblob...
+000024c0: 6c62 706c 6973 7430 30d8 0102 0304 0506  lbplist00.......
+000024d0: 0708 090a 0b1a 4546 470a 5f10 1276 6965  ......EFG._..vie
+000024e0: 774f 7074 696f 6e73 5665 7273 696f 6e5f  wOptionsVersion_
+000024f0: 100f 7368 6f77 4963 6f6e 5072 6576 6965  ..showIconPrevie
+00002500: 7757 636f 6c75 6d6e 735f 1011 6361 6c63  wWcolumns_..calc
+00002510: 756c 6174 6541 6c6c 5369 7a65 7358 7465  ulateAllSizesXte
+00002520: 7874 5369 7a65 5a73 6f72 7443 6f6c 756d  xtSizeZsortColum
+00002530: 6e58 6963 6f6e 5369 7a65 5f10 1075 7365  nXiconSize_..use
+00002540: 5265 6c61 7469 7665 4461 7465 7314 0000  RelativeDates...
+00002550: 0000 0000 0000 0000 0000 0000 0001 09d9  ................
+00002560: 0c0d 0e0f 1011 1213 1415 1e23 282d 3236  ...........#(-26
+00002570: 3b3f 5863 6f6d 6d65 6e74 7355 6c61 6265  ;?XcommentsUlabe
+00002580: 6c57 7665 7273 696f 6e5b 6461 7465 4372  lWversion[dateCr
+00002590: 6561 7465 6454 7369 7a65 5c64 6174 654d  eatedTsize\dateM
+000025a0: 6f64 6966 6965 6454 6b69 6e64 546e 616d  odifiedTkindTnam
+000025b0: 655e 6461 7465 4c61 7374 4f70 656e 6564  e^dateLastOpened
+000025c0: d416 1718 191a 0a1c 1d57 7669 7369 626c  .........Wvisibl
+000025d0: 6559 6173 6365 6e64 696e 6755 7769 6474  eYascendingUwidt
+000025e0: 6855 696e 6465 7808 0911 012c 1007 d416  hUindex....,....
+000025f0: 1718 191a 0a21 2208 0910 6410 05d4 1617  .....!"...d.....
+00002600: 1819 1a0a 2627 0809 104b 1006 d416 1718  ....&'...K......
+00002610: 191a 1a2b 2c08 0810 b510 02d4 1617 1819  ...+,...........
+00002620: 0a1a 3031 0908 1061 1003 d416 1718 190a  ..01...a........
+00002630: 1a2b 3509 0810 01d4 1617 1819 0a0a 393a  .+5...........9:
+00002640: 0909 1073 1004 d419 1718 163c 1a1c 0a10  ...s.......<....
+00002650: 0008 09d4 1617 1819 1a1a 4243 0808 10c8  ..........BC....
+00002660: 1008 0823 402a 0000 0000 0000 546e 616d  ...#@*......Tnam
+00002670: 6523 4030 0000 0000 0000 0900 0800 1900  e#@0............
+00002680: 2e00 4000 4800 5c00 6500 7000 7900 8c00  ..@.H.\.e.p.y...
+00002690: 9d00 9e00 b100 ba00 c000 c800 d400 d900  ................
+000026a0: e600 eb00 f000 ff01 0801 1001 1a01 2001  .............. .
+000026b0: 2601 2701 2801 2b01 2d01 3601 3701 3801  &.'.(.+.-.6.7.8.
+000026c0: 3a01 3c01 4501 4601 4701 4901 4b01 5401  :.<.E.F.G.I.K.T.
+000026d0: 5501 5601 5801 5a01 6301 6401 6501 6701  U.V.X.Z.c.d.e.g.
+000026e0: 6901 7201 7301 7401 7601 7f01 8001 8101  i.r.s.t.v.......
+000026f0: 8301 8501 8e01 9001 9101 9201 9b01 9c01  ................
+00002700: 9d01 9f01 a101 a201 ab01 b001 b900 0000  ................
+00002710: 0000 0002 0100 0000 0000 0000 4900 0000  ............I...
+00002720: 0000 0000 0000 0000 0000 0001 ba00 0000  ................
+00002730: 0600 6c00 6d00 7000 7300 6500 7476 5372  ..l.m.p.s.e.tvSr
+00002740: 6e6c 6f6e 6700 0000 0100 0000 0700 6d00  nlong.........m.
+00002750: 6f00 6c00 6400 7200 6100 7749 6c6f 6362  o.l.d.r.a.wIlocb
+00002760: 6c6f 6200 0000 1000 0001 1d00 0000 2eff  lob.............
+00002770: ffff ffff ff00 0074 6169 6e65 7253 686f  .......tainerSho
 00002780: 7753 6964 6562 6172 5c57 696e 646f 7742  wSidebar\WindowB
 00002790: 6f75 6e64 735b 5368 6f77 5369 6465 6261  ounds[ShowSideba
-000027a0: 7208 0908 095f 1017 7b7b 3436 2c20 3430  r...._..{{46, 40
-000027b0: 317d 2c20 7b39 3230 2c20 3433 367d 7d09  1}, {920, 436}}.
-000027c0: 0815 232f 3b52 5f6b 6c6d 6e6f 8900 0000  ..#/;R_klmno....
-000027d0: 0000 0001 0100 0000 0000 0000 0d00 0000  ................
-000027e0: 0000 0000 0000 0000 0000 0000 8a00 0000  ................
-000027f0: 0600 7600 6900 6500 7700 3300 6476 5372  ..v.i.e.w.3.dvSr
-00002800: 6e6c 6f6e 0000 0005 0000 0000 0000 280b  nlon..........(.
+000027a0: 7208 0908 095f 1018 7b7b 3534 332c 2036  r...._..{{543, 6
+000027b0: 3433 7d2c 207b 3932 302c 2034 3336 7d7d  43}, {920, 436}}
+000027c0: 0908 1523 2f3b 525f 6b6c 6d6e 6f8a 0000  ...#/;R_klmno...
+000027d0: 0000 0000 0101 0000 0000 0000 000d 0000  ................
+000027e0: 0000 0000 0000 0000 0000 0000 008b 0000  ................
+000027f0: 0006 0076 0069 0065 0077 0033 0064 7074  ...v.i.e.w.3.dpt
+00002800: 624c 7573 0000 0005 0000 0000 0000 280b  bLus..........(.
 00002810: 0000 0045 0000 100c 0000 0108 0000 200b  ...E.......... .
 00002820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -713,57 +713,57 @@
 00002c80: 0100 0100 0000 0000 0100 0200 0000 0000  ................
 00002c90: 0100 0400 0000 0000 0100 0800 0000 0000  ................
 00002ca0: 0100 1000 0000 0000 0100 2000 0000 0000  .......... .....
 00002cb0: 0100 4000 0000 0000 0100 8000 0000 0000  ..@.............
 00002cc0: 0101 0000 0000 0000 0102 0000 0000 0000  ................
 00002cd0: 0104 0000 0000 0000 0108 0000 0000 0000  ................
 00002ce0: 0110 0000 0000 0000 0120 0000 0000 0000  ......... ......
-00002cf0: 0140 0000 0000 0000 0050 7265 7669 6577  .@.......Preview
-00002d00: 5763 6f6c 756d 6e73 5f10 1163 616c 6375  Wcolumns_..calcu
-00002d10: 6c61 7465 416c 6c53 697a 6573 5874 6578  lateAllSizesXtex
-00002d20: 7453 697a 655a 736f 7274 436f 6c75 6d6e  tSizeZsortColumn
-00002d30: 5869 636f 6e53 697a 655f 1010 7573 6552  XiconSize_..useR
-00002d40: 656c 6174 6976 6544 6174 6573 1400 0000  elativeDates....
-00002d50: 0000 0000 0000 0000 0000 0000 0109 d90c  ................
-00002d60: 0d0e 0f10 1112 1314 151e 2328 2d32 363b  ..........#(-26;
-00002d70: 3f58 636f 6d6d 656e 7473 556c 6162 656c  ?XcommentsUlabel
-00002d80: 5776 6572 7369 6f6e 5b64 6174 6543 7265  Wversion[dateCre
-00002d90: 6174 6564 5473 697a 655c 6461 7465 4d6f  atedTsize\dateMo
-00002da0: 6469 6669 6564 546b 696e 6454 6e61 6d65  difiedTkindTname
-00002db0: 5e64 6174 654c 6173 744f 7065 6e65 64d4  ^dateLastOpened.
-00002dc0: 1617 1819 1a0a 1c1d 5776 6973 6962 6c65  ........Wvisible
-00002dd0: 5961 7363 656e 6469 6e67 5577 6964 7468  YascendingUwidth
-00002de0: 5569 6e64 6578 0809 1101 2c10 07d4 1617  Uindex....,.....
-00002df0: 1819 1a0a 2122 0809 1064 1005 d416 1718  ....!"...d......
-00002e00: 191a 0a26 2708 0910 4b10 06d4 1617 1819  ...&'...K.......
-00002e10: 1a1a 2b2c 0808 10b5 1002 d416 1718 190a  ..+,............
-00002e20: 1a30 3109 0810 6110 03d4 1617 1819 0a1a  .01...a.........
-00002e30: 2b35 0908 1001 d416 1718 190a 0a39 3a09  +5...........9:.
-00002e40: 0910 7310 04d4 1917 1816 3c1a 1c0a 1000  ..s.......<.....
-00002e50: 0809 d416 1718 191a 1a42 4308 0810 c810  .........BC.....
-00002e60: 0808 2340 2a00 0000 0000 0054 6e61 6d65  ..#@*......Tname
-00002e70: 2340 3000 0000 0000 0009 0008 0019 002e  #@0.............
-00002e80: 0040 0048 005c 0065 0070 0079 008c 009d  .@.H.\.e.p.y....
-00002e90: 009e 00b1 00ba 00c0 00c8 00d4 00d9 00e6  ................
-00002ea0: 00eb 00f0 00ff 0108 0110 011a 0120 0126  ............. .&
-00002eb0: 0127 0128 012b 012d 0136 0137 0138 013a  .'.(.+.-.6.7.8.:
-00002ec0: 013c 0145 0146 0147 0149 014b 0154 0155  .<.E.F.G.I.K.T.U
-00002ed0: 0156 0158 015a 0163 0164 0165 0167 0169  .V.X.Z.c.d.e.g.i
-00002ee0: 0172 0173 0174 0176 017f 0180 0181 0183  .r.s.t.v........
-00002ef0: 0185 018e 0190 0191 0192 019b 019c 019d  ................
-00002f00: 019f 01a1 01a2 01ab 01b0 01b9 0000 0000  ................
-00002f10: 0000 0201 0000 0000 0000 0049 0000 0000  ...........I....
-00002f20: 0000 0000 0000 0000 0000 01ba 0000 0006  ................
-00002f30: 006c 006d 0070 0073 0065 0074 7653 726e  .l.m.p.s.e.tvSrn
-00002f40: 6c6f 6e67 0000 0001 0000 0007 006d 006f  long.........m.o
-00002f50: 006c 0064 0072 0061 0077 496c 6f63 626c  .l.d.r.a.wIlocbl
-00002f60: 6f62 0000 0010 0000 011d 0000 002e ffff  ob..............
-00002f70: ffff ffff 0000 6e74 6169 6e65 7253 686f  ......ntainerSho
+00002cf0: 0140 0000 0000 0000 006e 5072 6576 6965  .@.......nPrevie
+00002d00: 7757 636f 6c75 6d6e 735f 1011 6361 6c63  wWcolumns_..calc
+00002d10: 756c 6174 6541 6c6c 5369 7a65 7358 7465  ulateAllSizesXte
+00002d20: 7874 5369 7a65 5a73 6f72 7443 6f6c 756d  xtSizeZsortColum
+00002d30: 6e58 6963 6f6e 5369 7a65 5f10 1075 7365  nXiconSize_..use
+00002d40: 5265 6c61 7469 7665 4461 7465 7314 0000  RelativeDates...
+00002d50: 0000 0000 0000 0000 0000 0000 0001 09d9  ................
+00002d60: 0c0d 0e0f 1011 1213 1415 1e23 282d 3236  ...........#(-26
+00002d70: 3b3f 5863 6f6d 6d65 6e74 7355 6c61 6265  ;?XcommentsUlabe
+00002d80: 6c57 7665 7273 696f 6e5b 6461 7465 4372  lWversion[dateCr
+00002d90: 6561 7465 6454 7369 7a65 5c64 6174 654d  eatedTsize\dateM
+00002da0: 6f64 6966 6965 6454 6b69 6e64 546e 616d  odifiedTkindTnam
+00002db0: 655e 6461 7465 4c61 7374 4f70 656e 6564  e^dateLastOpened
+00002dc0: d416 1718 191a 0a1c 1d57 7669 7369 626c  .........Wvisibl
+00002dd0: 6559 6173 6365 6e64 696e 6755 7769 6474  eYascendingUwidt
+00002de0: 6855 696e 6465 7808 0911 012c 1007 d416  hUindex....,....
+00002df0: 1718 191a 0a21 2208 0910 6410 05d4 1617  .....!"...d.....
+00002e00: 1819 1a0a 2627 0809 104b 1006 d416 1718  ....&'...K......
+00002e10: 191a 1a2b 2c08 0810 b510 02d4 1617 1819  ...+,...........
+00002e20: 0a1a 3031 0908 1061 1003 d416 1718 190a  ..01...a........
+00002e30: 1a2b 3509 0810 01d4 1617 1819 0a0a 393a  .+5...........9:
+00002e40: 0909 1073 1004 d419 1718 163c 1a1c 0a10  ...s.......<....
+00002e50: 0008 09d4 1617 1819 1a1a 4243 0808 10c8  ..........BC....
+00002e60: 1008 0823 402a 0000 0000 0000 546e 616d  ...#@*......Tnam
+00002e70: 6523 4030 0000 0000 0000 0900 0800 1900  e#@0............
+00002e80: 2e00 4000 4800 5c00 6500 7000 7900 8c00  ..@.H.\.e.p.y...
+00002e90: 9d00 9e00 b100 ba00 c000 c800 d400 d900  ................
+00002ea0: e600 eb00 f000 ff01 0801 1001 1a01 2001  .............. .
+00002eb0: 2601 2701 2801 2b01 2d01 3601 3701 3801  &.'.(.+.-.6.7.8.
+00002ec0: 3a01 3c01 4501 4601 4701 4901 4b01 5401  :.<.E.F.G.I.K.T.
+00002ed0: 5501 5601 5801 5a01 6301 6401 6501 6701  U.V.X.Z.c.d.e.g.
+00002ee0: 6901 7201 7301 7401 7601 7f01 8001 8101  i.r.s.t.v.......
+00002ef0: 8301 8501 8e01 9001 9101 9201 9b01 9c01  ................
+00002f00: 9d01 9f01 a101 a201 ab01 b001 b900 0000  ................
+00002f10: 0000 0002 0100 0000 0000 0000 4900 0000  ............I...
+00002f20: 0000 0000 0000 0000 0000 0001 ba00 0000  ................
+00002f30: 0600 6c00 6d00 7000 7300 6500 7476 5372  ..l.m.p.s.e.tvSr
+00002f40: 6e6c 6f6e 6700 0000 0100 0000 0700 6d00  nlong.........m.
+00002f50: 6f00 6c00 6400 7200 6100 7749 6c6f 6362  o.l.d.r.a.wIlocb
+00002f60: 6c6f 6200 0000 1000 0001 1d00 0000 2eff  lob.............
+00002f70: ffff ffff ff00 0074 6169 6e65 7253 686f  .......tainerSho
 00002f80: 7753 6964 6562 6172 5c57 696e 646f 7742  wSidebar\WindowB
 00002f90: 6f75 6e64 735b 5368 6f77 5369 6465 6261  ounds[ShowSideba
-00002fa0: 7208 0908 095f 1017 7b7b 3436 2c20 3430  r...._..{{46, 40
-00002fb0: 317d 2c20 7b39 3230 2c20 3433 367d 7d09  1}, {920, 436}}.
-00002fc0: 0815 232f 3b52 5f6b 6c6d 6e6f 8900 0000  ..#/;R_klmno....
-00002fd0: 0000 0001 0100 0000 0000 0000 0d00 0000  ................
-00002fe0: 0000 0000 0000 0000 0000 0000 8a00 0000  ................
-00002ff0: 0600 7600 6900 6500 7700 3300 6476 5372  ..v.i.e.w.3.dvSr
-00003000: 6e6c 6f6e                                nlon
+00002fa0: 7208 0908 095f 1018 7b7b 3534 332c 2036  r...._..{{543, 6
+00002fb0: 3433 7d2c 207b 3932 302c 2034 3336 7d7d  43}, {920, 436}}
+00002fc0: 0908 1523 2f3b 525f 6b6c 6d6e 6f8a 0000  ...#/;R_klmno...
+00002fd0: 0000 0000 0101 0000 0000 0000 000d 0000  ................
+00002fe0: 0000 0000 0000 0000 0000 0000 008b 0000  ................
+00002ff0: 0006 0076 0069 0065 0077 0033 0064 7074  ...v.i.e.w.3.dpt
+00003000: 624c 7573                                bLus
```

### Comparing `MCPoly-0.5.1.3/MCPoly/lmpset/DATAtomolTXT.py` & `MCPoly-0.6b1/MCPoly/lmpset/DataToMolTxt.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,18 +1,16 @@
-import math as m
-import numpy as np
-from ase import Atoms
-from ase.io import write
 import os
 import re
+from ase import Atoms
+from ase.io import write
 
-def DATAtomolTXT(file,types={0:0},loc='./',savename=''):
+def DataToMolTxt(file, types = {0:0}, loc = './', savename = ''):
     """
     The method to change LAMMPS Data File into LAMMPS Molecule Text File.
-    DATAtomolTXT(file,types={0:0, ...},loc='./',savename='')
+    DataToMolTxt(file, types = {0:0, ...}, loc = './', savename = '')
     file: Your molecule system name on your .data file.
     types: Change the Atom Type number to suit the main LAMMPS input files.
     loc: File Location. The default is your current location.
     savename: Name of the saved XYZ File. The default is name of origin LAMMPS Data File.
     
     Example 1:
         Input:
@@ -47,15 +45,15 @@
             9 5
             
                 ...
     
     Example 2:
         Input:
             from MCPoly.lmpset import DATAtomolTXT
-            DATAtomolTXT('Poly1',types={1:11},savename='Poly1_rami')
+            DataToMolTxt('Poly1', types = {1:11}, savename = 'Poly1_rami')
             
         Output in Poly1_rami:
             #Polymer: BioPolymer1
 
             84 atoms
             85 bonds
             158 angles
@@ -78,92 +76,93 @@
             6 3
             7 2
             8 4
             9 5
             
                 ...
     """
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir(loc)
-    k=0
-    w1=0
-    n1=0
-    l=[]
-    pastline=''
-    real=[0,0,0]
-    f=open(file+'.data','r')
+    k = 0
+    w1 = 0
+    n1 = 0
+    l = []
+    pastline = ''
+    real = [0, 0, 0]
+    f = open(file+'.data', 'r')
     try:
-        if savename=='':
-            txt=open(file+'.txt','x')
+        if savename == '':
+            txt = open(file+'.txt', 'x')
         else:
-            txt=open(savename+'.txt','x')
+            txt = open(savename+'.txt', 'x')
     except:
-        if savename=='':
-            txt=open(file+'.txt','w')
+        if savename == '':
+            txt = open(file+'.txt', 'w')
         else:
-            txt=open(savename+'.txt','w')
+            txt = open(savename+'.txt', 'w')
     for line in f:
-        del1=re.search(r' types',line)
-        del2=re.search(r' [x-z]lo [x-z]hi',line)
-        a1=re.search(r' atoms',line)
-        m1=re.search(r'Masses',line)
-        c1=re.search(r'Atoms',line)
-        #c2=re.search(r'Bonds',line)
-        #c3=re.search(r'Angles',line)
-        #c4=re.search(r'Dihedrals',line)
-        #c5=re.search(r'Impropers',line)
+        del1 = re.search(r' types', line)
+        del2 = re.search(r' [x-z]lo [x-z]hi', line)
+        a1 = re.search(r' atoms', line)
+        m1 = re.search(r'Masses', line)
+        c1 = re.search(r'Atoms', line)
+        #c2 = re.search(r'Bonds', line)
+        #c3 = re.search(r'Angles', line)
+        #c4 = re.search(r'Dihedrals', line)
+        #c5 = re.search(r'Impropers', line)
         if del1:
             continue
         elif del2:
             continue
-        elif pastline==line and line=='\n':
+        elif pastline == line and line == '\n':
             continue
         elif a1:
-            b1=re.search(r'[0-9]+',line)
-            num=b1.group(0)
+            b1 = re.search(r'[0-9]+', line)
+            num = b1.group(0)
             txt.write(line)
         elif c1:
-            w1=1
-        elif w1==1:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if len(l1)==7:
+            w1 = 1
+        elif w1 == 1:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if len(l1) == 7:
                 l.append(l1)
-                if l1[0]==num:
-                    w1=2
-        elif w1==2:
+                if l1[0] == num:
+                    w1 = 2
+        elif w1 == 2:
             txt.write('Coords\n\n')
             for i4 in range(len(l)):
-                txt.write('{0} {1} {2} {3}\n'.format(i4+1,eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])))
+                txt.write('{0} {1} {2} {3}\n'.format(i4+1, eval(l[i4][-3]),\
+                                                     eval(l[i4][-2]), eval(l[i4][-1])))
             txt.write('\n')
             txt.write('Types\n\n')
             for i4 in range(len(l)):
                 try:
-                    ju=types[eval(l[i4][2])]
-                    txt.write('{0} {1}\n'.format(i4+1,ju))
+                    ju = types[eval(l[i4][2])]
+                    txt.write('{0} {1}\n'.format(i4+1, ju))
                 except:
-                    txt.write('{0} {1}\n'.format(i4+1,eval(l[i4][2])))
+                    txt.write('{0} {1}\n'.format(i4+1, eval(l[i4][2])))
             txt.write('\n')
             txt.write('Charges\n\n')
             for i4 in range(len(l)):
-                txt.write('{0} {1}\n'.format(i4+1,eval(l[i4][3])))
+                txt.write('{0} {1}\n'.format(i4+1, eval(l[i4][3])))
             txt.write('\n')
-            w1=0
-        elif n1==1:
-            l0=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if l0==[]:
+            w1 = 0
+        elif n1 == 1:
+            l0 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if l0 == []:
                 continue
             else:
-                n1=2
-        elif n1==2:
-            l0=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if l0==[]:
-                n1=0
+                n1 = 2
+        elif n1 == 2:
+            l0 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if l0 == []:
+                n1 = 0
                 continue
             else:
                 continue
         elif m1:
-            n1=1
+            n1 = 1
         else:
             txt.write(line)
-        pastline=line
+        pastline = line
     f.close()
     txt.close()
```

### Comparing `MCPoly-0.5.1.3/MCPoly/lmpset/chain.py` & `MCPoly-0.6b1/MCPoly/lmpset/chain.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,31 +1,28 @@
 import re
 import os
-import warnings
-import math as m
-from ase.io import read, write
 import sys
 
 mydir = os.path.dirname( __file__ )
 lmpdir = os.path.join(mydir, '..', 'lmpset')
 sys.path.append(lmpdir)
 from infchain import infchain
 
-def chain(file,bondtype,degree,loc='./'):
+def chain(file, bondtype, degree, loc='./'):
     """
-    The method to create a single molecule for a finite chain, specialised for polymers.
-    chain(file,bondtype,degree,loc='./')
+    The method to create a single molecule for a finite chain,  specialised for polymers.
+    chain(file, bondtype, degree, loc='./')
     file: Your molecule system name on your .data file.
     degree: Degree of polymerisation.
     bondtype: The bond type between the start and the end of the polymer. 
     loc: File Location. The default is your current location.
     Example:
         Input:
             from MCPoly.lmpset import chain
-            chain('BioPolymer2',11,16)
+            chain('BioPolymer2', 11, 16)
         Output in Poly1_16x.data:
             1314 atoms
             1345 bonds
             2468 angles
             3382 dihedrals
             753 impropers
             
@@ -36,1193 +33,1277 @@
             3 improper types
             
             ...
             82 1 83 1
             
             ...
     """
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir(loc)
-    k=0
-    w1=0
-    w2=0
-    w3=0
-    w4=0
-    w5=0
-    n1=0
-    t2=0
-    t3=0
-    t4=0
-    t5=0
-    H=[]
-    lx=[]
-    lost2_u=[]
-    lost2_d=[]
-    lost3_u=[]
-    lost3_d=[]
-    lost4_u=[]
-    lost4_d=[]
-    lost5_u=[]
-    lost5_d=[]
-    Hloc=[[0.0,0.0,0.0],[0.0,0.0,0.0]]
-    l=[]
-    real=[0,0,0]
-    inp = open('{0}.data'.format(file),'r')
+    k = 0
+    w1 = 0
+    w2 = 0
+    w3 = 0
+    w4 = 0
+    w5 = 0
+    n1 = 0
+    t2 = 0
+    t3 = 0
+    t4 = 0
+    t5 = 0
+    H = []
+    lx = []
+    lost2_u = []
+    lost2_d = []
+    lost3_u = []
+    lost3_d = []
+    lost4_u = []
+    lost4_d = []
+    lost5_u = []
+    lost5_d = []
+    Hloc = [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]
+    l = []
+    real = [0, 0, 0]
+    inp = open('{0}.data'.format(file), 'r')
     for line in inp:
-        a1=re.search(r' atoms',line)
-        a2=re.search(r' bonds',line)
-        a3=re.search(r' angles',line)
-        a4=re.search(r' dihedrals',line)
-        a5=re.search(r' impropers',line)
-        a6=re.search(r' xlo xhi',line)
-        a7=re.search(r' ylo yhi',line)
-        a8=re.search(r' zlo zhi',line)
-        
-        m1=re.search(r'Masses',line)
+        a1 = re.search(r' atoms', line)
+        a2 = re.search(r' bonds', line)
+        a3 = re.search(r' angles', line)
+        a4 = re.search(r' dihedrals', line)
+        a5 = re.search(r' impropers', line)
+        a6 = re.search(r' xlo xhi', line)
+        a7 = re.search(r' ylo yhi', line)
+        a8 = re.search(r' zlo zhi', line)
+        m1 = re.search(r'Masses', line)
         if a1:
-            b1=re.search(r'[0-9]+',line)
-            tipnum=eval(b1.group(0))
+            b1 = re.search(r'[0-9]+', line)
+            tipnum = eval(b1.group(0))
         elif a2:
-            b2=re.search(r'[0-9]+',line)
-            tipnum2=eval(b2.group(0))
+            b2 = re.search(r'[0-9]+', line)
+            tipnum2 = eval(b2.group(0))
         elif a3:
-            b3=re.search(r'[0-9]+',line)
-            tipnum3=eval(b3.group(0))
+            b3 = re.search(r'[0-9]+', line)
+            tipnum3 = eval(b3.group(0))
         elif a4:
-            b4=re.search(r'[0-9]+',line)
-            tipnum4=eval(b4.group(0))
+            b4 = re.search(r'[0-9]+', line)
+            tipnum4 = eval(b4.group(0))
         elif a5:
-            b5=re.search(r'[0-9]+',line)
-            tipnum5=eval(b5.group(0))
+            b5 = re.search(r'[0-9]+', line)
+            tipnum5 = eval(b5.group(0))
         elif a6:
-            b6=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            tipgapx=eval(b6[1])-eval(b6[0])
-            xlo=eval(b6[0])
-            xhi=eval(b6[1])
+            b6 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            tipgapx = eval(b6[1]) - eval(b6[0])
+            xlo = eval(b6[0])
+            xhi = eval(b6[1])
         elif a7:
-            b7=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            gapy=eval(b7[1])-eval(b7[0])
-            ylo=eval(b7[0])
+            b7 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            gapy = eval(b7[1]) - eval(b7[0])
+            ylo = eval(b7[0])
         elif a8:
-            b8=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            gapz=eval(b8[1])-eval(b8[0])
-            zlo=eval(b8[0])
-        if n1==1:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if l1==[]:
+            b8 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            gapz = eval(b8[1]) - eval(b8[0])
+            zlo = eval(b8[0])
+        if n1 == 1:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if l1 == []:
                 continue
             else:
-                n1=2
-        if n1==2:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if l1==[]:
-                n1=0
+                n1 = 2
+        if n1 == 2:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if l1 == []:
+                n1 = 0
                 continue
-            if eval(l1[-1])<1.1:
+            if eval(l1[-1]) < 1.1:
                 H.append(eval(l1[0]))
         if m1:
-            n1=1
-        c1=re.search('Atoms',line)
-        c2=re.search('Bonds',line)
-        c3=re.search('Angles',line)
-        c4=re.search('Dihedrals',line)
-        c5=re.search('Impropers',line)
+            n1 = 1
+        c1 = re.search('Atoms', line)
+        c2 = re.search('Bonds', line)
+        c3 = re.search('Angles', line)
+        c4 = re.search('Dihedrals', line)
+        c5 = re.search('Impropers', line)
         if c1:
-            w1=1
+            w1 = 1
         elif c2:
-            w2=1
+            w2 = 1
         elif c3:
-            w3=1
+            w3 = 1
         elif c4:
-            w4=1
+            w4 = 1
         elif c5:
-            w5=1
-        elif w1==1:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if len(l1)>=6:
+            w5 = 1
+        elif w1 == 1:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if len(l1) >= 6:
                 l.append(l1)
-                if eval(l1[0])==tipnum:
-                    w1=2
-        elif w1==2:
-            xmin=99999
-            xmax=-99999
-            xmaxnum=0
-            xminnum=0
-            realxmin=99999
-            realxmax=-99999
-            realxmaxnum=0
-            realxminnum=0
+                if eval(l1[0]) == tipnum:
+                    w1 = 2
+        elif w1 == 2:
+            xmin = 99999
+            xmax = -99999
+            xmaxnum = 0
+            xminnum = 0
+            realxmin = 99999
+            realxmax = -99999
+            realxmaxnum = 0
+            realxminnum = 0
             for i4 in range(len(l)):
                 if eval(l[i4][2]) not in H:
                     continue
-                if eval(l[i4][-3])>xmax:
-                    xmax=eval(l[i4][-3])
-                    xmaxnum=eval(l[i4][0])
-                    Hloc[1]=[eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])]
-                if eval(l[i4][-3])<xmin:
-                    xmin=eval(l[i4][-3])
-                    xminnum=eval(l[i4][0])
-                    Hloc[0]=[eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])]
+                if eval(l[i4][-3]) > xmax:
+                    xmax = eval(l[i4][-3])
+                    xmaxnum = eval(l[i4][0])
+                    Hloc[1] = [eval(l[i4][-3]), eval(l[i4][-2]), eval(l[i4][-1])]
+                if eval(l[i4][-3]) < xmin:
+                    xmin = eval(l[i4][-3])
+                    xminnum = eval(l[i4][0])
+                    Hloc[0] = [eval(l[i4][-3]), eval(l[i4][-2]), eval(l[i4][-1])]
             for i4 in range(len(l)):
                 if eval(l[i4][2]) in H:
                     continue
-                if eval(l[i4][-3])>realxmax:
-                    realxmax=eval(l[i4][-3])
-                    realxmaxnum=eval(l[i4][0])
-                if eval(l[i4][-3])<realxmin:
-                    realxmin=eval(l[i4][-3])
-                    realxminnum=eval(l[i4][0])
-            w1=0
-        elif w2==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==4:
+                if eval(l[i4][-3]) > realxmax:
+                    realxmax = eval(l[i4][-3])
+                    realxmaxnum = eval(l[i4][0])
+                if eval(l[i4][-3]) < realxmin:
+                    realxmin = eval(l[i4][-3])
+                    realxminnum = eval(l[i4][0])
+            w1 = 0
+        elif w2 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 4:
                 l.append(l1)
-                if eval(l1[0])==tipnum2:
-                    w2=2
-                    j=1
-        elif w2==2:
+                if eval(l1[0]) == tipnum2:
+                    w2 = 2
+                    j = 1
+        elif w2 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][2])==xminnum:
-                        lost2_d=[eval(l[i4][-2]),eval(l[i4][-1])]
-                    elif eval(l[i4][2])==xmaxnum:
-                        lost2_u=[eval(l[i4][-2]),eval(l[i4][-1])]
-                    continue
-                elif eval(l[i4][3]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][3])==xminnum:
-                        lost2_d=[eval(l[i4][-2]),eval(l[i4][-1])]
-                    elif eval(l[i4][3])==xmaxnum:
-                        lost2_u=[eval(l[i4][-2]),eval(l[i4][-1])]
-                    continue
-                j=j+1
-            k=k+1
-            l=[]
-            t2=j
-            j=1
-            w2=0
-            k=0
-        elif w3==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==5:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][2]) == xminnum:
+                        lost2_d = [eval(l[i4][-2]), eval(l[i4][-1])]
+                    elif eval(l[i4][2]) == xmaxnum:
+                        lost2_u = [eval(l[i4][-2]), eval(l[i4][-1])]
+                    continue
+                elif eval(l[i4][3]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][3]) == xminnum:
+                        lost2_d = [eval(l[i4][-2]), eval(l[i4][-1])]
+                    elif eval(l[i4][3]) == xmaxnum:
+                        lost2_u = [eval(l[i4][-2]), eval(l[i4][-1])]
+                    continue
+                j = j + 1
+            k = k + 1
+            l = []
+            t2 = j
+            j = 1
+            w2 = 0
+            k = 0
+        elif w3 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 5:
                 l.append(l1)
-                if eval(l1[0])==tipnum3:
-                    w3=2
-                    j=1
-        elif w3==2:
+                if eval(l1[0]) == tipnum3:
+                    w3 = 2
+                    j = 1
+        elif w3 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][2])==xminnum:
-                        lost3_d.append([eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    elif eval(l[i4][2])==xmaxnum:
-                        lost3_u.append([eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    continue
-                elif eval(l[i4][3]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][3])==xminnum:
-                        lost3_d.append([eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    if eval(l[i4][3])==xmaxnum:
-                        lost3_u.append([eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    continue
-                elif eval(l[i4][4]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][4])==xminnum:
-                        lost3_d.append([eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    if eval(l[i4][4])==xmaxnum:
-                        lost3_u.append([eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    continue
-                j=j+1
-            k=k+1
-            l=[]
-            t3=j
-            j=1
-            k=0
-            w3=0
-        elif w4==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==6:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][2]) == xminnum:
+                        lost3_d.append([eval(l[i4][-3]), eval(l[i4][-2]), eval(l[i4][-1])])
+                    elif eval(l[i4][2]) == xmaxnum:
+                        lost3_u.append([eval(l[i4][-3]), eval(l[i4][-2]), eval(l[i4][-1])])
+                    continue
+                elif eval(l[i4][3]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][3]) == xminnum:
+                        lost3_d.append([eval(l[i4][-3]), eval(l[i4][-2]), eval(l[i4][-1])])
+                    if eval(l[i4][3]) == xmaxnum:
+                        lost3_u.append([eval(l[i4][-3]), eval(l[i4][-2]), eval(l[i4][-1])])
+                    continue
+                elif eval(l[i4][4]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][4]) == xminnum:
+                        lost3_d.append([eval(l[i4][-3]), eval(l[i4][-2]), eval(l[i4][-1])])
+                    if eval(l[i4][4]) == xmaxnum:
+                        lost3_u.append([eval(l[i4][-3]), eval(l[i4][-2]), eval(l[i4][-1])])
+                    continue
+                j = j + 1
+            k = k + 1
+            l = []
+            t3 = j
+            j = 1
+            k = 0
+            w3 = 0
+        elif w4 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 6:
                 l.append(l1)
-                if eval(l1[0])==tipnum4:
-                    w4=2
-                    j=1
-        elif w4==2:
+                if eval(l1[0]) == tipnum4:
+                    w4 = 2
+                    j = 1
+        elif w4 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][2])==xminnum:
-                        lost4_d.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    elif eval(l[i4][2])==xmaxnum:
-                        lost4_u.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    continue
-                elif eval(l[i4][3]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][3])==xminnum:
-                        lost4_d.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    elif eval(l[i4][3])==xmaxnum:
-                        lost4_u.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    continue
-                elif eval(l[i4][4]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][4])==xminnum:
-                        lost4_d.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    elif eval(l[i4][4])==xmaxnum:
-                        lost4_u.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    continue
-                elif eval(l[i4][5]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][5])==xminnum:
-                        lost4_d.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    elif eval(l[i4][5])==xmaxnum:
-                        lost4_u.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    continue
-                j=j+1
-            k=k+1
-            l=[]
-            t4=j
-            j=1
-            k=0
-            w4=0
-        elif w5==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==6:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][2]) == xminnum:
+                        lost4_d.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    elif eval(l[i4][2]) == xmaxnum:
+                        lost4_u.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    continue
+                elif eval(l[i4][3]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][3]) == xminnum:
+                        lost4_d.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    elif eval(l[i4][3]) == xmaxnum:
+                        lost4_u.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    continue
+                elif eval(l[i4][4]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][4]) == xminnum:
+                        lost4_d.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    elif eval(l[i4][4]) == xmaxnum:
+                        lost4_u.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    continue
+                elif eval(l[i4][5]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][5]) == xminnum:
+                        lost4_d.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    elif eval(l[i4][5]) == xmaxnum:
+                        lost4_u.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    continue
+                j = j + 1
+            k = k + 1
+            l = []
+            t4 = j
+            j = 1
+            k = 0
+            w4 = 0
+        elif w5 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 6:
                 l.append(l1)
-                if eval(l1[0])==tipnum5:
-                    w5=2
-                    j=1
-        elif w5==2:
+                if eval(l1[0]) == tipnum5:
+                    w5 = 2
+                    j = 1
+        elif w5 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][2])==xminnum:
-                        lost5_d.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    elif eval(l[i4][2])==xmaxnum:
-                        lost5_u.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    continue
-                elif eval(l[i4][3]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][3])==xminnum:
-                        lost5_d.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    elif eval(l[i4][3])==xmaxnum:
-                        lost5_u.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    continue
-                elif eval(l[i4][4]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][4])==xminnum:
-                        lost5_d.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    elif eval(l[i4][4])==xmaxnum:
-                        lost5_u.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    continue
-                elif eval(l[i4][5]) in [xminnum,xmaxnum]:
-                    if eval(l[i4][5])==xminnum:
-                        lost5_d.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    elif eval(l[i4][5])==xmaxnum:
-                        lost5_u.append([eval(l[i4][-4]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])])
-                    continue
-                j=j+1
-            k=k+1
-            l=[]
-            t5=j
-            j=1
-            k=0
-            w4=0
-
-    k=0
-    w1=0
-    w2=0
-    w3=0
-    w4=0
-    w5=0
-    gap=0
-    l=[]
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][2]) == xminnum:
+                        lost5_d.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    elif eval(l[i4][2]) == xmaxnum:
+                        lost5_u.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    continue
+                elif eval(l[i4][3]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][3]) == xminnum:
+                        lost5_d.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    elif eval(l[i4][3]) == xmaxnum:
+                        lost5_u.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    continue
+                elif eval(l[i4][4]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][4]) == xminnum:
+                        lost5_d.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    elif eval(l[i4][4]) == xmaxnum:
+                        lost5_u.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    continue
+                elif eval(l[i4][5]) in [xminnum, xmaxnum]:
+                    if eval(l[i4][5]) == xminnum:
+                        lost5_d.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    elif eval(l[i4][5]) == xmaxnum:
+                        lost5_u.append([eval(l[i4][-4]), eval(l[i4][-3]),\
+                                        eval(l[i4][-2]), eval(l[i4][-1])])
+                    continue
+                j = j + 1
+            k = k + 1
+            l = []
+            t5 = j
+            j = 1
+            k = 0
+            w4 = 0
+    k = 0
+    w1 = 0
+    w2 = 0
+    w3 = 0
+    w4 = 0
+    w5 = 0
+    gap = 0
+    l = []
     try:
-        med = open('{0}_Chain.data'.format(file),'r')
+        med = open('{0}_Chain.data'.format(file), 'r')
     except:
-        infchain(file,bondtype,loc)
-        med = open('{0}_Chain.data'.format(file),'r')
+        infchain(file, bondtype, loc)
+        med = open('{0}_Chain.data'.format(file), 'r')
     for line in med:
-        a1=re.search(r' atoms',line)
-        a2=re.search(r' bonds',line)
-        a3=re.search(r' angles',line)
-        a4=re.search(r' dihedrals',line)
-        a5=re.search(r' impropers',line)
-        a6=re.search(r' xlo xhi',line)
+        a1 = re.search(r' atoms', line)
+        a2 = re.search(r' bonds', line)
+        a3 = re.search(r' angles', line)
+        a4 = re.search(r' dihedrals', line)
+        a5 = re.search(r' impropers', line)
+        a6 = re.search(r' xlo xhi', line)
         
-        m1=re.search(r'Masses',line)
+        m1 = re.search(r'Masses', line)
         if a1:
-            b1=re.search(r'[0-9]+',line)
-            num=eval(b1.group(0))
+            b1 = re.search(r'[0-9]+', line)
+            num = eval(b1.group(0))
         elif a2:
-            b2=re.search(r'[0-9]+',line)
-            num2=eval(b2.group(0))
+            b2 = re.search(r'[0-9]+', line)
+            num2 = eval(b2.group(0))
         elif a3:
-            b3=re.search(r'[0-9]+',line)
-            num3=eval(b3.group(0))
+            b3 = re.search(r'[0-9]+', line)
+            num3 = eval(b3.group(0))
         elif a4:
-            b4=re.search(r'[0-9]+',line)
-            num4=eval(b4.group(0))
+            b4 = re.search(r'[0-9]+', line)
+            num4 = eval(b4.group(0))
         elif a5:
-            b5=re.search(r'[0-9]+',line)
-            num5=eval(b5.group(0))
+            b5 = re.search(r'[0-9]+', line)
+            num5 = eval(b5.group(0))
         elif a6:
-            b6=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            gapx=eval(b6[1])-eval(b6[0])
-        if n1==1:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if l1==[]:
+            b6 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            gapx = eval(b6[1]) - eval(b6[0])
+        if n1 == 1:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if l1 == []:
                 continue
             else:
-                n1=2
-        if n1==2:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if l1==[]:
-                n1=0
+                n1 = 2
+        if n1 == 2:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if l1 == []:
+                n1 = 0
                 continue
             if eval(l1[-1])<1.1:
                 H.append(eval(l1[0]))
         if m1:
-            n1=1
-        c1=re.search('Atoms',line)
-        c2=re.search('Bonds',line)
-        c3=re.search('Angles',line)
-        c4=re.search('Dihedrals',line)
-        c5=re.search('Impropers',line)
+            n1 = 1
+        c1 = re.search('Atoms', line)
+        c2 = re.search('Bonds', line)
+        c3 = re.search('Angles', line)
+        c4 = re.search('Dihedrals', line)
+        c5 = re.search('Impropers', line)
         if c1:
-            w1=1
+            w1 = 1
         elif c2:
-            w2=1
+            w2 = 1
         elif c3:
-            w3=1
+            w3 = 1
         elif c4:
-            w4=1
+            w4 = 1
         elif c5:
-            w5=1
-        elif w1==1:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if len(l1)>=6:
+            w5 = 1
+        elif w1 == 1:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if len(l1) >= 6:
                 l.append(l1)
-                if eval(l1[0])==tipnum:
-                    w1=2
-        elif w1==2:
-            w1=0
-        elif w2==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==4:
+                if eval(l1[0]) == tipnum:
+                    w1 = 2
+        elif w1 == 2:
+            w1 = 0
+        elif w2 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 4:
                 l.append(l1)
-                if eval(l1[0])==tipnum2:
-                    w2=2
-                    j=1
-        elif w2==2:
+                if eval(l1[0]) == tipnum2:
+                    w2 = 2
+                    j = 1
+        elif w2 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
                     continue
-                j=j+1
-            k=k+1
-            l=[]
-            t2=j
-            j=1
-            w2=0
-            k=0
-        elif w3==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==5:
+                j = j + 1
+            k = k + 1
+            l = []
+            t2 = j
+            j = 1
+            w2 = 0
+            k = 0
+        elif w3 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 5:
                 l.append(l1)
-                if eval(l1[0])==tipnum3:
-                    w3=2
-                    j=1
-        elif w3==2:
+                if eval(l1[0]) == tipnum3:
+                    w3 = 2
+                    j = 1
+        elif w3 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][4]) in [xminnum,xmaxnum]:
+                if eval(l[i4][4]) in [xminnum, xmaxnum]:
                     continue
-                j=j+1
-            k=k+1
-            l=[]
-            t3=j
-            j=1
-            k=0
-            w3=0
-        elif w4==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==6:
+                j = j + 1
+            k = k + 1
+            l = []
+            t3 = j
+            j = 1
+            k = 0
+            w3 = 0
+        elif w4 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 6:
                 l.append(l1)
-                if eval(l1[0])==tipnum4:
-                    w4=2
-                    j=1
-        elif w4==2:
+                if eval(l1[0]) == tipnum4:
+                    w4 = 2
+                    j = 1
+        elif w4 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][4]) in [xminnum,xmaxnum]:
+                if eval(l[i4][4]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][5]) in [xminnum,xmaxnum]:
+                if eval(l[i4][5]) in [xminnum, xmaxnum]:
                     continue
-                j=j+1
-            k=k+1
-            l=[]
-            t4=j
-            j=1
-            k=0
-            w4=0
-        elif w5==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==6:
+                j = j + 1
+            k = k + 1
+            l = []
+            t4 = j
+            j = 1
+            k = 0
+            w4 = 0
+        elif w5 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 6:
                 l.append(l1)
-                if eval(l1[0])==tipnum5:
-                    w5=2
-                    j=1
-        elif w5==2:
+                if eval(l1[0]) == tipnum5:
+                    w5 = 2
+                    j = 1
+        elif w5 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][4]) in [xminnum,xmaxnum]:
+                if eval(l[i4][4]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][5]) in [xminnum,xmaxnum]:
+                if eval(l[i4][5]) in [xminnum, xmaxnum]:
                     continue
-                j=j+1
-            k=k+1
-            l=[]
-            t5=j
-            j=1
-            k=0
-            w4=0
+                j = j + 1
+            k = k + 1
+            l = []
+            t5 = j
+            j = 1
+            k = 0
+            w4 = 0
     try:
-        f = open('{0}_{1}x.data'.format(file,degree),'x')
+        f = open('{0}_{1}x.data'.format(file, degree), 'x')
     except:
-        f = open('{0}_{1}x.data'.format(file,degree),'w')
+        f = open('{0}_{1}x.data'.format(file, degree), 'w')
     inp.close()
-    k=0
-    w1=0
-    w2=0
-    w3=0
-    w4=0
-    w5=0
-    gap=0
-    l=[]
-    all_x=[]
-    inp = open('{0}.data'.format(file),'r')
+    k = 0
+    w1 = 0
+    w2 = 0
+    w3 = 0
+    w4 = 0
+    w5 = 0
+    gap = 0
+    l = []
+    all_x = []
+    inp = open('{0}.data'.format(file), 'r')
     for line in inp:
-        a1=re.search(r' atoms',line)
-        a2=re.search(r' bonds',line)
-        a3=re.search(r' angles',line)
-        a4=re.search(r' dihedrals',line)
-        a5=re.search(r' impropers',line)
-        a6=re.search(r' xlo xhi',line)
-        a7=re.search(r' ylo yhi',line)
-        a8=re.search(r' zlo zhi',line)
-        c1=re.search('Atoms',line)
-        c2=re.search('Bonds',line)
-        c3=re.search('Angles',line)
-        c4=re.search('Dihedrals',line)
-        c5=re.search('Impropers',line)
+        a1 = re.search(r' atoms', line)
+        a2 = re.search(r' bonds', line)
+        a3 = re.search(r' angles', line)
+        a4 = re.search(r' dihedrals', line)
+        a5 = re.search(r' impropers', line)
+        a6 = re.search(r' xlo xhi', line)
+        a7 = re.search(r' ylo yhi', line)
+        a8 = re.search(r' zlo zhi', line)
+        c1 = re.search('Atoms', line)
+        c2 = re.search('Bonds', line)
+        c3 = re.search('Angles', line)
+        c4 = re.search('Dihedrals', line)
+        c5 = re.search('Impropers', line)
         if a1:
-            b1=re.search(r'[0-9]+',line)
-            f.write('{0} atoms\n'.format((tipnum-2)*degree+2))
-            #allnum=b1.group(0)
+            b1 = re.search(r'[0-9]+', line)
+            f.write('{0} atoms\n'.format((tipnum-2)*degree + 2))
+            #allnum = b1.group(0)
         elif a2:
-            b2=re.search(r'[0-9]+',line)
-            f.write('{0} bonds\n'.format(tipnum2*degree-(degree-1)))
-            #allnum2=b2.group(0)
+            b2 = re.search(r'[0-9]+', line)
+            f.write('{0} bonds\n'.format(tipnum2*degree - (degree-1)))
+            #allnum2 = b2.group(0)
         elif a3:
-            f.write('{0} angles\n'.format(tipnum3+num3*(degree-1)))
-            #allnum3=b3.group(0)
+            f.write('{0} angles\n'.format(tipnum3 + num3*(degree-1)))
+            #allnum3 = b3.group(0)
         elif a4:
-            b4=re.search(r'[0-9]+',line)
-            f.write('{0} dihedrals\n'.format(tipnum4+num4*(degree-1)))
-            #allnum4=b4.group(0)
+            b4 = re.search(r'[0-9]+', line)
+            f.write('{0} dihedrals\n'.format(tipnum4 + num4*(degree-1)))
+            #allnum4 = b4.group(0)
         elif a5:
-            b5=re.search(r'[0-9]+',line)
-            f.write('{0} impropers\n'.format(tipnum5+num5*(degree-1)))
-            #allnum5=b5.group(0)
+            b5 = re.search(r'[0-9]+', line)
+            f.write('{0} impropers\n'.format(tipnum5 + num5*(degree-1)))
+            #allnum5 = b5.group(0)
         elif a6:
-            x1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            xd=eval(x1[1])-eval(x1[0])
-            f.write('{0:.5f} {1:.5f} xlo xhi\n'.format(0.0,tipgapx*(degree-1)+gapx))
+            x1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            xd = eval(x1[1]) - eval(x1[0])
+            f.write('{0:.5f} {1:.5f} xlo xhi\n'.format(0.0,\
+                                                       tipgapx*(degree-1) + gapx))
         elif a7:
-            y1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            yd=eval(y1[1])-eval(y1[0])
-            f.write('{0:.5f} {1:.5f} ylo yhi\n'.format(0.0,gapy))
+            y1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            yd = eval(y1[1]) - eval(y1[0])
+            f.write('{0:.5f} {1:.5f} ylo yhi\n'.format(0.0, gapy))
         elif a8:
-            z1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            zd=eval(z1[1])-eval(z1[0])
-            f.write('{0:.5f} {1:.5f} zlo zhi\n'.format(0.0,gapz))
+            z1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            zd = eval(z1[1]) - eval(z1[0])
+            f.write('{0:.5f} {1:.5f} zlo zhi\n'.format(0.0, gapz))
         elif c1:
-            w1=1
+            w1 = 1
             f.write(line)
             f.write('\n')
         elif c2:
-            w2=1
+            w2 = 1
             f.write(line)
             f.write('\n')
         elif c3:
-            w3=1
+            w3 = 1
             f.write(line)
             f.write('\n')
         elif c4:
-            w4=1
+            w4 = 1
             f.write(line)
             f.write('\n')
         elif c5:
-            w5=1
+            w5 = 1
             f.write(line)
             f.write('\n')
-        elif w1==1:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if len(l1)>=6:
+        elif w1 == 1:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if len(l1) >= 6:
                 l.append(l1)
-                if eval(l1[0])==tipnum:
-                    w1=2
-                    j=1
-        elif w1==2:
-            distance=0
-            allnum=0
+                if eval(l1[0]) == tipnum:
+                    w1 = 2
+                    j = 1
+        elif w1 == 2:
+            distance = 0
+            allnum = 0
             for i3 in range(degree):
                 for i4 in range(eval(b1.group(0))):
-                    if i3!=0 and i3!=degree-1:
-                        if i4+1 in [xminnum,xmaxnum]:
-                            gap=gap+1
-                            j=j+1
-                            continue
-                    elif i3==0:
-                        if i4+1==xmaxnum:
-                            gap=gap+1
-                            j=j+1
+                    if i3 != 0 and i3 != degree-1:
+                        if i4 + 1 in [xminnum, xmaxnum]:
+                            gap = gap + 1
+                            j = j + 1
+                            continue
+                    elif i3 == 0:
+                        if i4 + 1 == xmaxnum:
+                            gap = gap + 1
+                            j = j + 1
                             all_x.append(eval(l[i4][-3]))
                             continue
-                    elif i3==degree-1:
-                        if i4+1==xminnum:
-                            gap=gap+1
-                            j=j+1
-                            continue
-                    #print(i3,j-gap,eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1]))
-                    #if realxmin<=realxmax:
-                    f.write('{0} {1} {2} {3:.4f} {4:.5f} {5:.5f} {6:.5f}\n'.format(j-gap,eval(l[i4][1]),eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][-3])+distance-xlo,eval(l[i4][-2])-ylo,eval(l[i4][-1])-zlo))
+                    elif i3 == degree - 1:
+                        if i4 + 1 == xminnum:
+                            gap = gap + 1
+                            j = j + 1
+                            continue
+                    #print(i3, j-gap, eval(l[i4][-3]), eval(l[i4][-2]), eval(l[i4][-1]))
+                    #if realxmin< = realxmax:
+                    f.write('{0} {1} '.format(j-gap, eval(l[i4][1])))
+                    f.write('{0} {1:.4f} '.format(eval(l[i4][2]), eval(l[i4][3])))
+                    f.write('{0:.5f} '.format(eval(l[i4][-3]) + distance - xlo))
+                    f.write('{0:.5f} '.format(eval(l[i4][-2]) - ylo))
+                    f.write('{0:.5f}\n'.format(eval(l[i4][-1]) - zlo))
 #                    else:
-#                        f.write('{0} {1} {2} {3:.4f} {4:.5f} {5:.5f} {6:.5f}\n'.format(j-gap,eval(l[i4][1]),eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][-3])+distance-xhi,eval(l[i4][-2])-ylo,eval(l[i4][-1])-zlo))
-                    j=j+1
-                    if i3==0:
+#                        f.write('{0} {1} {2} {3:.4f} {4:.5f} {5:.5f} {6:.5f}\n'.format(j-gap,\
+#eval(l[i4][1]), eval(l[i4][2]), eval(l[i4][3]),
+#eval(l[i4][-3]) + distance-xhi, 
+#eval(l[i4][-2])-ylo, eval(l[i4][-1])-zlo))
+                    j = j + 1
+                    if i3 == 0:
                         all_x.append(eval(l[i4][-3]))
-                if i3!=0 and i3!=degree-1:
-                    distance=distance+tipgapx
-                    allnum=allnum+num-2
+                if i3 != 0 and i3 != degree - 1:
+                    distance = distance + tipgapx
+                    allnum = allnum + num - 2
                 else:
-                    distance=distance+gapx
-                    allnum=allnum+num-1
-            l=[]
-            j=1
-            w1=0
+                    distance = distance + gapx
+                    allnum = allnum + num - 1
+            l = []
+            j = 1
+            w1 = 0
             f.write('\n')
-        elif w2==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==4:
+        elif w2 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 4:
                 l.append(l1)
-                if eval(l1[0])==tipnum2:
-                    lx=l
-                    w2=2
-                    j=1
-        elif w2==2:
-            every=0
+                if eval(l1[0]) == tipnum2:
+                    lx = l
+                    w2 = 2
+                    j = 1
+        elif w2 == 2:
+            every = 0
             for i3 in range(degree):
-                repeated=[]
+                repeated = []
                 #print(i3)
                 for i4 in range(eval(b2.group(0))):
-                    if i3!=0 and i3!=degree-1:
-                        if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                    if i3 != 0 and i3 != degree - 1:
+                        if eval(l[i4][2]) in [xminnum, xmaxnum]:
                             #print(l[i4])
                             continue
-                        elif eval(l[i4][2])>min([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])-1)
-                        elif eval(l[i4][2])>max([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])-2)
-                        if eval(l[i4][3]) in [xminnum,xmaxnum]:
-                            if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+2)
-                            continue
-                        elif eval(l[i4][3])>min([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])-1)
-                        elif eval(l[i4][3])>max([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])-2)
-                    elif i3==0:
-                        if eval(l[i4][2])==xmaxnum:
-                            continue
-                        elif eval(l[i4][2])>xmaxnum:
-                            l[i4][2]=str(eval(l[i4][2])-1)
-                        if eval(l[i4][3])==xmaxnum:
-                            if eval(l[i4][2])>=xmaxnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            continue
-                        elif eval(l[i4][3])>xmaxnum:
-                            l[i4][3]=str(eval(l[i4][3])-1)
-                    elif i3==degree-1:
-                        if eval(l[i4][2])==xminnum:
-                            #print('{0} {1}\n'.format(eval(l[i4][2]),eval(l[i4][3])))
-                            continue
-                        elif eval(l[i4][2])>xminnum:
-                            l[i4][2]=str(eval(l[i4][2])-1)
-                        if eval(l[i4][3])==xminnum:
-                            if eval(l[i4][2])>=xminnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            continue
-                        elif eval(l[i4][3])>xminnum:
-                            l[i4][3]=str(eval(l[i4][3])-1)
-                    f.write('{0} {1} {2} {3}\n'.format(j,eval(l[i4][1]),eval(l[i4][2])+every,eval(l[i4][3])+every))
-                    #print('{0} {1} {2} {3}'.format(j,eval(l[i4][1]),eval(l[i4][2])+every,eval(l[i4][3])+every))
-                    j=j+1
-                if i3!=0:
-                    if realxminnum<=realxmaxnum:
-                        f.write('{0} {1} {2} {3}\n'.format(j,bondtype,realxminnum+every,realxmaxnum+every-num-1))
+                        elif eval(l[i4][2])>min([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2]) - 1)
+                        elif eval(l[i4][2])>max([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2]) - 2)
+                        if eval(l[i4][3]) in [xminnum, xmaxnum]:
+                            if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 2)
+                            continue
+                        elif eval(l[i4][3])>min([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3]) - 1)
+                        elif eval(l[i4][3])>max([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3]) - 2)
+                    elif i3 == 0:
+                        if eval(l[i4][2]) == xmaxnum:
+                            continue
+                        elif eval(l[i4][2]) > xmaxnum:
+                            l[i4][2] = str(eval(l[i4][2]) - 1)
+                        if eval(l[i4][3]) == xmaxnum:
+                            if eval(l[i4][2]) >= xmaxnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            continue
+                        elif eval(l[i4][3]) > xmaxnum:
+                            l[i4][3] = str(eval(l[i4][3]) - 1)
+                    elif i3 == degree-1:
+                        if eval(l[i4][2]) == xminnum:
+                            #print('{0} {1}\n'.format(eval(l[i4][2]), eval(l[i4][3])))
+                            continue
+                        elif eval(l[i4][2]) > xminnum:
+                            l[i4][2] = str(eval(l[i4][2]) - 1)
+                        if eval(l[i4][3]) == xminnum:
+                            if eval(l[i4][2]) >= xminnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            continue
+                        elif eval(l[i4][3]) > xminnum:
+                            l[i4][3] = str(eval(l[i4][3]) - 1)
+                    f.write('{0} {1} {2} {3}\n'.format(j, eval(l[i4][1]),\
+                                                       eval(l[i4][2]) + every, eval(l[i4][3]) + every))
+                    #print('{0} {1} {2} {3}'.format(j, eval(l[i4][1]), eval(l[i4][2]) + every, eval(l[i4][3]) + every))
+                    j = j + 1
+                if i3 != 0:
+                    if realxminnum <= realxmaxnum:
+                        f.write('{0} {1} {2} {3}\n'.format(j, bondtype, realxminnum + every,\
+                                                           realxmaxnum + every - num - 1))
                     else:
-                        if i3==degree-1:
-                            f.write('{0} {1} {2} {3}\n'.format(j,bondtype,realxminnum+every,realxmaxnum+every-num-1))
+                        if i3 == degree - 1:
+                            f.write('{0} {1} {2} {3}\n'.format(j, bondtype, realxminnum + every,\
+                                                               realxmaxnum + every - num - 1))
                         else:
-                            f.write('{0} {1} {2} {3}\n'.format(j,bondtype,realxminnum+every-1,realxmaxnum+every-num-1))
-                        #if all_x[eval(l[i4][2])-1]<=all_x[eval(l[i4][3])-1]:
-                        #    if eval(l[i4][2])>eval(l[i4][3])+tipnum*i3:
-                        #        f.write('{0} {1} {2} {3}\n'.format(j,bondtype,realxminnum+every,realxmaxnum+every-num))
+                            f.write('{0} {1} {2} {3}\n'.format(j, bondtype, realxminnum + every - 1,\
+                                                               realxmaxnum + every - num - 1))
+                        #if all_x[eval(l[i4][2])-1]< = all_x[eval(l[i4][3])-1]:
+                        #    if eval(l[i4][2])>eval(l[i4][3]) + tipnum*i3:
+                        #        f.write('{0} {1} {2} {3}\n'.format(j, bondtype,\
+                        #                                           realxminnum + every, realxmaxnum + every - num))
                         #    else:
-                        #        f.write('{0} {1} {2} {3}\n'.format(j,bondtype,realxminnum+every-num,realxmaxnum+every))
+                        #        f.write('{0} {1} {2} {3}\n'.format(j, bondtype,\
+                        #                                           realxminnum + every-num, realxmaxnum + every))
                         #elif all_x[eval(l[i4][2])-1]>all_x[eval(l[i4][3])-1]:
-                        #    if eval(l[i4][2])>eval(l[i4][3])+tipnum*i3:
-                        #        f.write('{0} {1} {2} {3}\n'.format(j,bondtype,realxminnum+every-num,realxmaxnum+every))
+                        #    if eval(l[i4][2])>eval(l[i4][3]) + tipnum*i3:
+                        #        f.write('{0} {1} {2} {3}\n'.format(j, bondtype,\
+                        #                                           realxminnum + every-num, realxmaxnum + every))
                         #    else:
-                        #        f.write('{0} {1} {2} {3}\n'.format(j,bondtype,realxminnum+every,realxmaxnum+every-num))
-                    #print('{0} {1} {2} {3}'.format(j,bondtype,realxminnum+every-1,realxmaxnum+every-num-1))
-                    j=j+1
-                #l=lx
-                if i3==0 or i3==degree-1:
-                    every=every+tipnum-1
+                        #        f.write('{0} {1} {2} {3}\n'.format(j, bondtype,\
+                        #                                           realxminnum + every, realxmaxnum + every - num))
+                    #print('{0} {1} {2} {3}'.format(j, bondtype,\
+                    #                               realxminnum + every-1, realxmaxnum + every - num - 1))
+                    j = j + 1
+                #l = lx
+                if i3 == 0 or i3 == degree - 1:
+                    every = every + tipnum - 1
                 else:
-                    every=every+tipnum-2
-                #print(l[-1],xmaxnum)
+                    every = every + tipnum - 2
+                #print(l[-1], xmaxnum)
                 for i4 in range(eval(b2.group(0))):
-                    if i3!=0 and i3!=degree-1:
-                        if ([eval(l[i4][2]),eval(l[i4][3])]==lost2_u or [eval(l[i4][2]),eval(l[i4][3])]==lost2_d) and [eval(l[i4][2]),eval(l[i4][3])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3])])
-                            continue
-                        elif eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])+1)
-                        elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])+2)
-                        if eval(l[i4][3])>=min([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                        elif eval(l[i4][3])+1>=max([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])+2)
-                    elif i3==0:
-                        if ([eval(l[i4][2]),eval(l[i4][3])]==lost2_u or [eval(l[i4][2]),eval(l[i4][3])]==lost2_d) and [eval(l[i4][2]),eval(l[i4][3])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3])])
-                            continue
-                        if eval(l[i4][2])>=xmaxnum:
-                            l[i4][2]=str(eval(l[i4][2])+1)  
-                        if eval(l[i4][3])>=xmaxnum:
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                    elif i3==degree-1:
-                        if ([eval(l[i4][2]),eval(l[i4][3])]==lost2_u or [eval(l[i4][2]),eval(l[i4][3])]==lost2_d) and [eval(l[i4][2]),eval(l[i4][3])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3])])
-                            continue
-                        if eval(l[i4][2])>=xminnum:
-                            l[i4][2]=str(eval(l[i4][2])+1)
-                        if eval(l[i4][3])>=xminnum:
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                #if i3==1:
+                    if i3 != 0 and i3 != degree - 1:
+                        if (([eval(l[i4][2]), eval(l[i4][3])] == lost2_u
+                                 or [eval(l[i4][2]), eval(l[i4][3])] == lost2_d) and
+                            [eval(l[i4][2]), eval(l[i4][3])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3])])
+                            continue
+                        elif eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2]) + 1)
+                        elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2]) + 2)
+                        if eval(l[i4][3]) >= min([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                        elif eval(l[i4][3]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3]) + 2)
+                    elif i3 == 0:
+                        if (([eval(l[i4][2]), eval(l[i4][3])] == lost2_u
+                                 or [eval(l[i4][2]), eval(l[i4][3])] == lost2_d) and
+                            [eval(l[i4][2]), eval(l[i4][3])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3])])
+                            continue
+                        if eval(l[i4][2]) >= xmaxnum:
+                            l[i4][2] = str(eval(l[i4][2]) + 1)  
+                        if eval(l[i4][3]) >= xmaxnum:
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                    elif i3 == degree-1:
+                        if (([eval(l[i4][2]), eval(l[i4][3])] == lost2_u
+                                 or [eval(l[i4][2]), eval(l[i4][3])] == lost2_d) and
+                            [eval(l[i4][2]), eval(l[i4][3])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3])])
+                            continue
+                        if eval(l[i4][2]) >= xminnum:
+                            l[i4][2] = str(eval(l[i4][2]) + 1)
+                        if eval(l[i4][3]) >= xminnum:
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                #if i3 == 1:
                     #print(l)
-            k=k+1
-            l=[]
-            j=1
-            w2=0
-            k=0
+            k = k + 1
+            l = []
+            j = 1
+            w2 = 0
+            k = 0
             f.write('\n')
-        elif w3==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==5:
+        elif w3 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 5:
                 l.append(l1)
-                if eval(l1[0])==tipnum3:
-                    w3=2
-                    j=1
-            #lx=l
-        elif w3==2:
-            every=0
+                if eval(l1[0]) == tipnum3:
+                    w3 = 2
+                    j = 1
+            #lx = l
+        elif w3 == 2:
+            every = 0
             for i3 in range(degree):
-                repeated=[]
+                repeated = []
                 for i4 in range(len(l)):
-                    if i3==0:
-                        if eval(l[i4][2])==xmaxnum:
+                    if i3 == 0:
+                        if eval(l[i4][2]) == xmaxnum:
                             continue
-                        elif eval(l[i4][2])>xmaxnum:
-                            l[i4][2]=str(eval(l[i4][2])-1) 
-                        if eval(l[i4][3])==xmaxnum:
-                            if eval(l[i4][2])>=xmaxnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            continue
-                        elif eval(l[i4][3])>xmaxnum:
-                            l[i4][3]=str(eval(l[i4][3])-1)
-                        if eval(l[i4][4])==xmaxnum:
-                            if eval(l[i4][2])>=xmaxnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            if eval(l[i4][3])>=xmaxnum:
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            continue
-                        elif eval(l[i4][4])>xmaxnum:
-                            l[i4][4]=str(eval(l[i4][4])-1)  
-                    elif i3==degree-1:
-                        if eval(l[i4][2])==xminnum:
-                            continue
-                        elif eval(l[i4][2])>xminnum:
-                            l[i4][2]=str(eval(l[i4][2])-1) 
-                        if eval(l[i4][3])==xminnum:
-                            if eval(l[i4][2])>=xminnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            continue
-                        elif eval(l[i4][3])>xmaxnum:
-                            l[i4][3]=str(eval(l[i4][3])-1)
-                        if eval(l[i4][4])==xminnum:
-                            if eval(l[i4][2])>=xminnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            if eval(l[i4][3])>=xminnum:
-                                l[i4][3]=str(eval(l[i4][3])+1)
+                        elif eval(l[i4][2]) > xmaxnum:
+                            l[i4][2] = str(eval(l[i4][2])-1) 
+                        if eval(l[i4][3]) == xmaxnum:
+                            if eval(l[i4][2]) >= xmaxnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            continue
+                        elif eval(l[i4][3]) > xmaxnum:
+                            l[i4][3] = str(eval(l[i4][3])-1)
+                        if eval(l[i4][4]) == xmaxnum:
+                            if eval(l[i4][2]) >= xmaxnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            if eval(l[i4][3]) >= xmaxnum:
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            continue
+                        elif eval(l[i4][4]) > xmaxnum:
+                            l[i4][4] = str(eval(l[i4][4])-1)  
+                    elif i3 == degree-1:
+                        if eval(l[i4][2]) == xminnum:
+                            continue
+                        elif eval(l[i4][2]) > xminnum:
+                            l[i4][2] = str(eval(l[i4][2])-1) 
+                        if eval(l[i4][3]) == xminnum:
+                            if eval(l[i4][2]) >= xminnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            continue
+                        elif eval(l[i4][3]) > xmaxnum:
+                            l[i4][3] = str(eval(l[i4][3])-1)
+                        if eval(l[i4][4]) == xminnum:
+                            if eval(l[i4][2]) >= xminnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            if eval(l[i4][3]) >= xminnum:
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
                             continue
-                        elif eval(l[i4][4])>xminnum:
-                            l[i4][4]=str(eval(l[i4][4])-1)           
+                        elif eval(l[i4][4]) > xminnum:
+                            l[i4][4] = str(eval(l[i4][4])-1)           
                     else:
-                        if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                        if eval(l[i4][2]) in [xminnum, xmaxnum]:
                             continue
-                        elif eval(l[i4][2])>min([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])-1)
-                        elif eval(l[i4][2])>max([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])-2)  
-                        if eval(l[i4][3]) in [xminnum,xmaxnum]:
-                            if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+2)
-                            continue
-                        elif eval(l[i4][3])>min([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])-1)
-                        elif eval(l[i4][3])>max([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])-2)  
-                        if eval(l[i4][4]) in [xminnum,xmaxnum]:
-                            if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+2)
-                            if eval(l[i4][3])>=min([xminnum,xmaxnum]):
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            elif eval(l[i4][3])+1>=max([xminnum,xmaxnum]):
-                                l[i4][3]=str(eval(l[i4][3])+2)
-                            continue
-                        elif eval(l[i4][4])>min([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])-1)
-                        elif eval(l[i4][4])>max([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])-2)  
-                    f.write('{0} {1} {2} {3} {4}\n'.format(j,eval(l[i4][1]),eval(l[i4][2])+every,eval(l[i4][3])+every,eval(l[i4][4])+every))
-                    j=j+1
-                if i3==0 or i3==degree-1:
-                    every=every+tipnum-1
+                        elif eval(l[i4][2])>min([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2])-1)
+                        elif eval(l[i4][2])>max([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2])-2)  
+                        if eval(l[i4][3]) in [xminnum, xmaxnum]:
+                            if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 2)
+                            continue
+                        elif eval(l[i4][3])>min([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3])-1)
+                        elif eval(l[i4][3])>max([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3])-2)  
+                        if eval(l[i4][4]) in [xminnum, xmaxnum]:
+                            if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 2)
+                            if eval(l[i4][3]) >= min([xminnum, xmaxnum]):
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            elif eval(l[i4][3]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][3] = str(eval(l[i4][3]) + 2)
+                            continue
+                        elif eval(l[i4][4])>min([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4])-1)
+                        elif eval(l[i4][4])>max([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4])-2)  
+                    f.write('{0} {1} {2} {3} {4}\n'.format(j, eval(l[i4][1]),\
+                                                           eval(l[i4][2]) + every, eval(l[i4][3]) + every, eval(l[i4][4]) + every))
+                    j = j + 1
+                if i3 == 0 or i3 == degree-1:
+                    every = every + tipnum-1
                 else:
-                    every=every+tipnum-2
+                    every = every + tipnum-2
                 for i4 in range(len(l)):
-                    if i3==0:
-                        if ([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])] in lost3_u or [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])] in lost3_d) and [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])])
-                            continue
-                        elif eval(l[i4][2])>=xmaxnum:
-                            l[i4][2]=str(eval(l[i4][2])+1) 
-                        if eval(l[i4][3])>=xmaxnum:
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                        if eval(l[i4][4])>=xmaxnum:
-                            l[i4][4]=str(eval(l[i4][4])+1)  
-                    elif i3==degree-1:
-                        if ([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])] in lost3_u or [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])] in lost3_d) and [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])])
-                            continue
-                        elif eval(l[i4][2])>=xminnum:
-                            l[i4][2]=str(eval(l[i4][2])+1) 
-                        if eval(l[i4][3])>=xminnum:
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                        if eval(l[i4][4])>=xminnum:
-                            l[i4][4]=str(eval(l[i4][4])+1)           
+                    if i3 == 0:
+                        if (([eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])] in lost3_u
+                                 or [eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])] in lost3_d) and
+                            [eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])])
+                            continue
+                        elif eval(l[i4][2]) >= xmaxnum:
+                            l[i4][2] = str(eval(l[i4][2]) + 1) 
+                        if eval(l[i4][3]) >= xmaxnum:
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                        if eval(l[i4][4]) >= xmaxnum:
+                            l[i4][4] = str(eval(l[i4][4]) + 1)  
+                    elif i3 == degree-1:
+                        if (([eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])] in lost3_u
+                                 or [eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])] in lost3_d) and
+                            [eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])])
+                            continue
+                        elif eval(l[i4][2]) >= xminnum:
+                            l[i4][2] = str(eval(l[i4][2]) + 1) 
+                        if eval(l[i4][3]) >= xminnum:
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                        if eval(l[i4][4]) >= xminnum:
+                            l[i4][4] = str(eval(l[i4][4]) + 1)           
                     else:
-                        if ([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])] in lost3_u or [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])] in lost3_d) and [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])])
-                            continue
-                        if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])+1)
-                        elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])+2)  
-                        if eval(l[i4][3])>=min([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                        elif eval(l[i4][3])+1>=max([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])+2)  
-                        if eval(l[i4][4])>=min([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])+1)
-                        elif eval(l[i4][4])+1>=max([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])+2)
-                #l=lx
-            k=k+1
-            l=[]
-            j=1
-            k=0
-            w3=0
+                        if (([eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])] in lost3_u
+                                 or [eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])] in lost3_d) and
+                            [eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])])
+                            continue
+                        if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2]) + 1)
+                        elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2]) + 2)  
+                        if eval(l[i4][3]) >= min([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                        elif eval(l[i4][3]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3]) + 2)  
+                        if eval(l[i4][4]) >= min([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4]) + 1)
+                        elif eval(l[i4][4]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4]) + 2)
+                #l = lx
+            k = k + 1
+            l = []
+            j = 1
+            k = 0
+            w3 = 0
             f.write('\n')
-        elif w4==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==6:
+        elif w4 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 6:
                 l.append(l1)
-                if eval(l1[0])==tipnum4:
-                    w4=2
-                    j=1
-            #lx=l
-        elif w4==2:
-            every=0
+                if eval(l1[0]) == tipnum4:
+                    w4 = 2
+                    j = 1
+            #lx = l
+        elif w4 == 2:
+            every = 0
             for i3 in range(degree):
-                repeated=[]
+                repeated = []
                 for i4 in range(len(l)):
-                    if i3==0:
-                        if eval(l[i4][2])==xmaxnum:
+                    if i3 == 0:
+                        if eval(l[i4][2]) == xmaxnum:
                             continue
-                        elif eval(l[i4][2])>xmaxnum:
-                            l[i4][2]=str(eval(l[i4][2])-1)
-                        if eval(l[i4][3])==xmaxnum:
-                            if eval(l[i4][2])>=xmaxnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            continue
-                        elif eval(l[i4][3])>xmaxnum:
-                            l[i4][3]=str(eval(l[i4][3])-1)  
-                        if eval(l[i4][4])==xmaxnum:
-                            if eval(l[i4][2])>=xmaxnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            if eval(l[i4][3])>=xmaxnum:
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            continue
-                        elif eval(l[i4][4])>xmaxnum:
-                            l[i4][4]=str(eval(l[i4][4])-1)
-                        if eval(l[i4][5])==xmaxnum:
-                            if eval(l[i4][2])>=xmaxnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            if eval(l[i4][3])>=xmaxnum:
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            if eval(l[i4][4])>=xmaxnum:
-                                l[i4][4]=str(eval(l[i4][4])+1)
-                            continue
-                        elif eval(l[i4][5])>xmaxnum:
-                            l[i4][5]=str(eval(l[i4][5])-1)
-                    elif i3==degree-1:
-                        if eval(l[i4][2])==xminnum:
-                            continue
-                        elif eval(l[i4][2])>xminnum:
-                            l[i4][2]=str(eval(l[i4][2])-1)  
-                        if eval(l[i4][3])==xminnum:
-                            if eval(l[i4][2])>=xminnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            continue
-                        elif eval(l[i4][3])>xminnum:
-                            l[i4][3]=str(eval(l[i4][3])-1)  
-                        if eval(l[i4][4])==xminnum:
-                            if eval(l[i4][2])>=xminnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            if eval(l[i4][3])>=xminnum:
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            continue
-                        elif eval(l[i4][4])>xminnum:
-                            l[i4][4]=str(eval(l[i4][4])-1)
-                        if eval(l[i4][5])==xminnum:
-                            if eval(l[i4][2])>=xminnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            if eval(l[i4][3])>=xminnum:
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            if eval(l[i4][4])>=xminnum:
-                                l[i4][4]=str(eval(l[i4][4])+1)
+                        elif eval(l[i4][2]) > xmaxnum:
+                            l[i4][2] = str(eval(l[i4][2])-1)
+                        if eval(l[i4][3]) == xmaxnum:
+                            if eval(l[i4][2]) >= xmaxnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            continue
+                        elif eval(l[i4][3]) > xmaxnum:
+                            l[i4][3] = str(eval(l[i4][3])-1)  
+                        if eval(l[i4][4]) == xmaxnum:
+                            if eval(l[i4][2]) >= xmaxnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            if eval(l[i4][3]) >= xmaxnum:
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            continue
+                        elif eval(l[i4][4]) > xmaxnum:
+                            l[i4][4] = str(eval(l[i4][4])-1)
+                        if eval(l[i4][5]) == xmaxnum:
+                            if eval(l[i4][2]) >= xmaxnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            if eval(l[i4][3]) >= xmaxnum:
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            if eval(l[i4][4]) >= xmaxnum:
+                                l[i4][4] = str(eval(l[i4][4]) + 1)
+                            continue
+                        elif eval(l[i4][5]) > xmaxnum:
+                            l[i4][5] = str(eval(l[i4][5])-1)
+                    elif i3 == degree-1:
+                        if eval(l[i4][2]) == xminnum:
+                            continue
+                        elif eval(l[i4][2]) > xminnum:
+                            l[i4][2] = str(eval(l[i4][2])-1)  
+                        if eval(l[i4][3]) == xminnum:
+                            if eval(l[i4][2]) >= xminnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            continue
+                        elif eval(l[i4][3]) > xminnum:
+                            l[i4][3] = str(eval(l[i4][3])-1)  
+                        if eval(l[i4][4]) == xminnum:
+                            if eval(l[i4][2]) >= xminnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            if eval(l[i4][3]) >= xminnum:
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            continue
+                        elif eval(l[i4][4]) > xminnum:
+                            l[i4][4] = str(eval(l[i4][4])-1)
+                        if eval(l[i4][5]) == xminnum:
+                            if eval(l[i4][2]) >= xminnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            if eval(l[i4][3]) >= xminnum:
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            if eval(l[i4][4]) >= xminnum:
+                                l[i4][4] = str(eval(l[i4][4]) + 1)
                             continue
-                        elif eval(l[i4][5])>xminnum:
-                            l[i4][5]=str(eval(l[i4][5])-1)
+                        elif eval(l[i4][5]) > xminnum:
+                            l[i4][5] = str(eval(l[i4][5])-1)
                     else:
-                        if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                        if eval(l[i4][2]) in [xminnum, xmaxnum]:
                             continue
-                        elif eval(l[i4][2])>min([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])-1)
-                        elif eval(l[i4][2])>max([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])-2)  
-                        if eval(l[i4][3]) in [xminnum,xmaxnum]:
-                            if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+2)
-                            continue
-                        elif eval(l[i4][3])>min([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])-1)
-                        elif eval(l[i4][3])>max([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])-2)  
-                        if eval(l[i4][4]) in [xminnum,xmaxnum]:
-                            if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+2)
-                            if eval(l[i4][3])>=min([xminnum,xmaxnum]):
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            elif eval(l[i4][3])+1>=max([xminnum,xmaxnum]):
-                                l[i4][3]=str(eval(l[i4][3])+2)
-                            continue
-                        elif eval(l[i4][4])>min([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])-1)
-                        elif eval(l[i4][4])>max([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])-2)  
-                        if eval(l[i4][5]) in [xminnum,xmaxnum]:
-                            if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+2)
-                            if eval(l[i4][3])>=min([xminnum,xmaxnum]):
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            elif eval(l[i4][3])+1>=max([xminnum,xmaxnum]):
-                                l[i4][3]=str(eval(l[i4][3])+2)
-                            if eval(l[i4][4])>=min([xminnum,xmaxnum]):
-                                l[i4][4]=str(eval(l[i4][4])+1)
-                            elif eval(l[i4][4])+1>=max([xminnum,xmaxnum]):
-                                l[i4][4]=str(eval(l[i4][2])+2)
-                            continue
-                        elif eval(l[i4][5])>min([xminnum,xmaxnum]):
-                            l[i4][5]=str(eval(l[i4][5])-1)
-                        elif eval(l[i4][5])>max([xminnum,xmaxnum]):
-                            l[i4][5]=str(eval(l[i4][5])-2)
-                    f.write('{0} {1} {2} {3} {4} {5}\n'.format(j,eval(l[i4][1]),eval(l[i4][2])+every,eval(l[i4][3])+every,eval(l[i4][4])+every,eval(l[i4][5])+every))
-                    j=j+1
+                        elif eval(l[i4][2])>min([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2])-1)
+                        elif eval(l[i4][2])>max([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2])-2)  
+                        if eval(l[i4][3]) in [xminnum, xmaxnum]:
+                            if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 2)
+                            continue
+                        elif eval(l[i4][3])>min([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3])-1)
+                        elif eval(l[i4][3])>max([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3])-2)  
+                        if eval(l[i4][4]) in [xminnum, xmaxnum]:
+                            if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 2)
+                            if eval(l[i4][3]) >= min([xminnum, xmaxnum]):
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            elif eval(l[i4][3]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][3] = str(eval(l[i4][3]) + 2)
+                            continue
+                        elif eval(l[i4][4])>min([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4])-1)
+                        elif eval(l[i4][4])>max([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4])-2)  
+                        if eval(l[i4][5]) in [xminnum, xmaxnum]:
+                            if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 2)
+                            if eval(l[i4][3]) >= min([xminnum, xmaxnum]):
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            elif eval(l[i4][3]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][3] = str(eval(l[i4][3]) + 2)
+                            if eval(l[i4][4]) >= min([xminnum, xmaxnum]):
+                                l[i4][4] = str(eval(l[i4][4]) + 1)
+                            elif eval(l[i4][4]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][4] = str(eval(l[i4][2]) + 2)
+                            continue
+                        elif eval(l[i4][5])>min([xminnum, xmaxnum]):
+                            l[i4][5] = str(eval(l[i4][5])-1)
+                        elif eval(l[i4][5])>max([xminnum, xmaxnum]):
+                            l[i4][5] = str(eval(l[i4][5])-2)
+                    f.write('{0} {1} {2} {3} {4} {5}\n'.format(j, eval(l[i4][1]),\
+                                                               eval(l[i4][2]) + every, eval(l[i4][3]) + every,\
+                                                               eval(l[i4][4]) + every, eval(l[i4][5]) + every))
+                    j = j + 1
                 for i4 in range(len(l)):
-                    if i3==0:
-                        if ([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost4_u or [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost4_d) and [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])])
-                            continue
-                        if eval(l[i4][2])>=xmaxnum:
-                            l[i4][2]=str(eval(l[i4][2])+1)
-                        if eval(l[i4][3])>=xmaxnum:
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                        if eval(l[i4][4])>=xmaxnum:
-                            l[i4][4]=str(eval(l[i4][4])+1)
-                        if eval(l[i4][5])>=xmaxnum:
-                            l[i4][5]=str(eval(l[i4][5])+1)
-                    elif i3==degree-1:
-                        if ([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost4_u or [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost4_d) and [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])])
-                            continue
-                        if eval(l[i4][2])>=xminnum:
-                            l[i4][2]=str(eval(l[i4][2])+1)
-                        if eval(l[i4][3])>=xminnum:
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                        if eval(l[i4][4])>=xminnum:
-                            l[i4][4]=str(eval(l[i4][4])+1)
-                        if eval(l[i4][5])>=xminnum:
-                            l[i4][5]=str(eval(l[i4][5])+1)
+                    if i3 == 0:
+                        if (([eval(l[i4][2]), eval(l[i4][3]),\
+                              eval(l[i4][4]), eval(l[i4][5])] in lost4_u
+                                 or [eval(l[i4][2]), eval(l[i4][3]),\
+                                    eval(l[i4][4]), eval(l[i4][5])] in lost4_d) and
+                            [eval(l[i4][2]), eval(l[i4][3]),\
+                             eval(l[i4][4]), eval(l[i4][5])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3]),\
+                                             eval(l[i4][4]), eval(l[i4][5])])
+                            continue
+                        if eval(l[i4][2]) >= xmaxnum:
+                            l[i4][2] = str(eval(l[i4][2]) + 1)
+                        if eval(l[i4][3]) >= xmaxnum:
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                        if eval(l[i4][4]) >= xmaxnum:
+                            l[i4][4] = str(eval(l[i4][4]) + 1)
+                        if eval(l[i4][5]) >= xmaxnum:
+                            l[i4][5] = str(eval(l[i4][5]) + 1)
+                    elif i3 == degree - 1:
+                        if (([eval(l[i4][2]), eval(l[i4][3]),\
+                              eval(l[i4][4]), eval(l[i4][5])] in lost4_u
+                                 or [eval(l[i4][2]), eval(l[i4][3]),\
+                                     eval(l[i4][4]), eval(l[i4][5])] in lost4_d) and
+                            [eval(l[i4][2]), eval(l[i4][3]),\
+                             eval(l[i4][4]), eval(l[i4][5])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3]),\
+                                             eval(l[i4][4]), eval(l[i4][5])])
+                            continue
+                        if eval(l[i4][2]) >= xminnum:
+                            l[i4][2] = str(eval(l[i4][2]) + 1)
+                        if eval(l[i4][3]) >= xminnum:
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                        if eval(l[i4][4]) >= xminnum:
+                            l[i4][4] = str(eval(l[i4][4]) + 1)
+                        if eval(l[i4][5]) >= xminnum:
+                            l[i4][5] = str(eval(l[i4][5]) + 1)
                     else:
-                        if ([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost4_u or [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost4_d) and [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])])
-                            continue
-                        if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])+1)
-                        elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])+2)  
-                        if eval(l[i4][3])>=min([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                        elif eval(l[i4][3])+1>=max([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])+2)  
-                        if eval(l[i4][4])>=min([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])+1)
-                        elif eval(l[i4][4])+1>=max([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])+2)  
-                        if eval(l[i4][5])>=min([xminnum,xmaxnum]):
-                            l[i4][5]=str(eval(l[i4][5])+1)
-                        elif eval(l[i4][5])+1>=max([xminnum,xmaxnum]):
-                            l[i4][5]=str(eval(l[i4][5])+2)
+                        if (([eval(l[i4][2]), eval(l[i4][3]),\
+                             eval(l[i4][4]), eval(l[i4][5])] in lost4_u
+                                or [eval(l[i4][2]), eval(l[i4][3]),\
+                                    eval(l[i4][4]), eval(l[i4][5])] in lost4_d) and
+                            [eval(l[i4][2]), eval(l[i4][3]),\
+                             eval(l[i4][4]), eval(l[i4][5])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3]),\
+                                             eval(l[i4][4]), eval(l[i4][5])])
+                            continue
+                        if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2]) + 1)
+                        elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2]) + 2)  
+                        if eval(l[i4][3]) >= min([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                        elif eval(l[i4][3]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3]) + 2)  
+                        if eval(l[i4][4]) >= min([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4]) + 1)
+                        elif eval(l[i4][4]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4]) + 2)  
+                        if eval(l[i4][5]) >= min([xminnum, xmaxnum]):
+                            l[i4][5] = str(eval(l[i4][5]) + 1)
+                        elif eval(l[i4][5]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][5] = str(eval(l[i4][5]) + 2)
 
-                if i3==0 or i3==degree-1:
-                    every=every+tipnum-1
+                if i3 == 0 or i3 == degree - 1:
+                    every = every + tipnum - 1
                 else:
-                    every=every+tipnum-2
-                #l=lx
-            k=k+1
-            l=[]
-            j=1
-            k=0
-            w4=0
+                    every = every + tipnum - 2
+                #l = lx
+            k = k + 1
+            l = []
+            j = 1
+            k = 0
+            w4 = 0
             f.write('\n')
-        elif w5==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==6:
+        elif w5 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 6:
                 l.append(l1)
-                if eval(l1[0])==tipnum5:
-                    w5=2
-                    j=1
-            #lx=l
-        elif w5==2:
-            every=0
+                if eval(l1[0]) == tipnum5:
+                    w5 = 2
+                    j = 1
+            #lx = l
+        elif w5 == 2:
+            every = 0
             for i3 in range(degree):
-                repeated=[]
+                repeated = []
                 for i4 in range(len(l)):
-                    if i3==0:
-                        if eval(l[i4][2])==xmaxnum:
+                    if i3 == 0:
+                        if eval(l[i4][2]) == xmaxnum:
                             continue
-                        elif eval(l[i4][2])>xmaxnum:
-                            l[i4][2]=str(eval(l[i4][2])-1)
-                        if eval(l[i4][3])==xmaxnum:
-                            if eval(l[i4][2])>=xmaxnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            continue
-                        elif eval(l[i4][3])>xmaxnum:
-                            l[i4][3]=str(eval(l[i4][3])-1)
-                        if eval(l[i4][4])==xmaxnum:
-                            if eval(l[i4][2])>=xmaxnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            if eval(l[i4][3])>=xmaxnum:
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            continue
-                        elif eval(l[i4][4])>xmaxnum:
-                            l[i4][4]=str(eval(l[i4][4])-1)
-                        if eval(l[i4][5])==xmaxnum:
-                            if eval(l[i4][2])>=xmaxnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            if eval(l[i4][3])>=xmaxnum:
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            if eval(l[i4][4])>=xmaxnum:
-                                l[i4][4]=str(eval(l[i4][4])+1)
-                            continue
-                        elif eval(l[i4][5])>xmaxnum:
-                            l[i4][5]=str(eval(l[i4][5])-1)
-                    elif i3==degree-1:
-                        if eval(l[i4][2])==xminnum:
-                            continue
-                        elif eval(l[i4][2])>xminnum:
-                            l[i4][2]=str(eval(l[i4][2])-1)
-                        if eval(l[i4][3])==xminnum:
-                            if eval(l[i4][2])>=xminnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            continue
-                        elif eval(l[i4][3])>xminnum:
-                            l[i4][3]=str(eval(l[i4][3])-1)
-                        if eval(l[i4][4])==xminnum:
-                            if eval(l[i4][2])>=xminnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            if eval(l[i4][3])>=xminnum:
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            continue
-                        elif eval(l[i4][4])>xminnum:
-                            l[i4][4]=str(eval(l[i4][4])-1)
-                        if eval(l[i4][5])==xminnum:
-                            if eval(l[i4][2])>=xminnum:
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            if eval(l[i4][3])>=xminnum:
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            if eval(l[i4][4])>=xminnum:
-                                l[i4][4]=str(eval(l[i4][4])+1)
+                        elif eval(l[i4][2]) > xmaxnum:
+                            l[i4][2] = str(eval(l[i4][2]) - 1)
+                        if eval(l[i4][3]) == xmaxnum:
+                            if eval(l[i4][2]) >= xmaxnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            continue
+                        elif eval(l[i4][3]) > xmaxnum:
+                            l[i4][3] = str(eval(l[i4][3]) - 1)
+                        if eval(l[i4][4]) == xmaxnum:
+                            if eval(l[i4][2]) >= xmaxnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            if eval(l[i4][3]) >= xmaxnum:
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            continue
+                        elif eval(l[i4][4]) > xmaxnum:
+                            l[i4][4] = str(eval(l[i4][4]) - 1)
+                        if eval(l[i4][5]) == xmaxnum:
+                            if eval(l[i4][2]) >= xmaxnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            if eval(l[i4][3]) >= xmaxnum:
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            if eval(l[i4][4]) >= xmaxnum:
+                                l[i4][4] = str(eval(l[i4][4]) + 1)
+                            continue
+                        elif eval(l[i4][5]) > xmaxnum:
+                            l[i4][5] = str(eval(l[i4][5]) - 1)
+                    elif i3 == degree-1:
+                        if eval(l[i4][2]) == xminnum:
+                            continue
+                        elif eval(l[i4][2]) > xminnum:
+                            l[i4][2] = str(eval(l[i4][2]) - 1)
+                        if eval(l[i4][3]) == xminnum:
+                            if eval(l[i4][2]) >= xminnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            continue
+                        elif eval(l[i4][3]) > xminnum:
+                            l[i4][3] = str(eval(l[i4][3]) - 1)
+                        if eval(l[i4][4]) == xminnum:
+                            if eval(l[i4][2]) >= xminnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            if eval(l[i4][3]) >= xminnum:
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            continue
+                        elif eval(l[i4][4]) > xminnum:
+                            l[i4][4] = str(eval(l[i4][4])-1)
+                        if eval(l[i4][5]) == xminnum:
+                            if eval(l[i4][2]) >= xminnum:
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            if eval(l[i4][3]) >= xminnum:
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            if eval(l[i4][4]) >= xminnum:
+                                l[i4][4] = str(eval(l[i4][4]) + 1)
                             continue
-                        elif eval(l[i4][5])>xminnum:
-                            l[i4][5]=str(eval(l[i4][5])-1)
+                        elif eval(l[i4][5]) > xminnum:
+                            l[i4][5] = str(eval(l[i4][5])-1)
                     else:
-                        if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                        if eval(l[i4][2]) in [xminnum, xmaxnum]:
                             continue
-                        elif eval(l[i4][2])>min([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])-1)
-                        elif eval(l[i4][2])>max([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])-2)  
-                        if eval(l[i4][3]) in [xminnum,xmaxnum]:
-                            if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+2)
-                            continue
-                        elif eval(l[i4][3])>min([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])-1)
-                        elif eval(l[i4][3])>max([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])-2)  
-                        if eval(l[i4][4]) in [xminnum,xmaxnum]:
-                            if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+2)
-                            if eval(l[i4][3])>=min([xminnum,xmaxnum]):
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            elif eval(l[i4][3])+1>=max([xminnum,xmaxnum]):
-                                l[i4][3]=str(eval(l[i4][3])+2)
-                            continue
-                        elif eval(l[i4][4])>min([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])-1)
-                        elif eval(l[i4][4])>max([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])-2)  
-                        if eval(l[i4][5]) in [xminnum,xmaxnum]:
-                            if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+1)
-                            elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                                l[i4][2]=str(eval(l[i4][2])+2)
-                            if eval(l[i4][3])>=min([xminnum,xmaxnum]):
-                                l[i4][3]=str(eval(l[i4][3])+1)
-                            elif eval(l[i4][3])+1>=max([xminnum,xmaxnum]):
-                                l[i4][3]=str(eval(l[i4][3])+2)
-                            if eval(l[i4][4])>=min([xminnum,xmaxnum]):
-                                l[i4][4]=str(eval(l[i4][4])+1)
-                            elif eval(l[i4][4])+1>=max([xminnum,xmaxnum]):
-                                l[i4][4]=str(eval(l[i4][4])+2)
-                            continue
-                        elif eval(l[i4][5])>min([xminnum,xmaxnum]):
-                            l[i4][5]=str(eval(l[i4][5])-1)
-                        elif eval(l[i4][5])>max([xminnum,xmaxnum]):
-                            l[i4][5]=str(eval(l[i4][5])-2)
-                    f.write('{0} {1} {2} {3} {4} {5}\n'.format(j,eval(l[i4][1]),eval(l[i4][2])+every,eval(l[i4][3])+every,eval(l[i4][4])+every,eval(l[i4][5])+every))
-                    j=j+1
+                        elif eval(l[i4][2])>min([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2])-1)
+                        elif eval(l[i4][2])>max([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2])-2)  
+                        if eval(l[i4][3]) in [xminnum, xmaxnum]:
+                            if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 2)
+                            continue
+                        elif eval(l[i4][3])>min([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3])-1)
+                        elif eval(l[i4][3])>max([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3])-2)  
+                        if eval(l[i4][4]) in [xminnum, xmaxnum]:
+                            if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 2)
+                            if eval(l[i4][3]) >= min([xminnum, xmaxnum]):
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            elif eval(l[i4][3]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][3] = str(eval(l[i4][3]) + 2)
+                            continue
+                        elif eval(l[i4][4])>min([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4]) - 1)
+                        elif eval(l[i4][4])>max([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4]) - 2)  
+                        if eval(l[i4][5]) in [xminnum, xmaxnum]:
+                            if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 1)
+                            elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][2] = str(eval(l[i4][2]) + 2)
+                            if eval(l[i4][3]) >= min([xminnum, xmaxnum]):
+                                l[i4][3] = str(eval(l[i4][3]) + 1)
+                            elif eval(l[i4][3]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][3] = str(eval(l[i4][3]) + 2)
+                            if eval(l[i4][4]) >= min([xminnum, xmaxnum]):
+                                l[i4][4] = str(eval(l[i4][4]) + 1)
+                            elif eval(l[i4][4]) + 1 >= max([xminnum, xmaxnum]):
+                                l[i4][4] = str(eval(l[i4][4]) + 2)
+                            continue
+                        elif eval(l[i4][5])>min([xminnum, xmaxnum]):
+                            l[i4][5] = str(eval(l[i4][5])-1)
+                        elif eval(l[i4][5])>max([xminnum, xmaxnum]):
+                            l[i4][5] = str(eval(l[i4][5])-2)
+                    f.write('{0} {1} {2} {3} {4} {5}\n'.format(j, eval(l[i4][1]),\
+                                                               eval(l[i4][2]) + every, eval(l[i4][3]) + every,\
+                                                               eval(l[i4][4]) + every, eval(l[i4][5]) + every))
+                    j = j + 1
                 for i4 in range(len(l)):
-                    if i3==0:
-                        if ([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost5_u or [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost5_d) and [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])])
-                            continue
-                        if eval(l[i4][2])>=xmaxnum:
-                            l[i4][2]=str(eval(l[i4][2])+1)
-                        if eval(l[i4][3])>=xmaxnum:
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                        if eval(l[i4][4])>=xmaxnum:
-                            l[i4][4]=str(eval(l[i4][4])+1)
-                        if eval(l[i4][5])>=xmaxnum:
-                            l[i4][5]=str(eval(l[i4][5])+1)
-                    elif i3==degree-1:
-                        if ([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost5_u or [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost5_d) and [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])])
-                            continue
-                        if eval(l[i4][2])>=xminnum:
-                            l[i4][2]=str(eval(l[i4][2])+1)
-                        if eval(l[i4][3])>=xminnum:
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                        if eval(l[i4][4])>=xminnum:
-                            l[i4][4]=str(eval(l[i4][4])+1)
-                        if eval(l[i4][5])>=xminnum:
-                            l[i4][5]=str(eval(l[i4][5])+1)
+                    if i3 == 0:
+                        if (([eval(l[i4][2]), eval(l[i4][3]),\
+                              eval(l[i4][4]), eval(l[i4][5])] in lost5_u
+                                  or [eval(l[i4][2]), eval(l[i4][3]),\
+                                      eval(l[i4][4]), eval(l[i4][5])] in lost5_d) and
+                            [eval(l[i4][2]), eval(l[i4][3]),\
+                             eval(l[i4][4]), eval(l[i4][5])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3]),\
+                                             eval(l[i4][4]), eval(l[i4][5])])
+                            continue
+                        if eval(l[i4][2]) >= xmaxnum:
+                            l[i4][2] = str(eval(l[i4][2]) + 1)
+                        if eval(l[i4][3]) >= xmaxnum:
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                        if eval(l[i4][4]) >= xmaxnum:
+                            l[i4][4] = str(eval(l[i4][4]) + 1)
+                        if eval(l[i4][5]) >= xmaxnum:
+                            l[i4][5] = str(eval(l[i4][5]) + 1)
+                    elif i3 == degree - 1:
+                        if (([eval(l[i4][2]), eval(l[i4][3]),\
+                              eval(l[i4][4]), eval(l[i4][5])] in lost5_u
+                                 or [eval(l[i4][2]), eval(l[i4][3]),\
+                                     eval(l[i4][4]), eval(l[i4][5])] in lost5_d) and
+                            [eval(l[i4][2]), eval(l[i4][3]),\
+                             eval(l[i4][4]), eval(l[i4][5])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3]),\
+                                             eval(l[i4][4]), eval(l[i4][5])])
+                            continue
+                        if eval(l[i4][2]) >= xminnum:
+                            l[i4][2] = str(eval(l[i4][2]) + 1)
+                        if eval(l[i4][3]) >= xminnum:
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                        if eval(l[i4][4]) >= xminnum:
+                            l[i4][4] = str(eval(l[i4][4]) + 1)
+                        if eval(l[i4][5]) >= xminnum:
+                            l[i4][5] = str(eval(l[i4][5]) + 1)
                     else:
-                        if ([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost5_u or [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] in lost5_d) and [eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])] not in repeated:
-                            repeated.append([eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])])
-                            continue
-                        if eval(l[i4][2])>=min([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])+1)
-                        elif eval(l[i4][2])+1>=max([xminnum,xmaxnum]):
-                            l[i4][2]=str(eval(l[i4][2])+2)  
-                        if eval(l[i4][3])>=min([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])+1)
-                        elif eval(l[i4][3])+1>=max([xminnum,xmaxnum]):
-                            l[i4][3]=str(eval(l[i4][3])+2)  
-                        if eval(l[i4][4])>=min([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])+1)
-                        elif eval(l[i4][4])+1>=max([xminnum,xmaxnum]):
-                            l[i4][4]=str(eval(l[i4][4])+2)
-                        if eval(l[i4][5])>=min([xminnum,xmaxnum]):
-                            l[i4][5]=str(eval(l[i4][5])+1)
-                        elif eval(l[i4][5])+1>=max([xminnum,xmaxnum]):
-                            l[i4][5]=str(eval(l[i4][5])+2)
-                if i3==0 or i3==degree-1:
-                    every=every+tipnum-1
+                        if (([eval(l[i4][2]), eval(l[i4][3]),\
+                              eval(l[i4][4]), eval(l[i4][5])] in lost5_u
+                                 or [eval(l[i4][2]), eval(l[i4][3]),\
+                                     eval(l[i4][4]), eval(l[i4][5])] in lost5_d) and
+                            [eval(l[i4][2]), eval(l[i4][3]),\
+                             eval(l[i4][4]), eval(l[i4][5])] not in repeated):
+                            repeated.append([eval(l[i4][2]), eval(l[i4][3]),\
+                                             eval(l[i4][4]), eval(l[i4][5])])
+                            continue
+                        if eval(l[i4][2]) >= min([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2]) + 1)
+                        elif eval(l[i4][2]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][2] = str(eval(l[i4][2]) + 2)  
+                        if eval(l[i4][3]) >= min([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3]) + 1)
+                        elif eval(l[i4][3]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][3] = str(eval(l[i4][3]) + 2)  
+                        if eval(l[i4][4]) >= min([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4]) + 1)
+                        elif eval(l[i4][4]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][4] = str(eval(l[i4][4]) + 2)
+                        if eval(l[i4][5]) >= min([xminnum, xmaxnum]):
+                            l[i4][5] = str(eval(l[i4][5]) + 1)
+                        elif eval(l[i4][5]) + 1 >= max([xminnum, xmaxnum]):
+                            l[i4][5] = str(eval(l[i4][5]) + 2)
+                if i3 == 0 or i3 == degree - 1:
+                    every = every + tipnum - 1
                 else:
-                    every=every+tipnum-2
-                #lx=l
-            k=k+1
-            l=[]
-            j=1
-            k=0
-            w4=0
-            l=lx
+                    every = every + tipnum - 2
+                #lx = l
+            k = k + 1
+            l = []
+            j = 1
+            k = 0
+            w4 = 0
+            l = lx
             f.write('\n')
         else:
             f.write(line)
     f.close()
     inp.close()
     med.close()
     os.chdir(opath)
```

### Comparing `MCPoly-0.5.1.3/MCPoly/lmpset/infchain.py` & `MCPoly-0.6b1/MCPoly/lmpset/infchain.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 import re
 import os
 import warnings
 import math as m
-from ase.io import read, write
+from ase.io import read,  write
 
-def infchain(file,bondtype,loc='./'):
+def infchain(file, bondtype, loc = './'):
     """
     The method to create a single molecule for periodical chain, specialised for polymers.
-    infchain(file,bondtype,loc='./')
+    infchain(file, bondtype, loc = './')
     file: Your molecule system name on your .data file.
     bondtype: The bond type between the start and the end of the polymer. 
     loc: File Location. The default is your current location.
     Example:
         Input:
             from MCPoly.lmpset import chain
-            infchain('Poly1',11)
+            infchain('Poly1', 11)
         Output in Poly1_Chain.data:
             82 atoms
             84 bonds
             154 angles
             211 dihedrals
             47 impropers
             
@@ -29,463 +29,470 @@
             3 improper types
             
             ...
             84 11 79 1
             
             ...
     """
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir(loc)
-    k=0
-    w1=0
-    w2=0
-    w3=0
-    w4=0
-    w5=0
-    n1=0
-    t2=0
-    t3=0
-    t4=0
-    t5=0
-    H=[]
-    l=[]
-    real=[0,0,0]
-    inp = open('{0}.data'.format(file),'r')
+    k = 0
+    w1 = 0
+    w2 = 0
+    w3 = 0
+    w4 = 0
+    w5 = 0
+    n1 = 0
+    t2 = 0
+    t3 = 0
+    t4 = 0
+    t5 = 0
+    H = []
+    l = []
+    real = [0, 0, 0]
+    inp  =  open('{0}.data'.format(file), 'r')
     for line in inp:
-        a1=re.search(r' atoms',line)
-        a2=re.search(r' bonds',line)
-        a3=re.search(r' angles',line)
-        a4=re.search(r' dihedrals',line)
-        a5=re.search(r' impropers',line)
-        m1=re.search(r'Masses',line)
+        a1 = re.search(r' atoms', line)
+        a2 = re.search(r' bonds', line)
+        a3 = re.search(r' angles', line)
+        a4 = re.search(r' dihedrals', line)
+        a5 = re.search(r' impropers', line)
+        m1 = re.search(r'Masses', line)
         if a1:
-            b1=re.search(r'[0-9]+',line)
-            num=b1.group(0)
+            b1 = re.search(r'[0-9]+', line)
+            num = b1.group(0)
         elif a2:
-            b2=re.search(r'[0-9]+',line)
-            num2=b2.group(0)
+            b2 = re.search(r'[0-9]+', line)
+            num2 = b2.group(0)
         elif a3:
-            b3=re.search(r'[0-9]+',line)
-            num3=b3.group(0)
+            b3 = re.search(r'[0-9]+', line)
+            num3 = b3.group(0)
         elif a4:
-            b4=re.search(r'[0-9]+',line)
-            num4=b4.group(0)
+            b4 = re.search(r'[0-9]+', line)
+            num4 = b4.group(0)
         elif a5:
-            b5=re.search(r'[0-9]+',line)
-            num5=b5.group(0)
-        if n1==1:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if l1==[]:
+            b5 = re.search(r'[0-9]+', line)
+            num5 = b5.group(0)
+        if n1 == 1:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if l1 == []:
                 continue
             else:
-                n1=2
-        if n1==2:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if l1==[]:
-                n1=0
+                n1 = 2
+        if n1 == 2:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if l1 == []:
+                n1 = 0
                 continue
-            if eval(l1[-1])<1.1:
+            if eval(l1[-1]) < 1.1:
                 H.append(eval(l1[0]))
         if m1:
-            n1=1
-        c1=re.search('Atoms',line)
-        c2=re.search('Bonds',line)
-        c3=re.search('Angles',line)
-        c4=re.search('Dihedrals',line)
-        c5=re.search('Impropers',line)
+            n1 = 1
+        c1 = re.search('Atoms', line)
+        c2 = re.search('Bonds', line)
+        c3 = re.search('Angles', line)
+        c4 = re.search('Dihedrals', line)
+        c5 = re.search('Impropers', line)
         if c1:
-            w1=1
+            w1 = 1
         elif c2:
-            w2=1
+            w2 = 1
         elif c3:
-            w3=1
+            w3 = 1
         elif c4:
-            w4=1
+            w4 = 1
         elif c5:
-            w5=1
-        elif w1==1:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if len(l1)>=6:
+            w5 = 1
+        elif w1 == 1:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if len(l1) >= 6:
                 l.append(l1)
-                if l1[0]==num:
-                    w1=2
-        elif w1==2:
-            xmin=99999
-            xmax=-99999
-            xmaxnum=0
-            xminnum=0
-            realxmin=99999
-            realxmax=-99999
-            realxmaxnum=0
-            realxminnum=0
+                if l1[0] == num:
+                    w1 = 2
+        elif w1 == 2:
+            xmin = 99999
+            xmax = -99999
+            xmaxnum = 0
+            xminnum = 0
+            realxmin = 99999
+            realxmax = -99999
+            realxmaxnum = 0
+            realxminnum = 0
             for i4 in range(len(l)):
                 if eval(l[i4][2]) not in H:
                     continue
-                if eval(l[i4][-3])>xmax:
-                    xmax=eval(l[i4][-3])
-                    xmaxnum=eval(l[i4][0])
-                if eval(l[i4][-3])<xmin:
-                    xmin=eval(l[i4][-3])
-                    xminnum=eval(l[i4][0])
+                if eval(l[i4][-3]) > xmax:
+                    xmax = eval(l[i4][-3])
+                    xmaxnum = eval(l[i4][0])
+                if eval(l[i4][-3]) < xmin:
+                    xmin = eval(l[i4][-3])
+                    xminnum = eval(l[i4][0])
             for i4 in range(len(l)):
                 if eval(l[i4][2]) in H:
                     continue
-                if eval(l[i4][-3])>realxmax:
-                    realxmax=eval(l[i4][-3])
-                    realxmaxnum=eval(l[i4][0])
-                if eval(l[i4][-3])<realxmin:
-                    realxmin=eval(l[i4][-3])
-                    realxminnum=eval(l[i4][0])
-            w1=0
-        elif w2==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==4:
+                if eval(l[i4][-3]) > realxmax:
+                    realxmax = eval(l[i4][-3])
+                    realxmaxnum = eval(l[i4][0])
+                if eval(l[i4][-3]) < realxmin:
+                    realxmin = eval(l[i4][-3])
+                    realxminnum = eval(l[i4][0])
+            w1 = 0
+        elif w2 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 4:
                 l.append(l1)
-                if l1[0]==num2:
-                    w2=2
-                    j=1
-        elif w2==2:
+                if l1[0] == num2:
+                    w2 = 2
+                    j = 1
+        elif w2 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
                     continue
-                j=j+1
-            k=k+1
-            l=[]
-            t2=j
-            j=1
-            w2=0
-            k=0
-        elif w3==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==5:
+                j = j + 1
+            k = k + 1
+            l = []
+            t2 = j
+            j = 1
+            w2 = 0
+            k = 0
+        elif w3 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 5:
                 l.append(l1)
-                if l1[0]==num3:
-                    w3=2
-                    j=1
-        elif w3==2:
+                if l1[0] == num3:
+                    w3 = 2
+                    j = 1
+        elif w3 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][4]) in [xminnum,xmaxnum]:
+                if eval(l[i4][4]) in [xminnum, xmaxnum]:
                     continue
-                j=j+1
-            k=k+1
-            l=[]
-            t3=j
-            j=1
-            k=0
-            w3=0
-        elif w4==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==6:
+                j = j+1
+            k = k+1
+            l = []
+            t3 = j
+            j = 1
+            k = 0
+            w3 = 0
+        elif w4 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 6:
                 l.append(l1)
-                if l1[0]==num4:
-                    w4=2
-                    j=1
-        elif w4==2:
+                if l1[0] == num4:
+                    w4 = 2
+                    j = 1
+        elif w4 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][4]) in [xminnum,xmaxnum]:
+                if eval(l[i4][4]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][5]) in [xminnum,xmaxnum]:
+                if eval(l[i4][5]) in [xminnum, xmaxnum]:
                     continue
-                j=j+1
-            k=k+1
-            l=[]
-            t4=j
-            j=1
-            k=0
-            w4=0
-        elif w5==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==6:
+                j = j+1
+            k = k+1
+            l = []
+            t4 = j
+            j = 1
+            k = 0
+            w4 = 0
+        elif w5 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 6:
                 l.append(l1)
-                if l1[0]==num5:
-                    w5=2
-                    j=1
-        elif w5==2:
+                if l1[0] == num5:
+                    w5 = 2
+                    j = 1
+        elif w5 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][4]) in [xminnum,xmaxnum]:
+                if eval(l[i4][4]) in [xminnum, xmaxnum]:
                     continue
-                if eval(l[i4][5]) in [xminnum,xmaxnum]:
+                if eval(l[i4][5]) in [xminnum, xmaxnum]:
                     continue
-                j=j+1
-            k=k+1
-            l=[]
-            t5=j
-            j=1
-            k=0
-            w4=0
+                j = j + 1
+            k = k + 1
+            l = []
+            t5 = j
+            j = 1
+            k = 0
+            w4 = 0
     inp.close()
-#    print(t2,t3,t4,t5)
-    inp = open('{0}.data'.format(file),'r')
-    k=0
-    w1=0
-    w2=0
-    w3=0
-    w4=0
-    w5=0
-    gap=0
-    l=[]
+#    print(t2, t3, t4, t5)
+    inp  =  open('{0}.data'.format(file), 'r')
+    k = 0
+    w1 = 0
+    w2 = 0
+    w3 = 0
+    w4 = 0
+    w5 = 0
+    gap = 0
+    l = []
     try:
-        f = open('{0}_Chain.data'.format(file),'x')
+        f  =  open('{0}_Chain.data'.format(file), 'x')
     except:
-        f = open('{0}_Chain.data'.format(file),'w')
+        f  =  open('{0}_Chain.data'.format(file), 'w')
     for line in inp:
-        a1=re.search(r' atoms',line)
-        a2=re.search(r' bonds',line)
-        a3=re.search(r' angles',line)
-        a4=re.search(r' dihedrals',line)
-        a5=re.search(r' impropers',line)
-        a6=re.search(r' xlo xhi',line)
-        a7=re.search(r' ylo yhi',line)
-        a8=re.search(r' zlo zhi',line)
-        c1=re.search('Atoms',line)
-        c2=re.search('Bonds',line)
-        c3=re.search('Angles',line)
-        c4=re.search('Dihedrals',line)
-        c5=re.search('Impropers',line)
+        a1 = re.search(r' atoms', line)
+        a2 = re.search(r' bonds', line)
+        a3 = re.search(r' angles', line)
+        a4 = re.search(r' dihedrals', line)
+        a5 = re.search(r' impropers', line)
+        a6 = re.search(r' xlo xhi', line)
+        a7 = re.search(r' ylo yhi', line)
+        a8 = re.search(r' zlo zhi', line)
+        c1 = re.search('Atoms', line)
+        c2 = re.search('Bonds', line)
+        c3 = re.search('Angles', line)
+        c4 = re.search('Dihedrals', line)
+        c5 = re.search('Impropers', line)
         if a1:
-            b1=re.search(r'[0-9]+',line)
+            b1 = re.search(r'[0-9]+', line)
             f.write('{0} atoms\n'.format(eval(b1.group(0))-2))
-            num=b1.group(0)
+            num = b1.group(0)
         elif a2:
-            b2=re.search(r'[0-9]+',line)
+            b2 = re.search(r'[0-9]+', line)
             f.write('{0} bonds\n'.format(eval(b2.group(0))-1))
-            num2=b2.group(0)
+            num2 = b2.group(0)
         elif a3:
             f.write('{0} angles\n'.format(t3-1))
-            num3=b3.group(0)
+            num3 = b3.group(0)
         elif a4:
-            b4=re.search(r'[0-9]+',line)
+            b4 = re.search(r'[0-9]+', line)
             f.write('{0} dihedrals\n'.format(t4-1))
-            num4=b4.group(0)
+            num4 = b4.group(0)
         elif a5:
-            b5=re.search(r'[0-9]+',line)
+            b5 = re.search(r'[0-9]+', line)
             f.write('{0} impropers\n'.format(t5-1))
-            num5=b5.group(0)
+            num5 = b5.group(0)
         elif a6:
-            x1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            xd=eval(x1[1])-eval(x1[0])
-            f.write('{0:.5f} {1:.5f} xlo xhi\n'.format(xmin,xmax))
+            x1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            xd = eval(x1[1])-eval(x1[0])
+            f.write('{0:.5f} {1:.5f} xlo xhi\n'.format(xmin, xmax))
         elif a7:
-            y1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            yd=eval(y1[1])-eval(y1[0])
-            f.write('{0:.5f} {1:.5f} ylo yhi\n'.format(eval(y1[0]),eval(y1[1])))
+            y1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            yd = eval(y1[1])-eval(y1[0])
+            f.write('{0:.5f} {1:.5f} ylo yhi\n'.format(eval(y1[0]), eval(y1[1])))
         elif a8:
-            z1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            zd=eval(z1[1])-eval(z1[0])
-            f.write('{0:.5f} {1:.5f} zlo zhi\n'.format(eval(z1[0]),eval(z1[1])))
+            z1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            zd = eval(z1[1])-eval(z1[0])
+            f.write('{0:.5f} {1:.5f} zlo zhi\n'.format(eval(z1[0]), eval(z1[1])))
         elif c1:
-            w1=1
+            w1 = 1
             f.write(line)
             f.write('\n')
         elif c2:
-            w2=1
+            w2 = 1
             f.write(line)
             f.write('\n')
         elif c3:
-            w3=1
+            w3 = 1
             f.write(line)
             f.write('\n')
         elif c4:
-            w4=1
+            w4 = 1
             f.write(line)
             f.write('\n')
         elif c5:
-            w5=1
+            w5 = 1
             f.write(line)
             f.write('\n')
-        elif w1==1:
-            l1=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if len(l1)>=6:
+        elif w1 == 1:
+            l1 = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if len(l1) >= 6:
                 l.append(l1)
-                if l1[0]==num:
-                    w1=2
-                    j=1
-        elif w1==2:
+                if l1[0] == num:
+                    w1 = 2
+                    j = 1
+        elif w1 == 2:
             for i4 in range(eval(b1.group(0))-2+1):
-                if j in [xminnum,xmaxnum]:
-                    gap=gap+1
-                    j=j+1
-                    continue
-                f.write('{0} {1} {2} {3:.4f} {4:.5f} {5:.5f} {6:.5f}\n'.format(j-gap,eval(l[i4][1]),eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][-3]),eval(l[i4][-2]),eval(l[i4][-1])))
-                j=j+1
-            l=[]
-            j=1
-            w1=0
+                if j in [xminnum, xmaxnum]:
+                    gap = gap + 1
+                    j = j + 1
+                    continue
+                f.write('{0} {1} {2} {3:.4f} {4:.5f} {5:.5f} {6:.5f}\n'.format(j-gap,\
+                                                                               eval(l[i4][1]), eval(l[i4][2]), eval(l[i4][3]),\
+                                                                               eval(l[i4][-3]), eval(l[i4][-2]), eval(l[i4][-1])))
+                j = j + 1
+            l = []
+            j = 1
+            w1 = 0
             f.write('\n')
-        elif w2==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==4:
+        elif w2 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 4:
                 l.append(l1)
-                if l1[0]==num2:
-                    w2=2
-                    j=1
-        elif w2==2:
+                if l1[0] == num2:
+                    w2 = 2
+                    j = 1
+        elif w2 == 2:
             for i4 in range(eval(b2.group(0))-1+1):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                elif eval(l[i4][2])>min([xminnum,xmaxnum]):
-                    l[i4][2]=str(eval(l[i4][2])-1)
-                elif eval(l[i4][2])>max([xminnum,xmaxnum]):
-                    l[i4][2]=str(eval(l[i4][2])-2)  
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
-                    continue
-                elif eval(l[i4][3])>min([xminnum,xmaxnum]):
-                    l[i4][3]=str(eval(l[i4][3])-1)
-                elif eval(l[i4][3])>max([xminnum,xmaxnum]):
-                    l[i4][3]=str(eval(l[i4][3])-2)  
-                f.write('{0} {1} {2} {3}\n'.format(j,eval(l[i4][1]),eval(l[i4][2]),eval(l[i4][3])))
-                j=j+1
-            k=k+1
-            l=[]
-            if realxmaxnum in [xminnum,xmaxnum]:
+                elif eval(l[i4][2]) > min([xminnum, xmaxnum]):
+                    l[i4][2] = str(eval(l[i4][2])-1)
+                elif eval(l[i4][2]) > max([xminnum, xmaxnum]):
+                    l[i4][2] = str(eval(l[i4][2])-2)  
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
+                    continue
+                elif eval(l[i4][3]) > min([xminnum, xmaxnum]):
+                    l[i4][3] = str(eval(l[i4][3])-1)
+                elif eval(l[i4][3]) > max([xminnum, xmaxnum]):
+                    l[i4][3] = str(eval(l[i4][3])-2)  
+                f.write('{0} {1} {2} {3}\n'.format(j, eval(l[i4][1]),\
+                                                   eval(l[i4][2]), eval(l[i4][3])))
+                j = j + 1
+            k = k + 1
+            l = []
+            if realxmaxnum in [xminnum, xmaxnum]:
                 continue
-            elif realxmaxnum>min([xminnum,xmaxnum]):
-                realxmaxnum=realxmaxnum-1
-            elif realxmaxnum>max([xminnum,xmaxnum]):
-                realxmaxnum=realxmaxnum-2  
-            if realxminnum in [xminnum,xmaxnum]:
+            elif realxmaxnum > min([xminnum, xmaxnum]):
+                realxmaxnum = realxmaxnum-1
+            elif realxmaxnum > max([xminnum, xmaxnum]):
+                realxmaxnum = realxmaxnum-2  
+            if realxminnum in [xminnum, xmaxnum]:
                 continue
-            elif realxminnum>min([xminnum,xmaxnum]):
-                realxminnum=realxminnum-1
-            elif realxminnum>max([xminnum,xmaxnum]):
-                realxminnum=realxminnum-2  
-            f.write('{0} {1} {2} {3}\n'.format(j,bondtype,realxmaxnum,realxminnum))
-            j=1
-            w2=0
-            k=0
+            elif realxminnum > min([xminnum, xmaxnum]):
+                realxminnum = realxminnum-1
+            elif realxminnum > max([xminnum, xmaxnum]):
+                realxminnum = realxminnum-2  
+            f.write('{0} {1} {2} {3}\n'.format(j, bondtype,\
+                                               realxmaxnum, realxminnum))
+            j = 1
+            w2 = 0
+            k = 0
             f.write('\n')
-        elif w3==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==5:
+        elif w3 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 5:
                 l.append(l1)
-                if l1[0]==num3:
-                    w3=2
-                    j=1
-        elif w3==2:
+                if l1[0] == num3:
+                    w3 = 2
+                    j = 1
+        elif w3 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                elif eval(l[i4][2])>min([xminnum,xmaxnum]):
-                    l[i4][2]=str(eval(l[i4][2])-1)
-                elif eval(l[i4][2])>max([xminnum,xmaxnum]):
-                    l[i4][2]=str(eval(l[i4][2])-2)  
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
-                    continue
-                elif eval(l[i4][3])>min([xminnum,xmaxnum]):
-                    l[i4][3]=str(eval(l[i4][3])-1)
-                elif eval(l[i4][3])>max([xminnum,xmaxnum]):
-                    l[i4][3]=str(eval(l[i4][3])-2)  
-                if eval(l[i4][4]) in [xminnum,xmaxnum]:
-                    continue
-                elif eval(l[i4][4])>min([xminnum,xmaxnum]):
-                    l[i4][4]=str(eval(l[i4][4])-1)
-                elif eval(l[i4][4])>max([xminnum,xmaxnum]):
-                    l[i4][4]=str(eval(l[i4][4])-2)  
-                f.write('{0} {1} {2} {3} {4}\n'.format(j,eval(l[i4][1]),eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4])))
-                j=j+1
-            k=k+1
-            l=[]
-            j=1
-            k=0
-            w3=0
+                elif eval(l[i4][2]) > min([xminnum, xmaxnum]):
+                    l[i4][2] = str(eval(l[i4][2])-1)
+                elif eval(l[i4][2]) > max([xminnum, xmaxnum]):
+                    l[i4][2] = str(eval(l[i4][2])-2)  
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
+                    continue
+                elif eval(l[i4][3]) > min([xminnum, xmaxnum]):
+                    l[i4][3] = str(eval(l[i4][3])-1)
+                elif eval(l[i4][3]) > max([xminnum, xmaxnum]):
+                    l[i4][3] = str(eval(l[i4][3])-2)  
+                if eval(l[i4][4]) in [xminnum, xmaxnum]:
+                    continue
+                elif eval(l[i4][4]) > min([xminnum, xmaxnum]):
+                    l[i4][4] = str(eval(l[i4][4])-1)
+                elif eval(l[i4][4]) > max([xminnum, xmaxnum]):
+                    l[i4][4] = str(eval(l[i4][4])-2)  
+                f.write('{0} {1} {2} {3} {4}\n'.format(j, eval(l[i4][1]),\
+                                                       eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4])))
+                j = j + 1
+            k = k + 1
+            l = []
+            j = 1
+            k = 0
+            w3 = 0
             f.write('\n')
-        elif w4==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==6:
+        elif w4 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 6:
                 l.append(l1)
-                if l1[0]==num4:
-                    w4=2
-                    j=1
-        elif w4==2:
+                if l1[0] == num4:
+                    w4 = 2
+                    j = 1
+        elif w4 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                elif eval(l[i4][2])>min([xminnum,xmaxnum]):
-                    l[i4][2]=str(eval(l[i4][2])-1)
-                elif eval(l[i4][2])>max([xminnum,xmaxnum]):
-                    l[i4][2]=str(eval(l[i4][2])-2)  
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
-                    continue
-                elif eval(l[i4][3])>min([xminnum,xmaxnum]):
-                    l[i4][3]=str(eval(l[i4][3])-1)
-                elif eval(l[i4][3])>max([xminnum,xmaxnum]):
-                    l[i4][3]=str(eval(l[i4][3])-2)  
-                if eval(l[i4][4]) in [xminnum,xmaxnum]:
-                    continue
-                elif eval(l[i4][4])>min([xminnum,xmaxnum]):
-                    l[i4][4]=str(eval(l[i4][4])-1)
-                elif eval(l[i4][4])>max([xminnum,xmaxnum]):
-                    l[i4][4]=str(eval(l[i4][4])-2)  
-                if eval(l[i4][5]) in [xminnum,xmaxnum]:
-                    continue
-                elif eval(l[i4][5])>min([xminnum,xmaxnum]):
-                    l[i4][5]=str(eval(l[i4][5])-1)
-                elif eval(l[i4][5])>max([xminnum,xmaxnum]):
-                    l[i4][5]=str(eval(l[i4][5])-2)
-                f.write('{0} {1} {2} {3} {4} {5}\n'.format(j,eval(l[i4][1]),eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])))
-                j=j+1
-            k=k+1
-            l=[]
-            j=1
-            k=0
-            w4=0
+                elif eval(l[i4][2]) > min([xminnum, xmaxnum]):
+                    l[i4][2] = str(eval(l[i4][2])-1)
+                elif eval(l[i4][2]) > max([xminnum, xmaxnum]):
+                    l[i4][2] = str(eval(l[i4][2])-2)  
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
+                    continue
+                elif eval(l[i4][3]) > min([xminnum, xmaxnum]):
+                    l[i4][3] = str(eval(l[i4][3])-1)
+                elif eval(l[i4][3]) > max([xminnum, xmaxnum]):
+                    l[i4][3] = str(eval(l[i4][3])-2)  
+                if eval(l[i4][4]) in [xminnum, xmaxnum]:
+                    continue
+                elif eval(l[i4][4]) > min([xminnum, xmaxnum]):
+                    l[i4][4] = str(eval(l[i4][4])-1)
+                elif eval(l[i4][4]) > max([xminnum, xmaxnum]):
+                    l[i4][4] = str(eval(l[i4][4])-2)  
+                if eval(l[i4][5]) in [xminnum, xmaxnum]:
+                    continue
+                elif eval(l[i4][5]) > min([xminnum, xmaxnum]):
+                    l[i4][5] = str(eval(l[i4][5])-1)
+                elif eval(l[i4][5]) > max([xminnum, xmaxnum]):
+                    l[i4][5] = str(eval(l[i4][5])-2)
+                f.write('{0} {1} {2} {3} {4} {5}\n'.format(j, eval(l[i4][1]),\
+                                                           eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4]), eval(l[i4][5])))
+                j = j + 1
+            k = k + 1
+            l = []
+            j = 1
+            k = 0
+            w4 = 0
             f.write('\n')
-        elif w5==1:
-            l1=re.findall(r'[0-9]+',line)
-            if len(l1)==6:
+        elif w5 == 1:
+            l1 = re.findall(r'[0-9]+', line)
+            if len(l1) == 6:
                 l.append(l1)
-                if l1[0]==num5:
-                    w5=2
-                    j=1
-        elif w5==2:
+                if l1[0] == num5:
+                    w5 = 2
+                    j = 1
+        elif w5 == 2:
             for i4 in range(len(l)):
-                if eval(l[i4][2]) in [xminnum,xmaxnum]:
+                if eval(l[i4][2]) in [xminnum, xmaxnum]:
                     continue
-                elif eval(l[i4][2])>min([xminnum,xmaxnum]):
-                    l[i4][2]=str(eval(l[i4][2])-1)
-                elif eval(l[i4][2])>max([xminnum,xmaxnum]):
-                    l[i4][2]=str(eval(l[i4][2])-2)  
-                if eval(l[i4][3]) in [xminnum,xmaxnum]:
-                    continue
-                elif eval(l[i4][3])>min([xminnum,xmaxnum]):
-                    l[i4][3]=str(eval(l[i4][3])-1)
-                elif eval(l[i4][3])>max([xminnum,xmaxnum]):
-                    l[i4][3]=str(eval(l[i4][3])-2)  
-                if eval(l[i4][4]) in [xminnum,xmaxnum]:
-                    continue
-                elif eval(l[i4][4])>min([xminnum,xmaxnum]):
-                    l[i4][4]=str(eval(l[i4][4])-1)
-                elif eval(l[i4][4])>max([xminnum,xmaxnum]):
-                    l[i4][4]=str(eval(l[i4][4])-2)  
-                if eval(l[i4][5]) in [xminnum,xmaxnum]:
-                    continue
-                elif eval(l[i4][5])>min([xminnum,xmaxnum]):
-                    l[i4][5]=str(eval(l[i4][5])-1)
-                elif eval(l[i4][5])>max([xminnum,xmaxnum]):
-                    l[i4][5]=str(eval(l[i4][5])-2)
-                f.write('{0} {1} {2} {3} {4} {5}\n'.format(j,eval(l[i4][1]),eval(l[i4][2]),eval(l[i4][3]),eval(l[i4][4]),eval(l[i4][5])))
-                j=j+1
-            k=k+1
-            l=[]
-            j=1
-            k=0
-            w4=0
+                elif eval(l[i4][2]) > min([xminnum, xmaxnum]):
+                    l[i4][2] = str(eval(l[i4][2])-1)
+                elif eval(l[i4][2]) > max([xminnum, xmaxnum]):
+                    l[i4][2] = str(eval(l[i4][2])-2)  
+                if eval(l[i4][3]) in [xminnum, xmaxnum]:
+                    continue
+                elif eval(l[i4][3]) > min([xminnum, xmaxnum]):
+                    l[i4][3] = str(eval(l[i4][3])-1)
+                elif eval(l[i4][3]) > max([xminnum, xmaxnum]):
+                    l[i4][3] = str(eval(l[i4][3])-2)  
+                if eval(l[i4][4]) in [xminnum, xmaxnum]:
+                    continue
+                elif eval(l[i4][4]) > min([xminnum, xmaxnum]):
+                    l[i4][4] = str(eval(l[i4][4])-1)
+                elif eval(l[i4][4]) > max([xminnum, xmaxnum]):
+                    l[i4][4] = str(eval(l[i4][4])-2)  
+                if eval(l[i4][5]) in [xminnum, xmaxnum]:
+                    continue
+                elif eval(l[i4][5]) > min([xminnum, xmaxnum]):
+                    l[i4][5] = str(eval(l[i4][5])-1)
+                elif eval(l[i4][5]) > max([xminnum, xmaxnum]):
+                    l[i4][5] = str(eval(l[i4][5])-2)
+                f.write('{0} {1} {2} {3} {4} {5}\n'.format(j, eval(l[i4][1]),\
+                                                           eval(l[i4][2]), eval(l[i4][3]), eval(l[i4][4]), eval(l[i4][5])))
+                j = j + 1
+            k = k + 1
+            l = []
+            j = 1
+            k = 0
+            w4 = 0
             f.write('\n')
         else:
             f.write(line)
     f.close()
     inp.close()
     os.chdir(opath)
```

### Comparing `MCPoly-0.5.1.3/MCPoly/lmpset/rebuild.py` & `MCPoly-0.6b1/MCPoly/lmpset/rebuild.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,41 +1,42 @@
 import os
 import re
+import sys
 import warnings
 import math as m
 import numpy as np
 from ase.io import read, write
 from ase import Atoms
-import sys
 
 mydir = os.path.dirname( __file__ )
 statusdir = os.path.join(mydir, '..', 'status')
 sys.path.append(statusdir)
 from status import status
 
-def rebuild(file, substitute, x=[99999,99999], y=[99999,99999], z=[99999,99999], loc='./', subloc='./'):
+def rebuild(file, substitute, x = [99999, 99999], y = [99999, 99999],\
+            z = [99999, 99999], loc = './', subloc = './'):
     """
         The method to replace the geometry structure of LAMMPS Input File from an XYZ File.
-        rebuild(file, substitute, x=[xmin,xmax], y=[ymin,ymax], z=[zmin,zmax], loc='./', subloc='./')
+        rebuild(file, substitute, x = [xmin, xmax], y = [ymin, ymax], z = [zmin, zmax], loc = './', subloc = './')
         file: Your molecule system name on your .data file.
         substitute: XYZ File used to replace.
-        x,y,z: Caption of the box.
+        x, y, z: Caption of the box.
         loc: Data File Location. The default is your current location.
         subloc: XYZ File Location. The default is your current location.
         Example:
             Input:
                 from MCPoly.lmpset import DATAtoXYZ
                 from MCPoly.lmpset import rebuild
                 from MCPoly.lmpset import mould
                 
-                atoms=mould('Atoms1')
-                atoms.cube(1,0,1,0,2,0) # Create the file Atoms1_112.data, see in lmpset.cube.
+                atoms = mould('Atoms1')
+                atoms.cube(1, 0, 1, 0, 2, 0) # Create the file Atoms1_112.data, see in lmpset.cube.
                 DATAtoXYZ('Atoms1_112') # Create Atoms1_112.xyz, see in lmpset.DATAtoXYZ
                 # After changing the geometry structure by GaussView or Avogrado and save it as Atoms1_replace.xyz
-                rebuild('Atoms1_112','Atoms1_replace')
+                rebuild('Atoms1_112', 'Atoms1_replace')
             
             Atoms1_replace.xyz:
                 106
                 
                 O          9.64263        4.67845        3.83021
                 C          9.97863        4.59047        2.66070
                 N         11.06345        5.23157        2.07395
@@ -57,90 +58,94 @@
                 5 1 5 0.1753 12.08548 6.09614 2.75528
                 6 1 6 0.5150 11.25704 4.90681 1.13587
                 7 1 5 0.0718 8.15829 2.96807 2.00836
                 ......
             
     """
     path = os.getcwd()
-    atoms=status('{0}'.format(substitute),loc=subloc)
-    pos=atoms.atom()
-    xmax=-99999
-    xmin=99999
-    ymax=-99999
-    ymin=99999
-    zmax=-99999
-    zmin=99999
+    atoms = status('{0}'.format(substitute), loc = subloc)
+    pos = atoms.atom()
+    xmax = -99999
+    xmin = 99999
+    ymax = -99999
+    ymin = 99999
+    zmax = -99999
+    zmin = 99999
     for num in pos:
-        if num[1]>xmax:
-            xmax=num[1]
-        if num[2]>ymax:
-            ymax=num[2]
-        if num[3]>zmax:
-            zmax=num[3]
-        if num[1]<xmin:
-            xmin=num[1]
-        if num[2]<ymin:
-            ymin=num[2]
-        if num[3]<zmin:
-            zmin=num[3]
-    atoms_number=len(pos)
+        if num[1]  >  xmax:
+            xmax = num[1]
+        if num[2] > ymax:
+            ymax = num[2]
+        if num[3] > zmax:
+            zmax = num[3]
+        if num[1] < xmin:
+            xmin = num[1]
+        if num[2] < ymin:
+            ymin = num[2]
+        if num[3] < zmin:
+            zmin = num[3]
+    atoms_number = len(pos)
     os.chdir(path)
-    readfile = open(loc+'{0}.data'.format(file),'r')
+    readfile = open(loc+'{0}.data'.format(file), 'r')
     try:
-        f = open(loc+'pre.data','x')
+        f = open(loc+'pre.data', 'x')
     except:
-        f = open(loc+'pre.data','w')
-    c=0
-    i=0
+        f = open(loc+'pre.data', 'w')
+    c = 0
+    i = 0
     for line in readfile:
-        x0=re.search(' xlo xhi',line)
-        y0=re.search(' ylo yhi',line)
-        z0=re.search(' zlo zhi',line)
-        a=re.search('Atoms',line)
+        x0 = re.search(' xlo xhi', line)
+        y0 = re.search(' ylo yhi', line)
+        z0 = re.search(' zlo zhi', line)
+        a = re.search('Atoms', line)
         if x0:
-            if x==[99999,99999]:
-                f.write('{0:.5f} {1:.5f} xlo xhi\n'.format(xmin,xmax))
+            if x == [99999, 99999]:
+                f.write('{0:.5f} {1:.5f} xlo xhi\n'.format(xmin, xmax))
             else:
-                f.write('{0:.5f} {1:.5f} xlo xhi\n'.format(x[0],x[1]))
+                f.write('{0:.5f} {1:.5f} xlo xhi\n'.format(x[0], x[1]))
         elif y0:
-            if y==[99999,99999]:
-                f.write('{0:.5f} {1:.5f} ylo yhi\n'.format(ymin,ymax))
+            if y == [99999, 99999]:
+                f.write('{0:.5f} {1:.5f} ylo yhi\n'.format(ymin, ymax))
             else:
-                f.write('{0:.5f} {1:.5f} ylo yhi\n'.format(y[0],y[1]))
+                f.write('{0:.5f} {1:.5f} ylo yhi\n'.format(y[0], y[1]))
         elif z0:
-            if z==[99999,99999]:
-                f.write('{0:.5f} {1:.5f} zlo zhi\n'.format(zmin,zmax))
+            if z == [99999, 99999]:
+                f.write('{0:.5f} {1:.5f} zlo zhi\n'.format(zmin, zmax))
             else:
-                f.write('{0:.5f} {1:.5f} zlo zhi\n'.format(z[0],z[1]))
-        elif c==1:
-            need=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if len(need)>=6:
-                c=2
-            if len(need)==7:
-                f.write('{0} {1} {2} {3} {4:.5f} {5:.5f} {6:.5f}\n'.format(need[0],need[1],need[2], need[3], pos[i][1], pos[i][2], pos[i][3]))
-                i=i+1
-            elif len(need)==6:
-                f.write('{0} {1} {2} {3:.5f} {4:.5f} {5:.5f}\n'.format(need[0],need[1],need[2], pos[i][1], pos[i][2], pos[i][3]))
-                i=i+1
-        elif c==2:
-            need=re.findall(r'\-?[0-9]+\.?[0-9]*',line)
-            if len(need)==7:
-                f.write('{0} {1} {2} {3} {4:.5f} {5:.5f} {6:.5f}\n'.format(need[0],need[1],need[2], need[3], pos[i][1], pos[i][2], pos[i][3]))
-            elif len(need)==6:
-                f.write('{0} {1} {2} {3:.5f} {4:.5f} {5:.5f}\n'.format(need[0],need[1],need[2], pos[i][1], pos[i][2], pos[i][3]))
-            i=i+1
-            if atoms_number==i:
-                c=0
+                f.write('{0:.5f} {1:.5f} zlo zhi\n'.format(z[0], z[1]))
+        elif c == 1:
+            need = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if len(need) >= 6:
+                c = 2
+            if len(need) == 7:
+                f.write('{0} {1} {2} {3} {4:.5f} {5:.5f} {6:.5f}\n'.format(need[0],\
+                                                                           need[1], need[2], need[3], pos[i][1], pos[i][2], pos[i][3]))
+                i = i + 1
+            elif len(need) == 6:
+                f.write('{0} {1} {2} {3:.5f} {4:.5f} {5:.5f}\n'.format(need[0],\
+                                                                       need[1], need[2], pos[i][1], pos[i][2], pos[i][3]))
+                i = i + 1
+        elif c == 2:
+            need = re.findall(r'\-?[0-9]+\.?[0-9]*', line)
+            if len(need) == 7:
+                f.write('{0} {1} {2} {3} {4:.5f} {5:.5f} {6:.5f}\n'.format(need[0],\
+                                                                           need[1], need[2], need[3], pos[i][1], pos[i][2], pos[i][3]))
+            elif len(need) == 6:
+                f.write('{0} {1} {2} {3:.5f} {4:.5f} {5:.5f}\n'.format(need[0],\
+                                                                       need[1], need[2], pos[i][1], pos[i][2], pos[i][3]))
+            i = i + 1
+            if atoms_number == i:
+                c = 0
         elif a:
-            c=1
+            c = 1
             f.write(line)
             f.write('\n')
         else:
             f.write(line)
     readfile.close()
     f.close()
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir(loc)
     os.system('rm {0}.data'.format(file))
     os.system('cp pre.data {0}.data'.format(file))
     os.system('rm pre.data')
     os.chdir(path)
```

### Comparing `MCPoly-0.5.1.3/MCPoly/moldraw/C_selection.py` & `MCPoly-0.6b1/MCPoly/moldraw/C_selection.py`

 * *Files 19% similar despite different names*

```diff
@@ -1,233 +1,235 @@
 import math as m
 import numpy as np
 from ase.io import read, write
 from ase import Atoms
 from ase.visualize import view
 
-def C_selection(substitution,atoms,Cnear,state=[1,1]):
-    if substitution=='CO' or substitution=='C=O':
-        return CO(atoms,Cnear,state)
-    if substitution=='CNH' or substitution=='C=NH':
-        return CNH(atoms,Cnear,state)
-    if substitution=='O':
-        return O(atoms,Cnear,state)
-    if substitution=='S':
-        return S(atoms,Cnear,state)
-    if substitution=='N':
-        return N(atoms,Cnear,state)
+def C_selection(substitution, atoms, Cnear, state=[1, 1]):
+    if substitution == 'CO' or substitution == 'C=O':
+        return CO(atoms, Cnear, state)
+    if substitution == 'CNH' or substitution == 'C=NH':
+        return CNH(atoms, Cnear, state)
+    if substitution == 'O':
+        return O(atoms, Cnear, state)
+    if substitution == 'S':
+        return S(atoms, Cnear, state)
+    if substitution == 'N':
+        return N(atoms, Cnear, state)
                         
-def CO(atoms,Cnear,state=[1,1]):
+def CO(atoms, Cnear, state=[1, 1]):
     atoms.append('O')
-    total_atoms=len(atoms)
-    x=atoms.get_positions()
-    x[-1][0]=x[-1][0]-50
-    x[-1][1]=x[-1][1]-50
-    x[-1][2]=x[-1][2]-50
+    total_atoms = len(atoms)
+    x = atoms.get_positions()
+    x[-1][0] = x[-1][0] - 50
+    x[-1][1] = x[-1][1] - 50
+    x[-1][2] = x[-1][2] - 50
     atoms.set_positions(x)
-    CnearC1=near(Cnear,atoms,'C')
-    CnearC2=near(Cnear,atoms,'C',ignore=[CnearC1],reverse=True)
-    #print(CnearC1,CnearC2)
-    mask=[0]*(total_atoms-1)+[1]
-    mask[Cnear]=1
-    for k in range(10):
-        if state[0]==1:
-            atoms.set_distance(Cnear,CnearC1,1.5220,fix=1,mask=mask)
-        elif state[0]==2:
-            atoms.set_distance(Cnear,CnearC1,1.4440,fix=1,mask=mask)
-        elif state[0]==6:
-            atoms.set_distance(Cnear,CnearC1,1.4900,fix=1,mask=mask)
-        elif state[0]==7:
-            atoms.set_distance(Cnear,CnearC1,1.3350,fix=1,mask=mask)
-        elif state[0]==8:
-            atoms.set_distance(Cnear,CnearC1,1.3640,fix=1,mask=mask)
-        elif state[0]==82:
-            atoms.set_distance(Cnear,CnearC1,1.5100,fix=1,mask=mask)
-        if state[1]==1:
-            atoms.set_distance(Cnear,CnearC2,1.5220,fix=1,mask=mask)
-        elif state[1]==2:
-            atoms.set_distance(Cnear,CnearC2,1.4440,fix=1,mask=mask)
-        elif state[1]==6:
-            atoms.set_distance(Cnear,CnearC2,1.4900,fix=1,mask=mask)
-        elif state[1]==7:
-            atoms.set_distance(Cnear,CnearC2,1.3350,fix=1,mask=mask)
-        elif state[1]==8:
-            atoms.set_distance(Cnear,CnearC2,1.3640,fix=1,mask=mask)
-        elif state[1]==82:
-            atoms.set_distance(Cnear,CnearC2,1.5100,fix=1,mask=mask)
-    mask[Cnear]=0
-    for k in range(10):
-        atoms.set_angle(CnearC1,Cnear,total_atoms-1,120,mask=mask)
-        atoms.set_angle(CnearC2,Cnear,total_atoms-1,120,mask=mask)
-    atoms.set_distance(total_atoms-1,Cnear,1.2290,fix=1,mask=mask)
+    CnearC1 = near(Cnear, atoms, 'C')
+    CnearC2 = near(Cnear, atoms, 'C', ignore=[CnearC1], reverse=True)
+    #print(CnearC1, CnearC2)
+    mask = [0]*(total_atoms-1)+[1]
+    mask[Cnear] = 1
+    for k in range(10):
+        if state[0] == 1:
+            atoms.set_distance(Cnear, CnearC1, 1.5220, fix=1, mask=mask)
+        elif state[0] == 2:
+            atoms.set_distance(Cnear, CnearC1, 1.4440, fix=1, mask=mask)
+        elif state[0] == 6:
+            atoms.set_distance(Cnear, CnearC1, 1.4900, fix=1, mask=mask)
+        elif state[0] == 7:
+            atoms.set_distance(Cnear, CnearC1, 1.3350, fix=1, mask=mask)
+        elif state[0] == 8:
+            atoms.set_distance(Cnear, CnearC1, 1.3640, fix=1, mask=mask)
+        elif state[0] == 82:
+            atoms.set_distance(Cnear, CnearC1, 1.5100, fix=1, mask=mask)
+        if state[1] == 1:
+            atoms.set_distance(Cnear, CnearC2, 1.5220, fix=1, mask=mask)
+        elif state[1] == 2:
+            atoms.set_distance(Cnear, CnearC2, 1.4440, fix=1, mask=mask)
+        elif state[1] == 6:
+            atoms.set_distance(Cnear, CnearC2, 1.4900, fix=1, mask=mask)
+        elif state[1] == 7:
+            atoms.set_distance(Cnear, CnearC2, 1.3350, fix=1, mask=mask)
+        elif state[1] == 8:
+            atoms.set_distance(Cnear, CnearC2, 1.3640, fix=1, mask=mask)
+        elif state[1] == 82:
+            atoms.set_distance(Cnear, CnearC2, 1.5100, fix=1, mask=mask)
+    mask[Cnear] = 0
+    for k in range(10):
+        atoms.set_angle(CnearC1, Cnear, total_atoms-1, 120, mask=mask)
+        atoms.set_angle(CnearC2, Cnear, total_atoms-1, 120, mask=mask)
+    atoms.set_distance(total_atoms-1, Cnear, 1.2290, fix=1, mask=mask)
     for i in range(2):
-        Hnear=near(Cnear,atoms,'H',limit=False)
+        Hnear = near(Cnear, atoms, 'H', limit = False)
         del atoms[Hnear]
     return atoms
 
-def CNH(atoms,Cnear,state=[1,1]):
+def CNH(atoms, Cnear, state=[1, 1]):
     atoms.append('N')
     atoms.append('H')
-    total_atoms=len(atoms)
-    x=atoms.get_positions()
-    x[-2][0]=x[-2][0]+50
-    x[-2][1]=x[-2][1]+50
-    x[-2][2]=x[-2][2]+50
-    x[-1][0]=x[-1][0]-50
-    x[-1][1]=x[-1][1]-50
-    x[-1][2]=x[-1][2]-50
+    total_atoms = len(atoms)
+    x = atoms.get_positions()
+    x[-2][0] = x[-2][0] + 50
+    x[-2][1] = x[-2][1] + 50
+    x[-2][2] = x[-2][2] + 50
+    x[-1][0] = x[-1][0] - 50
+    x[-1][1] = x[-1][1] - 50
+    x[-1][2] = x[-1][2] - 50
     atoms.set_positions(x)
-    CnearC1=near(Cnear,atoms,'C')
-    CnearC2=near(Cnear,atoms,'C',ignore=[CnearC1],reverse=True)
-    #print(CnearC1,CnearC2)
-    mask=[0]*(total_atoms-2)+[2]
-    mask[Cnear]=1
-    for k in range(10):
-        if state[0]==1:
-            atoms.set_distance(Cnear,CnearC1,1.5220,fix=1,mask=mask)
-        elif state[0]==2:
-            atoms.set_distance(Cnear,CnearC1,1.5220,fix=1,mask=mask)
-        elif state[0]==6:
-            atoms.set_distance(Cnear,CnearC1,1.5220,fix=1,mask=mask)
-        elif state[0]==7:
-            atoms.set_distance(Cnear,CnearC1,1.3350,fix=1,mask=mask)
-        elif state[0]==8:
-            atoms.set_distance(Cnear,CnearC1,1.3640,fix=1,mask=mask)
-        elif state[0]==82:
-            atoms.set_distance(Cnear,CnearC1,1.5100,fix=1,mask=mask)
-        if state[1]==1:
-            atoms.set_distance(Cnear,CnearC2,1.5220,fix=1,mask=mask)
-        elif state[1]==2:
-            atoms.set_distance(Cnear,CnearC2,1.5220,fix=1,mask=mask)
-        elif state[1]==6:
-            atoms.set_distance(Cnear,CnearC2,1.5220,fix=1,mask=mask)
-        elif state[1]==7:
-            atoms.set_distance(Cnear,CnearC2,1.3350,fix=1,mask=mask)
-        elif state[1]==8:
-            atoms.set_distance(Cnear,CnearC2,1.3640,fix=1,mask=mask)
-        elif state[1]==82:
-            atoms.set_distance(Cnear,CnearC2,1.5100,fix=1,mask=mask)
-    mask[Cnear]=0
-    for k in range(10):
-        atoms.set_angle(CnearC1,Cnear,total_atoms-2,120,mask=mask)
-        atoms.set_angle(CnearC2,Cnear,total_atoms-2,120,mask=mask)
-    mask[-2]=0
-    atoms.set_angle(Cnear,total_atoms-2,total_atoms-1,120.5,mask=mask)
-    atoms.set_distance(total_atoms-1,total_atoms-2,1.0100,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear1,Cnear,total_atoms-2,total_atoms-1,179.5,mask=mask)
+    CnearC1 = near(Cnear, atoms, 'C')
+    CnearC2 = near(Cnear, atoms, 'C', ignore=[CnearC1], reverse=True)
+    #print(CnearC1, CnearC2)
+    mask = [0]*(total_atoms-2) + [2]
+    mask[Cnear] = 1
+    for k in range(10):
+        if state[0] == 1:
+            atoms.set_distance(Cnear, CnearC1, 1.5220, fix=1, mask=mask)
+        elif state[0] == 2:
+            atoms.set_distance(Cnear, CnearC1, 1.5220, fix=1, mask=mask)
+        elif state[0] == 6:
+            atoms.set_distance(Cnear, CnearC1, 1.5220, fix=1, mask=mask)
+        elif state[0] == 7:
+            atoms.set_distance(Cnear, CnearC1, 1.3350, fix=1, mask=mask)
+        elif state[0] == 8:
+            atoms.set_distance(Cnear, CnearC1, 1.3640, fix=1, mask=mask)
+        elif state[0] == 82:
+            atoms.set_distance(Cnear, CnearC1, 1.5100, fix=1, mask=mask)
+        if state[1] == 1:
+            atoms.set_distance(Cnear, CnearC2, 1.5220, fix=1, mask=mask)
+        elif state[1] == 2:
+            atoms.set_distance(Cnear, CnearC2, 1.5220, fix=1, mask=mask)
+        elif state[1] == 6:
+            atoms.set_distance(Cnear, CnearC2, 1.5220, fix=1, mask=mask)
+        elif state[1] == 7:
+            atoms.set_distance(Cnear, CnearC2, 1.3350, fix=1, mask=mask)
+        elif state[1] == 8:
+            atoms.set_distance(Cnear, CnearC2, 1.3640, fix=1, mask=mask)
+        elif state[1] == 82:
+            atoms.set_distance(Cnear, CnearC2, 1.5100, fix=1, mask=mask)
+    mask[Cnear] = 0
+    for k in range(10):
+        atoms.set_angle(CnearC1, Cnear, total_atoms-2, 120, mask=mask)
+        atoms.set_angle(CnearC2, Cnear, total_atoms-2, 120, mask=mask)
+    mask[-2] = 0
+    atoms.set_angle(Cnear, total_atoms-2, total_atoms-1, 120.5, mask=mask)
+    atoms.set_distance(total_atoms-1, total_atoms-2, 1.0100, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear1, Cnear, total_atoms-2,\
+                       total_atoms-1, 179.5, mask=mask)
     for i in range(2):
-        Hnear=near(Cnear,atoms,'H',limit=False)
+        Hnear = near(Cnear, atoms, 'H', limit = False)
         del atoms[Hnear]
     return atoms
 
-def O(atoms,Cnear,state=[1,1]):
+def O(atoms, Cnear, state=[1, 1]):
     atoms.append('O')
-    total_atoms=len(atoms)
-    x=atoms.get_positions()
-    x[-1][0]=x[-1][0]-50
-    x[-1][1]=x[-1][1]-50
-    x[-1][2]=x[-1][2]-50
+    total_atoms = len(atoms)
+    x = atoms.get_positions()
+    x[-1][0] = x[-1][0] - 50
+    x[-1][1] = x[-1][1] - 50
+    x[-1][2] = x[-1][2] - 50
     atoms.set_positions(x)
-    CnearC1=near(Cnear,atoms,'C')
-    CnearC2=near(Cnear,atoms,'C',ignore=[CnearC1],reverse=True)
-    print(CnearC1,CnearC2)
-    mask=[0]*(total_atoms-1)+[1]
-    atoms.set_distance(total_atoms-1,Cnear,0,fix=1)
-    for k in range(10):
-        if state[0]==1:
-            atoms.set_distance(total_atoms-1,CnearC1,1.410,fix=1)
-        elif state[0]==2 or state[0]==6 or state[0]==82:
-            atoms.set_distance(total_atoms-1,CnearC1,1.364,fix=1)
-        elif state[0]==4:
-            atoms.set_distance(total_atoms-1,CnearC1,1.327,fix=1)
-        elif state[0]==164:
-            atoms.set_distance(total_atoms-1,CnearC1,1.670,fix=1)
-        if state[1]==1:
-            atoms.set_distance(total_atoms-1,CnearC2,1.410,fix=1)
-        elif state[1]==2 or state[1]==6 or state[1]==82:
-            atoms.set_distance(total_atoms-1,CnearC2,1.364,fix=1)
-        elif state[1]==4:
-            atoms.set_distance(total_atoms-1,CnearC2,1.327,fix=1)
-        elif state[1]==164:
-            atoms.set_distance(total_atoms-1,CnearC2,1.670,fix=1)
+    CnearC1 = near(Cnear, atoms, 'C')
+    CnearC2 = near(Cnear, atoms, 'C', ignore=[CnearC1], reverse=True)
+    print(CnearC1, CnearC2)
+    mask = [0]*(total_atoms-1) + [1]
+    atoms.set_distance(total_atoms-1, Cnear, 0, fix=1)
+    for k in range(10):
+        if state[0] == 1:
+            atoms.set_distance(total_atoms-1, CnearC1, 1.410, fix=1)
+        elif state[0] == 2 or state[0] == 6 or state[0] == 82:
+            atoms.set_distance(total_atoms-1, CnearC1, 1.364, fix=1)
+        elif state[0] == 4:
+            atoms.set_distance(total_atoms-1, CnearC1, 1.327, fix=1)
+        elif state[0] == 164:
+            atoms.set_distance(total_atoms-1, CnearC1, 1.670, fix=1)
+        if state[1] == 1:
+            atoms.set_distance(total_atoms-1, CnearC2, 1.410, fix=1)
+        elif state[1] == 2 or state[1] == 6 or state[1] == 82:
+            atoms.set_distance(total_atoms-1, CnearC2, 1.364, fix=1)
+        elif state[1] == 4:
+            atoms.set_distance(total_atoms-1, CnearC2, 1.327, fix=1)
+        elif state[1] == 164:
+            atoms.set_distance(total_atoms-1, CnearC2, 1.670, fix=1)
     del atoms[Cnear]
     for i in range(2):
-        total_atoms=len(atoms)
-        Hnear=near(total_atoms-1,atoms,'H',limit=False)
+        total_atoms = len(atoms)
+        Hnear = near(total_atoms-1, atoms, 'H', limit=False)
         del atoms[Hnear]
     return atoms
 
-def S(atoms,Cnear,state=[1,1]):
+def S(atoms, Cnear, state=[1, 1]):
     atoms.append('S')
-    total_atoms=len(atoms)
-    x=atoms.get_positions()
-    x[-1][0]=x[-1][0]-50
-    x[-1][1]=x[-1][1]-50
-    x[-1][2]=x[-1][2]-50
+    total_atoms = len(atoms)
+    x = atoms.get_positions()
+    x[-1][0] = x[-1][0] - 50
+    x[-1][1] = x[-1][1] - 50
+    x[-1][2] = x[-1][2] - 50
     atoms.set_positions(x)
-    CnearC1=near(Cnear,atoms,'C')
-    CnearC2=near(Cnear,atoms,'C',ignore=[CnearC1],reverse=True)
-    print(CnearC1,CnearC2)
-    mask=[0]*(total_atoms-1)+[1]
-    atoms.set_distance(total_atoms-1,Cnear,0,fix=1)
-    for k in range(10):
-        if state[0]==1:
-            atoms.set_distance(total_atoms-1,CnearC1,1.810,fix=1)
-        elif state[0]==2:
-            atoms.set_distance(total_atoms-1,CnearC1,1.770,fix=1)
-        if state[1]==1:
-            atoms.set_distance(total_atoms-1,CnearC2,1.810,fix=1)
-        elif state[1]==2:
-            atoms.set_distance(total_atoms-1,CnearC2,1.770,fix=1)
-    Hnear=near(total_atoms-1,atoms,'C',limit=False)
+    CnearC1 = near(Cnear, atoms, 'C')
+    CnearC2 = near(Cnear, atoms, 'C', ignore=[CnearC1], reverse=True)
+    print(CnearC1, CnearC2)
+    mask = [0]*(total_atoms-1) + [1]
+    atoms.set_distance(total_atoms-1, Cnear, 0, fix=1)
+    for k in range(10):
+        if state[0] == 1:
+            atoms.set_distance(total_atoms-1, CnearC1, 1.810, fix=1)
+        elif state[0] == 2:
+            atoms.set_distance(total_atoms-1, CnearC1, 1.770, fix=1)
+        if state[1] == 1:
+            atoms.set_distance(total_atoms-1, CnearC2, 1.810, fix=1)
+        elif state[1] == 2:
+            atoms.set_distance(total_atoms-1, CnearC2, 1.770, fix=1)
+    Hnear = near(total_atoms-1, atoms, 'C', limit=False)
     del atoms[Hnear]
     for i in range(2):
-        total_atoms=len(atoms)
-        Hnear=near(total_atoms-1,atoms,'H',limit=False)
+        total_atoms = len(atoms)
+        Hnear = near(total_atoms-1, atoms, 'H', limit=False)
         del atoms[Hnear]
     return atoms
 
-def N(atoms,Cnear,state=[1,1]):
+def N(atoms, Cnear, state=[1, 1]):
     atoms.append('N')
-    total_atoms=len(atoms)
-    x=atoms.get_positions()
-    x[-1][0]=x[-1][0]-50
-    x[-1][1]=x[-1][1]-50
-    x[-1][2]=x[-1][2]-50
+    total_atoms = len(atoms)
+    x = atoms.get_positions()
+    x[-1][0] = x[-1][0] - 50
+    x[-1][1] = x[-1][1] - 50
+    x[-1][2] = x[-1][2] - 50
     atoms.set_positions(x)
-    CnearC1=near(Cnear,atoms,'C')
-    CnearC2=near(Cnear,atoms,'C',ignore=[CnearC1],reverse=True)
-    print(CnearC1,CnearC2)
-    mask=[0]*(total_atoms-1)+[1]
-    atoms.set_distance(total_atoms-1,Cnear,0,fix=1)
-    for k in range(10):
-        if state[0]==1:
-            atoms.set_distance(total_atoms-1,CnearC1,1.4480,fix=1)
-        elif state[0]==2 or state[0]==6 or state[0]==82:
-            atoms.set_distance(total_atoms-1,CnearC1,1.3400,fix=1)
-        elif state[0]==4:
-            atoms.set_distance(total_atoms-1,CnearC1,1.4900,fix=1)
-        if state[1]==1:
-            atoms.set_distance(total_atoms-1,CnearC2,1.4480,fix=1)
-        elif state[1]==2 or state[1]==6 or state[1]==82:
-            atoms.set_distance(total_atoms-1,CnearC2,1.3400,fix=1)
-        elif state[1]==4:
-            atoms.set_distance(total_atoms-1,CnearC2,1.4900,fix=1)
-    CnearC1=numjudge(CnearC1,Cnear)
-    CnearC2=numjudge(CnearC2,Cnear)
+    CnearC1 = near(Cnear, atoms, 'C')
+    CnearC2 = near(Cnear, atoms, 'C', ignore=[CnearC1], reverse=True)
+    print(CnearC1, CnearC2)
+    mask = [0]*(total_atoms-1) + [1]
+    atoms.set_distance(total_atoms-1, Cnear, 0, fix=1)
+    for k in range(10):
+        if state[0] == 1:
+            atoms.set_distance(total_atoms-1, CnearC1, 1.4480, fix=1)
+        elif state[0] == 2 or state[0] == 6 or state[0] == 82:
+            atoms.set_distance(total_atoms-1, CnearC1, 1.3400, fix=1)
+        elif state[0] == 4:
+            atoms.set_distance(total_atoms-1, CnearC1, 1.4900, fix=1)
+        if state[1] == 1:
+            atoms.set_distance(total_atoms-1, CnearC2, 1.4480, fix=1)
+        elif state[1] == 2 or state[1] == 6 or state[1] == 82:
+            atoms.set_distance(total_atoms-1, CnearC2, 1.3400, fix=1)
+        elif state[1] == 4:
+            atoms.set_distance(total_atoms-1, CnearC2, 1.4900, fix=1)
+    CnearC1 = numjudge(CnearC1, Cnear)
+    CnearC2 = numjudge(CnearC2, Cnear)
     del atoms[Cnear]
     for i in range(2):
-        total_atoms=len(atoms)
-        Hnear=near(total_atoms-1,atoms,'H',limit=False)
+        total_atoms = len(atoms)
+        Hnear = near(total_atoms-1, atoms, 'H', limit=False)
         del atoms[Hnear]
-        CnearC1=numjudge(CnearC1,Hnear)
-        CnearC2=numjudge(CnearC2,Hnear)
+        CnearC1 = numjudge(CnearC1, Hnear)
+        CnearC2 = numjudge(CnearC2, Hnear)
     atoms.append('H')
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-1)+[1]
-    CnearC3=near(CnearC1,atoms,'C',ignore=[CnearC1,CnearC2])
-    for k in range(10):
-        atoms.set_angle(CnearC1,total_atoms-2,total_atoms-1,109.5,mask=mask)
-        atoms.set_angle(CnearC2,total_atoms-2,total_atoms-1,109.5,mask=mask)
-        atoms.set_dihedral(CnearC3,CnearC1,total_atoms-2,total_atoms-1,150,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-2,1.0100,fix=1)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-1) + [1]
+    CnearC3 = near(CnearC1, atoms, 'C', ignore = [CnearC1, CnearC2])
+    for k in range(10):
+        atoms.set_angle(CnearC1, total_atoms-2, total_atoms-1, 109.5, mask=mask)
+        atoms.set_angle(CnearC2, total_atoms-2, total_atoms-1, 109.5, mask=mask)
+        atoms.set_dihedral(CnearC3, CnearC1, total_atoms-2,\
+                           total_atoms-1, 150, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-2, 1.0100, fix=1)
     return atoms
```

### Comparing `MCPoly-0.5.1.3/MCPoly/moldraw/bind_selection.py` & `MCPoly-0.6b1/MCPoly/moldraw/bind_selection.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,1396 +1,1439 @@
 import math as m
 import numpy as np
-from ase.io import read, write
+from ase.io import read,  write
 from ase import Atoms
 from ase.visualize import view
 
-def bind_selection(ring_size,atoms,bond,state=[1,1],place=0,strict={1:'X'}, side=0, shuffle=0, less5=False, stable=False):
+def bind_selection(ring_size, atoms, bond, state=[1, 1], place=0, strict={1:'X'}, side=0, shuffle=0, less5=False, stable=False):
     '''This function will bind the ring onto a bond. 5 means adding a 5-membered-ring bound. 
     Adding a 6 in the front will make sure the conjugation of the ring.''' 
     
-    if ring_size==2 or ring_size=='bind2':
-        return bind2(atoms,bond,state)
-    elif ring_size==3 or ring_size=='bind3':
-        return bind3(atoms,bond,state,strict)
-    elif ring_size==5 or ring_size=='bind5':
-        return bind5(atoms,bond,state,strict,side,shuffle,less5,stable)
-    elif ring_size==6 or ring_size=='bind6':
-        return bind6(atoms,bond,state,strict,side,shuffle,less5)
-    elif ring_size==65 or ring_size=='bindconj5':
-        return bindconj5(atoms,bond,state,strict)
-    elif ring_size==66 or ring_size=='bindconj6':
-        return bindconj6(atoms,bond,state,strict)
+    if ring_size == 2 or ring_size == 'bind2':
+        return bind2(atoms, bond, state)
+    elif ring_size == 3 or ring_size == 'bind3':
+        return bind3(atoms, bond, state, strict)
+    elif ring_size == 5 or ring_size == 'bind5':
+        return bind5(atoms, bond, state, strict, side, shuffle, less5, stable)
+    elif ring_size == 6 or ring_size == 'bind6':
+        return bind6(atoms, bond, state, strict, side, shuffle, less5)
+    elif ring_size == 65 or ring_size == 'bindconj5':
+        return bindconj5(atoms, bond, state, strict)
+    elif ring_size == 66 or ring_size == 'bindconj6':
+        return bindconj6(atoms, bond, state, strict)
 
-def bind2(atoms,bond,state=[1,1]):
-    i1=bond[0]
-    i2=bond[1]
-    elements=atoms.get_chemical_symbols()
-    element1=elements[i1]
-    element2=elements[i2]
-    Cnear1=near(i1,atoms,'Not H',ignore=[i1,i2])
-    Cnear2=near(i2,atoms,'Not H',ignore=[i1,i2],reverse=True)
-    total_atoms=len(atoms)
-    mask=[0]*total_atoms
-    mask[i1]=1
-    mask[i2]=1
-    bondjudge2([Cnear1,Cnear2],atoms,[i1,i2],[element1,element2],state,mask)
+def bind2(atoms, bond, state=[1, 1]):
+    i1 = bond[0]
+    i2 = bond[1]
+    elements = atoms.get_chemical_symbols()
+    element1 = elements[i1]
+    element2 = elements[i2]
+    Cnear1 = near(i1, atoms, 'Not H', ignore=[i1, i2])
+    Cnear2 = near(i2, atoms, 'Not H', ignore=[i1, i2], reverse=True)
+    total_atoms = len(atoms)
+    mask = [0] * total_atoms
+    mask[i1] = 1
+    mask[i2] = 1
+    bondjudge2([Cnear1, Cnear2], atoms, [i1, i2], [element1, element2],\
+               state, mask)
     for j in range(2):
-        CnearH=near(i1,atoms,'H')
+        CnearH = near(i1, atoms, 'H')
         del atoms[CnearH]
-        i1=numjudge(i1,CnearH)
-        i2=numjudge(i2,CnearH)
+        i1 = numjudge(i1, CnearH)
+        i2 = numjudge(i2, CnearH)
     for j in range(2):
-        CnearH=near(i2,atoms,'H')
+        CnearH = near(i2, atoms, 'H')
         del atoms[CnearH]
-        i1=numjudge(i1,CnearH)
-        i2=numjudge(i2,CnearH)
+        i1 = numjudge(i1, CnearH)
+        i2 = numjudge(i2, CnearH)
     atoms.append('H')
     atoms.append('H')
-    x=atoms.get_positions()
-    x[-2][0]=x[-2][0]-100
-    x[-2][1]=x[-2][1]-50
-    x[-2][2]=x[-2][2]-50
-    x[-1][0]=x[-1][0]+50
-    x[-1][1]=x[-1][1]+50
-    x[-1][2]=x[-1][2]+50
+    x = atoms.get_positions()
+    x[-2][0] = x[-2][0] - 100
+    x[-2][1] = x[-2][1] - 50
+    x[-2][2] = x[-2][2] - 50
+    x[-1][0] = x[-1][0] + 50
+    x[-1][1] = x[-1][1] + 50
+    x[-1][2] = x[-1][2] + 50
     atoms.set_positions(x)
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-2)+[1]*2
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-2) + [1]*2
     for k in range(10):
-        atoms.set_angle(Cnear1,i1,total_atoms-2,118,mask=mask)
-        atoms.set_angle(i2,i1,total_atoms-2,118,mask=mask)
-    atoms.set_distance(total_atoms-2,i1,1.0800,fix=1,mask=mask)
-    mask[-2]=0
+        atoms.set_angle(Cnear1, i1, total_atoms-2, 118, mask=mask)
+        atoms.set_angle(i2, i1, total_atoms-2, 118, mask=mask)
+    atoms.set_distance(total_atoms-2, i1, 1.0800, fix=1, mask=mask)
+    mask[-2] = 0
     for k in range(10):
-        atoms.set_angle(Cnear2,i2,total_atoms-1,118,mask=mask)
-        atoms.set_angle(i1,i2,total_atoms-1,118,mask=mask)
-    atoms.set_distance(total_atoms-1,i2,1.0800,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms-2,i1,i2,total_atoms-1,0.5,mask=mask)
-    if element1=='N':
+        atoms.set_angle(Cnear2, i2, total_atoms-1, 118, mask=mask)
+        atoms.set_angle(i1, i2, total_atoms-1, 118, mask=mask)
+    atoms.set_distance(total_atoms-1, i2, 1.0800, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms-2, i1, i2, total_atoms-1, 0.5, mask=mask)
+    if element1 == 'N':
         del atoms[-2]
-    if element2=='N':
+    if element2 == 'N':
         del atoms[-1]
     return atoms
 
-def bind3(atoms,bond,state=[1,1],strict={1:'X'}):
-    i1=bond[0]
-    i2=bond[1]
-    Cnear=near(i1,atoms,'C')
-    total_atoms=len(atoms)
-    if strict[1]=='O':
+def bind3(atoms, bond, state=[1, 1], strict={1:'X'}):
+    i1 = bond[0]
+    i2 = bond[1]
+    Cnear = near(i1, atoms, 'C')
+    total_atoms = len(atoms)
+    if strict[1] == 'O':
         atoms.append('O')
-        mask=[0]*total_atoms+[1]
-        if state==[1,1]:
+        mask = [0]*total_atoms + [1]
+        if state == [1, 1]:
             for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.4100,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.4100,fix=1,mask=mask)
-        elif state==[1,2]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.4100,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.3640,fix=1,mask=mask)
-        elif state==[2,1]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.3640,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.4100,fix=1,mask=mask)
-        elif state==[2,2] or state==[6,6]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.3640,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.3640,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i1,i2,total_atoms,75,mask=mask)
+                atoms.set_distance(total_atoms, i1, 1.4100, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.4100, fix=1, mask=mask)
+        elif state == [1, 2]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.4100, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.3640, fix=1, mask=mask)
+        elif state == [2, 1]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.3640, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.4100, fix=1, mask=mask)
+        elif state == [2, 2] or state == [6, 6]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.3640, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.3640, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i1, i2, total_atoms, 75, mask=mask)
         for j in range(2):
-            CnearH=near(total_atoms-j,atoms,'H')
+            CnearH = near(total_atoms - j, atoms, 'H')
             del atoms[CnearH]
-    elif strict[1]=='S':
+    elif strict[1] == 'S':
         atoms.append('S')
-        mask=[0]*total_atoms+[1]
-        if state==[1,1]:
+        mask = [0]*total_atoms + [1]
+        if state == [1, 1]:
             for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.8100,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.8100,fix=1,mask=mask)
-        elif state==[1,2]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.8100,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.7700,fix=1,mask=mask)
-        elif state==[2,1]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.7700,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.8100,fix=1,mask=mask)
-        elif state==[2,2] or state==[6,6]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.7700,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.7700,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i1,i2,total_atoms,75,mask=mask)
+                atoms.set_distance(total_atoms, i1, 1.8100, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.8100, fix=1, mask=mask)
+        elif state == [1, 2]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.8100, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.7700, fix=1, mask=mask)
+        elif state == [2, 1]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.7700, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.8100, fix=1, mask=mask)
+        elif state == [2, 2] or state == [6, 6]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.7700, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.7700, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i1, i2, total_atoms, 75, mask=mask)
         for j in range(2):
-            CnearH=near(total_atoms,atoms,'H')
+            CnearH = near(total_atoms, atoms, 'H')
             del atoms[CnearH]
-            total_atoms=numjudge(total_atoms,CnearH)
-            i1=numjudge(i1,CnearH)
-            i2=numjudge(i2,CnearH)
-    elif strict[1]=='N':
+            total_atoms = numjudge(total_atoms, CnearH)
+            i1 = numjudge(i1, CnearH)
+            i2 = numjudge(i2, CnearH)
+    elif strict[1] == 'N':
         atoms.append('N')
         atoms.append('H')
-        mask=[0]*total_atoms+[1]*2
-        if state==[1,1]:
+        mask = [0]*total_atoms + [1]*2
+        if state == [1, 1]:
             for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.4480,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.4480,fix=1,mask=mask)
-        elif state==[1,2]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.4480,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.3400,fix=1,mask=mask)
-        elif state==[2,1]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.3400,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.4480,fix=1,mask=mask)
-        elif state==[2,2] or state==[6,6]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.3400,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.3400,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i1,i2,total_atoms,75,mask=mask)
-        mask[-2]=0
+                atoms.set_distance(total_atoms, i1, 1.4480, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.4480, fix=1, mask=mask)
+        elif state == [1, 2]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.4480, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.3400, fix=1, mask=mask)
+        elif state == [2, 1]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.3400, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.4480, fix=1, mask=mask)
+        elif state == [2, 2] or state == [6, 6]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.3400, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.3400, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i1, i2, total_atoms, 75, mask=mask)
+        mask[-2] = 0
         for j in range(2):
-            CnearH=near(total_atoms,atoms,'H')
+            CnearH = near(total_atoms, atoms, 'H')
             del atoms[CnearH]
-            total_atoms=numjudge(total_atoms,CnearH)
-            i1=numjudge(i1,CnearH)
-            i2=numjudge(i2,CnearH)
-        x=atoms.get_positions()
-        x[-1][0]=x[-1][0]+50
-        x[-1][1]=x[-1][1]+50
-        x[-1][2]=x[-1][2]+50
+            total_atoms = numjudge(total_atoms, CnearH)
+            i1 = numjudge(i1, CnearH)
+            i2 = numjudge(i2, CnearH)
+        x = atoms.get_positions()
+        x[-1][0] = x[-1][0] + 50
+        x[-1][1] = x[-1][1] + 50
+        x[-1][2] = x[-1][2] + 50
         atoms.set_positions(x)
-        total_atoms=len(atoms)
-        mask=[0]*(total_atoms-1)+[1]
-        atoms.set_distance(total_atoms-1,total_atoms-2,0,fix=1,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-2,1.0100,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-1,total_atoms-2,i1,i2,-90.5,mask=mask)
+        total_atoms = len(atoms)
+        mask = [0]*(total_atoms-1) + [1]
+        atoms.set_distance(total_atoms-1, total_atoms-2, 0, fix=1, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-2, 1.0100, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-1, total_atoms-2, i1, i2, -90.5, mask=mask)
         for k in range(10):
-            atoms.set_angle(i1,total_atoms-2,total_atoms-1,111.5,mask=mask)
-            atoms.set_angle(i2,total_atoms-2,total_atoms-1,111.5,mask=mask)
+            atoms.set_angle(i1, total_atoms-2, total_atoms-1, 111.5, mask=mask)
+            atoms.set_angle(i2, total_atoms-2, total_atoms-1, 111.5, mask=mask)
     else:
         atoms.append('C')
         atoms.append('H')
         atoms.append('H')
-        mask=[0]*total_atoms+[1]*3
-        if state==[1,1]:
+        mask = [0]*total_atoms + [1]*3
+        if state == [1, 1]:
             for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.5290,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.5290,fix=1,mask=mask)
-        elif state==[1,2]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.5290,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.5095,fix=1,mask=mask)
-        elif state==[2,1]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.5095,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.5290,fix=1,mask=mask)
-        elif state==[2,2]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.5095,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.5095,fix=1,mask=mask)
-        elif state==[6,6]:
-            for k in range(10):
-                atoms.set_distance(total_atoms,i1,1.5105,fix=1,mask=mask)
-                atoms.set_distance(total_atoms,i2,1.5105,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i1,i2,total_atoms,75,mask=mask)
-        mask[-3]=0
+                atoms.set_distance(total_atoms, i1, 1.5290, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.5290, fix=1, mask=mask)
+        elif state == [1, 2]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.5290, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.5095, fix=1, mask=mask)
+        elif state == [2, 1]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.5095, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.5290, fix=1, mask=mask)
+        elif state == [2, 2]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.5095, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.5095, fix=1, mask=mask)
+        elif state == [6, 6]:
+            for k in range(10):
+                atoms.set_distance(total_atoms, i1, 1.5105, fix=1, mask=mask)
+                atoms.set_distance(total_atoms, i2, 1.5105, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i1, i2, total_atoms, 75, mask=mask)
+        mask[-3] = 0
         for j in range(2):
-            CnearH=near(total_atoms,atoms,'H')
+            CnearH = near(total_atoms, atoms, 'H')
             del atoms[CnearH]
-            total_atoms=numjudge(total_atoms,CnearH)
-            i1=numjudge(i1,CnearH)
-            i2=numjudge(i2,CnearH)
-        x=atoms.get_positions()
-        x[-2][0]=x[-2][0]+50
-        x[-2][1]=x[-2][1]+50
-        x[-2][2]=x[-2][2]+50
-        x[-1][0]=x[-1][0]-50
-        x[-1][1]=x[-1][1]-50
-        x[-1][2]=x[-1][2]-50
+            total_atoms = numjudge(total_atoms, CnearH)
+            i1 = numjudge(i1, CnearH)
+            i2 = numjudge(i2, CnearH)
+        x = atoms.get_positions()
+        x[-2][0] = x[-2][0] + 50
+        x[-2][1] = x[-2][1] + 50
+        x[-2][2] = x[-2][2] + 50
+        x[-1][0] = x[-1][0] - 50
+        x[-1][1] = x[-1][1] - 50
+        x[-1][2] = x[-1][2] - 50
         atoms.set_positions(x)
-        total_atoms=len(atoms)
-        mask=[0]*(total_atoms-2)+[1]*2
-        atoms.set_distance(total_atoms-2,total_atoms-3,0,fix=1,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-3,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-2,total_atoms-3,i1,Cnear,110,mask=mask)
+        total_atoms = len(atoms)
+        mask = [0]*(total_atoms-2) + [1]*2
+        atoms.set_distance(total_atoms-2, total_atoms-3, 0, fix=1, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-3, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-2, total_atoms-3, i1, Cnear, 110, mask=mask)
         for k in range(10):
-            atoms.set_angle(i1,total_atoms-3,total_atoms-2,111.5,mask=mask)
-            atoms.set_angle(i2,total_atoms-3,total_atoms-2,111.5,mask=mask)
-        mask[-2]=0
-        atoms.set_distance(total_atoms-1,total_atoms-3,0,fix=1,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-3,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-1,total_atoms-3,i1,Cnear,-70.5,mask=mask)
+            atoms.set_angle(i1, total_atoms-3, total_atoms-2, 111.5, mask=mask)
+            atoms.set_angle(i2, total_atoms-3, total_atoms-2, 111.5, mask=mask)
+        mask[-2] = 0
+        atoms.set_distance(total_atoms-1, total_atoms-3, 0, fix=1, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-3, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-1, total_atoms-3, i1, Cnear, -70.5, mask=mask)
         for k in range(10):
-            atoms.set_angle(i1,total_atoms-3,total_atoms-1,111.5,mask=mask)
-            atoms.set_angle(i2,total_atoms-3,total_atoms-1,111.5,mask=mask)
-        atoms.set_dihedral(total_atoms-1,total_atoms-3,i1,i2,-90.5,mask=mask)
+            atoms.set_angle(i1, total_atoms-3, total_atoms-1, 111.5, mask=mask)
+            atoms.set_angle(i2, total_atoms-3, total_atoms-1, 111.5, mask=mask)
+        atoms.set_dihedral(total_atoms-1, total_atoms-3, i1, i2, -90.5, mask=mask)
     return atoms
 
-def bind5(atoms,bond,state=[1,1],strict={1:'X'},side=0,shuffle=0,less5=False,stable=False):
-    i1=bond[0]
-    i2=bond[1]
-    if side==0:
-        Hnear1=near(i1,atoms,'H')
-        Hnear2=near(i2,atoms,'H')
-    elif side==1:
-        Hnear1=near(i1,atoms,'H',reverse=True)
-        Hnear2=near(i2,atoms,'H',reverse=True)
-    elif side==2:
-        Hnear1=near(i1,atoms,'H')
-        Hnear2=near(i2,atoms,'H',reverse=True)
-    elif side==3:
-        Hnear1=near(i1,atoms,'H',reverse=True)
-        Hnear2=near(i2,atoms,'H')
-    print(Hnear1,Hnear2)
-    total_atoms=len(atoms)
-    mask=[0]*total_atoms
-    mask[Hnear1]=1
-    atoms.set_angle(i2,i1,Hnear1,100,mask=mask)
-    mask[Hnear1]=0
-    mask[Hnear2]=1
-    atoms.set_angle(i1,i2,Hnear2,-100,mask=mask)
-    if (less5==True and side<2) or (less5==False and side>=2):
-        atoms.set_dihedral(Hnear1,i1,i2,Hnear2,-35,mask=mask)
-        xoy=near(Hnear2,atoms,limit=False)
-        if atoms.get_distance(xoy,Hnear2)<=0.9:
-            atoms.set_dihedral(Hnear1,i1,i2,Hnear2,35,mask=mask)
-        xoy=near(i2,atoms,target='Not H')
-        if xoy==i1:
-            xoy=near(i2,atoms,target='Not H',reverse=True)
-        if atoms.get_angle(xoy,i2,Hnear2)<=90:
-            atoms.set_dihedral(Hnear1,i1,i2,Hnear2,35,mask=mask)
-    elif less5==False and side<2:
-        atoms.set_dihedral(Hnear1,i1,i2,Hnear2,55,mask=mask)
-        xoy=near(Hnear2,atoms,limit=False)
-        if atoms.get_distance(xoy,Hnear2)<=0.9:
-            atoms.set_dihedral(Hnear1,i1,i2,Hnear2,-55,mask=mask)
-        xoy=near(i2,atoms,target='Not H')
-        if xoy==i1:
-            xoy=near(i2,atoms,target='Not H',reverse=True)
-        if atoms.get_angle(xoy,i2,Hnear2)<=90:
-            atoms.set_dihedral(Hnear1,i1,i2,Hnear2,-55,mask=mask)
-    elif less5==True and side>=2:
-        atoms.set_dihedral(Hnear1,i1,i2,Hnear2,80,mask=mask)
-        xoy=near(Hnear2,atoms,limit=False)
-        if atoms.get_distance(xoy,Hnear2)<=0.9:
-            atoms.set_dihedral(Hnear1,i1,i2,Hnear2,-80,mask=mask)
-        xoy=near(i2,atoms,target='Not H')
-        if xoy==i1:
-            xoy=near(i2,atoms,target='Not H',reverse=True)
-        if atoms.get_angle(xoy,i2,Hnear2)<=90:
-            atoms.set_dihedral(Hnear1,i1,i2,Hnear2,-80,mask=mask)
-        mask[Hnear2]=0
-        mask[Hnear1]=1
-        if atoms.get_dihedral(Hnear1,i1,i2,Hnear2)<85:
-            atoms.set_dihedral(Hnear2,i2,i1,Hnear1,50,mask=mask)
+def bind5(atoms, bond, state=[1, 1], strict={1:'X'}, side=0, shuffle=0, less5=False, stable=False):
+    i1 = bond[0]
+    i2 = bond[1]
+    if side == 0:
+        Hnear1 = near(i1, atoms, 'H')
+        Hnear2 = near(i2, atoms, 'H')
+    elif side == 1:
+        Hnear1 = near(i1, atoms, 'H', reverse=True)
+        Hnear2 = near(i2, atoms, 'H', reverse=True)
+    elif side == 2:
+        Hnear1 = near(i1, atoms, 'H')
+        Hnear2 = near(i2, atoms, 'H', reverse=True)
+    elif side == 3:
+        Hnear1 = near(i1, atoms, 'H', reverse=True)
+        Hnear2 = near(i2, atoms, 'H')
+    print(Hnear1, Hnear2)
+    total_atoms = len(atoms)
+    mask = [0] * total_atoms
+    mask[Hnear1] = 1
+    atoms.set_angle(i2, i1, Hnear1, 100, mask=mask)
+    mask[Hnear1] = 0
+    mask[Hnear2] = 1
+    atoms.set_angle(i1, i2, Hnear2, -100, mask=mask)
+    if (less5 == True and side < 2) or (less5 == False and side >= 2):
+        atoms.set_dihedral(Hnear1, i1, i2, Hnear2, -35, mask=mask)
+        xoy = near(Hnear2, atoms, limit=False)
+        if atoms.get_distance(xoy, Hnear2) <= 0.9:
+            atoms.set_dihedral(Hnear1, i1, i2, Hnear2, 35, mask=mask)
+        xoy = near(i2, atoms, target='Not H')
+        if xoy == i1:
+            xoy = near(i2, atoms, target='Not H', reverse=True)
+        if atoms.get_angle(xoy, i2, Hnear2) <= 90:
+            atoms.set_dihedral(Hnear1, i1, i2, Hnear2, 35, mask=mask)
+    elif less5 == False and side < 2:
+        atoms.set_dihedral(Hnear1, i1, i2, Hnear2, 55, mask=mask)
+        xoy = near(Hnear2, atoms, limit=False)
+        if atoms.get_distance(xoy, Hnear2) <= 0.9:
+            atoms.set_dihedral(Hnear1, i1, i2, Hnear2, -55, mask=mask)
+        xoy = near(i2, atoms, target='Not H')
+        if xoy == i1:
+            xoy = near(i2, atoms, target='Not H', reverse=True)
+        if atoms.get_angle(xoy, i2, Hnear2) <= 90:
+            atoms.set_dihedral(Hnear1, i1, i2, Hnear2, -55, mask=mask)
+    elif less5 == True and side >= 2:
+        atoms.set_dihedral(Hnear1, i1, i2, Hnear2, 80, mask=mask)
+        xoy = near(Hnear2, atoms, limit=False)
+        if atoms.get_distance(xoy, Hnear2) <= 0.9:
+            atoms.set_dihedral(Hnear1, i1, i2, Hnear2, -80, mask=mask)
+        xoy = near(i2, atoms, target='Not H')
+        if xoy == i1:
+            xoy = near(i2, atoms, target='Not H', reverse=True)
+        if atoms.get_angle(xoy, i2, Hnear2) <= 90:
+            atoms.set_dihedral(Hnear1, i1, i2, Hnear2, -80, mask=mask)
+        mask[Hnear2] = 0
+        mask[Hnear1] = 1
+        if atoms.get_dihedral(Hnear1, i1, i2, Hnear2)<85:
+            atoms.set_dihedral(Hnear2, i2, i1, Hnear1, 50, mask=mask)
         else:
-            atoms.set_dihedral(Hnear2,i2,i1,Hnear1,360-50,mask=mask)
-    if less5==True and side>=2:
-        elements=atoms.get_chemical_symbols()
-        elements[Hnear1]='C'
-        elements[Hnear2]='C'
+            atoms.set_dihedral(Hnear2, i2, i1, Hnear1, 360 - 50, mask=mask)
+    if less5 == True and side >= 2:
+        elements = atoms.get_chemical_symbols()
+        elements[Hnear1] = 'C'
+        elements[Hnear2] = 'C'
         atoms.set_chemical_symbols(elements)
-        atoms.set_distance(Hnear1,i1,1.0400,fix=1)
-        atoms.set_distance(Hnear2,i2,1.0400,fix=1)
-        Hnear3=near(i1,atoms,'H')
-        Hnear4=near(i2,atoms,'H')
-        atoms.set_distance(Hnear1,i1,1.0900,fix=1)
-        atoms.set_distance(Hnear2,i2,1.0900,fix=1)
-        elements[Hnear1]='H'
-        elements[Hnear2]='H'
+        atoms.set_distance(Hnear1, i1, 1.0400, fix=1)
+        atoms.set_distance(Hnear2, i2, 1.0400, fix=1)
+        Hnear3 = near(i1, atoms, 'H')
+        Hnear4 = near(i2, atoms, 'H')
+        atoms.set_distance(Hnear1, i1, 1.0900, fix=1)
+        atoms.set_distance(Hnear2, i2, 1.0900, fix=1)
+        elements[Hnear1] = 'H'
+        elements[Hnear2] = 'H'
         atoms.set_chemical_symbols(elements)
-    #    x=atoms.get_positions()
-    #    x[Hnear3][0]=x[Hnear3][0]-50
-    #    x[Hnear3][1]=x[Hnear3][1]-50
-    #    x[Hnear3][2]=x[Hnear3][2]-50
-    #    x[Hnear4][0]=x[Hnear4][0]+50
-    #    x[Hnear4][1]=x[Hnear4][1]+50
-    #    x[Hnear4][2]=x[Hnear4][2]+50
+    #    x = atoms.get_positions()
+    #    x[Hnear3][0] = x[Hnear3][0] - 50
+    #    x[Hnear3][1] = x[Hnear3][1] - 50
+    #    x[Hnear3][2] = x[Hnear3][2] - 50
+    #    x[Hnear4][0] = x[Hnear4][0] + 50
+    #    x[Hnear4][1] = x[Hnear4][1] + 50
+    #    x[Hnear4][2] = x[Hnear4][2] + 50
     #    atoms.set_positions(x)
-    if less5==True and side>=2:
-        Cnear1=near(i1,atoms,'Not H')
-        Cnear2=near(i2,atoms,'Not H')
-        mask[Hnear1]=0
-        mask[Hnear2]=0
-        mask[Hnear3]=1
-        mask[Hnear4]=1
-        if Cnear1==i2:
-            Cnear1=near(i1,atoms,'Not H',reverse=True)
-        if Cnear2==i1:
-            Cnear2=near(i2,atoms,'Not H',reverse=True)
+    if less5 == True and side >= 2:
+        Cnear1 = near(i1, atoms, 'Not H')
+        Cnear2 = near(i2, atoms, 'Not H')
+        mask[Hnear1] = 0
+        mask[Hnear2] = 0
+        mask[Hnear3] = 1
+        mask[Hnear4] = 1
+        if Cnear1 == i2:
+            Cnear1 = near(i1, atoms, 'Not H', reverse=True)
+        if Cnear2 == i1:
+            Cnear2 = near(i2, atoms, 'Not H', reverse=True)
         for k in range(10):
-            atoms.set_angle(i2,i1,Hnear3,105.0,mask=mask)
-            atoms.set_angle(Hnear1,i1,Hnear3,105.0,mask=mask)
-        atoms.set_distance(Hnear3,i1,1.0900,fix=1,mask=mask)
-        mask[Hnear3]=0
+            atoms.set_angle(i2, i1, Hnear3, 105.0, mask=mask)
+            atoms.set_angle(Hnear1, i1, Hnear3, 105.0, mask=mask)
+        atoms.set_distance(Hnear3, i1, 1.0900, fix=1, mask=mask)
+        mask[Hnear3] = 0
         for k in range(10):
-            atoms.set_angle(i1,i2,Hnear4,105.0,mask=mask)
-            atoms.set_angle(Hnear2,i2,Hnear4,105.0,mask=mask)
-        atoms.set_distance(Hnear4,i2,1.0900,fix=1,mask=mask)
-    if shuffle==0:
-        atoms=CH3(atoms,Hnear1,state[0])
-        atoms=CH3(atoms,Hnear2,state[1],ring=True)
-    elif shuffle==1:
-        atoms=CH3(atoms,Hnear1,state[0],ring=True)
-        atoms=CH3(atoms,Hnear2,state[1])
-    elif shuffle==2:
-        atoms=CH3(atoms,Hnear1,state[0])
-        atoms=CH3(atoms,Hnear2,state[1])
-    elif shuffle==3:
-        atoms=CH3(atoms,Hnear1,state[0],ring=True)
-        atoms=CH3(atoms,Hnear2,state[1],ring=True)
+            atoms.set_angle(i1, i2, Hnear4, 105.0, mask=mask)
+            atoms.set_angle(Hnear2, i2, Hnear4, 105.0, mask=mask)
+        atoms.set_distance(Hnear4, i2, 1.0900, fix=1, mask=mask)
+    if shuffle == 0:
+        atoms = CH3(atoms, Hnear1, state[0])
+        atoms = CH3(atoms, Hnear2, state[1], ring=True)
+    elif shuffle == 1:
+        atoms = CH3(atoms, Hnear1, state[0], ring=True)
+        atoms = CH3(atoms, Hnear2, state[1])
+    elif shuffle == 2:
+        atoms = CH3(atoms, Hnear1, state[0])
+        atoms = CH3(atoms, Hnear2, state[1])
+    elif shuffle == 3:
+        atoms = CH3(atoms, Hnear1, state[0], ring=True)
+        atoms = CH3(atoms, Hnear2, state[1], ring=True)
     atoms.append('C')
     atoms.append('H')
     atoms.append('H')
-    x=atoms.get_positions()
-    x[-3][0]=x[-3][0]-50
-    x[-3][1]=x[-3][1]-50
-    x[-3][2]=x[-3][2]-50
-    x[-2][0]=x[-2][0]+50
-    x[-2][1]=x[-2][1]+50
-    x[-2][2]=x[-2][2]+50
-    x[-1][0]=x[-1][0]-50
-    x[-1][1]=x[-1][1]-50
-    x[-1][2]=x[-1][2]-50
+    x = atoms.get_positions()
+    x[-3][0] = x[-3][0] - 50
+    x[-3][1] = x[-3][1] - 50
+    x[-3][2] = x[-3][2] - 50
+    x[-2][0] = x[-2][0] + 50
+    x[-2][1] = x[-2][1] + 50
+    x[-2][2] = x[-2][2] + 50
+    x[-1][0] = x[-1][0] - 50
+    x[-1][1] = x[-1][1] - 50
+    x[-1][2] = x[-1][2] - 50
     atoms.set_positions(x)
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-3)+[1]*3
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-3)+[1]*3
     for k in range(10):
-        if atoms.get_distance(total_atoms-3,i1)<1.6 or stable==True:
-            atoms.set_distance(total_atoms-3,i1,2.4,fix=1,mask=mask)
-        if atoms.get_distance(total_atoms-3,i2)<1.6 or stable==True:
-            atoms.set_distance(total_atoms-3,i2,2.4,fix=1,mask=mask)
-        atoms.set_distance(total_atoms-3,Hnear1,1.5290,fix=1,mask=mask)
-        atoms.set_distance(total_atoms-3,Hnear2,1.5290,fix=1,mask=mask)
-    mask[-3]=0
+        if atoms.get_distance(total_atoms-3, i1) < 1.6 or stable == True:
+            atoms.set_distance(total_atoms-3, i1, 2.4, fix=1, mask=mask)
+        if atoms.get_distance(total_atoms-3, i2) < 1.6 or stable == True:
+            atoms.set_distance(total_atoms-3, i2, 2.4, fix=1, mask=mask)
+        atoms.set_distance(total_atoms-3, Hnear1, 1.5290, fix=1, mask=mask)
+        atoms.set_distance(total_atoms-3, Hnear2, 1.5290, fix=1, mask=mask)
+    mask[-3] = 0
     for j in range(2):
-        total_atoms=len(atoms)
-        CnearH=near(total_atoms-3,atoms,'H',limit=False)
+        total_atoms = len(atoms)
+        CnearH = near(total_atoms-3, atoms, 'H', limit=False)
         del atoms[CnearH]
-        i1=numjudge(i1,CnearH)
-        i2=numjudge(i2,CnearH)
-        Hnear1=numjudge(Hnear1,CnearH)
-        Hnear2=numjudge(Hnear2,CnearH)
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-2)+[1]*2
-    if side<2:
-        atoms.set_distance(total_atoms-2,total_atoms-3,0,fix=1,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-3,1.0900,fix=1,mask=mask)
+        i1 = numjudge(i1, CnearH)
+        i2 = numjudge(i2, CnearH)
+        Hnear1 = numjudge(Hnear1, CnearH)
+        Hnear2 = numjudge(Hnear2, CnearH)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-2) + [1]*2
+    if side < 2:
+        atoms.set_distance(total_atoms-2, total_atoms-3, 0, fix=1, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-3, 1.0900, fix=1, mask=mask)
         while(1):
-            if atoms.get_distance(total_atoms-2,Hnear1)<1.3:
-                atoms.set_distance(total_atoms-2,Hnear1,1.8,fix=1,mask=mask)
-            if atoms.get_distance(total_atoms-2,Hnear2)<1.3:
-                atoms.set_distance(total_atoms-2,Hnear2,1.8,fix=1,mask=mask)
-            xoy=near(total_atoms-1,atoms,limit=False)
-            #if atoms.get_distance(xoy,total_atoms-2)<=0.85:
-            #    atoms.set_distance(xoy,total_atoms-2,1,mask=mask)
-            atoms.set_angle(Hnear1,total_atoms-3,total_atoms-2,111.0,mask=mask)
-            atoms.set_angle(Hnear2,total_atoms-3,total_atoms-2,111.0,mask=mask)
-            atoms.set_distance(total_atoms-2,total_atoms-3,1.0900,fix=1,mask=mask)
-            if atoms.get_distance(total_atoms-2,Hnear1)>1.4 and atoms.get_distance(total_atoms-2,Hnear2)>1.4:
-                if abs(atoms.get_angle(Hnear1,total_atoms-3,total_atoms-2)-atoms.get_angle(Hnear2,total_atoms-3,total_atoms-2))<1:
-                    #print(atoms.get_angle(Hnear1,total_atoms-3,total_atoms-2)-atoms.get_angle(Hnear2,total_atoms-3,total_atoms-2))
+            if atoms.get_distance(total_atoms-2, Hnear1) < 1.3:
+                atoms.set_distance(total_atoms-2, Hnear1, 1.8, fix=1, mask=mask)
+            if atoms.get_distance(total_atoms-2, Hnear2) < 1.3:
+                atoms.set_distance(total_atoms-2, Hnear2, 1.8, fix=1, mask=mask)
+            xoy = near(total_atoms-1, atoms, limit=False)
+            #if atoms.get_distance(xoy, total_atoms-2) <= 0.85:
+            #    atoms.set_distance(xoy, total_atoms-2, 1, mask=mask)
+            atoms.set_angle(Hnear1, total_atoms-3, total_atoms-2, 111.0, mask=mask)
+            atoms.set_angle(Hnear2, total_atoms-3, total_atoms-2, 111.0, mask=mask)
+            atoms.set_distance(total_atoms-2, total_atoms-3, 1.0900, fix=1, mask=mask)
+            if (atoms.get_distance(total_atoms-2, Hnear1) > 1.4 and 
+                atoms.get_distance(total_atoms-2, Hnear2)) > 1.4:
+                if (abs(atoms.get_angle(Hnear1, total_atoms-3, total_atoms-2)
+                        - atoms.get_angle(Hnear2, total_atoms-3, total_atoms-2)) < 1):
+                    #print(atoms.get_angle(Hnear1, total_atoms-3, total_atoms-2)
+                    #.     - atoms.get_angle(Hnear2, total_atoms-3, total_atoms-2))
                     break
-        #atoms.set_dihedral(total_atoms-2,total_atoms-3,Hnear1,i1,60,mask=mask)
-        mask[-2]=0
-        #atoms.set_distance(total_atoms-1,total_atoms-3,0,fix=1,mask=mask)
-        #atoms.set_distance(total_atoms-1,total_atoms-3,1.0900,fix=1,mask=mask)
+        #atoms.set_dihedral(total_atoms-2, total_atoms-3, Hnear1, i1, 60, mask=mask)
+        mask[-2] = 0
+        #atoms.set_distance(total_atoms-1, total_atoms-3, 0, fix=1, mask=mask)
+        #atoms.set_distance(total_atoms-1, total_atoms-3, 1.0900, fix=1, mask=mask)
         #while(1):
-        #    if atoms.get_distance(total_atoms-1,Hnear1)<1.3:
-        #        atoms.set_distance(total_atoms-1,Hnear1,1.8,fix=1,mask=mask)
-        #    if atoms.get_distance(total_atoms-1,Hnear2)<1.3:
-        #        atoms.set_distance(total_atoms-1,Hnear2,1.8,fix=1,mask=mask)
-        #    atoms.set_angle(Hnear1,total_atoms-3,total_atoms-1,111.0,mask=mask)
-        #    atoms.set_angle(Hnear2,total_atoms-3,total_atoms-1,111.0,mask=mask)
-        #    atoms.set_distance(total_atoms-1,total_atoms-3,1.0900,fix=1,mask=mask)
-        #    if atoms.get_distance(total_atoms-1,Hnear1)>1.4 and atoms.get_distance(total_atoms-1,Hnear2)>1.4:
-        #        if abs(atoms.get_angle(Hnear1,total_atoms-3,total_atoms-1)-atoms.get_angle(Hnear2,total_atoms-3,total_atoms-1))<1:
-        #            print(atoms.get_angle(Hnear1,total_atoms-3,total_atoms-1)-atoms.get_angle(Hnear2,total_atoms-3,total_atoms-1))
+        #    if atoms.get_distance(total_atoms-1, Hnear1) < 1.3:
+        #        atoms.set_distance(total_atoms-1, Hnear1, 1.8, fix=1, mask=mask)
+        #    if atoms.get_distance(total_atoms-1, Hnear2) < 1.3:
+        #        atoms.set_distance(total_atoms-1, Hnear2, 1.8, fix=1, mask=mask)
+        #    atoms.set_angle(Hnear1, total_atoms-3, total_atoms-1, 111.0, mask=mask)
+        #    atoms.set_angle(Hnear2, total_atoms-3, total_atoms-1, 111.0, mask=mask)
+        #    atoms.set_distance(total_atoms-1, total_atoms-3, 1.0900, fix=1, mask=mask)
+        #    if atoms.get_distance(total_atoms-1, Hnear1) > 1.4 and
+        #       atoms.get_distance(total_atoms-1, Hnear2) > 1.4:
+        #        if abs(atoms.get_angle(Hnear1, total_atoms-3, total_atoms-1)
+        #               - atoms.get_angle(Hnear2, total_atoms-3, total_atoms-1)) < 1:
+        #            print(atoms.get_angle(Hnear1, total_atoms-3, total_atoms-1)
+        #                  - atoms.get_angle(Hnear2, total_atoms-3, total_atoms-1))
         #            break
-        #atoms.set_dihedral(total_atoms-1,total_atoms-3,Hnear1,i1,170,mask=mask)
+        #atoms.set_dihedral(total_atoms-1, total_atoms-3, Hnear1, i1, 170, mask=mask)
         #view(atoms)
-        #mask[-2]=0
-        #mask[-1]=1
-        atoms.set_distance(total_atoms-1,total_atoms-2,0,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-1,total_atoms-3,Hnear1,i1,atoms.get_dihedral(total_atoms-1,total_atoms-3,Hnear1,i1)+110,mask=mask)
-        xoy=near(total_atoms-1,atoms,limit=False)
-        if atoms.get_distance(xoy,total_atoms-1)<=0.9:
-            atoms.set_dihedral(total_atoms-1,total_atoms-3,Hnear1,i1,atoms.get_dihedral(total_atoms-1,total_atoms-3,Hnear1,i1)-220,mask=mask)
+        #mask[-2] = 0
+        #mask[-1] = 1
+        atoms.set_distance(total_atoms-1, total_atoms-2, 0, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-1, total_atoms-3, Hnear1, i1,\
+                           atoms.get_dihedral(total_atoms-1, total_atoms-3, Hnear1, i1)+110, mask=mask)
+        xoy = near(total_atoms-1, atoms, limit=False)
+        if atoms.get_distance(xoy, total_atoms-1) <= 0.9:
+            atoms.set_dihedral(total_atoms-1, total_atoms-3, Hnear1,\
+                               i1, atoms.get_dihedral(total_atoms-1, total_atoms-3, Hnear1, i1)-220, mask=mask)
     else:
-        atoms.set_distance(total_atoms-2,total_atoms-3,0,fix=1,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-3,1.0900,fix=1,mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-3, 0, fix=1, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-3, 1.0900, fix=1, mask=mask)
         while(1):
-            if atoms.get_distance(total_atoms-2,Hnear1)<1.3:
-                atoms.set_distance(total_atoms-2,Hnear1,1.8,fix=1,mask=mask)
-            if atoms.get_distance(total_atoms-2,Hnear2)<1.3:
-                atoms.set_distance(total_atoms-2,Hnear2,1.8,fix=1,mask=mask)
-            atoms.set_angle(Hnear1,total_atoms-3,total_atoms-2,111.0,mask=mask)
-            atoms.set_angle(Hnear2,total_atoms-3,total_atoms-2,111.0,mask=mask)
-            atoms.set_distance(total_atoms-2,total_atoms-3,1.0900,fix=1,mask=mask)
-            if atoms.get_distance(total_atoms-2,Hnear1)>1.4 and atoms.get_distance(total_atoms-2,Hnear2)>1.4:
+            if atoms.get_distance(total_atoms-2, Hnear1) < 1.3:
+                atoms.set_distance(total_atoms-2, Hnear1, 1.8, fix=1, mask=mask)
+            if atoms.get_distance(total_atoms-2, Hnear2) < 1.3:
+                atoms.set_distance(total_atoms-2, Hnear2, 1.8, fix=1, mask=mask)
+            atoms.set_angle(Hnear1, total_atoms-3, total_atoms-2, 111.0, mask=mask)
+            atoms.set_angle(Hnear2, total_atoms-3, total_atoms-2, 111.0, mask=mask)
+            atoms.set_distance(total_atoms-2, total_atoms-3, 1.0900, fix=1, mask=mask)
+            if (atoms.get_distance(total_atoms-2, Hnear1) > 1.4 and 
+                atoms.get_distance(total_atoms-2, Hnear2) > 1.4):
                 break
-        mask[-2]=0
-        atoms.set_distance(total_atoms-1,total_atoms-2,0,fix=1,mask=mask)
-        #atoms.set_distance(total_atoms-1,total_atoms-3,1.0900,fix=1,mask=mask)
+        mask[-2] = 0
+        atoms.set_distance(total_atoms-1, total_atoms-2, 0, fix=1, mask=mask)
+        #atoms.set_distance(total_atoms-1, total_atoms-3, 1.0900, fix=1, mask=mask)
         #while(1):
-        #    if atoms.get_distance(total_atoms-1,Hnear1)<1.3:
-        #        atoms.set_distance(total_atoms-1,Hnear1,1.8,fix=1,mask=mask)
-        #    if atoms.get_distance(total_atoms-1,Hnear2)<1.3:
-        #        atoms.set_distance(total_atoms-1,Hnear2,1.8,fix=1,mask=mask)
-        #    atoms.set_angle(Hnear1,total_atoms-3,total_atoms-1,111.0,mask=mask)
-        #    atoms.set_angle(Hnear2,total_atoms-3,total_atoms-1,111.0,mask=mask)
-        #    atoms.set_distance(total_atoms-1,total_atoms-3,1.0900,fix=1,mask=mask)
-        #    if atoms.get_distance(total_atoms-1,4)>1.4 and atoms.get_distance(total_atoms-1,6)>1.4:
+        #    if atoms.get_distance(total_atoms-1, Hnear1)<1.3:
+        #        atoms.set_distance(total_atoms-1, Hnear1, 1.8, fix=1, mask=mask)
+        #    if atoms.get_distance(total_atoms-1, Hnear2)<1.3:
+        #        atoms.set_distance(total_atoms-1, Hnear2, 1.8, fix=1, mask=mask)
+        #    atoms.set_angle(Hnear1, total_atoms-3, total_atoms-1, 111.0, mask=mask)
+        #    atoms.set_angle(Hnear2, total_atoms-3, total_atoms-1, 111.0, mask=mask)
+        #    atoms.set_distance(total_atoms-1, total_atoms-3, 1.0900, fix=1, mask=mask)
+        #    if atoms.get_distance(total_atoms-1, 4)>1.4 and atoms.get_distance(total_atoms-1, 6)>1.4:
         #        break
-        atoms.set_dihedral(total_atoms-1,total_atoms-3,Hnear1,i1,atoms.get_dihedral(total_atoms-1,total_atoms-3,Hnear1,i1)+110,mask=mask)
-        xoy=near(total_atoms-1,atoms,limit=False)
-        if atoms.get_distance(xoy,total_atoms-1)<=0.9:
-            atoms.set_dihedral(total_atoms-1,total_atoms-3,Hnear1,i1,atoms.get_dihedral(total_atoms-1,total_atoms-3,Hnear1,i1)-220,mask=mask)
-    needelements=[]
-    places=[]
+        atoms.set_dihedral(total_atoms-1, total_atoms-3, Hnear1, i1,\
+                           atoms.get_dihedral(total_atoms-1, total_atoms-3, Hnear1, i1)+110, mask=mask)
+        xoy = near(total_atoms-1, atoms, limit=False)
+        if atoms.get_distance(xoy, total_atoms-1) <= 0.9:
+            atoms.set_dihedral(total_atoms-1, total_atoms-3, Hnear1,\
+                               i1, atoms.get_dihedral(total_atoms-1, total_atoms-3, Hnear1, i1)-220, mask=mask)
+    needelements = []
+    places = []
     for j in range(3):
         try:
             needelements.append(strict[j+2])
             places.append(j+2)
         except:
             pass
     for i in range(len(needelements)):
-        total_atoms=len(atoms)
-        mask=[0]*total_atoms
-        if places[i]==2:
-            mask[Hnear1]=1
-            elements=atoms.get_chemical_symbols()
-            elements[Hnear1]=needelements[i]
+        total_atoms = len(atoms)
+        mask = [0]*total_atoms
+        if places[i] == 2:
+            mask[Hnear1] = 1
+            elements = atoms.get_chemical_symbols()
+            elements[Hnear1] = needelements[i]
             atoms.set_chemical_symbols(elements)
-            if needelements[i]=='N':
+            if needelements[i] == 'N':
                 for k in range(10):
-                    if state[0]==1:
-                        atoms.set_distance(Hnear1,i1,1.4480,fix=1,mask=mask)
-                    elif state[0]==2 or state[0]==6:
-                        atoms.set_distance(Hnear1,i1,1.3400,fix=1,mask=mask)
-                    atoms.set_distance(Hnear1,total_atoms-3,1.4480,fix=1,mask=mask)
-                mask[Hnear1]=0
-                total_atoms=len(atoms)
-                CnearH=near(Hnear1,atoms,'H',limit=False)
+                    if state[0] == 1:
+                        atoms.set_distance(Hnear1, i1, 1.4480, fix=1, mask=mask)
+                    elif state[0] == 2 or state[0] == 6:
+                        atoms.set_distance(Hnear1, i1, 1.3400, fix=1, mask=mask)
+                    atoms.set_distance(Hnear1, total_atoms-3, 1.4480, fix=1, mask=mask)
+                mask[Hnear1] = 0
+                total_atoms = len(atoms)
+                CnearH = near(Hnear1, atoms, 'H', limit=False)
                 del atoms[CnearH]
-                Hnear1=numjudge(Hnear1,CnearH)
-                i1=numjudge(i1,CnearH)
-                i2=numjudge(i2,CnearH)
-                CnearH=near(Hnear1,atoms,'H',limit=False)
-                mask[CnearH]=1
-                for k in range(10):
-                    atoms.set_angle(i1,Hnear1,CnearH,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-3,Hnear1,CnearH,109.5,mask=mask)
-                atoms.set_dihedral(i2,i1,Hnear1,CnearH,-150,mask=mask)
-                atoms.set_distance(CnearH,Hnear1,1.0100,fix=1)
-            elif needelements[i]=='O':
-                for k in range(10):
-                    if state[0]==1:
-                        atoms.set_distance(Hnear1,i1,1.4100,fix=1,mask=mask)
-                    elif state[0]==2 or state[0]==6:
-                        atoms.set_distance(Hnear1,i1,1.3640,fix=1,mask=mask)
-                    atoms.set_distance(Hnear1,total_atoms-3,1.4100,fix=1,mask=mask)
+                Hnear1 = numjudge(Hnear1, CnearH)
+                i1 = numjudge(i1, CnearH)
+                i2 = numjudge(i2, CnearH)
+                CnearH = near(Hnear1, atoms, 'H', limit=False)
+                mask[CnearH] = 1
+                for k in range(10):
+                    atoms.set_angle(i1, Hnear1, CnearH, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-3, Hnear1, CnearH, 109.5, mask=mask)
+                atoms.set_dihedral(i2, i1, Hnear1, CnearH, -150, mask=mask)
+                atoms.set_distance(CnearH, Hnear1, 1.0100, fix=1)
+            elif needelements[i] == 'O':
+                for k in range(10):
+                    if state[0] == 1:
+                        atoms.set_distance(Hnear1, i1, 1.4100, fix=1, mask=mask)
+                    elif state[0] == 2 or state[0] == 6:
+                        atoms.set_distance(Hnear1, i1, 1.3640, fix=1, mask=mask)
+                    atoms.set_distance(Hnear1, total_atoms-3, 1.4100, fix=1, mask=mask)
                 for j in range(2):
-                    total_atoms=len(atoms)
-                    CnearH=near(Hnear1,atoms,'H',limit=False)
+                    total_atoms = len(atoms)
+                    CnearH = near(Hnear1, atoms, 'H', limit=False)
                     del atoms[CnearH]
-                    Hnear1=numjudge(Hnear1,CnearH)
-        if places[i]==3:
-            mask[total_atoms-3]=1
-            elements=atoms.get_chemical_symbols()
-            elements[total_atoms-3]=needelements[i]
+                    Hnear1 = numjudge(Hnear1, CnearH)
+        if places[i] == 3:
+            mask[total_atoms-3] = 1
+            elements = atoms.get_chemical_symbols()
+            elements[total_atoms-3] = needelements[i]
             atoms.set_chemical_symbols(elements)
-            if needelements[i]=='N':
+            if needelements[i] == 'N':
                 for k in range(10):
-                    atoms.set_distance(total_atoms-3,Hnear1,1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms-3,Hnear2,1.4480,fix=1,mask=mask)
-                mask[total_atoms-3]=0
-                total_atoms=len(atoms)
-                CnearH=near(total_atoms-3,atoms,'H',limit=False)
+                    atoms.set_distance(total_atoms-3, Hnear1, 1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms-3, Hnear2, 1.4480, fix=1, mask=mask)
+                mask[total_atoms-3] = 0
+                total_atoms = len(atoms)
+                CnearH = near(total_atoms-3, atoms, 'H', limit=False)
                 del atoms[CnearH]
-                Hnear1=numjudge(Hnear1,CnearH)
-                i1=numjudge(i1,CnearH)
-                i2=numjudge(i2,CnearH)
-                CnearH=near(total_atoms-3,atoms,'H',limit=False)
-                mask[CnearH]=1
-                for k in range(10):
-                    atoms.set_angle(Hnear1,total_atoms-3,CnearH,109.5,mask=mask)
-                    atoms.set_angle(Hnear2,total_atoms-3,CnearH,109.5,mask=mask)
-                atoms.set_dihedral(i1,Hnear1,total_atoms-3,CnearH,-150,mask=mask)
-                atoms.set_distance(CnearH,total_atoms-3,1.0100,fix=1)
-            elif needelements[i]=='O':
+                Hnear1 = numjudge(Hnear1, CnearH)
+                i1 = numjudge(i1, CnearH)
+                i2 = numjudge(i2, CnearH)
+                CnearH = near(total_atoms-3, atoms, 'H', limit=False)
+                mask[CnearH] = 1
+                for k in range(10):
+                    atoms.set_angle(Hnear1, total_atoms-3, CnearH, 109.5, mask=mask)
+                    atoms.set_angle(Hnear2, total_atoms-3, CnearH, 109.5, mask=mask)
+                atoms.set_dihedral(i1, Hnear1, total_atoms-3, CnearH, -150, mask=mask)
+                atoms.set_distance(CnearH, total_atoms-3, 1.0100, fix=1)
+            elif needelements[i] == 'O':
                 for k in range(10):
-                    atoms.set_distance(total_atoms-3,Hnear1,1.4100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms-3,Hnear2,1.4100,fix=1,mask=mask)
+                    atoms.set_distance(total_atoms-3, Hnear1, 1.4100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms-3, Hnear2, 1.4100, fix=1, mask=mask)
                 for j in range(2):
-                    total_atoms=len(atoms)
-                    CnearH=near(total_atoms-3+j,atoms,'H',limit=False)
+                    total_atoms = len(atoms)
+                    CnearH = near(total_atoms-3+j, atoms, 'H', limit=False)
                     del atoms[CnearH]
-        if places[i]==4:
-            mask[Hnear2]=1
-            elements=atoms.get_chemical_symbols()
-            elements[Hnear2]=needelements[i]
+        if places[i] == 4:
+            mask[Hnear2] = 1
+            elements = atoms.get_chemical_symbols()
+            elements[Hnear2] = needelements[i]
             atoms.set_chemical_symbols(elements)
-            if needelements[i]=='N':
+            if needelements[i] == 'N':
                 for k in range(10):
-                    if state[0]==1:
-                        atoms.set_distance(Hnear2,i2,1.4480,fix=1,mask=mask)
-                    elif state[0]==2 or state[0]==6:
-                        atoms.set_distance(Hnear2,i2,1.3400,fix=1,mask=mask)
-                    atoms.set_distance(Hnear2,total_atoms-3,1.4480,fix=1,mask=mask)
-                mask[Hnear2]=0
-                total_atoms=len(atoms)
-                CnearH=near(Hnear2,atoms,'H',limit=False)
+                    if state[0] == 1:
+                        atoms.set_distance(Hnear2, i2, 1.4480, fix=1, mask=mask)
+                    elif state[0] == 2 or state[0] == 6:
+                        atoms.set_distance(Hnear2, i2, 1.3400, fix=1, mask=mask)
+                    atoms.set_distance(Hnear2, total_atoms-3, 1.4480, fix=1, mask=mask)
+                mask[Hnear2] = 0
+                total_atoms = len(atoms)
+                CnearH = near(Hnear2, atoms, 'H', limit=False)
                 del atoms[CnearH]
-                Hnear1=numjudge(Hnear1,CnearH)
-                i1=numjudge(i1,CnearH)
-                i2=numjudge(i2,CnearH)
-                CnearH=near(Hnear2,atoms,'H',limit=False)
-                mask[CnearH]=1
-                for k in range(10):
-                    atoms.set_angle(i2,Hnear2,CnearH,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-3,Hnear2,CnearH,109.5,mask=mask)
-                atoms.set_dihedral(i1,i2,Hnear2,CnearH,-150,mask=mask)
-                atoms.set_distance(CnearH,Hnear2,1.0100,fix=1)
-            elif needelements[i]=='O':
-                for k in range(10):
-                    if state[0]==1:
-                        atoms.set_distance(Hnear2,i2,1.4100,fix=1,mask=mask)
-                    elif state[0]==2 or state[0]==6:
-                        atoms.set_distance(Hnear2,i2,1.3640,fix=1,mask=mask)
-                    atoms.set_distance(Hnear2,total_atoms-3,1.4100,fix=1,mask=mask)
+                Hnear1 = numjudge(Hnear1, CnearH)
+                i1 = numjudge(i1, CnearH)
+                i2 = numjudge(i2, CnearH)
+                CnearH = near(Hnear2, atoms, 'H', limit=False)
+                mask[CnearH] = 1
+                for k in range(10):
+                    atoms.set_angle(i2, Hnear2, CnearH, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-3, Hnear2, CnearH, 109.5, mask=mask)
+                atoms.set_dihedral(i1, i2, Hnear2, CnearH, -150, mask=mask)
+                atoms.set_distance(CnearH, Hnear2, 1.0100, fix=1)
+            elif needelements[i] == 'O':
+                for k in range(10):
+                    if state[0] == 1:
+                        atoms.set_distance(Hnear2, i2, 1.4100, fix=1, mask=mask)
+                    elif state[0] == 2 or state[0] == 6:
+                        atoms.set_distance(Hnear2, i2, 1.3640, fix=1, mask=mask)
+                    atoms.set_distance(Hnear2, total_atoms-3, 1.4100, fix=1, mask=mask)
                 for j in range(2):
-                    total_atoms=len(atoms)
-                    CnearH=near(Hnear2,atoms,'H',limit=False)
+                    total_atoms = len(atoms)
+                    CnearH = near(Hnear2, atoms, 'H', limit=False)
                     del atoms[CnearH]
-                    Hnear2=numjudge(Hnear2,CnearH)
+                    Hnear2 = numjudge(Hnear2, CnearH)
     return atoms
 
-def bind6(atoms,bond,state=[1,1],strict={1:'X'},side=0,shuffle=0,less5=False):
-    i1=bond[0]
-    i2=bond[1]
-    if side==0:
-        Hnear1=near(i1,atoms,'H')
-        Hnear2=near(i2,atoms,'H')
-    elif side==1:
-        Hnear1=near(i1,atoms,'H',reverse=True)
-        Hnear2=near(i2,atoms,'H',reverse=True)
-    elif side==2:
-        Hnear1=near(i1,atoms,'H')
-        Hnear2=near(i2,atoms,'H',reverse=True)
-    elif side==3:
-        Hnear1=near(i1,atoms,'H',reverse=True)
-        Hnear2=near(i2,atoms,'H')
-    print(Hnear1,Hnear2)
-    if less5==True and side>=2:
-        total_atoms=len(atoms)
-        mask=[0]*total_atoms
-        mask[Hnear1]=1
-        mask[Hnear2]=1
-        atoms.set_angle(i2,i1,Hnear1,107.8,mask=mask)
-        mask[Hnear1]=0
-        atoms.set_angle(i1,i2,Hnear2,107.8,mask=mask)
-        atoms.set_dihedral(Hnear1,i1,i2,Hnear2,55,mask=mask)
-        xoy=near(Hnear2,atoms,limit=False)
-        if atoms.get_distance(xoy,Hnear2)<=0.9:
-            atoms.set_dihedral(Hnear1,i1,i2,Hnear2,-55,mask=mask)
-        xoy=near(i2,atoms,target='Not H')
-        if xoy==i1:
-            xoy=near(i2,atoms,target='Not H',reverse=True)
-        if atoms.get_angle(xoy,i2,Hnear2)<=90:
-            atoms.set_dihedral(Hnear1,i1,i2,Hnear2,-55,mask=mask)
-    if shuffle==0:
-        atoms=CH3(atoms,Hnear1,state[0])
-        atoms=CH3(atoms,Hnear2,state[1])
-    elif shuffle==1:
-        atoms=CH3(atoms,Hnear1,state[0],ring=True)
-        atoms=CH3(atoms,Hnear2,state[1],ring=True)
-    elif shuffle==2:
-        atoms=CH3(atoms,Hnear1,state[0],ring=True)
-        atoms=CH3(atoms,Hnear2,state[1])
-    elif shuffle==3:
-        atoms=CH3(atoms,Hnear1,state[0])
-        atoms=CH3(atoms,Hnear2,state[1],ring=True)
+def bind6(atoms, bond, state=[1, 1], strict={1:'X'}, side=0, shuffle=0, less5=False):
+    i1 = bond[0]
+    i2 = bond[1]
+    if side == 0:
+        Hnear1 = near(i1, atoms, 'H')
+        Hnear2 = near(i2, atoms, 'H')
+    elif side == 1:
+        Hnear1 = near(i1, atoms, 'H', reverse=True)
+        Hnear2 = near(i2, atoms, 'H', reverse=True)
+    elif side == 2:
+        Hnear1 = near(i1, atoms, 'H')
+        Hnear2 = near(i2, atoms, 'H', reverse=True)
+    elif side == 3:
+        Hnear1 = near(i1, atoms, 'H', reverse=True)
+        Hnear2 = near(i2, atoms, 'H')
+    print(Hnear1, Hnear2)
+    if less5 == True and side >= 2:
+        total_atoms = len(atoms)
+        mask = [0]*total_atoms
+        mask[Hnear1] = 1
+        mask[Hnear2] = 1
+        atoms.set_angle(i2, i1, Hnear1, 107.8, mask=mask)
+        mask[Hnear1] = 0
+        atoms.set_angle(i1, i2, Hnear2, 107.8, mask=mask)
+        atoms.set_dihedral(Hnear1, i1, i2, Hnear2, 55, mask=mask)
+        xoy = near(Hnear2, atoms, limit=False)
+        if atoms.get_distance(xoy, Hnear2) <= 0.9:
+            atoms.set_dihedral(Hnear1, i1, i2, Hnear2, -55, mask=mask)
+        xoy = near(i2, atoms, target='Not H')
+        if xoy == i1:
+            xoy = near(i2, atoms, target='Not H', reverse=True)
+        if atoms.get_angle(xoy, i2, Hnear2) <= 90:
+            atoms.set_dihedral(Hnear1, i1, i2, Hnear2, -55, mask=mask)
+    if shuffle == 0:
+        atoms = CH3(atoms, Hnear1, state[0])
+        atoms = CH3(atoms, Hnear2, state[1])
+    elif shuffle == 1:
+        atoms = CH3(atoms, Hnear1, state[0], ring=True)
+        atoms = CH3(atoms, Hnear2, state[1], ring=True)
+    elif shuffle == 2:
+        atoms = CH3(atoms, Hnear1, state[0], ring=True)
+        atoms = CH3(atoms, Hnear2, state[1])
+    elif shuffle == 3:
+        atoms = CH3(atoms, Hnear1, state[0])
+        atoms = CH3(atoms, Hnear2, state[1], ring=True)
     atoms.append('C')
     atoms.append('C')
     for j in range(4):
         atoms.append('H')
-    x=atoms.get_positions()
-    x[-5][0]=x[-5][0]+50
-    x[-5][1]=x[-5][1]+50
-    x[-5][2]=x[-5][2]+50
-    x[-6][0]=x[-6][0]-50
-    x[-6][1]=x[-6][1]-50
-    x[-6][2]=x[-6][2]-50
-    for i in range(-2,0):
-        x[2*i][0]=x[2*i][0]-50
-        x[2*i][1]=x[2*i][1]-50
-        x[2*i][2]=x[2*i][2]-50
-        x[2*i+1][0]=x[2*i+1][0]+50
-        x[2*i+1][1]=x[2*i+1][1]+50
-        x[2*i+1][2]=x[2*i+1][2]+50
+    x = atoms.get_positions()
+    x[-5][0] = x[-5][0] + 50
+    x[-5][1] = x[-5][1] + 50
+    x[-5][2] = x[-5][2] + 50
+    x[-6][0] = x[-6][0] - 50
+    x[-6][1] = x[-6][1] - 50
+    x[-6][2] = x[-6][2] - 50
+    for i in range(-2, 0):
+        x[2*i][0] = x[2*i][0] - 50
+        x[2*i][1] = x[2*i][1] - 50
+        x[2*i][2] = x[2*i][2] - 50
+        x[2*i+1][0] = x[2*i+1][0] + 50
+        x[2*i+1][1] = x[2*i+1][1] + 50
+        x[2*i+1][2] = x[2*i+1][2] + 50
     atoms.set_positions(x)
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-6)+[1]*6
-    atoms.set_angle(i1,Hnear1,total_atoms-6,107.8,mask=mask)
-    if state[0]==1:
-        atoms.set_distance(total_atoms-6,Hnear1,1.5290,fix=1,mask=mask)
-    elif state[0]==2:
-        atoms.set_distance(total_atoms-6,Hnear1,1.5095,fix=1,mask=mask)
-    elif state[0]==6:
-        atoms.set_distance(total_atoms-6,Hnear1,1.5105,fix=1,mask=mask)
-    if less5==False:
-        atoms.set_dihedral(i2,i1,Hnear1,total_atoms-6,47.9,mask=mask)
-        if atoms.get_distance(total_atoms-6,Hnear2)>=2.7:
-            atoms.set_dihedral(i2,i1,Hnear1,total_atoms-6,-47.9,mask=mask)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-6) + [1]*6
+    atoms.set_angle(i1, Hnear1, total_atoms-6, 107.8, mask=mask)
+    if state[0] == 1:
+        atoms.set_distance(total_atoms-6, Hnear1, 1.5290, fix=1, mask=mask)
+    elif state[0] == 2:
+        atoms.set_distance(total_atoms-6, Hnear1, 1.5095, fix=1, mask=mask)
+    elif state[0] == 6:
+        atoms.set_distance(total_atoms-6, Hnear1, 1.5105, fix=1, mask=mask)
+    if less5 == False:
+        atoms.set_dihedral(i2, i1, Hnear1, total_atoms-6, 47.9, mask=mask)
+        if atoms.get_distance(total_atoms-6, Hnear2) >= 2.7:
+            atoms.set_dihedral(i2, i1, Hnear1, total_atoms-6, -47.9, mask=mask)
     else:
-        atoms.set_dihedral(i2,i1,Hnear1,total_atoms-6,-47.9,mask=mask)
-        if atoms.get_distance(total_atoms-6,Hnear2)>=2.7:
-            atoms.set_dihedral(i2,i1,Hnear1,total_atoms-6,47.9,mask=mask)
+        atoms.set_dihedral(i2, i1, Hnear1, total_atoms-6, -47.9, mask=mask)
+        if atoms.get_distance(total_atoms-6, Hnear2) >= 2.7:
+            atoms.set_dihedral(i2, i1, Hnear1, total_atoms-6, 47.9, mask=mask)
             
-    mask[-6]=0
-    atoms.set_angle(i2,Hnear2,total_atoms-5,107.8,mask=mask)
+    mask[-6] = 0
+    atoms.set_angle(i2, Hnear2, total_atoms-5, 107.8, mask=mask)
     for k in range(10):
-        #print(atoms.get_dihedral(i1,i2,Hnear2,total_atoms-5))
-        if less5==True and atoms.get_dihedral(Hnear2,i2,i1,Hnear1)>10 and atoms.get_dihedral(Hnear2,i2,i1,Hnear1)<350:
-            if atoms.get_dihedral(i1,i2,Hnear2,total_atoms-5)<=30 and atoms.get_dihedral(i1,i2,Hnear2,total_atoms-5)>=0:
-                atoms.set_dihedral(i1,i2,Hnear2,total_atoms-5,47.9,mask=mask)
-            if atoms.get_dihedral(i1,i2,Hnear2,total_atoms-5)>=330 and atoms.get_dihedral(i1,i2,Hnear2,total_atoms-5)<=360:
-                atoms.set_dihedral(i1,i2,Hnear2,total_atoms-5,-47.9,mask=mask)
+        #print(atoms.get_dihedral(i1, i2, Hnear2, total_atoms-5))
+        if (less5 == True and atoms.get_dihedral(Hnear2, i2, i1, Hnear1) > 10 and
+            atoms.get_dihedral(Hnear2, i2, i1, Hnear1) < 350):
+            if (atoms.get_dihedral(i1, i2, Hnear2, total_atoms-5) <= 30
+                and atoms.get_dihedral(i1, i2, Hnear2, total_atoms-5) >= 0):
+                atoms.set_dihedral(i1, i2, Hnear2, total_atoms-5, 47.9, mask=mask)
+            if (atoms.get_dihedral(i1, i2, Hnear2, total_atoms-5) >= 330
+                and atoms.get_dihedral(i1, i2, Hnear2, total_atoms-5) <= 360):
+                atoms.set_dihedral(i1, i2, Hnear2, total_atoms-5, -47.9, mask=mask)
         else:
-            if atoms.get_dihedral(i1,i2,Hnear2,total_atoms-5)<=30 and atoms.get_dihedral(i1,i2,Hnear2,total_atoms-5)>=0:
-                atoms.set_dihedral(i1,i2,Hnear2,total_atoms-5,-47.9,mask=mask)
-            if atoms.get_dihedral(i1,i2,Hnear2,total_atoms-5)>=330 and atoms.get_dihedral(i1,i2,Hnear2,total_atoms-5)<=360:
-                atoms.set_dihedral(i1,i2,Hnear2,total_atoms-5,47.9,mask=mask)
-        atoms.set_distance(total_atoms-5,total_atoms-6,1.5290,fix=1,mask=mask)
-        if state[1]==1:
-            atoms.set_distance(total_atoms-5,Hnear2,1.5290,fix=1,mask=mask)
-        elif state[1]==2:
-            atoms.set_distance(total_atoms-5,Hnear2,1.5095,fix=1,mask=mask)
-        elif state[1]==6:
-            atoms.set_distance(total_atoms-5,Hnear2,1.5105,fix=1,mask=mask)
-    mask[-5]=0
+            if (atoms.get_dihedral(i1, i2, Hnear2, total_atoms-5) <= 30 and
+                atoms.get_dihedral(i1, i2, Hnear2, total_atoms-5) >= 0):
+                atoms.set_dihedral(i1, i2, Hnear2, total_atoms-5, -47.9, mask=mask)
+            if (atoms.get_dihedral(i1, i2, Hnear2, total_atoms-5) >= 330 and
+                atoms.get_dihedral(i1, i2, Hnear2, total_atoms-5) <= 360):
+                atoms.set_dihedral(i1, i2, Hnear2, total_atoms-5, 47.9, mask=mask)
+        atoms.set_distance(total_atoms-5, total_atoms-6, 1.5290, fix=1, mask=mask)
+        if state[1] == 1:
+            atoms.set_distance(total_atoms-5, Hnear2, 1.5290, fix=1, mask=mask)
+        elif state[1] == 2:
+            atoms.set_distance(total_atoms-5, Hnear2, 1.5095, fix=1, mask=mask)
+        elif state[1] == 6:
+            atoms.set_distance(total_atoms-5, Hnear2, 1.5105, fix=1, mask=mask)
+    mask[-5] = 0
     for j in range(2):
-        total_atoms=len(atoms)
-        CnearH=near(total_atoms-6+j,atoms,'H',limit=False)
+        total_atoms = len(atoms)
+        CnearH = near(total_atoms-6+j, atoms, 'H', limit=False)
         del atoms[CnearH]
-        i1=numjudge(i1,CnearH)
-        i2=numjudge(i2,CnearH)
-        Hnear1=numjudge(Hnear1,CnearH)
-        Hnear2=numjudge(Hnear2,CnearH)
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-4)+[1]*4
-    atoms.set_distance(total_atoms-4,total_atoms-6,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms-4,total_atoms-6,Hnear1,i1,-110,mask=mask)
+        i1 = numjudge(i1, CnearH)
+        i2 = numjudge(i2, CnearH)
+        Hnear1 = numjudge(Hnear1, CnearH)
+        Hnear2 = numjudge(Hnear2, CnearH)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-4)+[1]*4
+    atoms.set_distance(total_atoms-4, total_atoms-6, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms-4, total_atoms-6, Hnear1, i1, -110, mask=mask)
     for k in range(10):
-        atoms.set_angle(Hnear1,total_atoms-6,total_atoms-4,111.5,mask=mask)
-        atoms.set_angle(total_atoms-5,total_atoms-6,total_atoms-4,111.5,mask=mask)
-    mask[-4]=0
-    atoms.set_distance(total_atoms-3,total_atoms-4,0,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms-3,total_atoms-6,Hnear1,i1,atoms.get_dihedral(total_atoms-3,total_atoms-6,Hnear1,i1)-110,mask=mask)
-    xoy=near(total_atoms-3,atoms,limit=False)
-    if atoms.get_distance(xoy,total_atoms-3)<=0.9:
-        atoms.set_dihedral(total_atoms-3,total_atoms-6,Hnear1,i1,atoms.get_dihedral(total_atoms-3,total_atoms-6,Hnear1,i1)+220,mask=mask)
-    mask[-3]=0
-    atoms.set_distance(total_atoms-2,total_atoms-5,0,fix=1,mask=mask)
-    atoms.set_distance(total_atoms-2,total_atoms-5,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms-2,total_atoms-5,Hnear2,i2,110,mask=mask)
+        atoms.set_angle(Hnear1, total_atoms-6, total_atoms-4, 111.5, mask=mask)
+        atoms.set_angle(total_atoms-5, total_atoms-6,\
+                        total_atoms-4, 111.5, mask=mask)
+    mask[-4] = 0
+    atoms.set_distance(total_atoms-3, total_atoms-4, 0, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms-3, total_atoms-6, Hnear1, i1,\
+                       atoms.get_dihedral(total_atoms-3,\
+                                          total_atoms-6, Hnear1, i1)-110, mask=mask)
+    xoy = near(total_atoms-3, atoms, limit=False)
+    if atoms.get_distance(xoy, total_atoms-3) <= 0.9:
+        atoms.set_dihedral(total_atoms-3, total_atoms-6, Hnear1, i1,\
+                           atoms.get_dihedral(total_atoms-3,\
+                                              total_atoms-6, Hnear1, i1)+220, mask=mask)
+    mask[-3] = 0
+    atoms.set_distance(total_atoms-2, total_atoms-5, 0, fix=1, mask=mask)
+    atoms.set_distance(total_atoms-2, total_atoms-5, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms-2, total_atoms-5, Hnear2, i2, 110, mask=mask)
     for k in range(10):
-        atoms.set_angle(Hnear2,total_atoms-5,total_atoms-2,111.5,mask=mask)
-        atoms.set_angle(total_atoms-6,total_atoms-5,total_atoms-2,111.5,mask=mask)
-    mask[-2]=0
-    atoms.set_distance(total_atoms-1,total_atoms-2,0,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms-1,total_atoms-5,Hnear2,i2,atoms.get_dihedral(total_atoms-1,total_atoms-5,Hnear2,i2)-110,mask=mask)
-    xoy=near(total_atoms-1,atoms,limit=False)
-    if atoms.get_distance(xoy,total_atoms-1)<=0.9:
-        atoms.set_dihedral(total_atoms-1,total_atoms-5,Hnear2,i2,atoms.get_dihedral(total_atoms-1,total_atoms-5,Hnear2,i2)+220,mask=mask)
+        atoms.set_angle(Hnear2, total_atoms-5, total_atoms-2, 111.5, mask=mask)
+        atoms.set_angle(total_atoms-6, total_atoms-5,\
+                        total_atoms-2, 111.5, mask=mask)
+    mask[-2] = 0
+    atoms.set_distance(total_atoms-1, total_atoms-2, 0, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms-1, total_atoms-5, Hnear2, i2,\
+                       atoms.get_dihedral(total_atoms-1,\
+                                          total_atoms-5, Hnear2, i2)-110, mask=mask)
+    xoy = near(total_atoms-1, atoms, limit=False)
+    if atoms.get_distance(xoy, total_atoms-1) <= 0.9:
+        atoms.set_dihedral(total_atoms-1, total_atoms-5, Hnear2, i2,\
+                           atoms.get_dihedral(total_atoms-1,\
+                                              total_atoms-5, Hnear2, i2)+220, mask=mask)
 
 #    for k in range(10):
-#        atoms.set_angle(Hnear2,total_atoms-5,total_atoms-1,111.5,mask=mask)
-#        atoms.set_angle(total_atoms-6,total_atoms-5,total_atoms-1,111.5,mask=mask)
+#        atoms.set_angle(Hnear2, total_atoms-5, total_atoms-1, 111.5, mask=mask)
+#        atoms.set_angle(total_atoms-6, total_atoms-5, total_atoms-1, 111.5, mask=mask)
         
-    mask[-1]=0
-    needelements=[]
-    places=[]
+    mask[-1] = 0
+    needelements = []
+    places = []
     for j in range(4):
         try:
             needelements.append(strict[j+2])
             places.append(j+2)
         except:
             pass
-    error=0
+    error = 0
     for i in range(len(needelements)):
-        total_atoms=len(atoms)
-        mask=[0]*total_atoms
-        if places[i]==2:
-            mask[Hnear1]=1
-            elements=atoms.get_chemical_symbols()
-            elements[Hnear1]=needelements[i]
+        total_atoms = len(atoms)
+        mask = [0]*total_atoms
+        if places[i] == 2:
+            mask[Hnear1] = 1
+            elements = atoms.get_chemical_symbols()
+            elements[Hnear1] = needelements[i]
             atoms.set_chemical_symbols(elements)
-            if needelements[i]=='N':
+            if needelements[i] == 'N':
                 for k in range(10):
-                    if state[0]==1:
-                        atoms.set_distance(Hnear1,i1,1.4480,fix=1,mask=mask)
-                    elif state[0]==2 or state[0]==6:
-                        atoms.set_distance(Hnear1,i1,1.3400,fix=1,mask=mask)
-                    atoms.set_distance(Hnear1,total_atoms-6,1.4480,fix=1,mask=mask)
-                mask[Hnear1]=0
-                total_atoms=len(atoms)
-                CnearH=near(Hnear1,atoms,'H',limit=False)
+                    if state[0] == 1:
+                        atoms.set_distance(Hnear1, i1, 1.4480, fix=1, mask=mask)
+                    elif state[0] == 2 or state[0] == 6:
+                        atoms.set_distance(Hnear1, i1, 1.3400, fix=1, mask=mask)
+                    atoms.set_distance(Hnear1, total_atoms-6, 1.4480, fix=1, mask=mask)
+                mask[Hnear1] = 0
+                total_atoms = len(atoms)
+                CnearH = near(Hnear1, atoms, 'H', limit=False)
                 del atoms[CnearH]
-                Hnear1=numjudge(Hnear1,CnearH)
-                i1=numjudge(i1,CnearH)
-                i2=numjudge(i2,CnearH)
-                CnearH=near(Hnear1,atoms,'H',limit=False)
-                mask[CnearH]=1
-                for k in range(10):
-                    atoms.set_angle(i1,Hnear1,CnearH,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-6,Hnear1,CnearH,109.5,mask=mask)
-                atoms.set_dihedral(i2,i1,Hnear1,CnearH,-150,mask=mask)
-                atoms.set_distance(CnearH,Hnear1,1.0100,fix=1)
-            elif needelements[i]=='O':
-                for k in range(10):
-                    if state[0]==1:
-                        atoms.set_distance(Hnear1,i1,1.4100,fix=1,mask=mask)
-                    elif state[0]==2 or state[0]==6:
-                        atoms.set_distance(Hnear1,i1,1.3640,fix=1,mask=mask)
-                    atoms.set_distance(Hnear1,total_atoms-6,1.4100,fix=1,mask=mask)
+                Hnear1 = numjudge(Hnear1, CnearH)
+                i1 = numjudge(i1, CnearH)
+                i2 = numjudge(i2, CnearH)
+                CnearH = near(Hnear1, atoms, 'H', limit=False)
+                mask[CnearH] = 1
+                for k in range(10):
+                    atoms.set_angle(i1, Hnear1, CnearH, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-6, Hnear1, CnearH, 109.5, mask=mask)
+                atoms.set_dihedral(i2, i1, Hnear1, CnearH, -150, mask=mask)
+                atoms.set_distance(CnearH, Hnear1, 1.0100, fix=1)
+            elif needelements[i] == 'O':
+                for k in range(10):
+                    if state[0] == 1:
+                        atoms.set_distance(Hnear1, i1, 1.4100, fix=1, mask=mask)
+                    elif state[0] == 2 or state[0] == 6:
+                        atoms.set_distance(Hnear1, i1, 1.3640, fix=1, mask=mask)
+                    atoms.set_distance(Hnear1, total_atoms-6, 1.4100, fix=1, mask=mask)
                 for j in range(2):
-                    total_atoms=len(atoms)
-                    CnearH=near(Hnear1,atoms,'H',limit=False)
+                    total_atoms = len(atoms)
+                    CnearH = near(Hnear1, atoms, 'H', limit=False)
                     del atoms[CnearH]
-                    Hnear1=numjudge(Hnear1,CnearH)
-        if places[i]==3:
-            mask[total_atoms-6+error]=1
-            elements=atoms.get_chemical_symbols()
-            elements[total_atoms-6+error]=needelements[i]
+                    Hnear1 = numjudge(Hnear1, CnearH)
+        if places[i] == 3:
+            mask[total_atoms-6+error] = 1
+            elements = atoms.get_chemical_symbols()
+            elements[total_atoms-6+error] = needelements[i]
             atoms.set_chemical_symbols(elements)
-            if needelements[i]=='N':
+            if needelements[i] == 'N':
                 for k in range(10):
-                    atoms.set_distance(total_atoms-6+error,Hnear1,1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms-6+error,total_atoms-5+error,1.4480,fix=1,mask=mask)
-                mask[total_atoms-6+error]=0
-                total_atoms=len(atoms)
-                CnearH=near(total_atoms-6+error,atoms,'H',limit=False)
+                    atoms.set_distance(total_atoms-6+error, Hnear1, 1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms-6+error, total_atoms-5+error,\
+                                       1.4480, fix=1, mask=mask)
+                mask[total_atoms-6+error] = 0
+                total_atoms = len(atoms)
+                CnearH = near(total_atoms-6+error, atoms, 'H', limit=False)
                 del atoms[CnearH]
-                Hnear1=numjudge(Hnear1,CnearH)
-                i1=numjudge(i1,CnearH)
-                i2=numjudge(i2,CnearH)
-                CnearH=near(total_atoms-6+error,atoms,'H',limit=False)
-                mask[CnearH]=1
-                atoms.set_dihedral(i1,Hnear1,total_atoms-6+error,CnearH,-150,mask=mask)
-                for k in range(10):
-                    atoms.set_angle(Hnear1,total_atoms-6+error,CnearH,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-5+error,total_atoms-6+error,CnearH,109.5,mask=mask)
-                atoms.set_distance(CnearH,total_atoms-6+error,1.0100,fix=1)
-                error=error+1
-            elif needelements[i]=='O':
-                for k in range(10):
-                    atoms.set_distance(total_atoms-6+error,Hnear1,1.4100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms-6+error,total_atoms-5-error,1.4100,fix=1,mask=mask)
+                Hnear1 = numjudge(Hnear1, CnearH)
+                i1 = numjudge(i1, CnearH)
+                i2 = numjudge(i2, CnearH)
+                CnearH = near(total_atoms-6+error, atoms, 'H', limit=False)
+                mask[CnearH] = 1
+                atoms.set_dihedral(i1, Hnear1, total_atoms-6+error, CnearH, -150, mask=mask)
+                for k in range(10):
+                    atoms.set_angle(Hnear1, total_atoms-6+error, CnearH, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-5+error, total_atoms-6+error, CnearH,\
+                                    109.5, mask=mask)
+                atoms.set_distance(CnearH, total_atoms-6+error, 1.0100, fix=1)
+                error = error+1
+            elif needelements[i] == 'O':
+                for k in range(10):
+                    atoms.set_distance(total_atoms-6+error, Hnear1, 1.4100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms-6+error, total_atoms-5-error, 1.4100,\
+                                       fix=1, mask=mask)
                 for j in range(2):
-                    total_atoms=len(atoms)
-                    CnearH=near(total_atoms-6+error+j,atoms,'H',limit=False)
+                    total_atoms = len(atoms)
+                    CnearH = near(total_atoms-6+error+j, atoms, 'H', limit=False)
                     del atoms[CnearH]
-                error=error+2
-        if places[i]==4:
-            mask[total_atoms-5+error]=1
-            elements=atoms.get_chemical_symbols()
-            elements[total_atoms-5-error]=needelements[i]
+                error = error+2
+        if places[i] == 4:
+            mask[total_atoms-5+error] = 1
+            elements = atoms.get_chemical_symbols()
+            elements[total_atoms-5-error] = needelements[i]
             atoms.set_chemical_symbols(elements)
-            if needelements[i]=='N':
+            if needelements[i] == 'N':
                 for k in range(10):
-                    atoms.set_distance(total_atoms-5+error,total_atoms-6+error,1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms-5+error,Hnear2,1.4480,fix=1,mask=mask)
-                mask[total_atoms-5+error]=0
-                total_atoms=len(atoms)
-                CnearH=near(total_atoms-5+error,atoms,'H',limit=False)
+                    atoms.set_distance(total_atoms-5+error, total_atoms-6+error,\
+                                       1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms-5+error, Hnear2, 1.4480, fix=1, mask=mask)
+                mask[total_atoms-5+error] = 0
+                total_atoms = len(atoms)
+                CnearH = near(total_atoms-5+error, atoms, 'H', limit=False)
                 del atoms[CnearH]
-                Hnear1=numjudge(Hnear1,CnearH)
-                i1=numjudge(i1,CnearH)
-                i2=numjudge(i2,CnearH)
-                CnearH=near(total_atoms-5+error,atoms,'H',limit=False)
-                mask[CnearH]=1
-                atoms.set_dihedral(i2,Hnear2,total_atoms-5+error,CnearH,-150,mask=mask)
-                for k in range(10):
-                    atoms.set_angle(Hnear2,total_atoms-5+error,CnearH,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-6+error,total_atoms-5+error,CnearH,109.5,mask=mask)
-                atoms.set_distance(CnearH,total_atoms-5+error,1.0100,fix=1)
-                error=error+1
-            elif needelements[i]=='O':
-                for k in range(10):
-                    atoms.set_distance(total_atoms-5+error,total_atoms-6+error,1.4100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms-5+error,Hnear2,1.4100,fix=1,mask=mask)
+                Hnear1 = numjudge(Hnear1, CnearH)
+                i1 = numjudge(i1, CnearH)
+                i2 = numjudge(i2, CnearH)
+                CnearH = near(total_atoms-5+error, atoms, 'H', limit=False)
+                mask[CnearH] = 1
+                atoms.set_dihedral(i2, Hnear2, total_atoms-5+error, CnearH, -150, mask=mask)
+                for k in range(10):
+                    atoms.set_angle(Hnear2, total_atoms-5+error, CnearH, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-6+error, total_atoms-5+error,\
+                                    CnearH, 109.5, mask=mask)
+                atoms.set_distance(CnearH, total_atoms-5+error, 1.0100, fix=1)
+                error = error+1
+            elif needelements[i] == 'O':
+                for k in range(10):
+                    atoms.set_distance(total_atoms-5+error, total_atoms-6+error,\
+                                       1.4100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms-5+error, Hnear2, 1.4100, fix=1, mask=mask)
                 for j in range(2):
-                    total_atoms=len(atoms)
-                    CnearH=near(total_atoms-5-error+j,atoms,'H',limit=False)
+                    total_atoms = len(atoms)
+                    CnearH = near(total_atoms-5-error+j, atoms, 'H', limit=False)
                     del atoms[CnearH]
-                error=error+2
-        if places[i]==5:
-            mask[Hnear2]=1
-            elements=atoms.get_chemical_symbols()
-            elements[Hnear2]=needelements[i]
+                error = error+2
+        if places[i] == 5:
+            mask[Hnear2] = 1
+            elements = atoms.get_chemical_symbols()
+            elements[Hnear2] = needelements[i]
             atoms.set_chemical_symbols(elements)
-            if needelements[i]=='N':
+            if needelements[i] == 'N':
                 for k in range(10):
-                    if state[0]==1:
-                        atoms.set_distance(Hnear2,i2,1.4480,fix=1,mask=mask)
-                    elif state[0]==2 or state[0]==6:
-                        atoms.set_distance(Hnear2,i2,1.3400,fix=1,mask=mask)
-                    atoms.set_distance(Hnear2,total_atoms-5+error,1.4480,fix=1,mask=mask)
-                mask[Hnear2]=0
-                total_atoms=len(atoms)
-                CnearH=near(Hnear2,atoms,'H',limit=False)
+                    if state[0] == 1:
+                        atoms.set_distance(Hnear2, i2, 1.4480, fix=1, mask=mask)
+                    elif state[0] == 2 or state[0] == 6:
+                        atoms.set_distance(Hnear2, i2, 1.3400, fix=1, mask=mask)
+                    atoms.set_distance(Hnear2, total_atoms-5+error, 1.4480, fix=1, mask=mask)
+                mask[Hnear2] = 0
+                total_atoms = len(atoms)
+                CnearH = near(Hnear2, atoms, 'H', limit=False)
                 del atoms[CnearH]
-                Hnear1=numjudge(Hnear1,CnearH)
-                i1=numjudge(i1,CnearH)
-                i2=numjudge(i2,CnearH)
-                CnearH=near(Hnear2,atoms,'H',limit=False)
-                mask[CnearH]=1
-                for k in range(10):
-                    atoms.set_angle(i2,Hnear2,CnearH,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-5+error,Hnear2,CnearH,109.5,mask=mask)
-                atoms.set_dihedral(i1,i2,Hnear2,CnearH,-150,mask=mask)
-                atoms.set_distance(CnearH,Hnear2,1.0100,fix=1)
-            elif needelements[i]=='O':
-                for k in range(10):
-                    if state[0]==1:
-                        atoms.set_distance(Hnear2,i2,1.4100,fix=1,mask=mask)
-                    elif state[0]==2 or state[0]==6:
-                        atoms.set_distance(Hnear2,i2,1.3640,fix=1,mask=mask)
-                    atoms.set_distance(Hnear2,total_atoms-5+error,1.4100,fix=1,mask=mask)
+                Hnear1 = numjudge(Hnear1, CnearH)
+                i1 = numjudge(i1, CnearH)
+                i2 = numjudge(i2, CnearH)
+                CnearH = near(Hnear2, atoms, 'H', limit=False)
+                mask[CnearH] = 1
+                for k in range(10):
+                    atoms.set_angle(i2, Hnear2, CnearH, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-5+error, Hnear2, CnearH, 109.5, mask=mask)
+                atoms.set_dihedral(i1, i2, Hnear2, CnearH, -150, mask=mask)
+                atoms.set_distance(CnearH, Hnear2, 1.0100, fix=1)
+            elif needelements[i] == 'O':
+                for k in range(10):
+                    if state[0] == 1:
+                        atoms.set_distance(Hnear2, i2, 1.4100, fix=1, mask=mask)
+                    elif state[0] == 2 or state[0] == 6:
+                        atoms.set_distance(Hnear2, i2, 1.3640, fix=1, mask=mask)
+                    atoms.set_distance(Hnear2, total_atoms-5+error, 1.4100, fix=1, mask=mask)
                 for j in range(2):
-                    total_atoms=len(atoms)
-                    CnearH=near(Hnear2,atoms,'H',limit=False)
+                    total_atoms = len(atoms)
+                    CnearH = near(Hnear2, atoms, 'H', limit=False)
                     del atoms[CnearH]
-                    Hnear2=numjudge(Hnear2,CnearH)
+                    Hnear2 = numjudge(Hnear2, CnearH)
     return atoms
 
-def bindconj5(atoms,bond,state=[1,1],strict={1:'X'}):
+def bindconj5(atoms, bond, state=[1, 1], strict={1:'X'}):
     try:
-        if strict[1]=='X':
-            strict[3]='N'
+        if strict[1] == 'X':
+            strict[3] = 'N'
     except:
         pass
-    i1=bond[0]
-    i2=bond[1]
-    Cnear1=near(i1,atoms,'Not H')
-    Cnear2=near(i2,atoms,'Not H',reverse=True)
-    total_atoms=len(atoms)
-    mask=[0]*total_atoms
-    mask[i1]=1
-    mask[i2]=1
+    i1 = bond[0]
+    i2 = bond[1]
+    Cnear1 = near(i1, atoms, 'Not H')
+    Cnear2 = near(i2, atoms, 'Not H', reverse=True)
+    total_atoms = len(atoms)
+    mask = [0] * total_atoms
+    mask[i1] = 1
+    mask[i2] = 1
     for j in range(3):
         try:
-            element=strict[j+2]
-            place=j+2
+            element = strict[j+2]
+            place = j + 2
         except:
             pass
-    bondjudge5([Cnear1,Cnear2],atoms,[i1,i2],state,mask,place)
+    bondjudge5([Cnear1, Cnear2], atoms, [i1, i2], state, mask, place)
     for j in range(2):
-        CnearH=near(i1,atoms,'H')
+        CnearH = near(i1, atoms, 'H')
         del atoms[CnearH]
-        i1=numjudge(i1,CnearH)
-        i2=numjudge(i2,CnearH)
+        i1 = numjudge(i1, CnearH)
+        i2 = numjudge(i2, CnearH)
     for j in range(2):
-        CnearH=near(i2,atoms,'H')
+        CnearH = near(i2, atoms, 'H')
         del atoms[CnearH]
-        i1=numjudge(i1,CnearH)
-        i2=numjudge(i2,CnearH)
-    if place==2:
+        i1 = numjudge(i1, CnearH)
+        i2 = numjudge(i2, CnearH)
+    if place == 2:
         atoms.append(element)
         atoms.append('C')
         atoms.append('C')
-    elif place==3:
+    elif place == 3:
         atoms.append('C')
         atoms.append('C')
         atoms.append(element)
-    elif place==4:
+    elif place == 4:
         atoms.append('C')
         atoms.append(element)
         atoms.append('C')
     for j in range(3):
         atoms.append('H')
-    x=atoms.get_positions()
-    x[-6][0]=x[-6][0]-100
-    x[-6][1]=x[-6][1]-50
-    x[-6][2]=x[-6][2]-50
-    x[-5][0]=x[-5][0]+50
-    x[-5][1]=x[-5][1]+50
-    x[-5][2]=x[-5][2]+50
-    for j in range(-4,0):
-        x[j][0]=x[j][0]+50
-        x[j][1]=x[j][1]+50
-        x[j][2]=x[j][2]+50
+    x = atoms.get_positions()
+    x[-6][0] = x[-6][0] - 100
+    x[-6][1] = x[-6][1] - 50
+    x[-6][2] = x[-6][2] - 50
+    x[-5][0] = x[-5][0] + 50
+    x[-5][1] = x[-5][1] + 50
+    x[-5][2] = x[-5][2] + 50
+    for j in range(-4, 0):
+        x[j][0] = x[j][0] + 50
+        x[j][1] = x[j][1] + 50
+        x[j][2] = x[j][2] + 50
     atoms.set_positions(x)
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-6)+[1]*6
-    if place==2:
-        if element=='N':
-            atoms.set_angle(i2,i1,total_atoms-6,107.7,mask=mask)
-            if state[0]==1:
-                atoms.set_distance(total_atoms-6,i1,1.3810,fix=1,mask=mask)
-            elif state[0]==2:
-                atoms.set_distance(total_atoms-6,i1,1.3740,fix=1,mask=mask)
-        elif element=='O':
-            atoms.set_angle(i2,i1,total_atoms-6,110.6,mask=mask)
-            atoms.set_distance(total_atoms-6,i1,1.3600,fix=1,mask=mask)
-        mask[-6]=0
-        atoms.set_angle(i1,i2,total_atoms-5,107.3,mask=mask)
-        atoms.set_distance(total_atoms-5,i2,1.4240,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-6,i1,i2,total_atoms-5,0.5,mask=mask)
-        mask[-5]=0
-        if element=='N':
-            for k in range(10):
-                atoms.set_distance(total_atoms-4,total_atoms-6,1.3810,fix=1,mask=mask)
-                atoms.set_distance(total_atoms-4,total_atoms-5,1.3670,fix=1,mask=mask)
-            mask[-4]=0
-            #atoms.set_distance(total_atoms-1,total_atoms-6,0,fix=1,mask=mask)
-            atoms.set_dihedral(total_atoms-5,total_atoms-4,total_atoms-6,total_atoms-1,0.5,mask=mask)
-            for k in range(10):
-                atoms.set_angle(total_atoms-4,total_atoms-6,total_atoms-1,124.5,mask=mask)
-                atoms.set_angle(i1,total_atoms-6,total_atoms-1,124.5,mask=mask)
-            atoms.set_distance(total_atoms-1,total_atoms-6,1.0100,fix=1,mask=mask)
-            mask[-1]=0
-        elif element=='O':
-            for k in range(10):
-                atoms.set_distance(total_atoms-4,total_atoms-6,1.3600,fix=1,mask=mask)
-                atoms.set_distance(total_atoms-4,total_atoms-5,1.3670,fix=1,mask=mask)
-            mask[-4]=0
-        atoms.set_distance(total_atoms-3,total_atoms-4,1.0100,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-3,total_atoms-4,total_atoms-5,i2,0.5,mask=mask)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-6)+[1]*6
+    if place == 2:
+        if element == 'N':
+            atoms.set_angle(i2, i1, total_atoms-6, 107.7, mask=mask)
+            if state[0] == 1:
+                atoms.set_distance(total_atoms-6, i1, 1.3810, fix=1, mask=mask)
+            elif state[0] == 2:
+                atoms.set_distance(total_atoms-6, i1, 1.3740, fix=1, mask=mask)
+        elif element == 'O':
+            atoms.set_angle(i2, i1, total_atoms-6, 110.6, mask=mask)
+            atoms.set_distance(total_atoms-6, i1, 1.3600, fix=1, mask=mask)
+        mask[-6] = 0
+        atoms.set_angle(i1, i2, total_atoms-5, 107.3, mask=mask)
+        atoms.set_distance(total_atoms-5, i2, 1.4240, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-6, i1, i2, total_atoms-5, 0.5, mask=mask)
+        mask[-5] = 0
+        if element == 'N':
+            for k in range(10):
+                atoms.set_distance(total_atoms-4, total_atoms-6, 1.3810, fix=1, mask=mask)
+                atoms.set_distance(total_atoms-4, total_atoms-5, 1.3670, fix=1, mask=mask)
+            mask[-4] = 0
+            #atoms.set_distance(total_atoms-1, total_atoms-6, 0, fix=1, mask=mask)
+            atoms.set_dihedral(total_atoms-5, total_atoms-4, total_atoms-6,\
+                               total_atoms-1, 0.5, mask=mask)
+            for k in range(10):
+                atoms.set_angle(total_atoms-4, total_atoms-6, total_atoms-1, 124.5, mask=mask)
+                atoms.set_angle(i1, total_atoms-6, total_atoms-1, 124.5, mask=mask)
+            atoms.set_distance(total_atoms-1, total_atoms-6, 1.0100, fix=1, mask=mask)
+            mask[-1] = 0
+        elif element == 'O':
+            for k in range(10):
+                atoms.set_distance(total_atoms-4, total_atoms-6, 1.3600, fix=1, mask=mask)
+                atoms.set_distance(total_atoms-4, total_atoms-5, 1.3670, fix=1, mask=mask)
+            mask[-4] = 0
+        atoms.set_distance(total_atoms-3, total_atoms-4, 1.0100, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-3, total_atoms-4, total_atoms-5,\
+                           i2, 0.5, mask=mask)
         for k in range(10):
-            atoms.set_angle(total_atoms-6,total_atoms-4,total_atoms-3,126.5,mask=mask)
-            atoms.set_angle(total_atoms-5,total_atoms-4,total_atoms-3,126.5,mask=mask)
-        mask[-3]=0
-        atoms.set_distance(total_atoms-2,total_atoms-5,1.0100,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-2,total_atoms-5,i2,i1,0.5,mask=mask)
+            atoms.set_angle(total_atoms-6, total_atoms-4, total_atoms-3, 126.5, mask=mask)
+            atoms.set_angle(total_atoms-5, total_atoms-4, total_atoms-3, 126.5, mask=mask)
+        mask[-3] = 0
+        atoms.set_distance(total_atoms-2, total_atoms-5, 1.0100, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-2, total_atoms-5, i2, i1, 0.5, mask=mask)
         for k in range(10):
-            atoms.set_angle(i2,total_atoms-5,total_atoms-2,126.5,mask=mask)
-            atoms.set_angle(total_atoms-4,total_atoms-5,total_atoms-2,126.5,mask=mask)
-        mask[-2]=0
-    elif place==3:
-        atoms.set_angle(i2,i1,total_atoms-6,107.3,mask=mask)
-        atoms.set_distance(total_atoms-6,i1,1.3670,fix=1,mask=mask)
-        mask[-6]=0
-        atoms.set_angle(i1,i2,total_atoms-5,107.3,mask=mask)
-        atoms.set_distance(total_atoms-5,i2,1.3670,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-6,i1,i2,total_atoms-5,0.5,mask=mask)
-        mask[-5]=0
-        if element=='N':
-            for k in range(10):
-                atoms.set_distance(total_atoms-4,total_atoms-6,1.3810,fix=1,mask=mask)
-                atoms.set_distance(total_atoms-4,total_atoms-5,1.3810,fix=1,mask=mask)
-            mask[-4]=0
-            atoms.set_distance(total_atoms-1,total_atoms-4,0,fix=1,mask=mask)
-            atoms.set_distance(total_atoms-1,total_atoms-4,1.0100,fix=1,mask=mask)
-            atoms.set_dihedral(i1,total_atoms-6,total_atoms-4,total_atoms-1,110,mask=mask)
-            for k in range(10):
-                atoms.set_angle(total_atoms-6,total_atoms-4,total_atoms-1,124.5,mask=mask)
-                atoms.set_angle(total_atoms-5,total_atoms-4,total_atoms-1,124.5,mask=mask)
-            mask[-1]=0
-        elif element=='O':
-            for k in range(10):
-                atoms.set_distance(total_atoms-4,total_atoms-6,1.3600,fix=1,mask=mask)
-                atoms.set_distance(total_atoms-4,total_atoms-5,1.3600,fix=1,mask=mask)
-            mask[-4]=0
-        atoms.set_distance(total_atoms-3,total_atoms-6,1.0100,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-3,total_atoms-6,i1,i2,0.5,mask=mask)
+            atoms.set_angle(i2, total_atoms-5, total_atoms-2, 126.5, mask=mask)
+            atoms.set_angle(total_atoms-4, total_atoms-5, total_atoms-2, 126.5, mask=mask)
+        mask[-2] = 0
+    elif place == 3:
+        atoms.set_angle(i2, i1, total_atoms-6, 107.3, mask=mask)
+        atoms.set_distance(total_atoms-6, i1, 1.3670, fix=1, mask=mask)
+        mask[-6] = 0
+        atoms.set_angle(i1, i2, total_atoms-5, 107.3, mask=mask)
+        atoms.set_distance(total_atoms-5, i2, 1.3670, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-6, i1, i2, total_atoms-5, 0.5, mask=mask)
+        mask[-5] = 0
+        if element == 'N':
+            for k in range(10):
+                atoms.set_distance(total_atoms-4, total_atoms-6, 1.3810, fix=1, mask=mask)
+                atoms.set_distance(total_atoms-4, total_atoms-5, 1.3810, fix=1, mask=mask)
+            mask[-4] = 0
+            atoms.set_distance(total_atoms-1, total_atoms-4, 0, fix=1, mask=mask)
+            atoms.set_distance(total_atoms-1, total_atoms-4, 1.0100, fix=1, mask=mask)
+            atoms.set_dihedral(i1, total_atoms-6, total_atoms-4,\
+                               total_atoms-1, 110, mask=mask)
+            for k in range(10):
+                atoms.set_angle(total_atoms-6, total_atoms-4, total_atoms-1, 124.5, mask=mask)
+                atoms.set_angle(total_atoms-5, total_atoms-4, total_atoms-1, 124.5, mask=mask)
+            mask[-1] = 0
+        elif element == 'O':
+            for k in range(10):
+                atoms.set_distance(total_atoms-4, total_atoms-6, 1.3600, fix=1, mask=mask)
+                atoms.set_distance(total_atoms-4, total_atoms-5, 1.3600, fix=1, mask=mask)
+            mask[-4] = 0
+        atoms.set_distance(total_atoms-3, total_atoms-6, 1.0100, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-3, total_atoms-6, i1, i2, 0.5, mask=mask)
         for k in range(10):
-            atoms.set_angle(i1,total_atoms-6,total_atoms-3,126.5,mask=mask)
-            atoms.set_angle(total_atoms-4,total_atoms-6,total_atoms-3,126.5,mask=mask)
-        mask[-3]=0
-        atoms.set_distance(total_atoms-2,total_atoms-5,1.0100,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-2,total_atoms-5,i2,i1,0.5,mask=mask)
+            atoms.set_angle(i1, total_atoms-6, total_atoms-3, 126.5, mask=mask)
+            atoms.set_angle(total_atoms-4, total_atoms-6, total_atoms-3, 126.5, mask=mask)
+        mask[-3] = 0
+        atoms.set_distance(total_atoms-2, total_atoms-5, 1.0100, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-2, total_atoms-5, i2, i1, 0.5, mask=mask)
         for k in range(10):
-            atoms.set_angle(i2,total_atoms-5,total_atoms-2,126.5,mask=mask)
-            atoms.set_angle(total_atoms-4,total_atoms-5,total_atoms-2,126.5,mask=mask)
-        mask[-2]=0
-    elif place==4:
-        atoms.set_angle(i2,i1,total_atoms-6,107.3,mask=mask)
-        atoms.set_distance(total_atoms-6,i1,1.4240,fix=1,mask=mask)
-        mask[-6]=0
-        if element=='N':
-            atoms.set_angle(i1,i2,total_atoms-5,107.7,mask=mask)
-            if state[0]==1:
-                atoms.set_distance(total_atoms-5,i2,1.3810,fix=1,mask=mask)
-            if state[0]==2:
-                atoms.set_distance(total_atoms-5,i2,1.3740,fix=1,mask=mask)
-        elif element=='O':
-            atoms.set_angle(i1,i2,total_atoms-5,110.6,mask=mask)
-            atoms.set_distance(total_atoms-5,i2,1.3600,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-6,i1,i2,total_atoms-5,0.5,mask=mask)
-        mask[-5]=0
-        if element=='N':
-            for k in range(10):
-                atoms.set_distance(total_atoms-4,total_atoms-5,1.3810,fix=1,mask=mask)
-                atoms.set_distance(total_atoms-4,total_atoms-6,1.3670,fix=1,mask=mask)
-            mask[-4]=0
-            #atoms.set_distance(total_atoms-1,total_atoms-6,0,fix=1,mask=mask)
-            atoms.set_dihedral(total_atoms-6,total_atoms-4,total_atoms-5,total_atoms-1,0.5,mask=mask)
-            for k in range(10):
-                atoms.set_angle(total_atoms-4,total_atoms-5,total_atoms-1,124.5,mask=mask)
-                atoms.set_angle(i2,total_atoms-5,total_atoms-1,124.5,mask=mask)
-            atoms.set_distance(total_atoms-1,total_atoms-5,1.0100,fix=1,mask=mask)
-            mask[-1]=0
-        elif element=='O':
-            for k in range(10):
-                atoms.set_distance(total_atoms-4,total_atoms-5,1.3600,fix=1,mask=mask)
-                atoms.set_distance(total_atoms-4,total_atoms-6,1.3670,fix=1,mask=mask)
-            mask[-4]=0
-        atoms.set_distance(total_atoms-3,total_atoms-4,1.0100,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-3,total_atoms-4,total_atoms-5,i2,0.5,mask=mask)
+            atoms.set_angle(i2, total_atoms-5, total_atoms-2, 126.5, mask=mask)
+            atoms.set_angle(total_atoms-4, total_atoms-5, total_atoms-2, 126.5, mask=mask)
+        mask[-2] = 0
+    elif place == 4:
+        atoms.set_angle(i2, i1, total_atoms-6, 107.3, mask=mask)
+        atoms.set_distance(total_atoms-6, i1, 1.4240, fix=1, mask=mask)
+        mask[-6] = 0
+        if element == 'N':
+            atoms.set_angle(i1, i2, total_atoms-5, 107.7, mask=mask)
+            if state[0] == 1:
+                atoms.set_distance(total_atoms-5, i2, 1.3810, fix=1, mask=mask)
+            if state[0] == 2:
+                atoms.set_distance(total_atoms-5, i2, 1.3740, fix=1, mask=mask)
+        elif element == 'O':
+            atoms.set_angle(i1, i2, total_atoms-5, 110.6, mask=mask)
+            atoms.set_distance(total_atoms-5, i2, 1.3600, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-6, i1, i2, total_atoms-5, 0.5, mask=mask)
+        mask[-5] = 0
+        if element == 'N':
+            for k in range(10):
+                atoms.set_distance(total_atoms-4, total_atoms-5, 1.3810, fix=1, mask=mask)
+                atoms.set_distance(total_atoms-4, total_atoms-6, 1.3670, fix=1, mask=mask)
+            mask[-4] = 0
+            #atoms.set_distance(total_atoms-1, total_atoms-6, 0, fix=1, mask=mask)
+            atoms.set_dihedral(total_atoms-6, total_atoms-4, total_atoms-5,\
+                               total_atoms-1, 0.5, mask=mask)
+            for k in range(10):
+                atoms.set_angle(total_atoms-4, total_atoms-5, total_atoms-1, 124.5, mask=mask)
+                atoms.set_angle(i2, total_atoms-5, total_atoms-1, 124.5, mask=mask)
+            atoms.set_distance(total_atoms-1, total_atoms-5, 1.0100, fix=1, mask=mask)
+            mask[-1] = 0
+        elif element == 'O':
+            for k in range(10):
+                atoms.set_distance(total_atoms-4, total_atoms-5, 1.3600, fix=1, mask=mask)
+                atoms.set_distance(total_atoms-4, total_atoms-6, 1.3670, fix=1, mask=mask)
+            mask[-4] = 0
+        atoms.set_distance(total_atoms-3, total_atoms-4, 1.0100, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-3, total_atoms-4,\
+                           total_atoms-5, i2, 0.5, mask=mask)
         for k in range(10):
-            atoms.set_angle(total_atoms-6,total_atoms-4,total_atoms-3,126.5,mask=mask)
-            atoms.set_angle(total_atoms-5,total_atoms-4,total_atoms-3,126.5,mask=mask)
-        mask[-3]=0
-        atoms.set_distance(total_atoms-2,total_atoms-6,1.0100,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms-2,total_atoms-6,total_atoms-4,total_atoms-5,0.5,mask=mask)
+            atoms.set_angle(total_atoms-6, total_atoms-4, total_atoms-3, 126.5, mask=mask)
+            atoms.set_angle(total_atoms-5, total_atoms-4, total_atoms-3, 126.5, mask=mask)
+        mask[-3] = 0
+        atoms.set_distance(total_atoms-2, total_atoms-6, 1.0100, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms-2, total_atoms-6,\
+                           total_atoms-4, total_atoms-5, 0.5, mask=mask)
         for k in range(10):
-            atoms.set_angle(i1,total_atoms-6,total_atoms-2,126.5,mask=mask)
-            atoms.set_angle(total_atoms-4,total_atoms-6,total_atoms-2,126.5,mask=mask)
-        mask[-2]=0
-    if element!='N':
+            atoms.set_angle(i1, total_atoms-6, total_atoms-2, 126.5, mask=mask)
+            atoms.set_angle(total_atoms-4, total_atoms-6, total_atoms-2, 126.5, mask=mask)
+        mask[-2] = 0
+    if element != 'N':
         del atoms[-1]
     return atoms
 
-def bindconj6(atoms,bond,state=[1,1],strict={1:'X'}):
-    i1=bond[0]
-    i2=bond[1]
-    Cnear1=near(i1,atoms,'Not H')
-    Cnear2=near(i2,atoms,'Not H',reverse=True)
-    total_atoms=len(atoms)
-    mask=[0]*total_atoms
-    mask[i1]=1
-    mask[i2]=1
+def bindconj6(atoms, bond, state=[1, 1], strict={1:'X'}):
+    i1 = bond[0]
+    i2 = bond[1]
+    Cnear1 = near(i1, atoms, 'Not H')
+    Cnear2 = near(i2, atoms, 'Not H', reverse=True)
+    total_atoms = len(atoms)
+    mask = [0]*total_atoms
+    mask[i1] = 1
+    mask[i2] = 1
     for j in range(4):
         try:
-            element=strict[j+2]
-            place=j+2
+            element = strict[j+2]
+            place = j+2
             break
         except:
-            place=1
-    bondjudge6([Cnear1,Cnear2],atoms,[i1,i2],state,mask,place)
+            place = 1
+    bondjudge6([Cnear1, Cnear2], atoms, [i1, i2], state, mask, place)
     for j in range(2):
-        CnearH=near(i1,atoms,'H')
+        CnearH = near(i1, atoms, 'H')
         del atoms[CnearH]
-        i1=numjudge(i1,CnearH)
-        i2=numjudge(i2,CnearH)
+        i1 = numjudge(i1, CnearH)
+        i2 = numjudge(i2, CnearH)
     for j in range(2):
-        CnearH=near(i2,atoms,'H')
+        CnearH = near(i2, atoms, 'H')
         del atoms[CnearH]
-        i1=numjudge(i1,CnearH)
-        i2=numjudge(i2,CnearH)    
-    if place==2:
+        i1 = numjudge(i1, CnearH)
+        i2 = numjudge(i2, CnearH)    
+    if place == 2:
         atoms.append(element)
         atoms.append('C')
         atoms.append('C')
         atoms.append('C')
-    elif place==3:
+    elif place == 3:
         atoms.append('C')
         atoms.append('C')
         atoms.append(element)
         atoms.append('C')
-    elif place==4:
+    elif place == 4:
         atoms.append('C')
         atoms.append('C')
         atoms.append('C')
         atoms.append(element)
-    elif place==5:
+    elif place == 5:
         atoms.append('C')
         atoms.append(element)
         atoms.append('C')
         atoms.append('C')
     else:
         for j in range(4):
             atoms.append('C')
     for j in range(4):
         atoms.append('H')
-    x=atoms.get_positions()
-    x[-8][0]=x[-8][0]-100
-    x[-8][1]=x[-8][1]-50
-    x[-8][2]=x[-8][2]-50
-    x[-7][0]=x[-7][0]+50
-    x[-7][1]=x[-7][1]+50
-    x[-7][2]=x[-7][2]+50
-    x[-6][0]=x[-6][0]-50
-    x[-6][1]=x[-6][1]-50
-    x[-6][2]=x[-6][2]-50
-    x[-5][0]=x[-5][0]+50
-    x[-5][1]=x[-5][1]+50
-    x[-5][2]=x[-5][2]+50
-    for j in range(-2,0):
-        x[2*j][0]=x[2*j][0]+50
-        x[2*j][1]=x[2*j][1]+50
-        x[2*j][2]=x[2*j][2]+50
-        x[2*j+1][0]=x[2*j+1][0]-50
-        x[2*j+1][1]=x[2*j+1][1]-50
-        x[2*j+1][2]=x[2*j+1][2]-50
+    x = atoms.get_positions()
+    x[-8][0] = x[-8][0] - 100
+    x[-8][1] = x[-8][1] - 50
+    x[-8][2] = x[-8][2] - 50
+    x[-7][0] = x[-7][0] + 50
+    x[-7][1] = x[-7][1] + 50
+    x[-7][2] = x[-7][2] + 50
+    x[-6][0] = x[-6][0] - 50
+    x[-6][1] = x[-6][1] - 50
+    x[-6][2] = x[-6][2] - 50
+    x[-5][0] = x[-5][0] + 50
+    x[-5][1] = x[-5][1] + 50
+    x[-5][2] = x[-5][2] + 50
+    for j in range(-2, 0):
+        x[2*j][0] = x[2*j][0] + 50
+        x[2*j][1] = x[2*j][1] + 50
+        x[2*j][2] = x[2*j][2] + 50
+        x[2*j+1][0] = x[2*j+1][0] - 50
+        x[2*j+1][1] = x[2*j+1][1] - 50
+        x[2*j+1][2] = x[2*j+1][2] - 50
     atoms.set_positions(x)
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-8)+[1]*8
-    atoms.set_angle(i2,i1,total_atoms-8,120,mask=mask)
-    if state[0]==2:
-        atoms.set_distance(total_atoms-8,i1,1.4040,fix=1,mask=mask)
-    elif state[0]==82:
-        atoms.set_distance(total_atoms-8,i1,1.4330,fix=1,mask=mask)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-8) + [1]*8
+    atoms.set_angle(i2, i1, total_atoms-8, 120, mask=mask)
+    if state[0] == 2:
+        atoms.set_distance(total_atoms-8, i1, 1.4040, fix=1, mask=mask)
+    elif state[0] == 82:
+        atoms.set_distance(total_atoms-8, i1, 1.4330, fix=1, mask=mask)
     else:
-        atoms.set_distance(total_atoms-8,i1,1.4000,fix=1,mask=mask)
-    mask[-8]=0
-    atoms.set_angle(i1,i2,total_atoms-7,120,mask=mask)
-    if state[0]==2:
-        atoms.set_distance(total_atoms-7,i2,1.4040,fix=1,mask=mask)
-    elif state[0]==82:
-        atoms.set_distance(total_atoms-7,i2,1.4330,fix=1,mask=mask)
+        atoms.set_distance(total_atoms-8, i1, 1.4000, fix=1, mask=mask)
+    mask[-8] = 0
+    atoms.set_angle(i1, i2, total_atoms-7, 120, mask=mask)
+    if state[0] == 2:
+        atoms.set_distance(total_atoms-7, i2, 1.4040, fix=1, mask=mask)
+    elif state[0] == 82:
+        atoms.set_distance(total_atoms-7, i2, 1.4330, fix=1, mask=mask)
     else:
-        atoms.set_distance(total_atoms-7,i2,1.4000,fix=1,mask=mask)
-    if state[0]==2 or state[0]==82:
-        atoms.set_dihedral(total_atoms-8,i1,i2,total_atoms-7,5,mask=mask)
+        atoms.set_distance(total_atoms-7, i2, 1.4000, fix=1, mask=mask)
+    if state[0] == 2 or state[0] == 82:
+        atoms.set_dihedral(total_atoms-8, i1, i2, total_atoms-7, 5, mask=mask)
     else:
-        atoms.set_dihedral(total_atoms-8,i1,i2,total_atoms-7,0.5,mask=mask)
-    mask[-7]=0
-    atoms.set_angle(i1,total_atoms-8,total_atoms-6,120,mask=mask)
-    if state[0]==82:
-        atoms.set_distance(total_atoms-6,total_atoms-8,1.4330,fix=1,mask=mask)
+        atoms.set_dihedral(total_atoms-8, i1, i2, total_atoms-7, 0.5, mask=mask)
+    mask[-7] = 0
+    atoms.set_angle(i1, total_atoms-8, total_atoms-6, 120, mask=mask)
+    if state[0] == 82:
+        atoms.set_distance(total_atoms-6, total_atoms-8, 1.4330, fix=1, mask=mask)
     else:
-        atoms.set_distance(total_atoms-6,total_atoms-8,1.4000,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms-6,total_atoms-8,i1,i2,-0.5,mask=mask)
-    mask[-6]=0
-    atoms.set_angle(i2,total_atoms-7,total_atoms-5,120,mask=mask)
-    if state[0]==82:
-        atoms.set_distance(total_atoms-5,total_atoms-7,1.4330,fix=1,mask=mask)
+        atoms.set_distance(total_atoms-6, total_atoms-8, 1.4000, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms-6, total_atoms-8, i1, i2, -0.5, mask=mask)
+    mask[-6] = 0
+    atoms.set_angle(i2, total_atoms-7, total_atoms-5, 120, mask=mask)
+    if state[0] == 82:
+        atoms.set_distance(total_atoms-5, total_atoms-7, 1.4330, fix=1, mask=mask)
     else:
-        atoms.set_distance(total_atoms-5,total_atoms-7,1.4000,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms-5,total_atoms-7,i2,i1,-0.5,mask=mask)
-    mask[-5]=0
-    atoms.set_angle(total_atoms-4,total_atoms-8,i1,120,mask=mask)
-    atoms.set_distance(total_atoms-4,total_atoms-8,1.0800,fix=1,mask=mask)
-    atoms.set_dihedral(i2,i1,total_atoms-8,total_atoms-4,-179.5,mask=mask)
-    mask[-4]=0
-    atoms.set_angle(total_atoms-3,total_atoms-7,i2,120,mask=mask)
-    atoms.set_distance(total_atoms-3,total_atoms-7,1.0800,fix=1,mask=mask)
-    atoms.set_dihedral(i1,i2,total_atoms-7,total_atoms-3,-179.5,mask=mask)
-    mask[-3]=0
-    atoms.set_angle(total_atoms-8,total_atoms-6,total_atoms-2,120,mask=mask)
-    atoms.set_dihedral(total_atoms-2,total_atoms-6,total_atoms-8,i1,179.5,mask=mask)
-    atoms.set_distance(total_atoms-2,total_atoms-6,1.0800,fix=1,mask=mask)
-    mask[-2]=0
-    atoms.set_angle(total_atoms-7,total_atoms-5,total_atoms-1,120,mask=mask)
-    atoms.set_distance(total_atoms-1,total_atoms-5,1.0800,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms-8,total_atoms-6,total_atoms-7,total_atoms-1,179.5,mask=mask)
-    if place==2:
-        elements=atoms.get_chemical_symbols()
-        elements[-8]='N'
+        atoms.set_distance(total_atoms-5, total_atoms-7, 1.4000, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms-5, total_atoms-7, i2, i1, -0.5, mask=mask)
+    mask[-5] = 0
+    atoms.set_angle(total_atoms-4, total_atoms-8, i1, 120, mask=mask)
+    atoms.set_distance(total_atoms-4, total_atoms-8, 1.0800, fix=1, mask=mask)
+    atoms.set_dihedral(i2, i1, total_atoms-8, total_atoms-4, -179.5, mask=mask)
+    mask[-4] = 0
+    atoms.set_angle(total_atoms-3, total_atoms-7, i2, 120, mask=mask)
+    atoms.set_distance(total_atoms-3, total_atoms-7, 1.0800, fix=1, mask=mask)
+    atoms.set_dihedral(i1, i2, total_atoms-7, total_atoms-3, -179.5, mask=mask)
+    mask[-3] = 0
+    atoms.set_angle(total_atoms-8, total_atoms-6, total_atoms-2, 120, mask=mask)
+    atoms.set_dihedral(total_atoms-2, total_atoms-6,\
+                       total_atoms-8, i1, 179.5, mask=mask)
+    atoms.set_distance(total_atoms-2, total_atoms-6, 1.0800, fix=1, mask=mask)
+    mask[-2] = 0
+    atoms.set_angle(total_atoms-7, total_atoms-5, total_atoms-1, 120, mask=mask)
+    atoms.set_distance(total_atoms-1, total_atoms-5, 1.0800, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms-8, total_atoms-6,\
+                       total_atoms-7, total_atoms-1, 179.5, mask=mask)
+    if place == 2:
+        elements = atoms.get_chemical_symbols()
+        elements[-8] = 'N'
         atoms.set_chemical_symbols(elements)
         for k in range(10):
-            atoms.set_distance(total_atoms-8,total_atoms-6,1.3390,fix=1)
-            if state[0]==2:
-                atoms.set_distance(total_atoms-8,i1,1.3540,fix=1)
+            atoms.set_distance(total_atoms-8, total_atoms-6, 1.3390, fix=1)
+            if state[0] == 2:
+                atoms.set_distance(total_atoms-8, i1, 1.3540, fix=1)
             else:
-                atoms.set_distance(total_atoms-8,i1,1.3390,fix=1)
-        CnearH=near(total_atoms-8,atoms,'H')
+                atoms.set_distance(total_atoms-8, i1, 1.3390, fix=1)
+        CnearH = near(total_atoms-8, atoms, 'H')
         del atoms[CnearH]
-    elif place==3:
-        elements=atoms.get_chemical_symbols()
-        elements[-6]='N'
+    elif place == 3:
+        elements = atoms.get_chemical_symbols()
+        elements[-6] = 'N'
         atoms.set_chemical_symbols(elements)
         for k in range(10):
-            atoms.set_distance(total_atoms-6,total_atoms-8,1.3390,fix=1)
-            atoms.set_distance(total_atoms-6,total_atoms-5,1.3390,fix=1)
-        CnearH=near(total_atoms-6,atoms,'H')
+            atoms.set_distance(total_atoms-6, total_atoms-8, 1.3390, fix=1)
+            atoms.set_distance(total_atoms-6, total_atoms-5, 1.3390, fix=1)
+        CnearH = near(total_atoms-6, atoms, 'H')
         del atoms[CnearH]
-    elif place==4:
-        elements=atoms.get_chemical_symbols()
-        elements[-5]='N'
+    elif place == 4:
+        elements = atoms.get_chemical_symbols()
+        elements[-5] = 'N'
         atoms.set_chemical_symbols(elements)
         for k in range(10):
-            atoms.set_distance(total_atoms-5,total_atoms-6,1.3390,fix=1)
-            atoms.set_distance(total_atoms-5,total_atoms-7,1.3390,fix=1)
-        CnearH=near(total_atoms-5,atoms,'H')
+            atoms.set_distance(total_atoms-5, total_atoms-6, 1.3390, fix=1)
+            atoms.set_distance(total_atoms-5, total_atoms-7, 1.3390, fix=1)
+        CnearH = near(total_atoms-5, atoms, 'H')
         del atoms[CnearH]
-    elif place==5:
-        elements=atoms.get_chemical_symbols()
-        elements[-7]='N'
+    elif place == 5:
+        elements = atoms.get_chemical_symbols()
+        elements[-7] = 'N'
         atoms.set_chemical_symbols(elements)
         for k in range(10):
-            if state[0]==2:
-                atoms.set_distance(total_atoms-7,i2,1.3540,fix=1)
+            if state[0] == 2:
+                atoms.set_distance(total_atoms-7, i2, 1.3540, fix=1)
             else:
-                atoms.set_distance(total_atoms-7,i2,1.3390,fix=1)
-            atoms.set_distance(total_atoms-7,total_atoms-5,1.3390,fix=1)
-        CnearH=near(total_atoms-7,atoms,'H')
+                atoms.set_distance(total_atoms-7, i2, 1.3390, fix=1)
+            atoms.set_distance(total_atoms-7, total_atoms-5, 1.3390, fix=1)
+        CnearH = near(total_atoms-7, atoms, 'H')
         del atoms[CnearH]
     return atoms
         
-def numjudge(i,deleted):
+def numjudge(i, deleted):
     if deleted<i:
         return i-1
     else:
         return i
 
-def bondjudge2(Cnears,atoms,iis,elements,state,mask,times=10):
-    print(Cnears,iis,elements)
+def bondjudge2(Cnears, atoms, iis, elements, state, mask, times=10):
+    print(Cnears, iis, elements)
     if 'N' in elements:
         for k in range(times):
-            if state[0]==state[1] and state[0]==2:
-                atoms.set_distance(iis[0],Cnears[0],1.5095,fix=1,mask=mask)
-                atoms.set_distance(iis[1],Cnears[1],1.3400,fix=1,mask=mask)
-                atoms.set_distance(iis[0],iis[1],1.2900,fix=1,mask=mask)
+            if state[0] == state[1] and state[0] == 2:
+                atoms.set_distance(iis[0], Cnears[0], 1.5095, fix=1, mask=mask)
+                atoms.set_distance(iis[1], Cnears[1], 1.3400, fix=1, mask=mask)
+                atoms.set_distance(iis[0], iis[1], 1.2900, fix=1, mask=mask)
         return 7
     for k in range(times):
-        if state[0]==state[1] and state[0]==2:
-            atoms.set_distance(iis[0],Cnears[0],1.4000,fix=1,mask=mask)
-            atoms.set_distance(iis[1],Cnears[1],1.4000,fix=1,mask=mask)
-            atoms.set_distance(iis[0],iis[1],1.4000,fix=1,mask=mask)
+        if state[0] == state[1] and state[0] == 2:
+            atoms.set_distance(iis[0], Cnears[0], 1.4000, fix=1, mask=mask)
+            atoms.set_distance(iis[1], Cnears[1], 1.4000, fix=1, mask=mask)
+            atoms.set_distance(iis[0], iis[1], 1.4000, fix=1, mask=mask)
         else:
             for i in range(2):
-                if state[i]==1:
-                    atoms.set_distance(iis[i],Cnears[i],1.5095,fix=1,mask=mask)
-                elif state[i]==2:
-                    atoms.set_distance(iis[i],Cnears[i],1.4600,fix=1,mask=mask)
-                elif state[i]==7:
-                    atoms.set_distance(iis[i],Cnears[i],1.3400,fix=1,mask=mask)
-                elif state[i]==8:
-                    atoms.set_distance(iis[i],Cnears[i],1.3640,fix=1,mask=mask)
-                elif state[i]==16:
-                    atoms.set_distance(iis[i],Cnears[i],1.7700,fix=1,mask=mask)
-                elif state[i]==82:
-                    atoms.set_distance(iis[i],Cnears[i],1.4440,fix=1,mask=mask)
-            atoms.set_distance(iis[0],iis[1],1.3400,fix=1,mask=mask)
+                if state[i] == 1:
+                    atoms.set_distance(iis[i], Cnears[i], 1.5095, fix=1, mask=mask)
+                elif state[i] == 2:
+                    atoms.set_distance(iis[i], Cnears[i], 1.4600, fix=1, mask=mask)
+                elif state[i] == 7:
+                    atoms.set_distance(iis[i], Cnears[i], 1.3400, fix=1, mask=mask)
+                elif state[i] == 8:
+                    atoms.set_distance(iis[i], Cnears[i], 1.3640, fix=1, mask=mask)
+                elif state[i] == 16:
+                    atoms.set_distance(iis[i], Cnears[i], 1.7700, fix=1, mask=mask)
+                elif state[i] == 82:
+                    atoms.set_distance(iis[i], Cnears[i], 1.4440, fix=1, mask=mask)
+            atoms.set_distance(iis[0], iis[1], 1.3400, fix=1, mask=mask)
 
-def bondjudge5(Cnears,atoms,iis,state,mask,place,times=10):
-    if place==2:
+def bondjudge5(Cnears, atoms, iis, state, mask, place, times=10):
+    if place == 2:
         for k in range(times):
-            if state[0]==state[1] and state[0]==1:
-                atoms.set_distance(iis[0],Cnears[0],1.5040,fix=1,mask=mask)
-                atoms.set_distance(iis[1],Cnears[1],1.4950,fix=1,mask=mask)
-                atoms.set_distance(i1,i2,1.3670,fix=1,mask=mask)
-            elif state[0]==state[1] and state[0]==2:
-                atoms.set_distance(iis[0],Cnears[0],1.4040,fix=1,mask=mask)
-                atoms.set_distance(iis[1],Cnears[1],1.4000,fix=1,mask=mask)
-                atoms.set_distance(i1,i2,1.4240,fix=1,mask=mask)
-    elif place==3:
+            if state[0] == state[1] and state[0] == 1:
+                atoms.set_distance(iis[0], Cnears[0], 1.5040, fix=1, mask=mask)
+                atoms.set_distance(iis[1], Cnears[1], 1.4950, fix=1, mask=mask)
+                atoms.set_distance(i1, i2, 1.3670, fix=1, mask=mask)
+            elif state[0] == state[1] and state[0] == 2:
+                atoms.set_distance(iis[0], Cnears[0], 1.4040, fix=1, mask=mask)
+                atoms.set_distance(iis[1], Cnears[1], 1.4000, fix=1, mask=mask)
+                atoms.set_distance(i1, i2, 1.4240, fix=1, mask=mask)
+    elif place == 3:
         for k in range(times):
-            if state[0]==state[1] and state[0]==2:
-                atoms.set_distance(iis[0],Cnears[0],1.4000,fix=1,mask=mask)
-                atoms.set_distance(iis[1],Cnears[1],1.4000,fix=1,mask=mask)
+            if state[0] == state[1] and state[0] == 2:
+                atoms.set_distance(iis[0], Cnears[0], 1.4000, fix=1, mask=mask)
+                atoms.set_distance(iis[1], Cnears[1], 1.4000, fix=1, mask=mask)
             else:
                 for i in range(2):
-                    if state[i]==1:
-                        atoms.set_distance(iis[i],Cnears[i],1.4950,fix=1,mask=mask)
-                    elif state[i]==2:
-                        atoms.set_distance(iis[i],Cnears[i],1.4330,fix=1,mask=mask)
-                    elif state[i]==7:
-                        atoms.set_distance(iis[i],Cnears[i],1.4950,fix=1,mask=mask)
-                    elif state[i]==8:
-                        atoms.set_distance(iis[i],Cnears[i],1.3640,fix=1,mask=mask)
-                    elif state[i]==16:
-                        atoms.set_distance(iis[i],Cnears[i],1.7700,fix=1,mask=mask)
-                    #elif state[i]==82:
-                    #    atoms.set_distance(iis[i],Cnears[i],1.4440?,fix=1,mask=mask)
-            atoms.set_distance(i1,i2,1.4240,fix=1,mask=mask)
-    elif place==4:
+                    if state[i] == 1:
+                        atoms.set_distance(iis[i], Cnears[i], 1.4950, fix=1, mask=mask)
+                    elif state[i] == 2:
+                        atoms.set_distance(iis[i], Cnears[i], 1.4330, fix=1, mask=mask)
+                    elif state[i] == 7:
+                        atoms.set_distance(iis[i], Cnears[i], 1.4950, fix=1, mask=mask)
+                    elif state[i] == 8:
+                        atoms.set_distance(iis[i], Cnears[i], 1.3640, fix=1, mask=mask)
+                    elif state[i] == 16:
+                        atoms.set_distance(iis[i], Cnears[i], 1.7700, fix=1, mask=mask)
+                    #elif state[i] == 82:
+                    #    atoms.set_distance(iis[i], Cnears[i], 1.4440?, fix=1, mask=mask)
+            atoms.set_distance(i1, i2, 1.4240, fix=1, mask=mask)
+    elif place == 4:
         for k in range(times):
-            if state[0]==state[1] and state[0]==1:
-                atoms.set_distance(iis[0],Cnears[0],1.4950,fix=1,mask=mask)
-                atoms.set_distance(iis[1],Cnears[1],1.5040,fix=1,mask=mask)
-            elif state[0]==state[1] and state[0]==2:
-                atoms.set_distance(iis[0],Cnears[0],1.4000,fix=1,mask=mask)
-                atoms.set_distance(iis[1],Cnears[1],1.4040,fix=1,mask=mask)
-            atoms.set_distance(i1,i2,1.4240,fix=1,mask=mask)
+            if state[0] == state[1] and state[0] == 1:
+                atoms.set_distance(iis[0], Cnears[0], 1.4950, fix=1, mask=mask)
+                atoms.set_distance(iis[1], Cnears[1], 1.5040, fix=1, mask=mask)
+            elif state[0] == state[1] and state[0] == 2:
+                atoms.set_distance(iis[0], Cnears[0], 1.4000, fix=1, mask=mask)
+                atoms.set_distance(iis[1], Cnears[1], 1.4040, fix=1, mask=mask)
+            atoms.set_distance(i1, i2, 1.4240, fix=1, mask=mask)
 
-def bondjudge6(Cnears,atoms,iis,state,mask,place,times=10):
-    if place==2 or place==5:
+def bondjudge6(Cnears, atoms, iis, state, mask, place, times=10):
+    if place == 2 or place == 5:
         for k in range(times):
-            if state[0]==state[1] and state[0]==1:
-                atoms.set_distance(iis[0],Cnears[0],1.5100,fix=1,mask=mask)
-                atoms.set_distance(iis[1],Cnears[1],1.5100,fix=1,mask=mask)
-                atoms.set_distance(i1,i2,1.4000,fix=1,mask=mask)
-            elif state[0]==state[1] and state[0]==2:
-                atoms.set_distance(iis[0],Cnears[0],1.4040,fix=1,mask=mask)
-                atoms.set_distance(iis[1],Cnears[1],1.4040,fix=1,mask=mask)
-                atoms.set_distance(i1,i2,1.3700,fix=1,mask=mask)
-    elif place==1 or place==3 or place==4:
+            if state[0] == state[1] and state[0] == 1:
+                atoms.set_distance(iis[0], Cnears[0], 1.5100, fix=1, mask=mask)
+                atoms.set_distance(iis[1], Cnears[1], 1.5100, fix=1, mask=mask)
+                atoms.set_distance(i1, i2, 1.4000, fix=1, mask=mask)
+            elif state[0] == state[1] and state[0] == 2:
+                atoms.set_distance(iis[0], Cnears[0], 1.4040, fix=1, mask=mask)
+                atoms.set_distance(iis[1], Cnears[1], 1.4040, fix=1, mask=mask)
+                atoms.set_distance(i1, i2, 1.3700, fix=1, mask=mask)
+    elif place == 1 or place == 3 or place == 4:
         for k in range(times):
-            if state[0]==state[1] and state[0]==2:
-                atoms.set_distance(iis[0],Cnears[0],1.4040,fix=1,mask=mask)
-                atoms.set_distance(iis[1],Cnears[1],1.4040,fix=1,mask=mask)
-                atoms.set_distance(i1,i2,1.3700,fix=1,mask=mask)
-            elif state[0]==state[1] and state[0]==82:
-                atoms.set_distance(iis[0],Cnears[0],1.4190,fix=1,mask=mask)
-                atoms.set_distance(iis[1],Cnears[1],1.4190,fix=1,mask=mask)
-                atoms.set_distance(i1,i2,1.3700,fix=1,mask=mask)
+            if state[0] == state[1] and state[0] == 2:
+                atoms.set_distance(iis[0], Cnears[0], 1.4040, fix=1, mask=mask)
+                atoms.set_distance(iis[1], Cnears[1], 1.4040, fix=1, mask=mask)
+                atoms.set_distance(i1, i2, 1.3700, fix=1, mask=mask)
+            elif state[0] == state[1] and state[0] == 82:
+                atoms.set_distance(iis[0], Cnears[0], 1.4190, fix=1, mask=mask)
+                atoms.set_distance(iis[1], Cnears[1], 1.4190, fix=1, mask=mask)
+                atoms.set_distance(i1, i2, 1.3700, fix=1, mask=mask)
             else:
                 for i in range(2):
-                    if state[i]==1:
-                        atoms.set_distance(iis[i],Cnears[i],1.5105,fix=1,mask=mask)
-                    elif state[i]==2:
-                        atoms.set_distance(iis[i],Cnears[i],1.4330,fix=1,mask=mask)
-                    elif state[i]==7:
-                        atoms.set_distance(iis[i],Cnears[i],1.3400,fix=1,mask=mask)
-                    elif state[i]==8:
-                        atoms.set_distance(iis[i],Cnears[i],1.3640,fix=1,mask=mask)
-                    elif state[i]==16:
-                        atoms.set_distance(iis[i],Cnears[i],1.7700,fix=1,mask=mask)
-                    elif state[i]==82:
-                        atoms.set_distance(iis[i],Cnears[i],1.4190,fix=1,mask=mask)
-                    if state[i]==2:
-                        atoms.set_distance(i1,i2,1.4040,fix=1,mask=mask)
+                    if state[i] == 1:
+                        atoms.set_distance(iis[i], Cnears[i], 1.5105, fix=1, mask=mask)
+                    elif state[i] == 2:
+                        atoms.set_distance(iis[i], Cnears[i], 1.4330, fix=1, mask=mask)
+                    elif state[i] == 7:
+                        atoms.set_distance(iis[i], Cnears[i], 1.3400, fix=1, mask=mask)
+                    elif state[i] == 8:
+                        atoms.set_distance(iis[i], Cnears[i], 1.3640, fix=1, mask=mask)
+                    elif state[i] == 16:
+                        atoms.set_distance(iis[i], Cnears[i], 1.7700, fix=1, mask=mask)
+                    elif state[i] == 82:
+                        atoms.set_distance(iis[i], Cnears[i], 1.4190, fix=1, mask=mask)
+                    if state[i] == 2:
+                        atoms.set_distance(i1, i2, 1.4040, fix=1, mask=mask)
                     else:
-                        atoms.set_distance(i1,i2,1.4000,fix=1,mask=mask)
+                        atoms.set_distance(i1, i2, 1.4000, fix=1, mask=mask)
 
 
-def near(i,atoms,target='ALL',ignore=[],limit=True,reverse=False):
-    elements=atoms.get_chemical_symbols()
-    total_atoms=len(atoms)
-    j=0
-    targeted_distances=[]
+def near(i, atoms, target='ALL', ignore=[], limit=True, reverse=False):
+    elements = atoms.get_chemical_symbols()
+    total_atoms = len(atoms)
+    j = 0
+    targeted_distances = []
     for element in elements:
         if j in ignore:
-            j=j+1
+            j = j + 1
             continue
-        if element==target:
-            d=atoms.get_distances(i,j)
-            if limit==True:
-                if d[0]>=0.5:
+        if element == target:
+            d = atoms.get_distances(i, j)
+            if limit == True:
+                if d[0] >= 0.5:
                     targeted_distances.append(d[0])
             else:
                 targeted_distances.append(d[0])
-        if target=='Not H' or target=='notH' or target=='not H':
-            if element!='H':
-                d=atoms.get_distances(i,j)
-                if limit==True:
-                    if d[0]>=0.5:
+        if target == 'Not H' or target == 'notH' or target == 'not H':
+            if element != 'H':
+                d = atoms.get_distances(i, j)
+                if limit == True:
+                    if d[0] >= 0.5:
                         targeted_distances.append(d[0])
                 else:
                     targeted_distances.append(d[0])
-        j=j+1
-    if reverse==True:
-        _near=-1
+        j = j + 1
+    if reverse == True:
+        _near = -1
     else:
-        _near=0
-    if target=='all' or target=='All' or target=='ALL':
-        targeted_distances=atoms.get_distances(i,range(len(atoms)))
-        targeted_distances=np.delete(targeted_distances,np.where(targeted_distances==0.0))
-    distances=atoms.get_distances(i,range(len(atoms)))
-    #print(distances,targeted_distances)
+        _near = 0
+    if target == 'all' or target == 'All' or target == 'ALL':
+        targeted_distances = atoms.get_distances(i, range(len(atoms)))
+        targeted_distances = np.delete(targeted_distances,\
+                                       np.where(targeted_distances == 0.0))
+    distances = atoms.get_distances(i, range(len(atoms)))
+    #print(distances, targeted_distances)
     for distance in distances:
         if total_atoms+_near in ignore:
             continue
-        if reverse==True:
+        if reverse == True:
             if total_atoms+_near in ignore:
-                _near=_near-1
+                _near = _near - 1
                 continue
-            if abs(min(targeted_distances)-atoms.get_distances(i,total_atoms+_near))<=0.001:
-                #print(_near,atoms.get_distances(i,_near))
+            if abs(min(targeted_distances)-atoms.get_distances(i,\
+                                                               total_atoms+_near)) <= 0.001:
+                #print(_near, atoms.get_distances(i, _near))
                 return total_atoms+_near
-            _near=_near-1
+            _near = _near - 1
         else:
             if _near in ignore:
-                _near=_near+1
+                _near = _near + 1
                 continue
-            if abs(min(targeted_distances)-atoms.get_distances(i,_near))<=0.001:
-                #print(_near,atoms.get_distances(i,_near))
+            if abs(min(targeted_distances)-atoms.get_distances(i, _near)) <= 0.001:
+                #print(_near, atoms.get_distances(i, _near))
                 return _near
-            #print(min(targeted_distances),atoms.get_distances(i,_near))
-            _near=_near+1
+            #print(min(targeted_distances), atoms.get_distances(i, _near))
+            _near = _near + 1
```

### Comparing `MCPoly-0.5.1.3/MCPoly/moldraw/gui.py` & `MCPoly-0.6b1/MCPoly/moldraw/gui.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,461 +1,569 @@
 # import numpy as np
-from ase.io import read, write
+import os
+import re
+import py3Dmol
+from ase.io import read,  write
 from ase import Atoms
 from ase.visualize import view
 from MCPoly import view3d
 from MCPoly.moldraw import molecule
 from MCPoly.orcaset import view3dchoose
 import ipywidgets as widgets
 from IPython.display import display
 from rdkit import Chem
 from rdkit.Chem import AllChem
 from ipywidgets import interact
-import os
-import re
-import py3Dmol
 
 def smi2conf(smiles):
     '''Convert SMILES to rdkit.Mol with 3D coordinates'''
     mol = Chem.MolFromSmiles(smiles)
     if mol is not None:
         mol = Chem.AddHs(mol)
         AllChem.EmbedMolecule(mol)
         return mol
     else:
         return None
 
-def MolTo3DView(mol,size=(400,550),surface=False,opacity=0.5):
+def MolTo3DView(mol, size=(400, 550), surface=False, opacity=0.5):
     """Draw molecule in 3D (Not Origin)
     
     Args:
     ----
-        mol: rdMol, molecule to show
-        size: tuple(int, int), canvas size
-        style: str, type of drawing molecule
-               style can be 'line', 'stick', 'sphere', 'cartoon'
-        surface, bool, display SAS
-        opacity, float, opacity of surface, range 0.0-1.0
+        mol: rdMol,  molecule to show
+        size: tuple(int,  int),  canvas size
+        style: str,  type of drawing molecule
+               style can be 'line',  'stick',  'sphere',  'cartoon'
+        surface,  bool,  display SAS
+        opacity,  float,  opacity of surface,  range 0.0-1.0
     Return:
     ----
         viewer: py3Dmol.view, a class for constructing embedded 3Dmol.js views in ipython notebooks.
     """
     mblock = Chem.MolToMolBlock(mol)
-    viewer = py3Dmol.view(width=size[0],height=size[1])
-    viewer.addModel(mblock,'mol')
-    viewer.setStyle({'sphere':{'radius':0.4},'stick':{'radius':0.1}})
+    viewer = py3Dmol.view(width=size[0], height=size[1])
+    viewer.addModel(mblock, 'mol')
+    viewer.setStyle({'sphere':{'radius':0.4}, 'stick':{'radius':0.1}})
     if surface:
-        viewer.addSurface(py3Dmol.SAS, {'opacity': opacity})
+        viewer.addSurface(py3Dmol.SAS,  {'opacity': opacity})
     viewer.zoomTo()
-    Chem.MolToXYZFile(mol,'Mole_Untitled.xyz')
+    Chem.MolToXYZFile(mol, 'Mole_Untitled.xyz')
     return viewer
 
 def gui():
     """
         The method to draw molecule and save it in the folder.
         You will know how to do as long as you get into the GUI platform.
     
         TIPS: 1. This drawing function is under construction. There might be some errors in the programme.
-              2. 'shuffle', 'less than 5' are used to modify some geometry structure.
-              3. The visualisation will also risk the flexibility of the task, to make you programme more flexible, please directly use the code.
+              2. 'shuffle',  'less than 5' are used to modify some geometry structure.
+              3. The visualisation will also risk the flexibility of the task,  to make you programme more flexible,  please directly use the code.
     """
     
     def outputmol1(button):
         output.clear_output()
         output2.clear_output()
         placeoutput.clear_output()
         strictoutput1.clear_output()
         strictoutput2.clear_output()
         strictoutput3.clear_output()
         angleoutput.clear_output()
         shuffleoutput.clear_output()
         strictadd2.value=False
         strictadd3.value=False
         with output:
-            i.max=atoms.atomnum()-1
-            if button.description=='pyrrole':
-                place.max=5
+            i.max = atoms.atomnum() - 1
+            if button.description == 'pyrrole':
+                place.max = 5
                 with placeoutput:
                     display(place)
-            if button.description=='Py':
-                place.max=6
+            if button.description == 'Py':
+                place.max = 6
                 with placoutput:
                     display(place)
-            if button.description=='cyclo3':
-                strictnum1.max=3
-            elif button.description=='cyclo5':
-                strictnum1.max=5
-                strictnum2.max=5
-            elif button.description=='cyclo6':
-                strictnum1.max=6
-                strictnum2.max=6
-                strictnum3.max=6
-            if button.description in ['C2H3','C=NH','Ph','Py','pyrrole','cyclo5','cyclo6','Bpin','bicyclo[2.2.1]','bicyclo[2.2.2]']:
+            if button.description == 'cyclo3':
+                strictnum1.max = 3
+            elif button.description == 'cyclo5':
+                strictnum1.max = 5
+                strictnum2.max = 5
+            elif button.description == 'cyclo6':
+                strictnum1.max = 6
+                strictnum2.max = 6
+                strictnum3.max = 6
+            if button.description in ('C2H3', 'C=NH', 'Ph', 'Py', 'pyrrole', 'cyclo5',\
+                                      'cyclo6', 'Bpin', 'bicyclo[2.2.1]', 'bicyclo[2.2.2]'):
                 with shuffleoutput:
                     display(shuffle)
-            if button.description!='cyclo3' and button.description!='cyclo5' and button.description!='cyclo6':
+            if button.description not in ('cyclo3', 'cyclo5', 'cyclo6'):
                 pass
-            elif button.description=='cyclo3':
+            elif button.description == 'cyclo3':
                 with strictoutput1:
-                    display(widgets.VBox([strictnum1,widgets.HBox([strictele1])]))
+                    display(widgets.VBox([strictnum1, widgets.HBox([strictele1])]))
             else:
                 with strictoutput1:
-                    display(widgets.VBox([strictnum1,widgets.HBox([strictele1,strictadd2])]))
-            if button.description=='OH' or button.description=='OMe' or button.description=='SH' or button.description=='SMe':
+                    display(widgets.VBox([strictnum1, widgets.HBox([strictele1, strictadd2])]))
+            if button.description in ('OH', 'OMe', 'SH', 'SMe'):
                 with angleoutput:
-                    display(widgets.HBox([angle,angleavail]))
+                    display(widgets.HBox([angle, angleavail]))
             buttonname.value=button.description
-            display(widgets.VBox([i,state,placeoutput,strictoutput1,strictoutput2,strictoutput3,shuffleoutput,angleoutput]))
-            display(widgets.HBox([preview,settle]))
+            display(widgets.VBox([i, state, placeoutput, strictoutput1,\
+                                  strictoutput2, strictoutput3, shuffleoutput, angleoutput]))
+            display(widgets.HBox([preview, settle]))
     
     def outputmol2(button):
         output.clear_output()
         output2.clear_output()
         placeoutput.clear_output()
         strictoutput1.clear_output()
         strictoutput2.clear_output()
         strictoutput3.clear_output()
         angleoutput.clear_output()
         shuffleoutput.clear_output()
-        strictadd2.value=False
-        strictadd3.value=False
+        strictadd2.value = False
+        strictadd3.value = False
         with output:
-            i1.max=atoms.atomnum()-1
-            i2.max=atoms.atomnum()-1
-            state1.options=[('1',1),('2',2),('6',6)]
-            state2.options=[('1',1),('2',2),('6',6)]
-            if button.description=='bind3':
-                strictnum1.max=1
-            elif button.description=='bind5' or button.description=='bindconj5':
-                strictnum1.max=3
-                strictnum2.max=3
-            elif button.description=='bind6' or button.description=='bindconj6':
-                strictnum1.max=4
-                strictnum2.max=4
-            if button.description not in ['bind2','bindconj5','bindconj6']:
+            i1.max = atoms.atomnum() - 1
+            i2.max = atoms.atomnum() - 1
+            state1.options = [('1', 1), ('2', 2), ('6', 6)]
+            state2.options = [('1', 1), ('2', 2), ('6', 6)]
+            if button.description == 'bind3':
+                strictnum1.max = 1
+            elif button.description in ('bind5', 'bindconj5'):
+                strictnum1.max = 3
+                strictnum2.max = 3
+            elif button.description in ('bind6', 'bindconj6'):
+                strictnum1.max = 4
+                strictnum2.max = 4
+            if button.description not in ('bind2', 'bindconj5', 'bindconj6'):
                 with shuffleoutput:
                     display(shuffle)
-            if button.description=='bind2':
+            if button.description == 'bind2':
                 pass
-            elif button.description=='bind3':
+            elif button.description == 'bind3':
                 with strictoutput1:
-                    display(widgets.VBox([strictnum1,widgets.HBox([strictele1])]))
+                    display(widgets.VBox([strictnum1, widgets.HBox([strictele1])]))
             else:
                 with strictoutput1:
-                    display(widgets.VBox([strictnum1,widgets.HBox([strictele1,strictadd2])]))
-            buttonname.value=button.description
-            display(widgets.VBox([widgets.HBox([i1,state1]),widgets.HBox([i2,state2]),strictoutput1,strictoutput2,side,shuffle,less5,stable]))
-            display(widgets.HBox([preview,settle]))
+                    display(widgets.VBox([strictnum1, widgets.HBox([strictele1, strictadd2])]))
+            buttonname.value = button.description
+            display(widgets.VBox([widgets.HBox([i1, state1]), widgets.HBox([i2, state2]),\
+                                  strictoutput1, strictoutput2, side, shuffle, less5, stable]))
+            display(widgets.HBox([preview, settle]))
             
     def outputmol3(button):
         output.clear_output()
         with output:
-            i.max=atoms.atomnum()-1
-            state1.options=[('1',1),('2',2),('6',6),('7',7),('8',8),('82',82)]
-            state2.options=[('1',1),('2',2),('6',6),('7',7),('8',8),('82',82)]
-            buttonname.value=button.description
-            display(widgets.VBox([i,state1,state2]))
-            display(widgets.HBox([preview,settle]))
+            i.max = atoms.atomnum() - 1
+            state1.options = [('1', 1), ('2', 2), ('6', 6), ('7', 7), ('8', 8), ('82', 82)]
+            state2.options = [('1', 1), ('2', 2), ('6', 6), ('7', 7), ('8', 8), ('82', 82)]
+            buttonname.value = button.description
+            display(widgets.VBox([i, state1, state2]))
+            display(widgets.HBox([preview, settle]))
         
     def clear(button):
         output.clear_output()
         output2.clear_output()
 
     def openf(button):
         os.system('cp {0}.xyz Mole_Untitled.xyz'.format(file.value))
-        file.value='Mole_Untitled'
+        file.value = 'Mole_Untitled'
         with output3:
-            view3d(file.value,loc.value,width=400,height=500)
-            display(widgets.HBox([savename,savefile]))
+            view3d(file.value, loc.value, width=400, height=500)
+            display(widgets.HBox([savename, savefile]))
         output0.clear_output()
         global atoms
-        atoms=molecule(file.value,loc.value)
+        atoms = molecule(file.value, loc.value)
         with output0:
-            display(widgets.VBox([allchoose,stack]))
+            display(widgets.VBox([allchoose, stack]))
 
     def smartshow(smart):
         os.system('rm Mole_Untitled.xyz')
         output3.clear_output()
         with output3:
             try:
                 conf = smi2conf(smart)
                 return MolTo3DView(conf).show()
             except:
                 return None
     
     def smartset(button):
         output3.clear_output()
         with output3:
-            view3d('Mole_Untitled',loc.value,width=400,height=500)
-            display(widgets.HBox([savename,savefile]))
+            view3d('Mole_Untitled', loc.value, width=400, height=500)
+            display(widgets.HBox([savename, savefile]))
         output0.clear_output()
-        file.value='Mole_Untitled'
+        file.value = 'Mole_Untitled'
         global atoms
-        atoms=molecule('Mole_Untitled',loc.value)
+        atoms = molecule('Mole_Untitled', loc.value)
         with output0:
-            display(widgets.VBox([allchoose,stack]))
+            display(widgets.VBox([allchoose, stack]))
     
     def saveset(button):
         output0.clear_output()
         output.clear_output()
         output3.clear_output()
         atoms.xyzwrite(savename.value)
         os.system('rm Mole_Untitled.xyz')
-        file.value=''
+        file.value = ''
         with output0:
-            display(widgets.VBox([loc,widgets.HBox([file,openfile]),widgets.Label('OR',style=dict(font_weight='bold',text_decoration='underline')),\
-                          widgets.HBox([smart,smartbutton])]))
+            display(widgets.VBox([loc, widgets.HBox([file, openfile]),\
+                                  widgets.Label('OR', style=dict(font_weight='bold',\
+                                                                 text_decoration='underline')),\
+                                  widgets.HBox([smart, smartbutton])]))
     
     def viewset(button):
         global atoms
         output3.clear_output()
-        atoms_b=atoms
-        if choose.value=='Substrates':
-            if buttonname.value=='cyclo3':
-                if strictele1.value[0]=='X':
-                    atoms_b.sub(buttonname.value,i.value,state.value,place.value,shuffle=shuffle.value,angle=angle.value)
+        atoms_b = atoms
+        if choose.value == 'Substrates':
+            if buttonname.value == 'cyclo3':
+                if strictele1.value[0] == 'X':
+                    atoms_b.sub(buttonname.value, i.value, state.value,\
+                                place.value, shuffle=shuffle.value, angle=angle.value)
                 else:
-                    atoms_b.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1},shuffle=shuffle.value,angle=angle.value)
-            elif buttonname.value=='cyclo5':
-                if strictele1.value[0]=='X':
-                    atoms_b.sub(buttonname.value,i.value,state.value,place.value,shuffle=shuffle.value,angle=angle.value)
-                elif strictadd2.value==False:
-                    atoms_b.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1},shuffle=shuffle.value,angle=angle.value)
+                    atoms_b.sub(buttonname.value, i.value, state.value,\
+                                place.value, strict={strictnum1:strictele1},\
+                                shuffle=shuffle.value, angle=angle.value)
+            elif buttonname.value == 'cyclo5':
+                if strictele1.value[0] == 'X':
+                    atoms_b.sub(buttonname.value, i.value, state.value, place.value,\
+                                shuffle=shuffle.value, angle=angle.value)
+                elif strictadd2.value == False:
+                    atoms_b.sub(buttonname.value, i.value, state.value, place.value,\
+                                strict={strictnum1:strictele1},\
+                                shuffle=shuffle.value, angle=angle.value)
                 else:
-                    atoms_b.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1,strictnum2:strictele2},shuffle=shuffle.value,angle=angle.value)
-            elif buttonname.value=='cyclo6':
-                if strictele1.value[0]=='X':
-                    atoms_b.sub(buttonname.value,i.value,state.value,place.value,shuffle=shuffle.value,angle=angle.value)
-                elif strictadd2.value==False:
-                    atoms_b.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1},shuffle=shuffle.value,angle=angle.value)
-                elif strictadd3.value==False:
-                    atoms_b.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1,strictnum2:strictele2},shuffle=shuffle.value,angle=angle.value)
+                    atoms_b.sub(buttonname.value, i.value, state.value, place.value,\
+                                strict={strictnum1:strictele1, strictnum2:strictele2},\
+                                shuffle=shuffle.value, angle=angle.value)
+            elif buttonname.value == 'cyclo6':
+                if strictele1.value[0] == 'X':
+                    atoms_b.sub(buttonname.value, i.value, state.value, place.value,\
+                                shuffle=shuffle.value, angle=angle.value)
+                elif strictadd2.value == False:
+                    atoms_b.sub(buttonname.value, i.value, state.value, place.value,\
+                                strict={strictnum1:strictele1},\
+                                shuffle=shuffle.value, angle=angle.value)
+                elif strictadd3.value == False:
+                    atoms_b.sub(buttonname.value, i.value, state.value, place.value,\
+                                strict={strictnum1:strictele1, strictnum2:strictele2},\
+                                shuffle=shuffle.value, angle=angle.value)
                 else:
-                    atoms_b.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1,strictnum2:strictele2,strictnum3:strictele3},shuffle=shuffle.value,angle=angle.value)
+                    atoms_b.sub(buttonname.value, i.value, state.value, place.value,\
+                                strict={strictnum1:strictele1, strictnum2:strictele2,\
+                                        strictnum3:strictele3},\
+                                shuffle=shuffle.value, angle=angle.value)
             else:
-                atoms_b.sub(buttonname.value,i.value,state.value,place.value,shuffle=shuffle.value,angle=angle.value)
-        elif choose.value=='Ringbinders':
-            if buttonname.value=='bind3':
-                atoms_b.bind(buttonname.value,[i1.value,i2.value],state=[state1.value,state2.value],place=place.value,strict={strictnum1:strictele1},side=side.value,shuffle=shuffle.value, less5=less5.value, stable=stable.value)
-            elif buttonname.value in ['SmallChanges','bindconj5','bindconj6']:
-                if strictele1.value[0]=='X':
-                    atoms_b.bind(buttonname.value,[i1.value,i2.value],state=[state1.value,state2.value],place=place.value,side=side.value,shuffle=shuffle.value,less5=less5.value,stable=stable.value)
-                elif strictadd2.value==False:
-                    atoms_b.bind(buttonname.value,[i1.value,i2.value],state=[state1.value,state2.value],place=place.value,strict={strictnum1:strictele1},side=side.value,shuffle=shuffle.value,less5=less5.value,stable=stable.value)
+                atoms_b.sub(buttonname.value, i.value, state.value, place.value,\
+                            shuffle=shuffle.value, angle=angle.value)
+        elif choose.value == 'Ringbinders':
+            if buttonname.value == 'bind3':
+                atoms_b.bind(buttonname.value, [i1.value, i2.value],\
+                             state=[state1.value, state2.value], place=place.value,\
+                             strict={strictnum1:strictele1}, side=side.value,\
+                             shuffle=shuffle.value, less5=less5.value, stable=stable.value)
+            elif buttonname.value in ['SmallChanges', 'bindconj5', 'bindconj6']:
+                if strictele1.value[0] == 'X':
+                    atoms_b.bind(buttonname.value, [i1.value, i2.value],\
+                                 state=[state1.value, state2.value], place=place.value,\
+                                 side=side.value, shuffle=shuffle.value,\
+                                 less5=less5.value, stable=stable.value)
+                elif strictadd2.value == False:
+                    atoms_b.bind(buttonname.value, [i1.value, i2.value],\
+                                 state=[state1.value, state2.value], place=place.value,\
+                                 strict={strictnum1:strictele1}, side=side.value,\
+                                 shuffle=shuffle.value, less5=less5.value, stable=stable.value)
                 else:
-                    atoms_b.bind(buttonname.value,[i1.value,i2.value],state=[state1.value,state2.value],place=place.value,strict={strictnum1:strictele1,strictnum2:strictele2},side=side.value,shuffle=shuffle.value,less5=less5.value,stable=stable.value)
+                    atoms_b.bind(buttonname.value, [i1.value, i2.value],\
+                                 state=[state1.value, state2.value], place=place.value,\
+                                 strict={strictnum1:strictele1, strictnum2:strictele2},\
+                                 side=side.value, shuffle=shuffle.value,\
+                                 less5=less5.value, stable=stable.value)
             else:
-                atoms_b.bind(buttonname.value,[i1.value,i2.value],state=[state1.value,state2.value],place=place.value,side=side.value,shuffle=shuffle.value,less5=less5.value,stable=stable.value)
-        elif choose.value=='SmallChanges':
-            atoms_b.C(buttonname.value,i.value,state=[state1.value,state2.value])
+                atoms_b.bind(buttonname.value, [i1.value, i2.value],\
+                             state=[state1.value, state2.value], place=place.value,\
+                             side=side.value, shuffle=shuffle.value,\
+                             less5=less5.value, stable=stable.value)
+        elif choose.value == 'SmallChanges':
+            atoms_b.C(buttonname.value, i.value, state=[state1.value, state2.value])
         atoms_b.xyzwrite('Mole_Untitled_beta')
         with output3:
-            view3d('Mole_Untitled_beta',loc.value,width=400,height=500)
-            display(widgets.HBox([savename,savefile]))
+            view3d('Mole_Untitled_beta', loc.value, width=400, height=500)
+            display(widgets.HBox([savename, savefile]))
         file.value='Mole_Untitled'
         os.system('rm Mole_Untitled_beta.xyz')
-        atoms=molecule('Mole_Untitled',loc.value)
+        atoms = molecule('Mole_Untitled', loc.value)
 
     def settlechange(button):
         global atoms
         output3.clear_output()
-        if choose.value=='Substrates':
-            if buttonname.value=='cyclo3':
-                if strictele1.value[0]=='X':
-                    atoms.sub(buttonname.value,i.value,state.value,place.value,shuffle=shuffle.value,angle=angle.value)
+        if choose.value == 'Substrates':
+            if buttonname.value == 'cyclo3':
+                if strictele1.value[0] == 'X':
+                    atoms.sub(buttonname.value, i.value, state.value, place.value,\
+                              shuffle=shuffle.value, angle=angle.value)
                 else:
-                    atoms.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1},shuffle=shuffle.value,angle=angle.value)
-            elif buttonname.value=='cyclo5':
-                if strictele1.value[0]=='X':
-                    atoms.sub(buttonname.value,i.value,state.value,place.value,shuffle=shuffle.value,angle=angle.value)
-                elif strictadd2.value==False:
-                    atoms.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1},shuffle=shuffle.value,angle=angle.value)
+                    atoms.sub(buttonname.value, i.value, state.value, place.value,\
+                              strict={strictnum1:strictele1},\
+                              shuffle=shuffle.value, angle=angle.value)
+            elif buttonname.value == 'cyclo5':
+                if strictele1.value[0] == 'X':
+                    atoms.sub(buttonname.value, i.value, state.value, place.value,\
+                              shuffle=shuffle.value, angle=angle.value)
+                elif strictadd2.value == False:
+                    atoms.sub(buttonname.value, i.value, state.value, place.value,\
+                              strict={strictnum1:strictele1},\
+                              shuffle=shuffle.value, angle=angle.value)
                 else:
-                    atoms.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1,strictnum2:strictele2},shuffle=shuffle.value,angle=angle.value)
-            elif buttonname.value=='cyclo6':
-                if strictele1.value[0]=='X':
-                    atoms.sub(buttonname.value,i.value,state.value,place.value,shuffle=shuffle.value,angle=angle.value)
-                elif strictadd2.value==False:
-                    atoms.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1},shuffle=shuffle.value,angle=angle.value)
-                elif strictadd3.value==False:
-                    atoms.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1,strictnum2:strictele2},shuffle=shuffle.value,angle=angle.value)
+                    atoms.sub(buttonname.value, i.value, state.value, place.value,\
+                              strict={strictnum1:strictele1, strictnum2:strictele2},\
+                              shuffle=shuffle.value, angle=angle.value)
+            elif buttonname.value == 'cyclo6':
+                if strictele1.value[0] == 'X':
+                    atoms.sub(buttonname.value, i.value, state.value, place.value,\
+                              shuffle=shuffle.value, angle=angle.value)
+                elif strictadd2.value == False:
+                    atoms.sub(buttonname.value, i.value, state.value, place.value,\
+                              strict={strictnum1:strictele1},\
+                              shuffle=shuffle.value, angle=angle.value)
+                elif strictadd3.value == False:
+                    atoms.sub(buttonname.value, i.value, state.value, place.value,\
+                              strict={strictnum1:strictele1, strictnum2:strictele2},\
+                              shuffle=shuffle.value, angle=angle.value)
                 else:
-                    atoms.sub(buttonname.value,i.value,state.value,place.value,strict={strictnum1:strictele1,strictnum2:strictele2,strictnum3:strictele3},shuffle=shuffle.value,angle=angle.value)
+                    atoms.sub(buttonname.value, i.value, state.value, place.value,\
+                              strict={strictnum1:strictele1, strictnum2:strictele2,\
+                                      strictnum3:strictele3},\
+                              shuffle=shuffle.value, angle=angle.value)
             else:
-                atoms.sub(buttonname.value,i.value,state.value,place.value,shuffle=shuffle.value,angle=angle.value)
-        elif choose.value=='Ringbinders':
-            if buttonname.value=='bind3':
-                atoms.bind(buttonname.value,[i1.value,i2.value],state=[state1.value,state2.value],place=place.value,strict={strictnum1:strictele1},side=side.value,shuffle=shuffle.value, less5=less5.value, stable=stable.value)
-            elif buttonname.value in ['SmallChanges','bindconj5','bindconj6']:
-                if strictele1.value[0]=='X':
-                    atoms.bind(buttonname.value,[i1.value,i2.value],state=[state1.value,state2.value],place=place.value,side=side.value,shuffle=shuffle.value,less5=less5.value,stable=stable.value)
-                elif strictadd2.value==False:
-                    atoms.bind(buttonname.value,[i1.value,i2.value],state=[state1.value,state2.value],place=place.value,strict={strictnum1:strictele1},side=side.value,shuffle=shuffle.value,less5=less5.value,stable=stable.value)
+                atoms.sub(buttonname.value, i.value, state.value,\
+                          place.value, shuffle=shuffle.value, angle=angle.value)
+        elif choose.value == 'Ringbinders':
+            if buttonname.value == 'bind3':
+                atoms.bind(buttonname.value, [i1.value, i2.value],\
+                           state=[state1.value, state2.value], place=place.value,\
+                           strict={strictnum1:strictele1}, side=side.value,\
+                           shuffle=shuffle.value,  less5=less5.value,  stable=stable.value)
+            elif buttonname.value in ['SmallChanges', 'bindconj5', 'bindconj6']:
+                if strictele1.value[0] == 'X':
+                    atoms.bind(buttonname.value, [i1.value, i2.value],\
+                               state=[state1.value, state2.value], place=place.value,\
+                               side=side.value, shuffle=shuffle.value, less5=less5.value,\
+                               stable=stable.value)
+                elif strictadd2.value == False:
+                    atoms.bind(buttonname.value, [i1.value, i2.value],\
+                               state=[state1.value, state2.value], place=place.value,\
+                               strict={strictnum1:strictele1}, side=side.value,\
+                               shuffle=shuffle.value, less5=less5.value, stable=stable.value)
                 else:
-                    atoms.bind(buttonname.value,[i1.value,i2.value],state=[state1.value,state2.value],place=place.value,strict={strictnum1:strictele1,strictnum2:strictele2},side=side.value,shuffle=shuffle.value,less5=less5.value,stable=stable.value)
+                    atoms.bind(buttonname.value, [i1.value, i2.value],\
+                               state=[state1.value, state2.value], place=place.value,\
+                               strict={strictnum1:strictele1, strictnum2:strictele2},\
+                               side=side.value, shuffle=shuffle.value,\
+                               less5=less5.value, stable=stable.value)
             else:
-                atoms.bind(buttonname.value,[i1.value,i2.value],state=[state1.value,state2.value],place=place.value,side=side.value,shuffle=shuffle.value,less5=less5.value,stable=stable.value)
-        elif choose.value=='SmallChanges':
-            atoms.C(buttonname.value,i.value,state=[state1.value,state2.value])
+                atoms.bind(buttonname.value, [i1.value, i2.value],\
+                           state=[state1.value, state2.value], place=place.value, side=side.value,\
+                           shuffle=shuffle.value, less5=less5.value, stable=stable.value)
+        elif choose.value == 'SmallChanges':
+            atoms.C(buttonname.value, i.value, state=[state1.value, state2.value])
         atoms.xyzwrite('Mole_Untitled')
-        atoms=molecule('Mole_Untitled',loc.value)
+        atoms = molecule('Mole_Untitled', loc.value)
         file.value='Mole_Untitled'
         with output3:
-            view3d('Mole_Untitled',loc.value,width=400,height=500)
-            display(widgets.HBox([savename,savefile]))
+            view3d('Mole_Untitled', loc.value, width=400, height=500)
+            display(widgets.HBox([savename, savefile]))
     
     def strictout2(strictadd2):
         strictoutput2.clear_output()
-        if strictadd2==True:
+        if strictadd2 == True:
             with strictoutput2:
-                if buttonname.value=='cyclo5' or buttonname.value=='bind5' or buttonname.value=='bind6' or buttonname.value=='bindconj5' or buttonname.value=='bindconj6':
-                    display(widgets.VBox([strictnum2,strictele2]))
+                if buttonname.value in ('cyclo5', 'bind5', 'bind6', 'bindconj5', 'bindconj6'):
+                    display(widgets.VBox([strictnum2, strictele2]))
                 else:
-                    display(widgets.VBox([strictnum2,widgets.HBox([strictele2,strictadd3])]))
+                    display(widgets.VBox([strictnum2, widgets.HBox([strictele2, strictadd3])]))
     
     def strictout3(strictadd3):
         strictoutput3.clear_output()
-        if strictadd3==True:
+        if strictadd3 == True:
             with strictoutput3:
-                display(widgets.VBox([strictnum3,strictele3]))
+                display(widgets.VBox([strictnum3, strictele3]))
     
     def angleavailout(angleavail):
-        if angleavail==True:
-            angle.disabled=True
+        if angleavail == True:
+            angle.disabled = True
         else:
-            angle.disabled=False
+            angle.disabled = False
 
-    def chooseshow(i,i1,i2,choose):
+    def chooseshow(i, i1, i2, choose):
         output3.clear_output()
         with output3:
             try:
-                if choose=='Substrates':
-                    view3dchoose(file.value,loc.value,choose=[i],width=400,height=500)
-                elif choose=='Ringbinders':
-                    view3dchoose(file.value,loc.value,choose=[i1,i2],width=400,height=500)
-                elif choose=='SmallChanges':
-                    view3dchoose(file.value,loc.value,choose=[i],width=400,height=500)
-                display(widgets.HBox([savename,savefile]))
+                if choose == 'Substrates':
+                    view3dchoose(file.value, loc.value, choose=[i], width=400, height=500)
+                elif choose == 'Ringbinders':
+                    view3dchoose(file.value, loc.value, choose=[i1, i2], width=400, height=500)
+                elif choose == 'SmallChanges':
+                    view3dchoose(file.value, loc.value, choose=[i], width=400, height=500)
+                display(widgets.HBox([savename, savefile]))
             except:
                 pass
     
     def default(strictele1):
-        if strictele1=='X(Default)':
+        if strictele1 == 'X(Default)':
             strictnum1.value=1
-            strictadd2.disabled=True
+            strictadd2.disabled = True
         else:
-            strictadd2.disabled=False
+            strictadd2.disabled = False
     
     output0 = widgets.Output()
     output = widgets.Output()
     output2 = widgets.Output()
     output3 = widgets.Output()
     strictoutput1 = widgets.Output()
     strictoutput2 = widgets.Output()
     strictoutput3 = widgets.Output()
     angleoutput = widgets.Output()
     placeoutput = widgets.Output()
     shuffleoutput = widgets.Output()
     
-    options=[]
-    loc=widgets.Text(description='Location:',value='./')
+    options = []
+    loc = widgets.Text(description='Location:', value='./')
     for path in os.listdir(loc.value):
-        if os.path.isfile(os.path.join(loc.value, path)):
-            a=re.search('.xyz', path)
+        if os.path.isfile(os.path.join(loc.value,  path)):
+            a = re.search('.xyz',  path)
             if a:
                 options.append(path[:-4])
-    file=widgets.Combobox(placeholder='Input the file name',options=options,
+    file = widgets.Combobox(placeholder = 'Input the file name', options=options,\
              description='xyz File:')
     
-    openfile=widgets.Button(description='Set')
+    openfile = widgets.Button(description='Set')
     openfile.on_click(openf)
     
-    smart=widgets.Text(description='SMART:',placeholder='Input SMART structure')
-    smartbutton=widgets.Button(description='Set')
+    smart = widgets.Text(description='SMART:',\
+                         placeholder = 'Input SMART structure')
+    smartbutton = widgets.Button(description='Set')
     smartbutton.on_click(smartset)
     
-    i=widgets.BoundedIntText(description='Atom Number:',min=0,style={'description_width': 'initial'})
-    state=widgets.Dropdown(description='Environment:',options=[('1',1),('2',2),('4',4),('6',6),('7',7),('8',8),('16',16),('82',82),('162',162),('164',164)],value=1,style={'description_width': 'initial'})
-    place=widgets.BoundedIntText(description='Connect Place:',min=0,value=0,style={'description_width': 'initial'})
-    strictnum1=widgets.BoundedIntText(description='Hetero Place 1:',min=1,value=1,style={'description_width': 'initial'})
-    strictele1=widgets.Dropdown(description='Hetero Elements 1:',options=['N','O','S','X(Default)'],value='X(Default)',style={'description_width': 'initial'})
-    #strictdefault=widgets.ToggleButton(description='default',value=True)
-    strictnum2=widgets.BoundedIntText(description='Hetero Place 2:',min=3,value=3,style={'description_width': 'initial'})
-    strictele2=widgets.Dropdown(description='Hetero Elements 2:',options=['N','O','S'],style={'description_width': 'initial'})
-    strictadd2=widgets.ToggleButton(description='Add',value=False)
-    strictnum3=widgets.BoundedIntText(description='Hetero Place 3:',min=5,value=5,style={'description_width': 'initial'})
-    strictele3=widgets.Dropdown(description='Hetero Elements 3:',options=['N','O','S'],style={'description_width': 'initial'})
-    strictadd3=widgets.ToggleButton(description='Add',value=False)
-    i1=widgets.BoundedIntText(description='Atom Number 1:',min=0,style={'description_width': 'initial'})
-    state1=widgets.Dropdown(description='Environment:',options=[('1',1),('2',2),('6',6)],value=1,style={'description_width': 'initial'})
-    i2=widgets.BoundedIntText(description='Atom Number 2:',min=0,style={'description_width': 'initial'})
-    state2=widgets.Dropdown(description='Environment:',options=[('1',1),('2',2),('6',6)],value=1,style={'description_width': 'initial'})
-    shuffle=widgets.BoundedIntText(description='Shuffle:',min=0,max=3,value=0,style={'description_width': 'initial'})
-    angle=widgets.BoundedFloatText(min=0,max=360,step=0.1,description='Angle:',style={'description_width': 'initial'})
-    angleavail=widgets.ToggleButton(value=False,description='Default',style={'description_width': 'initial'})
-    side=widgets.BoundedIntText(description='Conformer:',min=0,max=3,value=0,style={'description_width': 'initial'})
-    shuffle=widgets.BoundedIntText(description='Shuffle:',min=0,value=0,style={'description_width': 'initial'})
-    less5=widgets.Checkbox(description='Connect with small rings (member<=5)?',style={'description_width': 'initial'})
-    stable=widgets.Checkbox(description='Most Stable structure?',style={'description_width': 'initial'})
-    preview=widgets.Button(description='View')
+    i = widgets.BoundedIntText(description='Atom Number:',\
+                               min=0, style={'description_width': 'initial'})
+    state = widgets.Dropdown(description='Environment:',\
+                             options=[('1', 1), ('2', 2), ('4', 4), ('6', 6), ('7', 7),\
+                                      ('8', 8), ('16', 16), ('82', 82), ('162', 162), ('164', 164)],\
+                             value=1, style={'description_width': 'initial'})
+    place = widgets.BoundedIntText(description='Connect Place:',\
+                                   min=0, value=0, style={'description_width': 'initial'})
+    strictnum1 = widgets.BoundedIntText(description='Hetero Place 1:',\
+                                        min=1, value=1, style={'description_width': 'initial'})
+    strictele1 = widgets.Dropdown(description='Hetero Elements 1:',\
+                                  options=['N', 'O', 'S', 'X(Default)'], value='X(Default)',\
+                                  style={'description_width': 'initial'})
+    #strictdefault = widgets.ToggleButton(description='default', value=True)
+    strictnum2 = widgets.BoundedIntText(description='Hetero Place 2:',\
+                                        min=3, value=3, style={'description_width': 'initial'})
+    strictele2 = widgets.Dropdown(description='Hetero Elements 2:',\
+                                  options=['N', 'O', 'S'], style={'description_width': 'initial'})
+    strictadd2 = widgets.ToggleButton(description='Add', value=False)
+    strictnum3 = widgets.BoundedIntText(description='Hetero Place 3:',\
+                                        min=5, value=5, style={'description_width': 'initial'})
+    strictele3 = widgets.Dropdown(description='Hetero Elements 3:',\
+                                  options=['N', 'O', 'S'], style={'description_width': 'initial'})
+    strictadd3 = widgets.ToggleButton(description='Add', value=False)
+    i1 = widgets.BoundedIntText(description='Atom Number 1:',\
+                                min=0, style={'description_width': 'initial'})
+    state1 = widgets.Dropdown(description='Environment:',\
+                              options=[('1', 1), ('2', 2), ('6', 6)],\
+                              value=1, style={'description_width': 'initial'})
+    i2 = widgets.BoundedIntText(description='Atom Number 2:',\
+                                min=0, style={'description_width': 'initial'})
+    state2 = widgets.Dropdown(description='Environment:',\
+                              options=[('1', 1), ('2', 2), ('6', 6)], value=1,\
+                              style={'description_width': 'initial'})
+    shuffle = widgets.BoundedIntText(description='Shuffle:', min=0, max=3,\
+                                     value=0, style={'description_width': 'initial'})
+    angle = widgets.BoundedFloatText(min=0, max=360, step = 0.1,\
+                                     description='Angle:', style={'description_width': 'initial'})
+    angleavail = widgets.ToggleButton(value=False, description='Default',\
+                                      style={'description_width': 'initial'})
+    side = widgets.BoundedIntText(description='Conformer:', min=0, max=3,\
+                                  value=0, style={'description_width': 'initial'})
+    shuffle = widgets.BoundedIntText(description='Shuffle:', min=0, value=0,\
+                                     style={'description_width': 'initial'})
+    less5 = widgets.Checkbox(description='Connect with small rings (member<=5)?',\
+                             style={'description_width': 'initial'})
+    stable = widgets.Checkbox(description='Most Stable structure?',\
+                              style={'description_width': 'initial'})
+    preview = widgets.Button(description='View')
     preview.on_click(viewset)
-    settle=widgets.Button(description='Set')
+    settle = widgets.Button(description='Set')
     settle.on_click(settlechange)
-    savename=widgets.Text(description='Save Name:',value='Mole_Untitled')
-    savefile=widgets.Button(description='Save')
+    savename = widgets.Text(description='Save Name:', value='Mole_Untitled')
+    savefile = widgets.Button(description='Save')
     savefile.on_click(saveset)
-    buttonname=widgets.Text()
+    buttonname = widgets.Text()
     
-    #file=widgets.Button(description='Set')
+    #file = widgets.Button(description='Set')
     
-    strict2=widgets.interactive_output(strictout2, {'strictadd2': strictadd2})
-    strict3=widgets.interactive_output(strictout3, {'strictadd3': strictadd3})
-    angleout=widgets.interactive_output(angleavailout, {'angleavail': angleavail})
-    smartout=widgets.interactive_output(smartshow, {'smart': smart})
-    
-    substrates=['F','Cl','Br','I','OH','OMe','SH','SMe','NH2','NMe2','Me','Et','n-Pr','i-Pr','n-Bu','t-Bu','CF3','CCl3','CBr3','CI3','NO2','C2H3','C=NH',
-          'CHO','COOH','COMe','CN','Ph','pyrrole','Py','cyclo3','cyclo5','cyclo6','SOMe','SO2Me','SO3H','Bpin','bicyclo[2.2.1]','bicyclo[2.2.2]']
-    buttons1=[]
+    strict2 = widgets.interactive_output(strictout2, {'strictadd2': strictadd2})
+    strict3 = widgets.interactive_output(strictout3, {'strictadd3': strictadd3})
+    angleout = widgets.interactive_output(angleavailout,\
+                                          {'angleavail': angleavail})
+    smartout = widgets.interactive_output(smartshow, {'smart': smart})
+    
+    substrates = ['F', 'Cl', 'Br', 'I', 'OH', 'OMe', 'SH', 'SMe', 'NH2', 'NMe2',\
+                  'Me', 'Et', 'n-Pr', 'i-Pr', 'n-Bu', 't-Bu', 'CF3', 'CCl3', 'CBr3',\
+                  'CI3', 'NO2', 'C2H3', 'C=NH', 'CHO', 'COOH', 'COMe', 'CN', 'Ph',\
+                  'pyrrole', 'Py', 'cyclo3', 'cyclo5', 'cyclo6', 'SOMe', 'SO2Me',\
+                  'SO3H', 'Bpin', 'bicyclo[2.2.1]', 'bicyclo[2.2.2]']
+    buttons1 = []
     for x in substrates:
-        button=widgets.Button(layout=widgets.Layout(height='30px', min_width='120px'),description=x)
+        button = widgets.Button(layout = widgets.Layout(height='30px',\
+                                                      min_width='120px'), description=x)
         buttons1.append(button)
         button.on_click(outputmol1)
-    Substrates=widgets.HBox(children=[buttons1[x] for x in range(len(substrates))])
+    Substrates = widgets.HBox(
+        children = [buttons1[x] for x in range(len(substrates))])
     
-    binds=['bind2','bind3','bind5','bind6','bindconj5','bindconj6']
-    buttons2=[]
+    binds = ['bind2', 'bind3', 'bind5', 'bind6', 'bindconj5', 'bindconj6']
+    buttons2 = []
     for x in binds:
-        button=widgets.Button(layout=widgets.Layout(height='30px', min_width='120px'),description=x)
+        button = widgets.Button(layout = widgets.Layout(height='30px',\
+                                                        min_width='120px'), description=x)
         buttons2.append(button)
         button.on_click(outputmol2)
-    Ringbinders=widgets.HBox(children=[buttons2[x] for x in range(len(binds))])
+    Ringbinders = widgets.HBox(children = [buttons2[x] for x in range(len(binds))])
     
-    Cs=['C=O','C=NH','O','S','N']
-    buttons3=[]
+    Cs = ['C=O', 'C=NH', 'O', 'S', 'N']
+    buttons3 = []
     for x in Cs:
-        button=widgets.Button(layout=widgets.Layout(height='30px', min_width='120px'),description=x)
+        button = widgets.Button(layout = widgets.Layout(height='30px',\
+                                                        min_width='120px'), description=x)
         buttons3.append(button)
         button.on_click(outputmol3)
-    SmallChanges=widgets.HBox(children=[buttons3[x] for x in range(len(Cs))])
+    SmallChanges = widgets.HBox(children = [buttons3[x] for x in range(len(Cs))])
         
-    stack = widgets.Stack([Substrates,Ringbinders,SmallChanges])
-    
-    choose=widgets.Dropdown(options=['Substrates','Ringbinders','SmallChanges'])
-    widgets.jslink((choose,'index'),(stack,'selected_index'))
+    stack = widgets.Stack([Substrates, Ringbinders, SmallChanges])
     
-    chooseout=widgets.interactive_output(chooseshow, {'i': i, 'i1': i1, 'i2': i2, 'choose': choose})
-    defaultout=widgets.interactive_output(default, {'strictele1': strictele1})
+    choose=widgets.Dropdown(options=['Substrates', 'Ringbinders', 'SmallChanges'])
+    widgets.jslink((choose, 'index'), (stack, 'selected_index'))
     
-    box_layout = widgets.Layout(overflow='scroll hidden', border='2px solid black',
-                    width='65%',height='550px',display='flex')
-    box_layout2 = widgets.Layout(overflow='scroll hidden', border='2px solid black',
-                    width='35%',height='550px',display='flex')
-    output3.layout=box_layout2
-    clean=widgets.Button(description='Clean Data')
+    chooseout = widgets.interactive_output(chooseshow, {'i': i, 'i1': i1,\
+                                                        'i2': i2, 'choose': choose})
+    defaultout = widgets.interactive_output(default, {'strictele1': strictele1})
+    
+    box_layout = widgets.Layout(overflow='scroll hidden',\
+                                border='2px solid black', width='65%', height='550px', display='flex')
+    box_layout2 = widgets.Layout(overflow='scroll hidden',\
+                                 border='2px solid black', width='35%', height='550px', display='flex')
+    output3.layout = box_layout2
+    clean = widgets.Button(description='Clean Data')
     clean.on_click(clear)
     
     with output0:
-        display(widgets.VBox([loc,widgets.HBox([file,openfile]),widgets.Label('OR',style=dict(font_weight='bold',text_decoration='underline')),\
-                          widgets.HBox([smart,smartbutton])]))
-    
-    allchoose=widgets.HBox([widgets.Label('Choose your step: '),choose,clean])
-    display(widgets.HBox([widgets.VBox([output0,output],layout=box_layout),output3]))
+        display(widgets.VBox([loc, widgets.HBox([file, openfile]),\
+                              widgets.Label('OR', style = dict(font_weight='bold',\
+                                                               text_decoration='underline')),\
+                              widgets.HBox([smart, smartbutton])]))
+    
+    allchoose = widgets.HBox([widgets.Label('Choose your step: '), choose, clean])
+    display(widgets.HBox([widgets.VBox([output0, output],\
+                                       layout=box_layout), output3]))
```

### Comparing `MCPoly-0.5.1.3/MCPoly/moldraw/sub_selection.py` & `MCPoly-0.6b1/MCPoly/moldraw/sub_selection.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,2267 +1,2410 @@
 import math as m
 import numpy as np
 from ase.io import read, write
 from ase import Atoms
 from ase.visualize import view
 
-def sub_selection(substitution,atoms,i,state=1,place=0,strict={1:'X'},shuffle=0,angle=-1):
+def sub_selection(substitution, atoms, i, state=1, place=0, strict={1:'X'}, shuffle=0, angle=-1):
     '''This function will change the hydrogen into other substitution.''' 
     
-    if substitution=='H' or substitution=='F' or substitution=='Cl' or substitution=='Br' or substitution=='I':
-        return Halogen(substitution,atoms,i,state)
-    elif substitution=='OH':
-        return OH(atoms,i,state,angle)
-    elif substitution=='OMe' or substitution=='OCH3':
-        return OMe(atoms,i,state,angle)
-    elif substitution=='SH':
-        return SH(atoms,i,state,angle)
-    elif substitution=='SMe' or substitution=='SCH3':
-        return SMe(atoms,i,state,angle)
-    elif substitution=='NH2':
-        return NH2(atoms,i,state)
-    elif substitution=='NMe2' or substitution=='N(CH3)2':
-        return NMe2(atoms,i,state)
-    elif substitution=='CH3' or substitution=='Me':
-        return CH3(atoms,i,state)
-    elif substitution=='C2H3':
-        return C2H3(atoms,i,state,shuffle)
-    elif substitution=='C2H5' or substitution=='Et' or substitution=='i-C3H7' or substitution=='i-Pr' or substitution=='iPr' or substitution=='t-C4H9' or substitution=='t-Bu' or substitution=='tBu':
-        if substitution=='C2H5' or substitution=='Et':
-            return CChainR(atoms,i,1,state)
-        if substitution=='i-C3H7' or substitution=='i-Pr' or substitution=='iPr':
-            return CChainR(atoms,i,2,state)
-        if substitution=='t-C4H9' or substitution=='t-Bu' or substitution=='tBu':
-            return CChainR(atoms,i,3,state)
-    elif substitution=='C3H7' or substitution=='n-C3H7' or substitution=='Pr' or substitution=='n-Pr' or substitution=='nPr' or substitution=='C4H9' or substitution=='n-C4H9' or substitution=='nBu' or substitution=='Bu' or substitution=='n-Bu': 
-        if substitution=='C3H7' or substitution=='n-C3H7' or substitution=='n-Pr' or substitution=='nPr' or substitution=='Pr':
-            return CChainL(atoms,i,2,state)
-        if substitution=='C4H9' or substitution=='n-C4H9' or substitution=='n-Bu' or substitution=='nBu' or substitution=='Bu':
-            return CChainL(atoms,i,3,state)
-    elif substitution=='CF3' or substitution=='CCl3' or substitution=='CBr3' or substitution=='CI3':
-        return trihalo(substitution,atoms,i,state)
-    elif substitution=='NO2':
-        return NO2(atoms,i,state)
-    elif substitution=='CHO':
-        return CHO(atoms,i,state)
-    elif substitution=='C=NH':
-        return C2N(atoms,i,state,shuffle)
-    elif substitution=='COCH3' or substitution=='COMe':
-        return COMe(atoms,i,state)
-    elif substitution=='COOH':
-        return COOH(atoms,i,state)
-    elif substitution=='COOMe' or substitution=='COOCH3':
-        return COOMe(atoms,i,state)
-    elif substitution=='CN':
-        return CN(atoms,i,state)
-    elif substitution=='Ph':
-        return Ph(atoms,i,state,shuffle)
-    elif substitution=='Py' or substitution=='pyridine' or substitution=='Pyridine':
-        return Py(atoms,i,state,place,shuffle)
-    elif substitution=='PL' or substitution=='pyrrole' or substitution=='Pyrrole':
-        return Pyrrole(atoms,i,state,place,shuffle)
-    elif substitution=='cycloC3H5' or substitution=='cycloPr' or  substitution=='cyclo3':
-        return ring3(atoms,i,state,strict)
-    elif substitution=='cycloC5H9' or substitution=='cycloPe' or substitution=='cyclo5':
-        return ring5(atoms,i,state,strict,shuffle)
-    elif substitution=='cycloC6H11' or substitution=='cycloHe' or substitution=='cyclo6':
-        return ring6(atoms,i,state,strict,shuffle)
-    elif substitution=='SOMe' or substitution=='SOCH3':
-        return SOMe(atoms,i,state)
-    elif substitution=='SO2Me' or substitution=='SO2CH3':
-        return SO2_('CH3',atoms,i,state)
-    elif substitution=='SO3H':
-        return SO2_('OH',atoms,i,state)
-    elif substitution=='double5' or substitution=='d5' or substitution=='D5' or substitution=='bicyclo[2.2.1]':
-        return D(5,atoms,i,state,shuffle)
-    elif substitution=='double6' or substitution=='d6' or substitution=='D6' or substitution=='bicyclo[2.2.2]':
-        return D(6,atoms,i,state,shuffle)
-    elif substitution=='Bpin':
-        return Bpin(atoms,i,state,shuffle)
+    if substitution in ('H','F','Cl','Br','I'):
+        return Halogen(substitution, atoms, i, state)
+    elif substitution == 'OH':
+        return OH(atoms, i, state, angle)
+    elif substitution in ('OMe', 'OCH3'):
+        return OMe(atoms, i, state, angle)
+    elif substitution == 'SH':
+        return SH(atoms, i, state, angle)
+    elif substitution == ('SMe', 'SCH3'):
+        return SMe(atoms, i, state, angle)
+    elif substitution == 'NH2':
+        return NH2(atoms, i, state)
+    elif substitution == ('NMe2', 'N(CH3)2'):
+        return NMe2(atoms, i, state)
+    elif substitution == ('CH3', 'Me'):
+        return CH3(atoms, i, state)
+    elif substitution == 'C2H3':
+        return C2H3(atoms, i, state, shuffle)
+    elif substitution in ('C2H5', 'Et', 'i-C3H7', 'i-Pr',\
+                          'iPr', 't-C4H9', 't-Bu', 'tBu'):
+        if substitution in ('C2H5', 'Et'):
+            return CChainR(atoms, i, 1, state)
+        if substitution in ('i-C3H7', 'i-Pr', 'iPr'):
+            return CChainR(atoms, i, 2, state)
+        if substitution in ('t-C4H9', 't-Bu', 'tBu'):
+            return CChainR(atoms, i, 3, state)
+    elif substitution in ('C3H7', 'n-C3H7', 'Pr', 'n-Pr', 'nPr',\
+                          'C4H9', 'n-C4H9', 'nBu', 'Bu', 'n-Bu'): 
+        if substitution in ('C3H7', 'n-C3H7', 'n-Pr', 'nPr', 'Pr'):
+            return CChainL(atoms, i, 2, state)
+        if substitution in ('C4H9', 'n-C4H9', 'n-Bu', 'nBu', 'Bu'):
+            return CChainL(atoms, i, 3, state)
+    elif substitution in ('CF3', 'CCl3', 'CBr3', 'CI3'):
+        return trihalo(substitution, atoms, i, state)
+    elif substitution == 'NO2':
+        return NO2(atoms, i, state)
+    elif substitution == 'CHO':
+        return CHO(atoms, i, state)
+    elif substitution == 'C=NH':
+        return C2N(atoms, i, state, shuffle)
+    elif substitution in ('COCH3', 'COMe'):
+        return COMe(atoms, i, state)
+    elif substitution == 'COOH':
+        return COOH(atoms, i, state)
+    elif substitution in ('COOMe', 'COOCH3'):
+        return COOMe(atoms, i, state)
+    elif substitution == 'CN':
+        return CN(atoms, i, state)
+    elif substitution == 'Ph':
+        return Ph(atoms, i, state, shuffle)
+    elif substitution in ('Py', 'pyridine', 'Pyridine'):
+        return Py(atoms, i, state, place, shuffle)
+    elif substitution in ('PL', 'pyrrole', 'Pyrrole'):
+        return Pyrrole(atoms, i, state, place, shuffle)
+    elif substitution in ('cycloC3H5', 'cycloPr', 'cyclo3'):
+        return ring3(atoms, i, state, strict)
+    elif substitution in ('cycloC5H9', 'cycloPe', 'cyclo5'):
+        return ring5(atoms, i, state, strict, shuffle)
+    elif substitution in ('cycloC6H11', 'cycloHe', 'cyclo6'):
+        return ring6(atoms, i, state, strict, shuffle)
+    elif substitution in ('SOMe', 'SOCH3'):
+        return SOMe(atoms, i, state)
+    elif substitution in ('SO2Me', 'SO2CH3'):
+        return SO2_('CH3', atoms, i, state)
+    elif substitution == 'SO3H':
+        return SO2_('OH', atoms, i, state)
+    elif substitution in ('double5', 'd5', 'D5', 'bicyclo[2.2.1]'):
+        return D(5, atoms, i, state, shuffle)
+    elif substitution in ('double6', 'd6', 'D6', 'bicyclo[2.2.2]'):
+        return D(6, atoms, i, state, shuffle)
+    elif substitution == 'Bpin':
+        return Bpin(atoms, i, state, shuffle)
     else:
         assert 'Error! No such substitution!'
     
-def Halogen(substitution,atoms,i,state=1):
-    elements=atoms.get_chemical_symbols()
-    elements[i]=substitution
+def Halogen(substitution, atoms, i, state=1):
+    elements = atoms.get_chemical_symbols()
+    elements[i] = substitution
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    if state==1:
-        if substitution=='F':
-            atoms.set_distance(i,Cnear,1.3605,fix=1)
-        elif substitution=='Cl':
-            atoms.set_distance(i,Cnear,1.781,fix=1)
-        elif substitution=='Br':
-            atoms.set_distance(i,Cnear,1.945,fix=1)
-        elif substitution=='I':
-            atoms.set_distance(i,Cnear,2.190,fix=1)
+    Cnear = near(i, atoms)
+    if state == 1:
+        if substitution == 'F':
+            atoms.set_distance(i, Cnear, 1.3605, fix=1)
+        elif substitution == 'Cl':
+            atoms.set_distance(i, Cnear, 1.781, fix=1)
+        elif substitution == 'Br':
+            atoms.set_distance(i, Cnear, 1.945, fix=1)
+        elif substitution == 'I':
+            atoms.set_distance(i, Cnear, 2.210, fix=1)
         return atoms
-    elif state==2 or state==6:
-        if substitution=='F':
-            if state==6:
-                atoms.set_distance(i,Cnear,1.354,fix=1)
-            if state==2:
-                atoms.set_distance(i,Cnear,1.340,fix=1)
-        elif substitution=='Cl':
-            atoms.set_distance(i,Cnear,1.725,fix=1)
-        elif substitution=='Br':
-            atoms.set_distance(i,Cnear,1.870,fix=1)
-        elif substitution=='I':
-            atoms.set_distance(i,Cnear,2.080,fix=1)
+    elif state == 2 or state == 6:
+        if substitution == 'F':
+            if state == 6:
+                atoms.set_distance(i, Cnear, 1.354, fix=1)
+            if state == 2:
+                atoms.set_distance(i, Cnear, 1.340, fix=1)
+        elif substitution == 'Cl':
+            atoms.set_distance(i, Cnear, 1.725, fix=1)
+        elif substitution == 'Br':
+            atoms.set_distance(i, Cnear, 1.870, fix=1)
+        elif substitution == 'I':
+            atoms.set_distance(i, Cnear, 2.080, fix=1)
         return atoms
 
-def OH(atoms,i,state=1,angle=-1):
+def OH(atoms, i, state=1, angle=-1):
     atoms.append('H')
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-1)+[1]
-    x=atoms.get_positions()
-    x[-1][0]=x[-1][0]+50
-    x[-1][1]=x[-1][1]+50
-    x[-1][2]=x[-1][2]+50
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-1) + [1]
+    x = atoms.get_positions()
+    x[-1][0] = x[-1][0] + 50
+    x[-1][1] = x[-1][1] + 50
+    x[-1][2] = x[-1][2] + 50
     atoms.set_positions(x)
-    elements=atoms.get_chemical_symbols()
-    elements[i]='O'
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'O'
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    CnearC=near(Cnear,atoms,'C')
-    if state==1:
-        atoms.set_distance(i,Cnear,1.410,fix=1)
-    elif state==2 or state==6:
-        atoms.set_distance(i,Cnear,1.364,fix=1)
-    elif state==4:
-        atoms.set_distance(i,Cnear,1.327,fix=1)
-    elif state==164:
-        atoms.set_distance(i,Cnear,1.670,fix=1)
+    Cnear = near(i,  atoms)
+    CnearC = near(Cnear, atoms, 'C')
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.410, fix=1)
+    elif state == 2 or state == 6:
+        atoms.set_distance(i, Cnear, 1.364, fix=1)
+    elif state == 4:
+        atoms.set_distance(i, Cnear, 1.327, fix=1)
+    elif state == 164:
+        atoms.set_distance(i, Cnear, 1.670, fix=1)
     else:
-        atoms.set_distance(i,Cnear,1.410,fix=1)
-    atoms.set_distance(total_atoms-1,i,0.945,fix=1)
-    atoms.set_angle(Cnear,i,total_atoms-1,103.5)
-    if angle>0:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-1,angle,mask=mask)
-    if state==2 or state==6:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-1,5)
-    return atoms
-
-def OMe(atoms,i,state=1,angle=-1):
-    Cnear=near(i, atoms)
-    CnearC=near(Cnear,atoms,'C')
-    total_atoms=len(atoms)
-    atoms=OH(atoms,i,state,angle)
-    total_atoms=len(atoms)
-    atoms=CH3(atoms,total_atoms-1,8)
-    #print(Cnear,CnearC)
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-4)+[1]*4
+        atoms.set_distance(i, Cnear, 1.410, fix=1)
+    atoms.set_distance(total_atoms-1, i, 0.945, fix=1)
+    atoms.set_angle(Cnear, i, total_atoms-1, 103.5)
+    if angle > 0:
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-1, angle, mask=mask)
+    if state == 2 or state == 6:
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-1, 5)
+    return atoms
+
+def OMe(atoms, i, state=1, angle=-1):
+    Cnear = near(i,  atoms)
+    CnearC = near(Cnear, atoms, 'C')
+    total_atoms = len(atoms)
+    atoms = OH(atoms, i, state, angle)
+    total_atoms = len(atoms)
+    atoms = CH3(atoms, total_atoms-1, 8)
+    #print(Cnear, CnearC)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-4) + [1]*4
     angle=0
-    atoms.set_distance(i,total_atoms-1,2,mask=mask)
-    atoms.set_dihedral(CnearC,Cnear,i,total_atoms-4,105,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-4,total_atoms-1,88,mask=mask)
-    mask[-3:]=[0,0,0]
-    atoms.set_distance(i,total_atoms-4,1.43)
+    atoms.set_distance(i, total_atoms-1, 2, mask=mask)
+    atoms.set_dihedral(CnearC, Cnear, i, total_atoms-4, 105, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-4, total_atoms-1, 88, mask=mask)
+    mask[-3:] = [0, 0, 0]
+    atoms.set_distance(i, total_atoms-4, 1.43)
     return atoms
 
-def SH(atoms,i,state=1,angle=-1):
+def SH(atoms, i, state=1, angle=-1):
     atoms.append('H')
-    total_atoms=len(atoms)
-    x=atoms.get_positions()
-    x[-1][0]=x[-1][0]+50
-    x[-1][1]=x[-1][1]+50
-    x[-1][2]=x[-1][2]+50
+    total_atoms = len(atoms)
+    x = atoms.get_positions()
+    x[-1][0] = x[-1][0] + 50
+    x[-1][1] = x[-1][1] + 50
+    x[-1][2] = x[-1][2] + 50
     atoms.set_positions(x)
-    elements=atoms.get_chemical_symbols()
-    elements[i]='S'
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'S'
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    CnearC=near(Cnear,atoms,'C')
-    if state==16:
-        atoms.set_distance(i,Cnear,2.057,fix=1)
+    Cnear = near(i,  atoms)
+    CnearC = near(Cnear, atoms, 'C')
+    if state == 16:
+        atoms.set_distance(i, Cnear, 2.057, fix=1)
     else:
-        atoms.set_distance(i,Cnear,1.810,fix=1)
-    atoms.set_angle(Cnear,i,total_atoms-1,101.5)
-    if angle>0:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-1,angle)
-    atoms.set_distance(total_atoms-1,i,1.336,fix=1)
+        atoms.set_distance(i, Cnear, 1.810, fix=1)
+    atoms.set_angle(Cnear, i, total_atoms-1, 101.5)
+    if angle > 0:
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-1, angle)
+    atoms.set_distance(total_atoms-1, i, 1.336, fix=1)
+    return atoms
+
+def SMe(atoms, i, state=1, angle=-1):
+    Cnear = near(i,  atoms)
+    CnearC = near(Cnear, atoms, 'C')
+    atoms = SH(atoms, i, state, angle)
+    total_atoms = len(atoms)
+    atoms = CH3(atoms, total_atoms-1, 16)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-4) + [1]*4
+    angle = 0
+    atoms.set_dihedral(CnearC, Cnear, i, total_atoms-4, 105, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-4, total_atoms-1, 88, mask=mask)
+    mask[-3:] = [0, 0, 0]
+    atoms.set_distance(i, total_atoms-4, 1.82)
     return atoms
 
-def SMe(atoms,i,state=1,angle=-1):
-    Cnear=near(i, atoms)
-    CnearC=near(Cnear,atoms,'C')
-    atoms=SH(atoms,i,state,angle)
-    total_atoms=len(atoms)
-    atoms=CH3(atoms,total_atoms-1,16)
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-4)+[1]*4
-    angle=0
-    atoms.set_dihedral(CnearC,Cnear,i,total_atoms-4,105,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-4,total_atoms-1,88,mask=mask)
-    mask[-3:]=[0,0,0]
-    atoms.set_distance(i,total_atoms-4,1.82)
-    return atoms
-
-def NH2(atoms,i,state=1):
+def NH2(atoms, i, state=1):
     atoms.append('H')
     atoms.append('H')
-    total_atoms=len(atoms)
-    x=atoms.get_positions()
-    x[-2][0]=x[-2][0]+50
-    x[-2][1]=x[-2][1]+50
-    x[-2][2]=x[-2][2]+50
-    x[-1][0]=x[-1][0]-50
-    x[-1][1]=x[-1][1]-50
-    x[-1][2]=x[-1][2]-50
+    total_atoms = len(atoms)
+    x = atoms.get_positions()
+    x[-2][0] = x[-2][0] + 50
+    x[-2][1] = x[-2][1] + 50
+    x[-2][2] = x[-2][2] + 50
+    x[-1][0] = x[-1][0] - 50
+    x[-1][1] = x[-1][1] - 50
+    x[-1][2] = x[-1][2] - 50
     atoms.set_positions(x)
-    elements=atoms.get_chemical_symbols()
-    elements[i]='N'
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'N'
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    CnearC=near(Cnear,atoms,'C')
-    mask=[0]*(total_atoms-2)+[1]*2
-    if state==1:
-        atoms.set_distance(i,Cnear,1.448,fix=1)
-    elif state==2 or state==6:
-        atoms.set_distance(i,Cnear,1.340,fix=1)
+    Cnear = near(i,  atoms)
+    CnearC = near(Cnear, atoms, 'C')
+    mask = [0]*(total_atoms-2) + [1]*2
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.448, fix=1)
+    elif state == 2 or state == 6:
+        atoms.set_distance(i, Cnear, 1.340, fix=1)
     else:
-        atoms.set_distance(i,Cnear,1.448,fix=1)
-    atoms.set_distance(total_atoms-2,i,1.0100,fix=1)
-    atoms.set_angle(Cnear,i,total_atoms-2,110.5)
-    if state==1:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-2,70,mask=mask)
-    elif state==2 or state==6:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-2,-175,mask=mask)
-    mask[-2]=0
-    atoms.set_angle(total_atoms-2,i,total_atoms-1,110.5)
-    atoms.set_distance(total_atoms-1,i,1.0100,fix=1)
-    atoms.set_angle(Cnear,i,total_atoms-1,110.5)
-    if state==1:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-1,179,mask=mask)
-    elif state==2 or state==6:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-1,70,mask=mask)
+        atoms.set_distance(i, Cnear, 1.448, fix=1)
+    atoms.set_distance(total_atoms-2, i, 1.0100, fix=1)
+    atoms.set_angle(Cnear, i, total_atoms-2, 110.5)
+    if state == 1:
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-2, 70, mask=mask)
+    elif state == 2 or state == 6:
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-2, -175, mask=mask)
+    mask[-2] = 0
+    atoms.set_angle(total_atoms-2, i, total_atoms-1, 110.5)
+    atoms.set_distance(total_atoms-1, i, 1.0100, fix=1)
+    atoms.set_angle(Cnear, i, total_atoms-1, 110.5)
+    if state == 1:
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-1, 179, mask=mask)
+    elif state == 2 or state == 6:
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-1, 70, mask=mask)
     #print(atoms.get_positions())
     return atoms
 
-def NMe2(atoms,i):
-    Cnear=near(i, atoms)
-    CnearC=near(Cnear,atoms,'C')
-    atoms=NH2(atoms,i)
-    total_atoms=len(atoms)
-    atomA=total_atoms-2
-    atomB=total_atoms-1
-    mask=[0]*total_atoms
-    mask[atomA]=1
-    atoms.set_distance(i,atomA,1.448,fix=1,mask=mask)
-    mask[atomA]=0
-    atoms=CH3(atoms,atomA,7)
-    total_atoms=len(atoms)
-    mask=[0]*total_atoms
-    mask[atomB]=1
-    atoms.set_distance(i,atomB,1.448,fix=1,mask=mask)
-    mask[atomB]=0
-    atoms=CH3(atoms,atomB,7)
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-8)+[1]*8
-    atoms.set_dihedral(CnearC,Cnear,i,total_atoms-8,95,mask=mask)
+def NMe2(atoms, i):
+    Cnear = near(i, atoms)
+    CnearC = near(Cnear, atoms, 'C')
+    atoms = NH2(atoms, i)
+    total_atoms = len(atoms)
+    atomA = total_atoms-2
+    atomB = total_atoms-1
+    mask = [0] * total_atoms
+    mask[atomA] = 1
+    atoms.set_distance(i, atomA, 1.448, fix=1, mask=mask)
+    mask[atomA] = 0
+    atoms = CH3(atoms, atomA, 7)
+    total_atoms = len(atoms)
+    mask = [0] * total_atoms
+    mask[atomB] = 1
+    atoms.set_distance(i, atomB, 1.448, fix=1, mask=mask)
+    mask[atomB] = 0
+    atoms = CH3(atoms, atomB, 7)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-8) + [1]*8
+    atoms.set_dihedral(CnearC, Cnear, i, total_atoms-8, 95, mask=mask)
     return atoms
 
-def C2H3(atoms,i,state=1,shuffle=0):
+def C2H3(atoms, i, state=1, shuffle=0):
     atoms.append('H')
     atoms.append('C')
     atoms.append('H')
     atoms.append('H')
-    Cnear=near(i, atoms)
-    total_atoms=len(atoms)
-    elements=atoms.get_chemical_symbols()
-    elements[i]='C'
-    if state==1:
-        atoms.set_distance(i,Cnear,1.5095,fix=1)
-    elif state==2:
-        atoms.set_distance(i,Cnear,1.4600,fix=1)
-    elif state==6:
-        atoms.set_distance(i,Cnear,1.4330,fix=1)
-    elif state==82:
-        atoms.set_distance(i,Cnear,1.4440,fix=1)
-    elif state==162:
-        atoms.set_distance(i,Cnear,1.7700,fix=1)
-    elif state==164:
-        atoms.set_distance(i,Cnear,1.7600,fix=1)
+    Cnear = near(i,  atoms)
+    total_atoms = len(atoms)
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'C'
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.5095, fix=1)
+    elif state == 2:
+        atoms.set_distance(i, Cnear, 1.4600, fix=1)
+    elif state == 6:
+        atoms.set_distance(i, Cnear, 1.4330, fix=1)
+    elif state == 82:
+        atoms.set_distance(i, Cnear, 1.4440, fix=1)
+    elif state == 162:
+        atoms.set_distance(i, Cnear, 1.7700, fix=1)
+    elif state == 164:
+        atoms.set_distance(i, Cnear, 1.7600, fix=1)
     else:
-        atoms.set_distance(i,Cnear,1.5095,fix=1)
-    CnearH=near(Cnear,atoms,'H',ignore=[Cnear,i])
+        atoms.set_distance(i, Cnear, 1.5095, fix=1)
+    CnearH = near(Cnear, atoms, 'H', ignore=[Cnear, i])
     #print(CnearH)
     atoms.set_chemical_symbols(elements)
-    mask=[0]*(total_atoms-4)+[1]*4
-    x=atoms.get_positions()
-    x[-4][0]=x[-4][0]+50
-    x[-4][1]=x[-4][1]+50
-    x[-4][2]=x[-4][2]+50
-    for j in range(-3,0):
-        x[j][0]=x[j][0]-50
-        x[j][1]=x[j][1]-50
-        x[j][2]=x[j][2]-50
+    mask = [0]*(total_atoms-4) + [1]*4
+    x = atoms.get_positions()
+    x[-4][0] = x[-4][0] + 50
+    x[-4][1] = x[-4][1] + 50
+    x[-4][2] = x[-4][2] + 50
+    for j in range(-3, 0):
+        x[j][0] = x[j][0] - 50
+        x[j][1] = x[j][1] - 50
+        x[j][2] = x[j][2] - 50
     atoms.set_positions(x)
-    atoms.set_angle(Cnear,i,total_atoms-4,120,mask=mask)
-    atoms.set_distance(total_atoms-4,i,1.0800,fix=1,mask=mask)
-    if shuffle==1:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-4,5.0,mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-4, 120, mask=mask)
+    atoms.set_distance(total_atoms-4, i, 1.0800, fix=1, mask=mask)
+    if shuffle == 1:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-4, 5.0, mask=mask)
     else:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-4,-175.0,mask=mask)
-    mask[-4]=0
-    atoms.set_angle(Cnear,i,total_atoms-3,120,mask=mask)
-    atoms.set_distance(total_atoms-3,i,1.3400,fix=1,mask=mask)
-    if shuffle==1:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-3,-175.0,mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-4, -175.0, mask=mask)
+    mask[-4] = 0
+    atoms.set_angle(Cnear, i, total_atoms-3, 120, mask=mask)
+    atoms.set_distance(total_atoms-3, i, 1.3400, fix=1, mask=mask)
+    if shuffle == 1:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-3, -175.0, mask=mask)
     else:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-3,5.0,mask=mask)
-    mask[-3]=0
-    atoms.set_angle(i,total_atoms-3,total_atoms-2,120,mask=mask)
-    atoms.set_distance(total_atoms-2,total_atoms-3,1.0800,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-3,total_atoms-2,0.5,mask=mask)
-    mask[-2]=0
-    atoms.set_angle(i,total_atoms-3,total_atoms-1,120,mask=mask)
-    atoms.set_distance(total_atoms-1,total_atoms-3,1.0800,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-3,total_atoms-1,-179.5,mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-3, 5.0, mask=mask)
+    mask[-3] = 0
+    atoms.set_angle(i, total_atoms-3, total_atoms-2, 120, mask=mask)
+    atoms.set_distance(total_atoms-2, total_atoms-3, 1.0800, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-3, total_atoms-2, 0.5, mask=mask)
+    mask[-2] = 0
+    atoms.set_angle(i, total_atoms-3, total_atoms-1, 120, mask=mask)
+    atoms.set_distance(total_atoms-1, total_atoms-3, 1.0800, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-3, total_atoms-1, -179.5, mask=mask)
     return atoms
 
-def CH3(atoms,i,state=1,ring=False):
+def CH3(atoms, i, state=1, ring=False):
     atoms.append('H')
     atoms.append('H')
     atoms.append('H')
-    Cnear=near(i, atoms)
-    CnearC=near(Cnear,atoms,'C')
-    total_atoms=len(atoms)
-    elements=atoms.get_chemical_symbols()
-    elements[i]='C'
-    if state==1:
-        atoms.set_distance(i,Cnear,1.5290,fix=1)
-    elif state==2:
-        atoms.set_distance(i,Cnear,1.5095,fix=1)
-    elif state==3:
-        atoms.set_distance(i,Cnear,1.4700,fix=1)
-    elif state==6:
-        atoms.set_distance(i,Cnear,1.5105,fix=1)
-    elif state==7:
-        atoms.set_distance(i,Cnear,1.4480,fix=1)
-    elif state==8:
-        atoms.set_distance(i,Cnear,1.4100,fix=1)
-    elif state==82:
-        atoms.set_distance(i,Cnear,1.5220,fix=1)
-    elif state==16:
-        atoms.set_distance(i,Cnear,1.8100,fix=1)
-    elif state==162:
-        atoms.set_distance(i,Cnear,1.7900,fix=1)
-    elif state==164:
-        atoms.set_distance(i,Cnear,1.7700,fix=1)
+    Cnear = near(i,  atoms)
+    CnearC = near(Cnear, atoms, 'C')
+    total_atoms = len(atoms)
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'C'
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.5290, fix=1)
+    elif state == 2:
+        atoms.set_distance(i, Cnear, 1.5095, fix=1)
+    elif state == 3:
+        atoms.set_distance(i, Cnear, 1.4700, fix=1)
+    elif state == 6:
+        atoms.set_distance(i, Cnear, 1.5105, fix=1)
+    elif state == 7:
+        atoms.set_distance(i, Cnear, 1.4480, fix=1)
+    elif state == 8:
+        atoms.set_distance(i, Cnear, 1.4100, fix=1)
+    elif state == 82:
+        atoms.set_distance(i, Cnear, 1.5220, fix=1)
+    elif state == 16:
+        atoms.set_distance(i, Cnear, 1.8100, fix=1)
+    elif state == 162:
+        atoms.set_distance(i, Cnear, 1.7900, fix=1)
+    elif state == 164:
+        atoms.set_distance(i, Cnear, 1.7700, fix=1)
     else:
-        atoms.set_distance(i,Cnear,1.5290,fix=1)
+        atoms.set_distance(i, Cnear, 1.5290, fix=1)
     atoms.set_chemical_symbols(elements)
-    mask=[0]*(total_atoms-3)+[1]*3
-    x=atoms.get_positions()
-    x[-3][0]=x[-3][0]-50
-    x[-3][1]=x[-3][1]-50
-    x[-3][2]=x[-3][2]-50
-    x[-2][0]=x[-2][0]-50
-    x[-2][1]=x[-2][1]-50
-    x[-2][2]=x[-2][2]-50
+    mask = [0]*(total_atoms-3) + [1]*3
+    x = atoms.get_positions()
+    x[-3][0] = x[-3][0] - 50
+    x[-3][1] = x[-3][1] - 50
+    x[-3][2] = x[-3][2] - 50
+    x[-2][0] = x[-2][0] - 50
+    x[-2][1] = x[-2][1] - 50
+    x[-2][2] = x[-2][2] - 50
     atoms.set_positions(x)
-    atoms.set_angle(Cnear,i,total_atoms-3,109.5,mask=mask)
-    atoms.set_distance(total_atoms-3,i,1.0900,fix=1,mask=mask)
-    atoms.set_angle(Cnear,i,total_atoms-3,109.5,mask=mask)
-    if ring==True:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-3,120,mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-3, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-3, i, 1.0900, fix=1, mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-3, 109.5, mask=mask)
+    if ring == True:
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-3, 120, mask=mask)
     else:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-3,179,mask=mask)
-    mask[-3]=0
-    atoms.set_angle(total_atoms-3,i,total_atoms-2,104.5,mask=mask)
-    atoms.set_angle(Cnear,i,total_atoms-2,109.5,mask=mask)
-    atoms.set_distance(total_atoms-2,i,1.0900,fix=1,mask=mask)
-    atoms.set_angle(Cnear,i,total_atoms-2,109.5,mask=mask)
-    if ring==True:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-2,0.5,mask=mask)
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-3, 179, mask=mask)
+    mask[-3] = 0
+    atoms.set_angle(total_atoms-3, i, total_atoms-2, 104.5, mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-2, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-2, i, 1.0900, fix=1, mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-2, 109.5, mask=mask)
+    if ring == True:
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-2, 0.5, mask=mask)
     else:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-2,59,mask=mask)
-    mask[-2]=0
-    x=atoms.get_positions()
-    x[-1][0]=x[-1][0]+50
-    x[-1][1]=x[-1][1]+50
-    x[-1][2]=x[-1][2]+50
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-2, 59, mask=mask)
+    mask[-2] = 0
+    x = atoms.get_positions()
+    x[-1][0] = x[-1][0] + 50
+    x[-1][1] = x[-1][1] + 50
+    x[-1][2] = x[-1][2] + 50
     atoms.set_positions(x)
-    atoms.set_angle(Cnear,i,total_atoms-1,109.5,mask=mask)
-    atoms.set_angle(total_atoms-3,i,total_atoms-1,109.5,mask=mask)
-    atoms.set_distance(total_atoms-1,i,1.0900,fix=1,mask=mask)
-    atoms.set_angle(Cnear,i,total_atoms-1,109.5,mask=mask)
-    if ring==True:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-1,-120,mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-1, 109.5, mask=mask)
+    atoms.set_angle(total_atoms-3, i, total_atoms-1, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-1, i, 1.0900, fix=1, mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-1, 109.5, mask=mask)
+    if ring == True:
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-1, -120, mask=mask)
     else:
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-1,-60,mask=mask)
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-1, -60, mask=mask)
     return atoms
 
-def CChainL(atoms,i,chain,state=1):
-    Cnear=near(i, atoms)
-    CnearC=near(Cnear,atoms,'C')
-    atoms=CH3(atoms,i,state)
+def CChainL(atoms, i, chain, state=1):
+    Cnear = near(i,  atoms)
+    CnearC = near(Cnear, atoms, 'C')
+    atoms = CH3(atoms, i, state)
     for i in range(chain):
-        total_atoms=len(atoms)
-        mask=[0]*total_atoms
-        total_atoms=len(atoms)
-        atom=total_atoms-2
-        mask[atom]=1
-        atoms.set_distance(i,atom,1.5290,fix=1,mask=mask)
-        mask[atom]=0
-        atoms=CH3(atoms,atom)
+        total_atoms = len(atoms)
+        mask = [0] * total_atoms
+        total_atoms = len(atoms)
+        atom = total_atoms - 2
+        mask[atom] = 1
+        atoms.set_distance(i, atom, 1.5290, fix=1, mask=mask)
+        mask[atom] = 0
+        atoms = CH3(atoms, atom)
     return atoms
 
-def CChainR(atoms,i,chain,state=1):
-    Cnear=near(i, atoms)
-    CnearC=near(Cnear,atoms,'C')
-    atoms=CH3(atoms,i,state)
+def CChainR(atoms, i, chain, state=1):
+    Cnear = near(i,  atoms)
+    CnearC = near(Cnear, atoms, 'C')
+    atoms = CH3(atoms, i, state)
     #view(atoms)
-    total_atoms=len(atoms)
-    atomA=total_atoms-3
-    atomB=total_atoms-2
-    atomC=total_atoms-1
-    mask=[0]*total_atoms
-    if chain>=1:
-        mask[atomB]=1
-        atoms.set_distance(i,atomB,1.5290,fix=1,mask=mask)
-        mask[atomB]=0
-        atoms=CH3(atoms,atomB)
-        if chain>=2:
-            total_atoms=len(atoms)
-            mask=[0]*total_atoms
-            mask[atomC]=1
-            atoms.set_distance(i,atomC,1.5290,fix=1,mask=mask)
-            mask[atomC]=0
-            atoms=CH3(atoms,atomC)
-            if chain==3:
-                total_atoms=len(atoms)
-                mask=[0]*total_atoms
-                mask[atomA]=1
-                atoms.set_distance(i,atomA,1.5290,fix=1,mask=mask)
-                mask[atomA]=0
-                atoms=CH3(atoms,atomA)
-    total_atoms=len(atoms)
-    mask=[0]*total_atoms
-    if chain==1:
+    total_atoms = len(atoms)
+    atomA = total_atoms - 3
+    atomB = total_atoms - 2
+    atomC = total_atoms - 1
+    mask = [0] * total_atoms
+    if chain >= 1:
+        mask[atomB] = 1
+        atoms.set_distance(i, atomB, 1.5290, fix=1, mask=mask)
+        mask[atomB] = 0
+        atoms = CH3(atoms, atomB)
+        if chain >= 2:
+            total_atoms = len(atoms)
+            mask = [0] * total_atoms
+            mask[atomC] = 1
+            atoms.set_distance(i, atomC, 1.5290, fix=1, mask=mask)
+            mask[atomC] = 0
+            atoms = CH3(atoms, atomC)
+            if chain == 3:
+                total_atoms = len(atoms)
+                mask = [0] * total_atoms
+                mask[atomA] = 1
+                atoms.set_distance(i, atomA, 1.5290, fix=1, mask=mask)
+                mask[atomA] = 0
+                atoms = CH3(atoms, atomA)
+    total_atoms = len(atoms)
+    mask = [0] * total_atoms
+    if chain == 1:
         mask[-6:]=[1]*6
-        atoms.set_dihedral(CnearC,Cnear,i,atomB,110,mask=mask)
-    if chain==2:
+        atoms.set_dihedral(CnearC, Cnear, i, atomB, 110, mask=mask)
+    if chain == 2:
         mask[-9:]=[1]*9
-        atoms.set_dihedral(CnearC,Cnear,i,atomB,95,mask=mask)
+        atoms.set_dihedral(CnearC, Cnear, i, atomB, 95, mask=mask)
     return atoms
 
-def trihalo(substitution,atoms,i,state=1):
+def trihalo(substitution, atoms, i, state=1):
     import re
-    atoms=CH3(atoms,i,state)
-    halo=re.search(r'[A-Z]+[a-z]*',substitution)
-    for i in range(-3,0):
-        Halogen(halo.group(0)[1:],atoms,i)
+    atoms = CH3(atoms, i, state)
+    halo=re.search(r'[A-Z]+[a-z]*', substitution)
+    for i in range(-3, 0):
+        Halogen(halo.group(0)[1:], atoms, i)
     return atoms
 
-def NO2(atoms,i,state=1):
+def NO2(atoms, i, state=1):
     atoms.append('O')
     atoms.append('O')
-    total_atoms=len(atoms)
-    elements=atoms.get_chemical_symbols()
-    elements[i]='N'
+    total_atoms = len(atoms)
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'N'
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    CnearH=near(Cnear,atoms,'H')
-    if state==1:
-        atoms.set_distance(i,Cnear,1.4900,fix=1)
-    elif state==6:
-        atoms.set_distance(i,Cnear,1.4600,fix=1)
-    atoms.set_dihedral(CnearH,Cnear,i,total_atoms-2,-175.0,mask=mask)
-    atoms.set_distance(total_atoms-2,i,1.2250,fix=1)
-    atoms.set_angle(Cnear,i,total_atoms-2,119.5)
-    atoms.set_angle(total_atoms-2,i,total_atoms-1,119.5)
-    atoms.set_distance(total_atoms-1,i,1.2250,fix=1)
-    atoms.set_angle(Cnear,i,total_atoms-1,120.5)
+    Cnear = near(i,  atoms)
+    CnearH = near(Cnear, atoms, 'H')
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.4900, fix=1)
+    elif state == 6:
+        atoms.set_distance(i, Cnear, 1.4600, fix=1)
+    atoms.set_dihedral(CnearH, Cnear, i, total_atoms-2, -175.0, mask=mask)
+    atoms.set_distance(total_atoms-2, i, 1.2250, fix=1)
+    atoms.set_angle(Cnear, i, total_atoms-2, 119.5)
+    atoms.set_angle(total_atoms-2, i, total_atoms-1, 119.5)
+    atoms.set_distance(total_atoms-1, i, 1.2250, fix=1)
+    atoms.set_angle(Cnear, i, total_atoms-1, 120.5)
     #print(atoms.get_positions())
     return atoms
 
-def CHO(atoms,i,state=1):
+def CHO(atoms, i, state=1):
     atoms.append('O')
     atoms.append('H')
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-2)+[1]*2
-    elements=atoms.get_chemical_symbols()
-    elements[i]='C'
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-2) + [1]*2
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'C'
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    CnearH=near(Cnear,atoms,'H')
-    if state==1:
-        atoms.set_distance(i,Cnear,1.5220,fix=1)
-    elif state==2:
-        atoms.set_distance(i,Cnear,1.4440,fix=1)
-    elif state==6:
-        atoms.set_distance(i,Cnear,1.4900,fix=1)
-    elif state==7:
-        atoms.set_distance(i,Cnear,1.3350,fix=1)
-    elif state==8:
-        atoms.set_distance(i,Cnear,1.3640,fix=1)
-    elif state==82:
-        atoms.set_distance(i,Cnear,1.5100,fix=1)
-    x=atoms.get_positions()
+    Cnear = near(i,  atoms)
+    CnearH = near(Cnear, atoms, 'H')
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.5220, fix=1)
+    elif state == 2:
+        atoms.set_distance(i, Cnear, 1.4440, fix=1)
+    elif state == 6:
+        atoms.set_distance(i, Cnear, 1.4900, fix=1)
+    elif state == 7:
+        atoms.set_distance(i, Cnear, 1.3350, fix=1)
+    elif state == 8:
+        atoms.set_distance(i, Cnear, 1.3640, fix=1)
+    elif state == 82:
+        atoms.set_distance(i, Cnear, 1.5100, fix=1)
+    x = atoms.get_positions()
     #Separate into a side
-    x[-2][0]=x[-2][0]-50
-    x[-2][1]=x[-2][1]-50
-    x[-2][2]=x[-2][2]-50
+    x[-2][0] = x[-2][0] - 50
+    x[-2][1] = x[-2][1] - 50
+    x[-2][2] = x[-2][2] - 50
     atoms.set_positions(x)
-    atoms.set_angle(Cnear,i,total_atoms-2,120.5,mask=mask)
-    atoms.set_distance(total_atoms-2,i,1.2290,fix=1,mask=mask)
-    atoms.set_dihedral(CnearH,Cnear,i,total_atoms-2,55,mask=mask)#
-    mask[-2]=0
-    x=atoms.get_positions()
+    atoms.set_angle(Cnear, i, total_atoms-2, 120.5, mask=mask)
+    atoms.set_distance(total_atoms-2, i, 1.2290, fix=1, mask=mask)
+    atoms.set_dihedral(CnearH, Cnear, i, total_atoms-2, 55, mask=mask)
+    mask[-2] = 0
+    x = atoms.get_positions()
     #Separate into another side
-    x[-1][0]=x[-1][0]+50
-    x[-1][1]=x[-1][1]+50
-    x[-1][2]=x[-1][2]+50
+    x[-1][0] = x[-1][0] + 50
+    x[-1][1] = x[-1][1] + 50
+    x[-1][2] = x[-1][2] + 50
     atoms.set_positions(x)
     for k in range(10):
-        atoms.set_angle(total_atoms-2,i,total_atoms-1,120,mask=mask)
-        atoms.set_angle(Cnear,i,total_atoms-1,120,mask=mask)
-    atoms.set_distance(total_atoms-1,i,1.0900,fix=1,mask=mask)
+        atoms.set_angle(total_atoms-2, i, total_atoms-1, 120, mask=mask)
+        atoms.set_angle(Cnear, i, total_atoms-1, 120, mask=mask)
+    atoms.set_distance(total_atoms-1, i, 1.0900, fix=1, mask=mask)
     return atoms
 
-def C2N(atoms,i,state=1,shuffle=0):
+def C2N(atoms, i, state=1, shuffle=0):
     atoms.append('N')
     atoms.append('H')
     atoms.append('H')
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-3)+[1]*3
-    elements=atoms.get_chemical_symbols()
-    elements[i]='C'
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-3) + [1]*3
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'C'
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    CnearH=near(Cnear,atoms,'H',ignore=[Cnear,i])
-    if state==1:
-        atoms.set_distance(i,Cnear,1.5220,fix=1)
-    elif state==2:
-        atoms.set_distance(i,Cnear,1.4440,fix=1)
-    elif state==6:
-        atoms.set_distance(i,Cnear,1.5220,fix=1)
-    elif state==7:
-        atoms.set_distance(i,Cnear,1.3350,fix=1)
-    elif state==8:
-        atoms.set_distance(i,Cnear,1.3640,fix=1)
-    elif state==82:
-        atoms.set_distance(i,Cnear,1.5100,fix=1)
-    x=atoms.get_positions()
+    Cnear = near(i,  atoms)
+    CnearH = near(Cnear, atoms, 'H', ignore=[Cnear, i])
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.5220, fix=1)
+    elif state == 2:
+        atoms.set_distance(i, Cnear, 1.4440, fix=1)
+    elif state == 6:
+        atoms.set_distance(i, Cnear, 1.5220, fix=1)
+    elif state == 7:
+        atoms.set_distance(i, Cnear, 1.3350, fix=1)
+    elif state == 8:
+        atoms.set_distance(i, Cnear, 1.3640, fix=1)
+    elif state == 82:
+        atoms.set_distance(i, Cnear, 1.5100, fix=1)
+    x = atoms.get_positions()
     #Separate into a side
-    x[-3][0]=x[-3][0]-50
-    x[-3][1]=x[-3][1]-50
-    x[-3][2]=x[-3][2]-50
+    x[-3][0] = x[-3][0] - 50
+    x[-3][1] = x[-3][1] - 50
+    x[-3][2] = x[-3][2] - 50
     atoms.set_positions(x)
-    atoms.set_angle(Cnear,i,total_atoms-3,120.5,mask=mask)
-    atoms.set_distance(total_atoms-3,i,1.3580,fix=1,mask=mask)
-    if shuffle==0:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-3,55,mask=mask)
-    elif shuffle==1:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-3,179.5,mask=mask)
-    mask[-3]=0
-    x=atoms.get_positions()
-    x[-2][0]=x[-2][0]+50
-    x[-2][1]=x[-2][1]+50
-    x[-2][2]=x[-2][2]+50
+    atoms.set_angle(Cnear, i, total_atoms-3, 120.5, mask=mask)
+    atoms.set_distance(total_atoms-3, i, 1.3580, fix=1, mask=mask)
+    if shuffle == 0:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-3, 55, mask=mask)
+    elif shuffle == 1:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-3, 179.5, mask=mask)
+    mask[-3] = 0
+    x = atoms.get_positions()
+    x[-2][0] = x[-2][0] + 50
+    x[-2][1] = x[-2][1] + 50
+    x[-2][2] = x[-2][2] + 50
     atoms.set_positions(x)
-    atoms.set_angle(i,total_atoms-3,total_atoms-2,120.5,mask=mask)
-    atoms.set_distance(total_atoms-2,total_atoms-3,1.0100,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-3,total_atoms-2,179.5,mask=mask)
-    mask[-2]=0
-    x=atoms.get_positions()
+    atoms.set_angle(i, total_atoms-3, total_atoms-2, 120.5, mask=mask)
+    atoms.set_distance(total_atoms-2, total_atoms-3, 1.0100, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-3, total_atoms-2, 179.5, mask=mask)
+    mask[-2] = 0
+    x = atoms.get_positions()
     #Separate into another side
-    x[-1][0]=x[-1][0]+50
-    x[-1][1]=x[-1][1]+50
-    x[-1][2]=x[-1][2]+50
+    x[-1][0] = x[-1][0] + 50
+    x[-1][1] = x[-1][1] + 50
+    x[-1][2] = x[-1][2] + 50
     atoms.set_positions(x)
-    if shuffle==1:
-        atoms.set_dihedral(Cnear,i,total_atoms-3,total_atoms-1,55,mask=mask)
+    if shuffle == 1:
+        atoms.set_dihedral(Cnear, i, total_atoms-3, total_atoms-1, 55, mask=mask)
     for k in range(10):
-        atoms.set_angle(total_atoms-3,i,total_atoms-1,120,mask=mask)
-        atoms.set_angle(Cnear,i,total_atoms-1,120,mask=mask)
-    atoms.set_distance(total_atoms-1,i,1.0100,fix=1,mask=mask)
+        atoms.set_angle(total_atoms-3, i, total_atoms-1, 120, mask=mask)
+        atoms.set_angle(Cnear, i, total_atoms-1, 120, mask=mask)
+    atoms.set_distance(total_atoms-1, i, 1.0100, fix=1, mask=mask)
     return atoms
 
-def COMe(atoms,i,state=1):
-    atoms=CHO(atoms,i,state)
-    total_atoms=len(atoms)
-    atoms=CH3(atoms,total_atoms-1,82)
-    total_atoms=len(atoms)
+def COMe(atoms, i, state=1):
+    atoms = CHO(atoms, i, state)
+    total_atoms = len(atoms)
+    atoms = CH3(atoms, total_atoms-1, 82)
+    total_atoms = len(atoms)
     return atoms
     
-def COOH(atoms,i,state=1):
+def COOH(atoms, i, state=1):
     atoms.append('O')
     atoms.append('O')
     atoms.append('H')
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-3)+[1]*3
-    elements=atoms.get_chemical_symbols()
-    elements[i]='C'
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-3) + [1]*3
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'C'
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    CnearH=near(Cnear,atoms,'H')
-    if state==1:
-        atoms.set_distance(i,Cnear,1.5220,fix=1)
-    elif state==2:
-        atoms.set_distance(i,Cnear,1.4440,fix=1)
-    elif state==6:
-        atoms.set_distance(i,Cnear,1.4900,fix=1)
-    elif state==7:
-        atoms.set_distance(i,Cnear,1.3350,fix=1)
-    elif state==8:
-        atoms.set_distance(i,Cnear,1.3640,fix=1)
-    elif state==82:
-        atoms.set_distance(i,Cnear,1.5095,fix=1)
-    x=atoms.get_positions()
+    Cnear = near(i,  atoms)
+    CnearH = near(Cnear, atoms, 'H')
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.5220, fix=1)
+    elif state == 2:
+        atoms.set_distance(i, Cnear, 1.4440, fix=1)
+    elif state == 6:
+        atoms.set_distance(i, Cnear, 1.4900, fix=1)
+    elif state == 7:
+        atoms.set_distance(i, Cnear, 1.3350, fix=1)
+    elif state == 8:
+        atoms.set_distance(i, Cnear, 1.3640, fix=1)
+    elif state == 82:
+        atoms.set_distance(i, Cnear, 1.5095, fix=1)
+    x = atoms.get_positions()
     #Separate into a side
-    x[-3][0]=x[-3][0]-50
-    x[-3][1]=x[-3][1]-50
-    x[-3][2]=x[-3][2]-50
+    x[-3][0] = x[-3][0] - 50
+    x[-3][1] = x[-3][1] - 50
+    x[-3][2] = x[-3][2] - 50
     atoms.set_positions(x)
-    atoms.set_angle(Cnear,i,total_atoms-3,120.5,mask=mask)
-    atoms.set_distance(total_atoms-3,i,1.3640,fix=1,mask=mask)
-    atoms.set_dihedral(CnearH,Cnear,i,total_atoms-3,10.4,mask=mask)#
-    mask[-3]=0
-    x=atoms.get_positions()
+    atoms.set_angle(Cnear, i, total_atoms-3, 120.5, mask=mask)
+    atoms.set_distance(total_atoms-3, i, 1.3640, fix=1, mask=mask)
+    atoms.set_dihedral(CnearH, Cnear, i, total_atoms-3, 10.4, mask=mask)
+    mask[-3] = 0
+    x = atoms.get_positions()
     #Separate into another side
-    x[-2][0]=x[-2][0]+50
-    x[-2][1]=x[-2][1]+50
-    x[-2][2]=x[-2][2]+50
+    x[-2][0] = x[-2][0] + 50
+    x[-2][1] = x[-2][1] + 50
+    x[-2][2] = x[-2][2] + 50
     atoms.set_positions(x)
     for k in range(10):
-        atoms.set_angle(total_atoms-3,i,total_atoms-2,120,mask=mask)
-        atoms.set_angle(Cnear,i,total_atoms-2,120,mask=mask)
-    atoms.set_distance(total_atoms-2,i,1.2290,fix=1,mask=mask)
-    mask[-2]=0
-    atoms.set_distance(total_atoms-1,total_atoms-3,0.945,fix=1)
-    atoms.set_angle(i,total_atoms-3,total_atoms-1,120.5)
-    atoms.set_dihedral(total_atoms-2,i,total_atoms-3,total_atoms-1,5)
+        atoms.set_angle(total_atoms-3, i, total_atoms-2, 120, mask=mask)
+        atoms.set_angle(Cnear, i, total_atoms-2, 120, mask=mask)
+    atoms.set_distance(total_atoms-2, i, 1.2290, fix=1, mask=mask)
+    mask[-2] = 0
+    atoms.set_distance(total_atoms-1, total_atoms-3, 0.945, fix=1)
+    atoms.set_angle(i, total_atoms-3, total_atoms-1, 120.5)
+    atoms.set_dihedral(total_atoms-2, i, total_atoms-3, total_atoms-1, 5)
     #print(atoms.get_positions())
     #print(atoms.get_chemical_symbols())
     return atoms
 
-def COOMe(atoms,i,state=1):
-    atoms=COOH(atoms,i,state)
-    total_atoms=len(atoms)
-    atoms=CH3(atoms,total_atoms-1,8)
+def COOMe(atoms, i, state=1):
+    atoms = COOH(atoms, i, state)
+    total_atoms = len(atoms)
+    atoms = CH3(atoms, total_atoms-1, 8)
     return atoms
 
-def CN(atoms,i,state=1):
+def CN(atoms, i, state=1):
     atoms.append('N')
-    total_atoms=len(atoms)
-    elements=atoms.get_chemical_symbols()
-    elements[i]='C'
+    total_atoms = len(atoms)
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'C'
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    if state==1:
-        atoms.set_distance(i,Cnear,1.4700,fix=1)
-    elif state==6:
-        atoms.set_distance(i,Cnear,1.4510,fix=1)
-    atoms.set_distance(total_atoms-1,i,1.157,fix=1)
-    atoms.set_angle(Cnear,i,total_atoms-1,179.5)
+    Cnear = near(i,  atoms)
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.4700, fix=1)
+    elif state == 6:
+        atoms.set_distance(i, Cnear, 1.4510, fix=1)
+    atoms.set_distance(total_atoms-1, i, 1.157, fix=1)
+    atoms.set_angle(Cnear, i, total_atoms-1, 179.5)
     #print(atoms.get_positions())
     return atoms
 
-def Ph(atoms,i,state=1,shuffle=0):
+def Ph(atoms, i, state=1, shuffle=0):
     for j in range(5):
         atoms.append('C')
     for j in range(5):
         atoms.append('H')
-    Cnear=near(i, atoms)
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-10)+[1]*10
-    elements=atoms.get_chemical_symbols()
-    elements[i]='C'
+    Cnear = near(i,  atoms)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-10) + [1]*10
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'C'
     atoms.set_chemical_symbols(elements)
-    x=atoms.get_positions()
+    x = atoms.get_positions()
     #Separate into a side
-    for j in range(-10,-8):
-        x[j][0]=x[j][0]-50
-        x[j][1]=x[j][1]-50
-        x[j][2]=x[j][2]-50
-    for j in range(-5,-3):
-        x[j][0]=x[j][0]-50
-        x[j][1]=x[j][1]-50
-        x[j][2]=x[j][2]-50
-    for j in range(-8,-5):
-        x[j][0]=x[j][0]+50
-        x[j][1]=x[j][1]+50
-        x[j][2]=x[j][2]+50
-    for j in range(-3,0):
-        x[j][0]=x[j][0]+50
-        x[j][1]=x[j][1]+50
-        x[j][2]=x[j][2]+50
+    for j in range(-10, -8):
+        x[j][0] = x[j][0] - 50
+        x[j][1] = x[j][1] - 50
+        x[j][2] = x[j][2] - 50
+    for j in range(-5, -3):
+        x[j][0] = x[j][0] - 50
+        x[j][1] = x[j][1] - 50
+        x[j][2] = x[j][2] - 50
+    for j in range(-8, -5):
+        x[j][0] = x[j][0] + 50
+        x[j][1] = x[j][1] + 50
+        x[j][2] = x[j][2] + 50
+    for j in range(-3, 0):
+        x[j][0] = x[j][0] + 50
+        x[j][1] = x[j][1] + 50
+        x[j][2] = x[j][2] + 50
     atoms.set_positions(x)
-    #if shuffle==0:
-    CnearH=near(Cnear,atoms,'H',ignore=[Cnear,i])
-    #elif shuffle==1:
-    #    CnearH=near(Cnear,atoms,'C')
-    #print(Cnear,CnearH)
-    if state==1:
-        atoms.set_distance(i,Cnear,1.5105,fix=1)
-    elif state==2:
-        atoms.set_distance(i,Cnear,1.4330,fix=1)
-    elif state==6:
-        atoms.set_distance(i,Cnear,1.5100,fix=1)
-    elif state==7:
-        atoms.set_distance(i,Cnear,1.3400,fix=1)
-    elif state==8:
-        atoms.set_distance(i,Cnear,1.3640,fix=1)
-    elif state==16:
-        atoms.set_distance(i,Cnear,1.7700,fix=1)
-    elif state==82:
-        atoms.set_distance(i,Cnear,1.4900,fix=1)
-    atoms.set_angle(Cnear,i,total_atoms-10,120,mask=mask)
-    atoms.set_distance(total_atoms-10,i,1.4,fix=1,mask=mask)
-    if shuffle==0:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-10,5.4,mask=mask)
-    elif shuffle==1:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-10,95.4,mask=mask)
-    mask[-10]=0
-    atoms.set_angle(Cnear,i,total_atoms-6,120,mask=mask)
-    atoms.set_distance(total_atoms-6,i,1.4,fix=1,mask=mask)
-    if shuffle==0:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-6,-175.0,mask=mask)
-    elif shuffle==1:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-6,-85.0,mask=mask)
-    mask[-6]=0
-    atoms.set_angle(i,total_atoms-10,total_atoms-9,120,mask=mask)
-    atoms.set_distance(total_atoms-9,total_atoms-10,1.4,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-10,total_atoms-9,179.5,mask=mask)
-    mask[-9]=0
-    atoms.set_angle(i,total_atoms-6,total_atoms-7,120,mask=mask)
-    atoms.set_distance(total_atoms-7,total_atoms-6,1.4,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-6,total_atoms-7,179.5,mask=mask)
-    mask[-7]=0
-    atoms.set_angle(total_atoms-6,total_atoms-7,total_atoms-8,120,mask=mask)
-    atoms.set_distance(total_atoms-8,total_atoms-7,1.4,fix=1,mask=mask)
-    atoms.set_angle(total_atoms-7,total_atoms-8,total_atoms-9,120,mask=mask)
-    atoms.set_dihedral(i,total_atoms-6,total_atoms-7,total_atoms-8,0.5,mask=mask)
-    mask[-8]=0
-    atoms.set_angle(i,total_atoms-10,total_atoms-5,120,mask=mask)
-    atoms.set_distance(total_atoms-5,total_atoms-10,1.0800,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-10,total_atoms-5,0.5,mask=mask)
-    mask[-5]=0
-    atoms.set_angle(i,total_atoms-6,total_atoms-1,120,mask=mask)
-    atoms.set_distance(total_atoms-1,total_atoms-6,1.0800,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-6,total_atoms-1,0.5,mask=mask)
-    mask[-1]=0
-    atoms.set_angle(total_atoms-10,total_atoms-9,total_atoms-4,120,mask=mask)
-    atoms.set_distance(total_atoms-4,total_atoms-9,1.0800,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms-5,total_atoms-10,total_atoms-9,total_atoms-4,0.5,mask=mask)
-    mask[-4]=0
-    atoms.set_angle(total_atoms-6,total_atoms-7,total_atoms-2,120,mask=mask)
-    atoms.set_distance(total_atoms-2,total_atoms-7,1.0800,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms-1,total_atoms-6,total_atoms-7,total_atoms-2,0.5,mask=mask)
-    mask[-2]=0
-    atoms.set_angle(total_atoms-9,total_atoms-8,total_atoms-3,120,mask=mask)
-    atoms.set_distance(total_atoms-3,total_atoms-8,1.0800,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms-4,total_atoms-9,total_atoms-8,total_atoms-3,0.5,mask=mask)
-    return atoms
-
-def Py(atoms,i,state=1,place=4,shuffle=0):
-    atoms=Ph(atoms,i,state,shuffle)
-    total_atoms=len(atoms)
-    mask=[0]*total_atoms
+    #if shuffle == 0:
+    CnearH = near(Cnear, atoms, 'H', ignore=[Cnear, i])
+    #elif shuffle == 1:
+    #    CnearH = near(Cnear, atoms, 'C')
+    #print(Cnear, CnearH)
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.5105, fix=1)
+    elif state == 2:
+        atoms.set_distance(i, Cnear, 1.4330, fix=1)
+    elif state == 6:
+        atoms.set_distance(i, Cnear, 1.5100, fix=1)
+    elif state == 7:
+        atoms.set_distance(i, Cnear, 1.3400, fix=1)
+    elif state == 8:
+        atoms.set_distance(i, Cnear, 1.3640, fix=1)
+    elif state == 16:
+        atoms.set_distance(i, Cnear, 1.7700, fix=1)
+    elif state == 82:
+        atoms.set_distance(i, Cnear, 1.4900, fix=1)
+    atoms.set_angle(Cnear, i, total_atoms-10, 120, mask=mask)
+    atoms.set_distance(total_atoms-10, i, 1.4, fix=1, mask=mask)
+    if shuffle == 0:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-10, 5.4, mask=mask)
+    elif shuffle == 1:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-10, 95.4, mask=mask)
+    mask[-10] = 0
+    atoms.set_angle(Cnear, i, total_atoms-6, 120, mask=mask)
+    atoms.set_distance(total_atoms-6, i, 1.4, fix=1, mask=mask)
+    if shuffle == 0:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-6, -175.0, mask=mask)
+    elif shuffle == 1:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-6, -85.0, mask=mask)
+    mask[-6] = 0
+    atoms.set_angle(i, total_atoms-10, total_atoms-9, 120, mask=mask)
+    atoms.set_distance(total_atoms-9, total_atoms-10, 1.4, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-10, total_atoms-9, 179.5, mask=mask)
+    mask[-9] = 0
+    atoms.set_angle(i, total_atoms-6, total_atoms-7, 120, mask=mask)
+    atoms.set_distance(total_atoms-7, total_atoms-6, 1.4, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-6, total_atoms-7, 179.5, mask=mask)
+    mask[-7] = 0
+    atoms.set_angle(total_atoms-6, total_atoms-7, total_atoms-8, 120, mask=mask)
+    atoms.set_distance(total_atoms-8, total_atoms-7, 1.4, fix=1, mask=mask)
+    atoms.set_angle(total_atoms-7, total_atoms-8, total_atoms-9, 120, mask=mask)
+    atoms.set_dihedral(i, total_atoms-6, total_atoms-7, total_atoms-8,\
+                       0.5, mask=mask)
+    mask[-8] = 0
+    atoms.set_angle(i, total_atoms-10, total_atoms-5, 120, mask=mask)
+    atoms.set_distance(total_atoms-5, total_atoms-10, 1.0800, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-10, total_atoms-5, 0.5, mask=mask)
+    mask[-5] = 0
+    atoms.set_angle(i, total_atoms-6, total_atoms-1, 120, mask=mask)
+    atoms.set_distance(total_atoms-1, total_atoms-6, 1.0800, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-6, total_atoms-1, 0.5, mask=mask)
+    mask[-1] = 0
+    atoms.set_angle(total_atoms-10, total_atoms-9, total_atoms-4, 120, mask=mask)
+    atoms.set_distance(total_atoms-4, total_atoms-9, 1.0800, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms-5, total_atoms-10, total_atoms-9,\
+                       total_atoms-4, 0.5, mask=mask)
+    mask[-4] = 0
+    atoms.set_angle(total_atoms-6, total_atoms-7, total_atoms-2, 120, mask=mask)
+    atoms.set_distance(total_atoms-2, total_atoms-7, 1.0800, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms-1, total_atoms-6, total_atoms-7,\
+                       total_atoms-2, 0.5, mask=mask)
+    mask[-2] = 0
+    atoms.set_angle(total_atoms-9, total_atoms-8, total_atoms-3, 120, mask=mask)
+    atoms.set_distance(total_atoms-3, total_atoms-8, 1.0800, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms-4, total_atoms-9, total_atoms-8,\
+                       total_atoms-3, 0.5, mask=mask)
+    return atoms
+
+def Py(atoms, i, state=1, place=4, shuffle=0):
+    atoms = Ph(atoms, i, state, shuffle)
+    total_atoms = len(atoms)
+    mask = [0] * total_atoms
 
-def Pyrrole(atoms,i,state=1,place=0,shuffle=0):
-    if place==0:
+def Pyrrole(atoms, i, state=1, place=0, shuffle=0):
+    if place == 0:
         for j in range(4):
             atoms.append('C')
         for j in range(4):
             atoms.append('H')
-        Cnear=near(i, atoms)
-        total_atoms=len(atoms)
-        mask=[0]*(total_atoms-8)+[1]*8
-        elements=atoms.get_chemical_symbols()
-        elements[i]='N'
-        if shuffle==0:
-            CnearH=near(Cnear,atoms,'H')
-        elif shuffle==1:
-            CnearH=near(Cnear,atoms,'C')
+        Cnear = near(i,  atoms)
+        total_atoms = len(atoms)
+        mask = [0]*(total_atoms-8) + [1]*8
+        elements = atoms.get_chemical_symbols()
+        elements[i] = 'N'
+        if shuffle == 0:
+            CnearH = near(Cnear, atoms, 'H')
+        elif shuffle == 1:
+            CnearH = near(Cnear, atoms, 'C')
         atoms.set_chemical_symbols(elements)
-        if state==1:
-            atoms.set_distance(i,Cnear,1.475,fix=1,ignore=i)
-        elif state==6:
-            atoms.set_distance(i,Cnear,1.440,fix=1,ignore=i)
-        x=atoms.get_positions()
+        if state == 1:
+            atoms.set_distance(i, Cnear, 1.475, fix=1, ignore=i)
+        elif state == 6:
+            atoms.set_distance(i, Cnear, 1.440, fix=1, ignore=i)
+        x = atoms.get_positions()
         #Separate into a side
-        for j in range(-8,-6):
-            x[j][0]=x[j][0]-50
-            x[j][1]=x[j][1]-50
-            x[j][2]=x[j][2]-50
-        for j in range(-4,-2):
-            x[j][0]=x[j][0]-50
-            x[j][1]=x[j][1]-50
-            x[j][2]=x[j][2]-50
-        for j in range(-6,-4):
-            x[j][0]=x[j][0]+50
-            x[j][1]=x[j][1]+50
-            x[j][2]=x[j][2]+50
-        for j in range(-2,0):
-            x[j][0]=x[j][0]+50
-            x[j][1]=x[j][1]+50
-            x[j][2]=x[j][2]+50
+        for j in range(-8, -6):
+            x[j][0] = x[j][0] - 50
+            x[j][1] = x[j][1] - 50
+            x[j][2] = x[j][2] - 50
+        for j in range(-4, -2):
+            x[j][0] = x[j][0] - 50
+            x[j][1] = x[j][1] - 50
+            x[j][2] = x[j][2] - 50
+        for j in range(-6, -4):
+            x[j][0] = x[j][0] + 50
+            x[j][1] = x[j][1] + 50
+            x[j][2] = x[j][2] + 50
+        for j in range(-2, 0):
+            x[j][0] = x[j][0] + 50
+            x[j][1] = x[j][1] + 50
+            x[j][2] = x[j][2] + 50
         atoms.set_positions(x)
-        atoms.set_angle(Cnear,i,total_atoms-8,125.35,mask=mask)
-        atoms.set_distance(total_atoms-8,i,1.381,fix=1,mask=mask)
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-8,5.4,mask=mask)
-        mask[-8]=0
-        atoms.set_angle(Cnear,i,total_atoms-5,125.35,mask=mask)
-        atoms.set_distance(total_atoms-5,i,1.381,fix=1,mask=mask)
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-5,-175.0,mask=mask)
-        mask[-5]=0
-        atoms.set_angle(i,total_atoms-8,total_atoms-7,107.7,mask=mask)
-        atoms.set_distance(total_atoms-7,total_atoms-8,1.367,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-8,total_atoms-7,179.5,mask=mask)
-        mask[-7]=0
-        atoms.set_angle(i,total_atoms-5,total_atoms-6,107.7,mask=mask)
-        atoms.set_distance(total_atoms-6,total_atoms-5,1.367,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-5,total_atoms-6,-179.5,mask=mask)
-        mask[-6]=0
-        atoms.set_angle(i,total_atoms-8,total_atoms-4,126,mask=mask)
-        atoms.set_distance(total_atoms-4,total_atoms-8,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-8,total_atoms-4,0.5,mask=mask)
-        mask[-4]=0
-        atoms.set_angle(i,total_atoms-5,total_atoms-1,126,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-5,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-5,total_atoms-1,-0.5,mask=mask)
-        mask[-1]=0
-        atoms.set_angle(total_atoms-8,total_atoms-7,total_atoms-3,126,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms-7,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms-8,total_atoms-7,total_atoms-3,179.5,mask=mask)
-        mask[-3]=0
-        atoms.set_angle(total_atoms-5,total_atoms-6,total_atoms-2,126,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-6,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms-5,total_atoms-6,total_atoms-2,-179.5,mask=mask)
-        mask[-2]=0
-    elif place==1:
+        atoms.set_angle(Cnear, i, total_atoms-8, 125.35, mask=mask)
+        atoms.set_distance(total_atoms-8, i, 1.381, fix=1, mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-8, 5.4, mask=mask)
+        mask[-8] = 0
+        atoms.set_angle(Cnear, i, total_atoms-5, 125.35, mask=mask)
+        atoms.set_distance(total_atoms-5, i, 1.381, fix=1, mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-5, -175.0, mask=mask)
+        mask[-5] = 0
+        atoms.set_angle(i, total_atoms-8, total_atoms-7, 107.7, mask=mask)
+        atoms.set_distance(total_atoms-7, total_atoms-8, 1.367, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-8, total_atoms-7, 179.5, mask=mask)
+        mask[-7] = 0
+        atoms.set_angle(i, total_atoms-5, total_atoms-6, 107.7, mask=mask)
+        atoms.set_distance(total_atoms-6, total_atoms-5, 1.367, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-5, total_atoms-6, -179.5, mask=mask)
+        mask[-6] = 0
+        atoms.set_angle(i, total_atoms-8, total_atoms-4, 126, mask=mask)
+        atoms.set_distance(total_atoms-4, total_atoms-8, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-8, total_atoms-4, 0.5, mask=mask)
+        mask[-4] = 0
+        atoms.set_angle(i, total_atoms-5, total_atoms-1, 126, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-5, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-5, total_atoms-1, -0.5, mask=mask)
+        mask[-1] = 0
+        atoms.set_angle(total_atoms-8, total_atoms-7, total_atoms-3, 126, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms-7, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms-8, total_atoms-7,\
+                           total_atoms-3, 179.5, mask=mask)
+        mask[-3] = 0
+        atoms.set_angle(total_atoms-5, total_atoms-6, total_atoms-2, 126, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-6, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms-5, total_atoms-6,\
+                           total_atoms-2, -179.5, mask=mask)
+        mask[-2] = 0
+    elif place == 1:
         atoms.append('N')
         for j in range(3):
             atoms.append('C')
         for j in range(4):
             atoms.append('H')
-        Cnear=near(i, atoms)
-        total_atoms=len(atoms)
-        mask=[0]*(total_atoms-8)+[1]*8
-        elements=atoms.get_chemical_symbols()
-        elements[i]='C'
-        if shuffle==0:
-            CnearH=near(Cnear,atoms,'H',ignore=i)
-        elif shuffle==1:
-            CnearH=near(Cnear,atoms,'C',ignore=i)
+        Cnear = near(i,  atoms)
+        total_atoms = len(atoms)
+        mask = [0]*(total_atoms-8) + [1]*8
+        elements = atoms.get_chemical_symbols()
+        elements[i] = 'C'
+        if shuffle == 0:
+            CnearH = near(Cnear, atoms, 'H', ignore=i)
+        elif shuffle == 1:
+            CnearH = near(Cnear, atoms, 'C', ignore=i)
         atoms.set_chemical_symbols(elements)
-        if state==1:
-            atoms.set_distance(i,Cnear,1.5100,fix=1)
-        elif state==6:
-            atoms.set_distance(i,Cnear,1.4600,fix=1)
-        x=atoms.get_positions()
+        if state == 1:
+            atoms.set_distance(i, Cnear, 1.5100, fix=1)
+        elif state == 6:
+            atoms.set_distance(i, Cnear, 1.4600, fix=1)
+        x = atoms.get_positions()
         #Separate into a side
-        for j in range(-8,-6):
-            x[j][0]=x[j][0]-50
-            x[j][1]=x[j][1]-50
-            x[j][2]=x[j][2]-50
-        for j in range(-4,-2):
-            x[j][0]=x[j][0]-50
-            x[j][1]=x[j][1]-50
-            x[j][2]=x[j][2]-50
-        for j in range(-6,-4):
-            x[j][0]=x[j][0]+50
-            x[j][1]=x[j][1]+50
-            x[j][2]=x[j][2]+50
-        for j in range(-2,0):
-            x[j][0]=x[j][0]+50
-            x[j][1]=x[j][1]+50
-            x[j][2]=x[j][2]+50
+        for j in range(-8, -6):
+            x[j][0] = x[j][0] - 50
+            x[j][1] = x[j][1] - 50
+            x[j][2] = x[j][2] - 50
+        for j in range(-4, -2):
+            x[j][0] = x[j][0] - 50
+            x[j][1] = x[j][1] - 50
+            x[j][2] = x[j][2] - 50
+        for j in range(-6, -4):
+            x[j][0] = x[j][0] + 50
+            x[j][1] = x[j][1] + 50
+            x[j][2] = x[j][2] + 50
+        for j in range(-2, 0):
+            x[j][0] = x[j][0] + 50
+            x[j][1] = x[j][1] + 50
+            x[j][2] = x[j][2] + 50
         atoms.set_positions(x)
-        atoms.set_angle(Cnear,i,total_atoms-8,120.8,mask=mask)
-        atoms.set_distance(total_atoms-8,i,1.381,fix=1,mask=mask)
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-8,6.0,mask=mask)
-        mask[-8]=0
-        atoms.set_angle(Cnear,i,total_atoms-5,131.58,mask=mask)
-        atoms.set_distance(total_atoms-5,i,1.367,fix=1,mask=mask)
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-5,-175.0,mask=mask)
-        mask[-5]=0
-        atoms.set_angle(i,total_atoms-8,total_atoms-7,109.8,mask=mask)
-        atoms.set_distance(total_atoms-7,total_atoms-8,1.381,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-8,total_atoms-7,179.5,mask=mask)
-        mask[-7]=0
-        atoms.set_angle(i,total_atoms-5,total_atoms-6,107.3,mask=mask)
-        atoms.set_distance(total_atoms-6,total_atoms-5,1.424,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-5,total_atoms-6,-179.5,mask=mask)
-        mask[-6]=0
-        atoms.set_angle(i,total_atoms-8,total_atoms-4,126,mask=mask)
-        atoms.set_distance(total_atoms-4,total_atoms-8,1.0100,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-8,total_atoms-4,0.5,mask=mask)
-        mask[-4]=0
-        atoms.set_angle(i,total_atoms-5,total_atoms-1,126,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-5,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-5,total_atoms-1,-0.5,mask=mask)
-        mask[-1]=0
-        atoms.set_angle(total_atoms-8,total_atoms-7,total_atoms-3,126,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms-7,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms-8,total_atoms-7,total_atoms-3,179.5,mask=mask)
-        mask[-3]=0
-        atoms.set_angle(total_atoms-5,total_atoms-6,total_atoms-2,126,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-6,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms-5,total_atoms-6,total_atoms-2,-179.5,mask=mask)
-        mask[-2]=0
-    elif place==-1:
+        atoms.set_angle(Cnear, i, total_atoms-8, 120.8, mask=mask)
+        atoms.set_distance(total_atoms-8, i, 1.381, fix=1, mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-8, 6.0, mask=mask)
+        mask[-8] = 0
+        atoms.set_angle(Cnear, i, total_atoms-5, 131.58, mask=mask)
+        atoms.set_distance(total_atoms-5, i, 1.367, fix=1, mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-5, -175.0, mask=mask)
+        mask[-5] = 0
+        atoms.set_angle(i, total_atoms-8, total_atoms-7, 109.8, mask=mask)
+        atoms.set_distance(total_atoms-7, total_atoms-8, 1.381, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-8, total_atoms-7, 179.5, mask=mask)
+        mask[-7] = 0
+        atoms.set_angle(i, total_atoms-5, total_atoms-6, 107.3, mask=mask)
+        atoms.set_distance(total_atoms-6, total_atoms-5, 1.424, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-5, total_atoms-6, -179.5, mask=mask)
+        mask[-6] = 0
+        atoms.set_angle(i, total_atoms-8, total_atoms-4, 126, mask=mask)
+        atoms.set_distance(total_atoms-4, total_atoms-8, 1.0100, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-8, total_atoms-4, 0.5, mask=mask)
+        mask[-4] = 0
+        atoms.set_angle(i, total_atoms-5, total_atoms-1, 126, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-5, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-5, total_atoms-1, -0.5, mask=mask)
+        mask[-1] = 0
+        atoms.set_angle(total_atoms-8, total_atoms-7, total_atoms-3, 126, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms-7, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms-8, total_atoms-7, total_atoms-3,\
+                           179.5, mask=mask)
+        mask[-3] = 0
+        atoms.set_angle(total_atoms-5, total_atoms-6, total_atoms-2, 126, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-6, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms-5, total_atoms-6, total_atoms-2,\
+                           -179.5, mask=mask)
+        mask[-2] = 0
+    elif place == -1:
         atoms.append('N')
         for j in range(3):
             atoms.append('C')
         for j in range(4):
             atoms.append('H')
-        Cnear=near(i, atoms)
-        total_atoms=len(atoms)
-        mask=[0]*(total_atoms-8)+[1]*8
-        elements=atoms.get_chemical_symbols()
-        elements[i]='C'
-        if shuffle==0:
-            CnearH=near(Cnear,atoms,'H',ignore=i)
-        elif shuffle==1:
-            CnearH=near(Cnear,atoms,'C',ignore=i)
+        Cnear = near(i,  atoms)
+        total_atoms = len(atoms)
+        mask = [0]*(total_atoms-8) + [1]*8
+        elements = atoms.get_chemical_symbols()
+        elements[i] = 'C'
+        if shuffle == 0:
+            CnearH = near(Cnear, atoms, 'H', ignore=i)
+        elif shuffle == 1:
+            CnearH = near(Cnear, atoms, 'C', ignore=i)
         atoms.set_chemical_symbols(elements)
-        if state==1:
-            atoms.set_distance(i,Cnear,1.5100,fix=1)
-        elif state==6:
-            atoms.set_distance(i,Cnear,1.4600,fix=1)
-        x=atoms.get_positions()
+        if state == 1:
+            atoms.set_distance(i, Cnear, 1.5100, fix=1)
+        elif state == 6:
+            atoms.set_distance(i, Cnear, 1.4600, fix=1)
+        x = atoms.get_positions()
         #Separate into a side
-        for j in range(-8,-6):
-            x[j][0]=x[j][0]-50
-            x[j][1]=x[j][1]-50
-            x[j][2]=x[j][2]-50
-        for j in range(-4,-2):
-            x[j][0]=x[j][0]-50
-            x[j][1]=x[j][1]-50
-            x[j][2]=x[j][2]-50
-        for j in range(-6,-4):
-            x[j][0]=x[j][0]+50
-            x[j][1]=x[j][1]+50
-            x[j][2]=x[j][2]+50
-        for j in range(-2,0):
-            x[j][0]=x[j][0]+50
-            x[j][1]=x[j][1]+50
-            x[j][2]=x[j][2]+50
+        for j in range(-8, -6):
+            x[j][0] = x[j][0] - 50
+            x[j][1] = x[j][1] - 50
+            x[j][2] = x[j][2] - 50
+        for j in range(-4, -2):
+            x[j][0] = x[j][0] - 50
+            x[j][1] = x[j][1] - 50
+            x[j][2] = x[j][2] - 50
+        for j in range(-6, -4):
+            x[j][0] = x[j][0] + 50
+            x[j][1] = x[j][1] + 50
+            x[j][2] = x[j][2] + 50
+        for j in range(-2, 0):
+            x[j][0] = x[j][0] + 50
+            x[j][1] = x[j][1] + 50
+            x[j][2] = x[j][2] + 50
         atoms.set_positions(x)
-        atoms.set_angle(Cnear,i,total_atoms-5,131.58,mask=mask)
-        atoms.set_distance(total_atoms-5,i,1.367,fix=1,mask=mask)
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-5,6.0,mask=mask)
-        mask[-5]=0
-        atoms.set_angle(Cnear,i,total_atoms-8,120.8,mask=mask)
-        atoms.set_distance(total_atoms-8,i,1.381,fix=1,mask=mask)
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-8,-175.0,mask=mask)
-        mask[-8]=0
-        atoms.set_angle(i,total_atoms-5,total_atoms-6,107.3,mask=mask)
-        atoms.set_distance(total_atoms-6,total_atoms-5,1.424,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-5,total_atoms-6,179.5,mask=mask)
-        mask[-6]=0
-        atoms.set_angle(i,total_atoms-8,total_atoms-7,109.8,mask=mask)
-        atoms.set_distance(total_atoms-7,total_atoms-8,1.381,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-8,total_atoms-7,-179.5,mask=mask)
-        mask[-7]=0
-        atoms.set_angle(i,total_atoms-7,total_atoms-4,126,mask=mask)
-        atoms.set_distance(total_atoms-4,total_atoms-5,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-5,total_atoms-4,0.5,mask=mask)
-        mask[-4]=0
-        atoms.set_angle(i,total_atoms-8,total_atoms-1,126,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-8,1.0100,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-8,total_atoms-1,-0.5,mask=mask)
-        mask[-1]=0
-        atoms.set_angle(total_atoms-5,total_atoms-6,total_atoms-3,126,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms-6,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms-5,total_atoms-6,total_atoms-3,179.5,mask=mask)
-        mask[-3]=0
-        atoms.set_angle(total_atoms-8,total_atoms-7,total_atoms-2,126,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-7,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms-8,total_atoms-7,total_atoms-2,-179.5,mask=mask)
-        mask[-2]=0
-    elif place==2:
+        atoms.set_angle(Cnear, i, total_atoms-5, 131.58, mask=mask)
+        atoms.set_distance(total_atoms-5, i, 1.367, fix=1, mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-5, 6.0, mask=mask)
+        mask[-5] = 0
+        atoms.set_angle(Cnear, i, total_atoms-8, 120.8, mask=mask)
+        atoms.set_distance(total_atoms-8, i, 1.381, fix=1, mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-8, -175.0, mask=mask)
+        mask[-8] = 0
+        atoms.set_angle(i, total_atoms-5, total_atoms-6, 107.3, mask=mask)
+        atoms.set_distance(total_atoms-6, total_atoms-5, 1.424, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-5, total_atoms-6, 179.5, mask=mask)
+        mask[-6] = 0
+        atoms.set_angle(i, total_atoms-8, total_atoms-7, 109.8, mask=mask)
+        atoms.set_distance(total_atoms-7, total_atoms-8, 1.381, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-8, total_atoms-7, -179.5, mask=mask)
+        mask[-7] = 0
+        atoms.set_angle(i, total_atoms-7, total_atoms-4, 126, mask=mask)
+        atoms.set_distance(total_atoms-4, total_atoms-5, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-5, total_atoms-4, 0.5, mask=mask)
+        mask[-4] = 0
+        atoms.set_angle(i, total_atoms-8, total_atoms-1, 126, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-8, 1.0100, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-8, total_atoms-1, -0.5, mask=mask)
+        mask[-1] = 0
+        atoms.set_angle(total_atoms-5, total_atoms-6, total_atoms-3, 126, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms-6, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms-5, total_atoms-6,\
+                           total_atoms-3, 179.5, mask=mask)
+        mask[-3] = 0
+        atoms.set_angle(total_atoms-8, total_atoms-7, total_atoms-2, 126, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-7, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms-8, total_atoms-7,\
+                           total_atoms-2, -179.5, mask=mask)
+        mask[-2] = 0
+    elif place == 2:
         atoms.append('C')
         atoms.append('N')
         for j in range(2):
             atoms.append('C')
         for j in range(4):
             atoms.append('H')
-        Cnear=near(i, atoms)
-        total_atoms=len(atoms)
-        mask=[0]*(total_atoms-8)+[1]*8
-        elements=atoms.get_chemical_symbols()
-        elements[i]='C'
-        if shuffle==0:
-            CnearH=near(Cnear,atoms,'H',ignore=i)
-        elif shuffle==1:
-            CnearH=near(Cnear,atoms,'C',ignore=i)
+        Cnear = near(i,  atoms)
+        total_atoms = len(atoms)
+        mask = [0]*(total_atoms-8) + [1]*8
+        elements = atoms.get_chemical_symbols()
+        elements[i] = 'C'
+        if shuffle == 0:
+            CnearH = near(Cnear, atoms, 'H', ignore=i)
+        elif shuffle == 1:
+            CnearH = near(Cnear, atoms, 'C', ignore=i)
         atoms.set_chemical_symbols(elements)
-        if state==1:
-            atoms.set_distance(i,Cnear,1.5100,fix=1)
-        elif state==6:
-            atoms.set_distance(i,Cnear,1.4600,fix=1)
-        x=atoms.get_positions()
+        if state == 1:
+            atoms.set_distance(i, Cnear, 1.5100, fix=1)
+        elif state == 6:
+            atoms.set_distance(i, Cnear, 1.4600, fix=1)
+        x = atoms.get_positions()
         #Separate into a side
-        for j in range(-8,-6):
-            x[j][0]=x[j][0]-50
-            x[j][1]=x[j][1]-50
-            x[j][2]=x[j][2]-50
-        for j in range(-4,-2):
-            x[j][0]=x[j][0]-50
-            x[j][1]=x[j][1]-50
-            x[j][2]=x[j][2]-50
-        for j in range(-6,-4):
-            x[j][0]=x[j][0]+50
-            x[j][1]=x[j][1]+50
-            x[j][2]=x[j][2]+50
-        for j in range(-2,0):
-            x[j][0]=x[j][0]+50
-            x[j][1]=x[j][1]+50
-            x[j][2]=x[j][2]+50
+        for j in range(-8, -6):
+            x[j][0] = x[j][0] - 50
+            x[j][1] = x[j][1] - 50
+            x[j][2] = x[j][2] - 50
+        for j in range(-4, -2):
+            x[j][0] = x[j][0] - 50
+            x[j][1] = x[j][1] - 50
+            x[j][2] = x[j][2] - 50
+        for j in range(-6, -4):
+            x[j][0] = x[j][0] + 50
+            x[j][1] = x[j][1] + 50
+            x[j][2] = x[j][2] + 50
+        for j in range(-2, 0):
+            x[j][0] = x[j][0] + 50
+            x[j][1] = x[j][1] + 50
+            x[j][2] = x[j][2] + 50
         atoms.set_positions(x)
-        atoms.set_angle(Cnear,i,total_atoms-8,125.4,mask=mask)
-        atoms.set_distance(total_atoms-8,i,1.367,fix=1,mask=mask)
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-8,5.4,mask=mask)
-        mask[-8]=0
-        atoms.set_angle(Cnear,i,total_atoms-5,126.75,mask=mask)
-        atoms.set_distance(total_atoms-5,i,1.424,fix=1,mask=mask)
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-5,-175.0,mask=mask)
-        mask[-5]=0
-        atoms.set_angle(i,total_atoms-8,total_atoms-7,107.7,mask=mask)
-        atoms.set_distance(total_atoms-7,total_atoms-8,1.381,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-8,total_atoms-7,179.5,mask=mask)
-        mask[-7]=0
-        atoms.set_angle(i,total_atoms-5,total_atoms-6,107.3,mask=mask)
-        atoms.set_distance(total_atoms-6,total_atoms-5,1.367,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-5,total_atoms-6,-179.5,mask=mask)
-        mask[-6]=0
-        atoms.set_angle(i,total_atoms-8,total_atoms-4,126,mask=mask)
-        atoms.set_distance(total_atoms-4,total_atoms-8,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-8,total_atoms-4,0.5,mask=mask)
-        mask[-4]=0
-        atoms.set_angle(i,total_atoms-5,total_atoms-1,126,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-5,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-5,total_atoms-1,-0.5,mask=mask)
-        mask[-1]=0
-        atoms.set_angle(total_atoms-8,total_atoms-7,total_atoms-3,126,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms-7,1.0100,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms-8,total_atoms-7,total_atoms-3,179.5,mask=mask)
-        mask[-3]=0
-        atoms.set_angle(total_atoms-5,total_atoms-6,total_atoms-2,126,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-6,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms-5,total_atoms-6,total_atoms-2,-179.5,mask=mask)
-        mask[-2]=0
-    elif place==-2:
+        atoms.set_angle(Cnear, i, total_atoms-8, 125.4, mask=mask)
+        atoms.set_distance(total_atoms-8, i, 1.367, fix=1, mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-8, 5.4, mask=mask)
+        mask[-8] = 0
+        atoms.set_angle(Cnear, i, total_atoms-5, 126.75, mask=mask)
+        atoms.set_distance(total_atoms-5, i, 1.424, fix=1, mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-5, -175.0, mask=mask)
+        mask[-5] = 0
+        atoms.set_angle(i, total_atoms-8, total_atoms-7, 107.7, mask=mask)
+        atoms.set_distance(total_atoms-7, total_atoms-8, 1.381, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-8, total_atoms-7, 179.5, mask=mask)
+        mask[-7] = 0
+        atoms.set_angle(i, total_atoms-5, total_atoms-6, 107.3, mask=mask)
+        atoms.set_distance(total_atoms-6, total_atoms-5, 1.367, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-5, total_atoms-6, -179.5, mask=mask)
+        mask[-6] = 0
+        atoms.set_angle(i, total_atoms-8, total_atoms-4, 126, mask=mask)
+        atoms.set_distance(total_atoms-4, total_atoms-8, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-8, total_atoms-4, 0.5, mask=mask)
+        mask[-4] = 0
+        atoms.set_angle(i, total_atoms-5, total_atoms-1, 126, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-5, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-5, total_atoms-1, -0.5, mask=mask)
+        mask[-1] = 0
+        atoms.set_angle(total_atoms-8, total_atoms-7, total_atoms-3, 126, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms-7, 1.0100, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms-8, total_atoms-7,\
+                           total_atoms-3, 179.5, mask=mask)
+        mask[-3] = 0
+        atoms.set_angle(total_atoms-5, total_atoms-6, total_atoms-2, 126, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-6, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms-5, total_atoms-6,\
+                           total_atoms-2, -179.5, mask=mask)
+        mask[-2] = 0
+    elif place == -2:
         atoms.append('C')
         atoms.append('N')
         for j in range(2):
             atoms.append('C')
         for j in range(4):
             atoms.append('H')
-        Cnear=near(i, atoms)
-        total_atoms=len(atoms)
-        mask=[0]*(total_atoms-8)+[1]*8
-        elements=atoms.get_chemical_symbols()
-        elements[i]='C'
-        if shuffle==0:
-            CnearH=near(Cnear,atoms,'H',ignore=i)
-        elif shuffle==1:
-            CnearH=near(Cnear,atoms,'C',ignore=i)
+        Cnear = near(i,  atoms)
+        total_atoms = len(atoms)
+        mask = [0]*(total_atoms-8) + [1]*8
+        elements = atoms.get_chemical_symbols()
+        elements[i] = 'C'
+        if shuffle == 0:
+            CnearH = near(Cnear, atoms, 'H', ignore=i)
+        elif shuffle == 1:
+            CnearH = near(Cnear, atoms, 'C', ignore=i)
         atoms.set_chemical_symbols(elements)
-        if state==1:
-            atoms.set_distance(i,Cnear,1.5100,fix=1)
-        elif state==6:
-            atoms.set_distance(i,Cnear,1.4600,fix=1)
-        x=atoms.get_positions()
+        if state == 1:
+            atoms.set_distance(i, Cnear, 1.5100, fix=1)
+        elif state == 6:
+            atoms.set_distance(i, Cnear, 1.4600, fix=1)
+        x = atoms.get_positions()
         #Separate into a side
-        for j in range(-8,-6):
-            x[j][0]=x[j][0]-50
-            x[j][1]=x[j][1]-50
-            x[j][2]=x[j][2]-50
-        for j in range(-4,-2):
-            x[j][0]=x[j][0]-50
-            x[j][1]=x[j][1]-50
-            x[j][2]=x[j][2]-50
-        for j in range(-6,-4):
-            x[j][0]=x[j][0]+50
-            x[j][1]=x[j][1]+50
-            x[j][2]=x[j][2]+50
-        for j in range(-2,0):
-            x[j][0]=x[j][0]+50
-            x[j][1]=x[j][1]+50
-            x[j][2]=x[j][2]+50
+        for j in range(-8, -6):
+            x[j][0] = x[j][0] - 50
+            x[j][1] = x[j][1] - 50
+            x[j][2] = x[j][2] - 50
+        for j in range(-4, -2):
+            x[j][0] = x[j][0] - 50
+            x[j][1] = x[j][1] - 50
+            x[j][2] = x[j][2] - 50
+        for j in range(-6, -4):
+            x[j][0] = x[j][0] + 50
+            x[j][1] = x[j][1] + 50
+            x[j][2] = x[j][2] + 50
+        for j in range(-2, 0):
+            x[j][0] = x[j][0] + 50
+            x[j][1] = x[j][1] + 50
+            x[j][2] = x[j][2] + 50
         atoms.set_positions(x)
-        atoms.set_angle(Cnear,i,total_atoms-8,125.4,mask=mask)
-        atoms.set_distance(total_atoms-8,i,1.367,fix=1,mask=mask)
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-8,175.0,mask=mask)
-        mask[-8]=0
-        atoms.set_angle(Cnear,i,total_atoms-5,126.75,mask=mask)
-        atoms.set_distance(total_atoms-5,i,1.424,fix=1,mask=mask)
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-5,-5.4,mask=mask)
-        mask[-5]=0
-        atoms.set_angle(i,total_atoms-8,total_atoms-7,107.7,mask=mask)
-        atoms.set_distance(total_atoms-7,total_atoms-8,1.381,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-8,total_atoms-7,-179.5,mask=mask)
-        mask[-7]=0
-        atoms.set_angle(i,total_atoms-5,total_atoms-6,107.3,mask=mask)
-        atoms.set_distance(total_atoms-6,total_atoms-5,1.367,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-5,total_atoms-6,179.5,mask=mask)
-        mask[-6]=0
-        atoms.set_angle(i,total_atoms-5,total_atoms-4,126,mask=mask)
-        atoms.set_distance(total_atoms-4,total_atoms-5,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-5,total_atoms-4,0.5,mask=mask)
-        mask[-4]=0
-        atoms.set_angle(i,total_atoms-8,total_atoms-1,126,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-8,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms-8,total_atoms-1,-0.5,mask=mask)
-        mask[-1]=0
-        atoms.set_angle(total_atoms-8,total_atoms-7,total_atoms-3,126,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms-7,1.0800,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms-8,total_atoms-7,total_atoms-3,179.5,mask=mask)
-        mask[-3]=0
-        atoms.set_angle(total_atoms-5,total_atoms-6,total_atoms-2,126,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-6,1.0100,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms-5,total_atoms-6,total_atoms-2,-179.5,mask=mask)
-        mask[-2]=0
+        atoms.set_angle(Cnear, i, total_atoms-8, 125.4, mask=mask)
+        atoms.set_distance(total_atoms-8, i, 1.367, fix=1, mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-8, 175.0, mask=mask)
+        mask[-8] = 0
+        atoms.set_angle(Cnear, i, total_atoms-5, 126.75, mask=mask)
+        atoms.set_distance(total_atoms-5, i, 1.424, fix=1, mask=mask)
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-5, -5.4, mask=mask)
+        mask[-5] = 0
+        atoms.set_angle(i, total_atoms-8, total_atoms-7, 107.7, mask=mask)
+        atoms.set_distance(total_atoms-7, total_atoms-8, 1.381, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-8, total_atoms-7, -179.5, mask=mask)
+        mask[-7] = 0
+        atoms.set_angle(i, total_atoms-5, total_atoms-6, 107.3, mask=mask)
+        atoms.set_distance(total_atoms-6, total_atoms-5, 1.367, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-5, total_atoms-6, 179.5, mask=mask)
+        mask[-6] = 0
+        atoms.set_angle(i, total_atoms-5, total_atoms-4, 126, mask=mask)
+        atoms.set_distance(total_atoms-4, total_atoms-5, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-5, total_atoms-4, 0.5, mask=mask)
+        mask[-4] = 0
+        atoms.set_angle(i, total_atoms-8, total_atoms-1, 126, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-8, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms-8, total_atoms-1, -0.5, mask=mask)
+        mask[-1] = 0
+        atoms.set_angle(total_atoms-8, total_atoms-7, total_atoms-3, 126, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms-7, 1.0800, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms-8, total_atoms-7,\
+                           total_atoms-3, 179.5, mask=mask)
+        mask[-3] = 0
+        atoms.set_angle(total_atoms-5, total_atoms-6, total_atoms-2, 126, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-6, 1.0100, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms-5, total_atoms-6,\
+                           total_atoms-2, -179.5, mask=mask)
+        mask[-2] = 0
     return atoms
 
-def ring3(atoms,i,state=1,strict={1:'X'}):
+def ring3(atoms, i, state=1, strict={1:'X'}):
     for j in range(2):
         atoms.append('C')
     for j in range(5):
         atoms.append('H')
-    total_atoms=len(atoms)
-    Cnear=near(i, atoms)
-    CnearC=near(Cnear,atoms,'C')
-    mask=[0]*(total_atoms-7)+[1]*7
-    elements=atoms.get_chemical_symbols()
-    elements[i]='C'
+    total_atoms = len(atoms)
+    Cnear = near(i,  atoms)
+    CnearC = near(Cnear, atoms, 'C')
+    mask = [0]*(total_atoms-7) + [1]*7
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'C'
     try:
-        if strict[1]=='N':
-            elements[i]='N'
+        if strict[1] == 'N':
+            elements[i] = 'N'
         else:
-            elements[i]='C'
+            elements[i] = 'C'
     except:
-        elements[i]='C'
+        elements[i] = 'C'
     atoms.set_chemical_symbols(elements)
-    if elements[i]=='C':
-        if state==1:
-            atoms.set_distance(i,Cnear,1.5290,fix=1)
-        elif state==2 or state==82:
-            atoms.set_distance(i,Cnear,1.5095,fix=1)
-        elif state==3:
-            atoms.set_distance(i,Cnear,1.4700,fix=1)
-        elif state==6:
-            atoms.set_distance(i,Cnear,1.5105,fix=1)
-        elif state==7:
-            atoms.set_distance(i,Cnear,1.4480,fix=1)
-        elif state==8:
-            atoms.set_distance(i,Cnear,1.4100,fix=1)
-        elif state==16:
-            atoms.set_distance(i,Cnear,1.8100,fix=1)
-        elif state==162:
-            atoms.set_distance(i,Cnear,1.7900,fix=1)
-        elif state==164:
-            atoms.set_distance(i,Cnear,1.7700,fix=1)
-    elif elements[i]=='N':
-        if state==1:
-            atoms.set_distance(i,Cnear,1.448,fix=1)
-        elif state==2 or state==6:
-            atoms.set_distance(i,Cnear,1.340,fix=1)
+    if elements[i] == 'C':
+        if state == 1:
+            atoms.set_distance(i, Cnear, 1.5290, fix=1)
+        elif state == 2 or state == 82:
+            atoms.set_distance(i, Cnear, 1.5095, fix=1)
+        elif state == 3:
+            atoms.set_distance(i, Cnear, 1.4700, fix=1)
+        elif state == 6:
+            atoms.set_distance(i, Cnear, 1.5105, fix=1)
+        elif state == 7:
+            atoms.set_distance(i, Cnear, 1.4480, fix=1)
+        elif state == 8:
+            atoms.set_distance(i, Cnear, 1.4100, fix=1)
+        elif state == 16:
+            atoms.set_distance(i, Cnear, 1.8100, fix=1)
+        elif state == 162:
+            atoms.set_distance(i, Cnear, 1.7900, fix=1)
+        elif state == 164:
+            atoms.set_distance(i, Cnear, 1.7700, fix=1)
+    elif elements[i] == 'N':
+        if state == 1:
+            atoms.set_distance(i, Cnear, 1.448, fix=1)
+        elif state == 2 or state == 6:
+            atoms.set_distance(i, Cnear, 1.340, fix=1)
         else:
-            atoms.set_distance(i,Cnear,1.448,fix=1)
-    x=atoms.get_positions()
-    x[-5][0]=x[-5][0]-50
-    x[-5][1]=x[-5][1]-50
-    x[-5][2]=x[-5][2]-50
-    x[-7][0]=x[-7][0]-50
-    x[-7][1]=x[-7][1]-50
-    x[-7][2]=x[-7][2]-50
-    x[-6][0]=x[-6][0]+50
-    x[-6][1]=x[-6][1]+50
-    x[-6][2]=x[-6][2]+50
-    for j in range(-4,-2):
-        x[j][0]=x[j][0]-50
-        x[j][1]=x[j][1]-50
-        x[j][2]=x[j][2]-50
-    for j in range(-2,0):
-        x[j][0]=x[j][0]+50
-        x[j][1]=x[j][1]+50
-        x[j][2]=x[j][2]+50
+            atoms.set_distance(i, Cnear, 1.448, fix=1)
+    x = atoms.get_positions()
+    x[-5][0] = x[-5][0] - 50
+    x[-5][1] = x[-5][1] - 50
+    x[-5][2] = x[-5][2] - 50
+    x[-7][0] = x[-7][0] - 50
+    x[-7][1] = x[-7][1] - 50
+    x[-7][2] = x[-7][2] - 50
+    x[-6][0] = x[-6][0] + 50
+    x[-6][1] = x[-6][1] + 50
+    x[-6][2] = x[-6][2] + 50
+    for j in range(-4, -2):
+        x[j][0] = x[j][0] - 50
+        x[j][1] = x[j][1] - 50
+        x[j][2] = x[j][2] - 50
+    for j in range(-2, 0):
+        x[j][0] = x[j][0] + 50
+        x[j][1] = x[j][1] + 50
+        x[j][2] = x[j][2] + 50
     atoms.set_positions(x)
-    if elements[i]=='C':
-        atoms.set_angle(Cnear,i,total_atoms-5,109.5,mask=mask)
-        atoms.set_distance(total_atoms-5,i,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-5,-150,mask=mask)
-        mask[-5]=0
+    if elements[i] == 'C':
+        atoms.set_angle(Cnear, i, total_atoms-5, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-5, i, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-5, -150, mask=mask)
+        mask[-5] = 0
     else:
-        mask[-5]=0
-    if elements[i]=='N':
-        atoms.set_angle(Cnear,i,total_atoms-7,122.5,mask=mask)
-        atoms.set_distance(total_atoms-7,i,1.4480,fix=1,mask=mask)
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-7,0.5,mask=mask)
-        mask[-7]=0
-        atoms.set_angle(Cnear,i,total_atoms-6,122.5,mask=mask)
-        atoms.set_distance(total_atoms-6,i,1.4480,fix=1,mask=mask)
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-6,73.5,mask=mask)
-        mask[-6]=0
-    elif elements[i]=='C':
-        atoms.set_angle(Cnear,i,total_atoms-7,122.5,mask=mask)
-        atoms.set_distance(total_atoms-7,i,1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-7,0.5,mask=mask)
-        mask[-7]=0
-        atoms.set_angle(Cnear,i,total_atoms-6,122.5,mask=mask)
-        atoms.set_distance(total_atoms-6,i,1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(CnearC,Cnear,i,total_atoms-6,73.5,mask=mask)
-        mask[-6]=0
-    atoms.set_angle(i,total_atoms-7,total_atoms-4,122.5,mask=mask)
-    atoms.set_distance(total_atoms-4,total_atoms-7,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-7,total_atoms-4,5,mask=mask)
-    mask[-4]=0
-    atoms.set_angle(i,total_atoms-7,total_atoms-3,122.5,mask=mask)
-    atoms.set_distance(total_atoms-3,total_atoms-7,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-7,total_atoms-3,-140,mask=mask)
-    mask[-3]=0
-    atoms.set_angle(i,total_atoms-6,total_atoms-2,122.5,mask=mask)
-    atoms.set_distance(total_atoms-2,total_atoms-6,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-6,total_atoms-2,-5,mask=mask)
-    mask[-2]=0
-    atoms.set_angle(i,total_atoms-6,total_atoms-1,122.5,mask=mask)
-    atoms.set_distance(total_atoms-1,total_atoms-6,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-6,total_atoms-1,140,mask=mask)
-    mask[-1]=0
+        mask[-5] = 0
+    if elements[i] == 'N':
+        atoms.set_angle(Cnear, i, total_atoms-7, 122.5, mask=mask)
+        atoms.set_distance(total_atoms-7, i, 1.4480, fix=1, mask=mask)
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-7, 0.5, mask=mask)
+        mask[-7] = 0
+        atoms.set_angle(Cnear, i, total_atoms-6, 122.5, mask=mask)
+        atoms.set_distance(total_atoms-6, i, 1.4480, fix=1, mask=mask)
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-6, 73.5, mask=mask)
+        mask[-6] = 0
+    elif elements[i] == 'C':
+        atoms.set_angle(Cnear, i, total_atoms-7, 122.5, mask=mask)
+        atoms.set_distance(total_atoms-7, i, 1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-7, 0.5, mask=mask)
+        mask[-7] = 0
+        atoms.set_angle(Cnear, i, total_atoms-6, 122.5, mask=mask)
+        atoms.set_distance(total_atoms-6, i, 1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(CnearC, Cnear, i, total_atoms-6, 73.5, mask=mask)
+        mask[-6] = 0
+    atoms.set_angle(i, total_atoms-7, total_atoms-4, 122.5, mask=mask)
+    atoms.set_distance(total_atoms-4, total_atoms-7, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-7, total_atoms-4, 5, mask=mask)
+    mask[-4] = 0
+    atoms.set_angle(i, total_atoms-7, total_atoms-3, 122.5, mask=mask)
+    atoms.set_distance(total_atoms-3, total_atoms-7, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-7, total_atoms-3, -140, mask=mask)
+    mask[-3] = 0
+    atoms.set_angle(i, total_atoms-6, total_atoms-2, 122.5, mask=mask)
+    atoms.set_distance(total_atoms-2, total_atoms-6, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-6, total_atoms-2, -5, mask=mask)
+    mask[-2] = 0
+    atoms.set_angle(i, total_atoms-6, total_atoms-1, 122.5, mask=mask)
+    atoms.set_distance(total_atoms-1, total_atoms-6, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-6, total_atoms-1, 140, mask=mask)
+    mask[-1] = 0
     for j in range(2):
         try:
-            ring_element=strict[j+2]
+            ring_element = strict[j+2]
         except: 
             continue
-        elements=atoms.get_chemical_symbols()
-        if ring_element=='O':
-            elements[-7+j]='O'
+        elements = atoms.get_chemical_symbols()
+        if ring_element == 'O':
+            elements[-7+j] = 'O'
             atoms.set_chemical_symbols(elements)
-            mask=[0]*total_atoms
-            mask[-7+j]=1
-            if j==0:
+            mask = [0] * total_atoms
+            mask[-7+j] = 1
+            if j == 0:
                 for l in range(10):
-                    atoms.set_distance(total_atoms-6,total_atoms-7,1.4100,mask=mask)
-                    atoms.set_distance(i,total_atoms-7,1.4100,mask=mask)
-            elif j==1:
+                    atoms.set_distance(total_atoms-6, total_atoms-7, 1.4100, mask=mask)
+                    atoms.set_distance(i, total_atoms-7, 1.4100, mask=mask)
+            elif j == 1:
                 for l in range(10):
-                    atoms.set_distance(i,total_atoms-6,1.4100,mask=mask)
-                    atoms.set_distance(total_atoms-7,total_atoms-6,1.4100,mask=mask)
-        elif ring_element=='S':
-            elements[-7+j]='S'
+                    atoms.set_distance(i, total_atoms-6, 1.4100, mask=mask)
+                    atoms.set_distance(total_atoms-7, total_atoms-6, 1.4100, mask=mask)
+        elif ring_element == 'S':
+            elements[-7+j] = 'S'
             atoms.set_chemical_symbols(elements)
-            mask=[0]*total_atoms
-            mask[-7+j]=1
-            if j==0:
+            mask = [0] * total_atoms
+            mask[-7+j] = 1
+            if j == 0:
                 for l in range(10):
-                    atoms.set_distance(total_atoms-6,total_atoms-7,1.8100,mask=mask)
-                    atoms.set_distance(i,total_atoms-7,1.8100,mask=mask)
-            elif j==1:
+                    atoms.set_distance(total_atoms-6, total_atoms-7, 1.8100, mask=mask)
+                    atoms.set_distance(i, total_atoms-7, 1.8100, mask=mask)
+            elif j == 1:
                 for l in range(10):
-                    atoms.set_distance(i,total_atoms-6,1.8100,mask=mask)
-                    atoms.set_distance(total_atoms-7,total_atoms-6,1.8100,mask=mask)
-        elif ring_element=='N':
-            elements[-7+j]='N'
+                    atoms.set_distance(i, total_atoms-6, 1.8100, mask=mask)
+                    atoms.set_distance(total_atoms-7, total_atoms-6, 1.8100, mask=mask)
+        elif ring_element == 'N':
+            elements[-7+j] = 'N'
             atoms.set_chemical_symbols(elements)
-            mask=[0]*total_atoms
-            mask[-7+j]=1
-            if j==0:
+            mask = [0] * total_atoms
+            mask[-7+j] = 1
+            if j == 0:
                 for l in range(10):
-                    atoms.set_distance(total_atoms-6,total_atoms-7,1.4480,mask=mask)
-                    atoms.set_distance(i,total_atoms-7,1.4480,mask=mask)
-                mask[-7]=0
-                mask[-3]=1
+                    atoms.set_distance(total_atoms-6, total_atoms-7, 1.4480, mask=mask)
+                    atoms.set_distance(i, total_atoms-7, 1.4480, mask=mask)
+                mask[-7] = 0
+                mask[-3] = 1
                 for l in range(10):
-                    atoms.set_angle(i,total_atoms-7,total_atoms-3,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-6,total_atoms-7,total_atoms-3,109.5,mask=mask)
-                atoms.set_distance(total_atoms-3,total_atoms-7,1.0100,fix=1,mask=mask)
-                mask[-3]=0
-            elif j==1:
+                    atoms.set_angle(i, total_atoms-7, total_atoms-3, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-6, total_atoms-7, total_atoms-3, 109.5, mask=mask)
+                atoms.set_distance(total_atoms-3, total_atoms-7, 1.0100, fix=1, mask=mask)
+                mask[-3] = 0
+            elif j == 1:
                 for l in range(10):
-                    atoms.set_distance(i,total_atoms-6,1.4480,mask=mask)
-                    atoms.set_distance(total_atoms-7,total_atoms-6,1.4480,mask=mask)
-                mask[-6]=0
-                mask[-1]=1
+                    atoms.set_distance(i, total_atoms-6, 1.4480, mask=mask)
+                    atoms.set_distance(total_atoms-7, total_atoms-6, 1.4480, mask=mask)
+                mask[-6] = 0
+                mask[-1] = 1
                 for l in range(10):
-                    atoms.set_angle(i,total_atoms-6,total_atoms-1,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-7,total_atoms-6,total_atoms-1,109.5,mask=mask)
-                atoms.set_distance(total_atoms-1,total_atoms-6,1.0100,fix=1,mask=mask)
-                mask[-1]=0
-        mask[-7+j]=0
+                    atoms.set_angle(i, total_atoms-6, total_atoms-1, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-7, total_atoms-6, total_atoms-1, 109.5, mask=mask)
+                atoms.set_distance(total_atoms-1, total_atoms-6, 1.0100, fix=1, mask=mask)
+                mask[-1] = 0
+        mask[-7+j] = 0
     try:
-        if strict[1]=='N':
+        if strict[1] == 'N':
             del atoms[-5]
         else:
             pass
     except:
         pass
     deleted=[]
     for j in range(2):
         try:
-            ring_element=strict[j+2]
+            ring_element = strict[j+2]
         except: 
             continue
-        if ring_element=='N':
-            if j+2==2:
+        if ring_element == 'N':
+            if j + 2 == 2:
                 deleted.append(total_atoms-4)
-            if j+2==3:
+            if j + 2 == 3:
                 deleted.append(total_atoms-2)
         else:
-            if j+2==2:
+            if j + 2 == 2:
                 deleted.append(total_atoms-3)
                 deleted.append(total_atoms-4)
-            if j+2==3:
+            if j + 2 == 3:
                 deleted.append(total_atoms-1)
                 deleted.append(total_atoms-2)
     deleted.sort(reverse=True)
     for d in deleted:
         del atoms[d]
     return atoms
 
-def ring5(atoms,i,state=1,strict={1:'X'},shuffle=0):
-    Cnear=near(i, atoms)
+def ring5(atoms, i, state=1, strict={1:'X'}, shuffle=0):
+    Cnear = near(i, atoms)
     try:
-        if strict[1]=='N':
+        if strict[1] == 'N':
             pass
     except:
-        strict[1]='X'
-    if strict[1]=='N':
-        atoms=NH2(atoms,i,state)
+        strict[1] = 'X'
+    if strict[1] == 'N':
+        atoms = NH2(atoms, i, state)
     else:
-        atoms=CH3(atoms,i,state)
+        atoms = CH3(atoms, i, state)
     for j in range(2):
         atoms.append('C')
     for j in range(8):
         atoms.append('H')
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-10)+[1]*10
-    elements=atoms.get_chemical_symbols()
-    if shuffle==0:
-        box=[-12,-11]
-    elif shuffle==1:
-        box=[-13,-12]
-    elif shuffle==2:
-        box=[-11,-13]
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-10) + [1]*10
+    elements = atoms.get_chemical_symbols()
+    if shuffle == 0:
+        box=[-12, -11]
+    elif shuffle == 1:
+        box=[-13, -12]
+    elif shuffle == 2:
+        box=[-11, -13]
     for j in box:
-        elements[total_atoms+j]='C'
+        elements[total_atoms+j] = 'C'
         atoms.set_chemical_symbols(elements)
-        if strict[1]=='N':
-            atoms.set_distance(total_atoms+j,i,1.4480,fix=1)
+        if strict[1] == 'N':
+            atoms.set_distance(total_atoms+j, i, 1.4480, fix=1)
         else:
-            atoms.set_distance(total_atoms+j,i,1.5290,fix=1)
-    x=atoms.get_positions()
-    x[-10][0]=x[-10][0]-50
-    x[-10][1]=x[-10][1]-50
-    x[-10][2]=x[-10][2]-50
-    x[-9][0]=x[-9][0]+50
-    x[-9][1]=x[-9][1]+50
-    x[-9][2]=x[-9][2]+50
-    for j in range(-8,-4):
-        x[j][0]=x[j][0]-50
-        x[j][1]=x[j][1]-50
-        x[j][2]=x[j][2]-50
-    for j in range(-4,0):
-        x[j][0]=x[j][0]+50
-        x[j][1]=x[j][1]+50
-        x[j][2]=x[j][2]+50
-    if strict[1]=='N':
+            atoms.set_distance(total_atoms+j, i, 1.5290, fix=1)
+    x = atoms.get_positions()
+    x[-10][0] = x[-10][0] - 50
+    x[-10][1] = x[-10][1] - 50
+    x[-10][2] = x[-10][2] - 50
+    x[-9][0] = x[-9][0] + 50
+    x[-9][1] = x[-9][1] + 50
+    x[-9][2] = x[-9][2] + 50
+    for j in range(-8, -4):
+        x[j][0] = x[j][0] - 50
+        x[j][1] = x[j][1] - 50
+        x[j][2] = x[j][2] - 50
+    for j in range(-4, 0):
+        x[j][0] = x[j][0] + 50
+        x[j][1] = x[j][1] + 50
+        x[j][2] = x[j][2] + 50
+    if strict[1] == 'N':
         atoms.set_positions(x)
-        atoms.set_angle(i,total_atoms+box[0],total_atoms-10,104.98,mask=mask)
-        atoms.set_distance(total_atoms-10,total_atoms+box[0],1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms+box[0],total_atoms-10,164.01,mask=mask)
-        mask[-10]=0
-        atoms.set_angle(i,total_atoms+box[1],total_atoms-9,104.98,mask=mask)
-        atoms.set_distance(total_atoms-9,total_atoms+box[1],1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms+box[1],total_atoms-9,-164.01,mask=mask)
-        mask[-9]=0
+        atoms.set_angle(i, total_atoms+box[0], total_atoms-10, 104.98, mask=mask)
+        atoms.set_distance(total_atoms-10, total_atoms+box[0], 1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms+box[0], total_atoms-10,\
+                           164.01, mask=mask)
+        mask[-10] = 0
+        atoms.set_angle(i, total_atoms+box[1], total_atoms-9, 104.98, mask=mask)
+        atoms.set_distance(total_atoms-9, total_atoms+box[1], 1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms+box[1], total_atoms-9,\
+                           -164.01, mask=mask)
+        mask[-9] = 0
     else:
         atoms.set_positions(x)
-        atoms.set_angle(i,total_atoms+box[0],total_atoms-10,99.37,mask=mask)
-        atoms.set_distance(total_atoms-10,total_atoms+box[0],1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms+box[0],total_atoms-10,-161,mask=mask)
-        mask[-10]=0
-        atoms.set_angle(i,total_atoms+box[1],total_atoms-9,99.37,mask=mask)
-        atoms.set_distance(total_atoms-9,total_atoms+box[1],1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms+box[1],total_atoms-9,161,mask=mask)
-        mask[-9]=0
-    atoms.set_angle(i,total_atoms+box[0],total_atoms-8,109.5,mask=mask)
-    atoms.set_distance(total_atoms-8,total_atoms+box[0],1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[0],total_atoms-8,75,mask=mask)
-    mask[-8]=0
-    atoms.set_angle(i,total_atoms+box[0],total_atoms-7,109.5,mask=mask)
-    atoms.set_distance(total_atoms-7,total_atoms+box[0],1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[0],total_atoms-7,-45,mask=mask)
-    mask[-7]=0
-    atoms.set_angle(i,total_atoms+box[1],total_atoms-6,109.5,mask=mask)
-    atoms.set_distance(total_atoms-6,total_atoms+box[1],1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[1],total_atoms-6,-75,mask=mask)
-    mask[-6]=0
-    atoms.set_angle(i,total_atoms+box[1],total_atoms-5,109.5,mask=mask)
-    atoms.set_distance(total_atoms-5,total_atoms+box[1],1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[1],total_atoms-5,45,mask=mask)
-    mask[-5]=0
-    if strict[1]=='N':
-        atoms.set_angle(total_atoms+box[0],total_atoms-10,total_atoms-4,109.5,mask=mask)
-        atoms.set_distance(total_atoms-4,total_atoms-10,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[0],total_atoms-10,total_atoms-4,-140.5,mask=mask)
-        mask[-4]=0
-        atoms.set_angle(total_atoms+box[0],total_atoms-10,total_atoms-3,109.5,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms-10,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[0],total_atoms-10,total_atoms-3,95,mask=mask)
-        mask[-3]=0
-        atoms.set_angle(total_atoms+box[1],total_atoms-9,total_atoms-2,109.5,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-9,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1],total_atoms-9,total_atoms-2,140.5,mask=mask)
-        mask[-2]=0
-        atoms.set_angle(total_atoms+box[1],total_atoms-9,total_atoms-1,109.5,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-9,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1],total_atoms-9,total_atoms-1,-95,mask=mask)
-        mask[-1]=0
+        atoms.set_angle(i, total_atoms+box[0], total_atoms-10, 99.37, mask=mask)
+        atoms.set_distance(total_atoms-10, total_atoms+box[0], 1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms+box[0], total_atoms-10,\
+                           -161, mask=mask)
+        mask[-10] = 0
+        atoms.set_angle(i, total_atoms+box[1], total_atoms-9, 99.37, mask=mask)
+        atoms.set_distance(total_atoms-9, total_atoms+box[1], 1.5290,\
+                           fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms+box[1], total_atoms-9,\
+                           161, mask=mask)
+        mask[-9] = 0
+    atoms.set_angle(i, total_atoms+box[0], total_atoms-8, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-8, total_atoms+box[0], 1.0900,\
+                       fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[0], total_atoms-8,\
+                       75, mask=mask)
+    mask[-8] = 0
+    atoms.set_angle(i, total_atoms+box[0], total_atoms-7, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-7, total_atoms+box[0], 1.0900,\
+                       fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[0], total_atoms-7,\
+                       -45, mask=mask)
+    mask[-7] = 0
+    atoms.set_angle(i, total_atoms+box[1], total_atoms-6, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-6, total_atoms+box[1], 1.0900,\
+                       fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[1], total_atoms-6,\
+                       -75, mask=mask)
+    mask[-6] = 0
+    atoms.set_angle(i, total_atoms+box[1], total_atoms-5, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-5, total_atoms+box[1], 1.0900,\
+                       fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[1], total_atoms-5,\
+                       45, mask=mask)
+    mask[-5] = 0
+    if strict[1] == 'N':
+        atoms.set_angle(total_atoms+box[0], total_atoms-10,\
+                        total_atoms-4, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-4, total_atoms-10, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[0], total_atoms-10,\
+                           total_atoms-4, -140.5, mask=mask)
+        mask[-4] = 0
+        atoms.set_angle(total_atoms+box[0], total_atoms-10,\
+                        total_atoms-3, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms-10, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[0], total_atoms-10,\
+                           total_atoms-3, 95, mask=mask)
+        mask[-3] = 0
+        atoms.set_angle(total_atoms+box[1], total_atoms-9,\
+                        total_atoms-2, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-9, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1], total_atoms-9,\
+                           total_atoms-2, 140.5, mask=mask)
+        mask[-2] = 0
+        atoms.set_angle(total_atoms+box[1], total_atoms-9,\
+                        total_atoms-1, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-9, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1], total_atoms-9,\
+                           total_atoms-1, -95, mask=mask)
+        mask[-1] = 0
     else:
-        atoms.set_angle(total_atoms+box[0],total_atoms-10,total_atoms-4,109.5,mask=mask)
-        atoms.set_distance(total_atoms-4,total_atoms-10,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[0],total_atoms-10,total_atoms-4,-90.5,mask=mask)
-        mask[-4]=0
-        atoms.set_angle(total_atoms+box[0],total_atoms-10,total_atoms-3,109.5,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms-10,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[0],total_atoms-10,total_atoms-3,145,mask=mask)
-        mask[-3]=0
-        atoms.set_angle(total_atoms+box[1],total_atoms-9,total_atoms-2,109.5,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-9,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1],total_atoms-9,total_atoms-2,90.5,mask=mask)
-        mask[-2]=0
-        atoms.set_angle(total_atoms+box[1],total_atoms-9,total_atoms-1,109.5,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-9,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1],total_atoms-9,total_atoms-1,-145,mask=mask)
-        mask[-1]=0
+        atoms.set_angle(total_atoms+box[0], total_atoms-10,\
+                        total_atoms-4, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-4, total_atoms-10, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[0], total_atoms-10,\
+                           total_atoms-4, -90.5, mask=mask)
+        mask[-4] = 0
+        atoms.set_angle(total_atoms+box[0], total_atoms-10,\
+                        total_atoms-3, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms-10, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[0], total_atoms-10,\
+                           total_atoms-3, 145, mask=mask)
+        mask[-3] = 0
+        atoms.set_angle(total_atoms+box[1], total_atoms-9,\
+                        total_atoms-2, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-9, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1], total_atoms-9,\
+                           total_atoms-2, 90.5, mask=mask)
+        mask[-2] = 0
+        atoms.set_angle(total_atoms+box[1], total_atoms-9,\
+                        total_atoms-1, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-9, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1], total_atoms-9,\
+                           total_atoms-1, -145, mask=mask)
+        mask[-1] = 0
     l=0
     for j in range(4):
         try:
-            ring_element=strict[j+2]
+            ring_element = strict[j+2]
         except: 
             continue
-        if ring_element=='O':
+        if ring_element == 'O':
             mask.append(1)
             atoms.append(ring_element)
-            if j+2==2:
-                atoms.set_distance(total_atoms+l,total_atoms+box[0],0,fix=1,mask=mask)
+            if j + 2 == 2:
+                atoms.set_distance(total_atoms+l, total_atoms+box[0], 0, fix=1, mask=mask)
                 for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms-10,1.4100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,i,1.4100,fix=1,mask=mask)
-            elif j+2==3:
-                atoms.set_distance(total_atoms+l,total_atoms-10,0,fix=1,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[0],1.4100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-9,1.4100,fix=1,mask=mask)
-            elif j+2==4:
-                atoms.set_distance(total_atoms+l,total_atoms-9,0,fix=1,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[1],1.4100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-10,1.4100,fix=1,mask=mask)
-            elif j+2==5:
-                atoms.set_distance(total_atoms+l,total_atoms+box[1],0,fix=1,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,i,1.4100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-9,1.4100,fix=1,mask=mask)
-            mask[-1]=0
-            l=l+1
-        elif ring_element=='S':
+                    atoms.set_distance(total_atoms+l, total_atoms-10, 1.4100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, i, 1.4100, fix=1, mask=mask)
+            elif j + 2 == 3:
+                atoms.set_distance(total_atoms+l, total_atoms-10, 0, fix=1, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms+box[0], 1.4100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-9, 1.4100, fix=1, mask=mask)
+            elif j + 2 == 4:
+                atoms.set_distance(total_atoms+l, total_atoms-9, 0, fix=1, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms+box[1], 1.4100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-10, 1.4100, fix=1, mask=mask)
+            elif j + 2 == 5:
+                atoms.set_distance(total_atoms+l, total_atoms+box[1], 0, fix=1, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, i, 1.4100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-9, 1.4100, fix=1, mask=mask)
+            mask[-1] = 0
+            l = l + 1
+        elif ring_element == 'S':
             mask.append(1)
             atoms.append(ring_element)
-            if j+2==4:
-                atoms.set_distance(total_atoms+l,total_atoms-9,0,fix=1,mask=mask)
+            if j + 2 == 4:
+                atoms.set_distance(total_atoms+l, total_atoms-9, 0, fix=1, mask=mask)
                 for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[1],1.8100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-10,1.8100,fix=1,mask=mask)
-            elif j+2==3:
-                atoms.set_distance(total_atoms+l,total_atoms-10,0,fix=1,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[0],1.8100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-9,1.8100,fix=1,mask=mask)
-            elif j+2==5:
-                atoms.set_distance(total_atoms+l,total_atoms+box[1],0,fix=1,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,i,1.8100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-9,1.8100,fix=1,mask=mask)
-            elif j+2==2:
-                atoms.set_distance(total_atoms+l,total_atoms+box[0],0,fix=1,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms-10,1.8100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,i,1.8100,fix=1,mask=mask)
-            mask[-1]=0
-            l=l+1
-        elif ring_element=='N':
+                    atoms.set_distance(total_atoms+l, total_atoms+box[1], 1.8100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-10, 1.8100, fix=1, mask=mask)
+            elif j + 2 == 3:
+                atoms.set_distance(total_atoms+l, total_atoms-10, 0, fix=1, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms+box[0], 1.8100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-9, 1.8100, fix=1, mask=mask)
+            elif j + 2 == 5:
+                atoms.set_distance(total_atoms+l, total_atoms+box[1], 0, fix=1, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, i, 1.8100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-9, 1.8100, fix=1, mask=mask)
+            elif j + 2 == 2:
+                atoms.set_distance(total_atoms+l, total_atoms+box[0], 0, fix=1, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms-10, 1.8100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, i, 1.8100, fix=1, mask=mask)
+            mask[-1] = 0
+            l = l + 1
+        elif ring_element == 'N':
             mask.append(1)
             mask.append(1)
             atoms.append(ring_element)
             atoms.append('H')
-            x=atoms.get_positions()
-            x[-1][0]=x[-1][0]-50
-            x[-1][1]=x[-1][1]-50
-            x[-1][2]=x[-1][2]-50
+            x = atoms.get_positions()
+            x[-1][0] = x[-1][0] - 50
+            x[-1][1] = x[-1][1] - 50
+            x[-1][2] = x[-1][2] - 50
             atoms.set_positions(x)
-            if j+2==4:
-                atoms.set_distance(total_atoms+l,total_atoms-9,0,fix=1,mask=mask)
+            if j + 2 == 4:
+                atoms.set_distance(total_atoms+l, total_atoms-9, 0, fix=1, mask=mask)
                 # Pseudo-Optimization
                 for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[1],1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-10,1.4480,fix=1,mask=mask)
-                mask[-2]=0
-                for k in range(10):
-                    atoms.set_angle(total_atoms-10,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                    atoms.set_angle(total_atoms+box[1],total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                atoms.set_distance(total_atoms+l+1,total_atoms+l,1.0100,fix=1,mask=mask)
-            elif j+2==3:
-                atoms.set_distance(total_atoms+l,total_atoms-10,0,fix=1,mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms+box[1], 1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-10, 1.4480, fix=1, mask=mask)
+                mask[-2] = 0
+                for k in range(10):
+                    atoms.set_angle(total_atoms-10, total_atoms+l, \
+                                    total_atoms+l+1, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms+box[1], total_atoms+l,\
+                                    total_atoms+l+1, 109.5, mask=mask)
+                atoms.set_distance(total_atoms+l+1, total_atoms+l, 1.0100, fix=1, mask=mask)
+            elif j + 2 == 3:
+                atoms.set_distance(total_atoms+l, total_atoms-10, 0, fix=1, mask=mask)
                 # Pseudo-Optimization
                 for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[0],1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-9,1.4480,fix=1,mask=mask)
-                mask[-2]=0
-                for k in range(10):
-                    atoms.set_angle(total_atoms+box[0],total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-9,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                atoms.set_distance(total_atoms+l+1,total_atoms+l,1.0100,fix=1,mask=mask)
-            elif j+2==5:
-                atoms.set_distance(total_atoms+l,total_atoms+box[1],0,fix=1,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,i,1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-9,1.4480,fix=1,mask=mask)
-                mask[-2]=0
-                for k in range(10):
-                    atoms.set_angle(i,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-9,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                atoms.set_distance(total_atoms+l+1,total_atoms+l,1.0100,fix=1,mask=mask)
-            elif j+2==2:
-                atoms.set_distance(total_atoms+l,total_atoms+box[0],0,fix=1,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms-10,1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,i,1.4480,fix=1,mask=mask)
-                mask[-2]=0
-                for k in range(10):
-                    atoms.set_angle(i,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-10,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                atoms.set_distance(total_atoms+l+1,total_atoms+l,1.0100,fix=1,mask=mask)
-            mask[-1]=0
-            l=l+2
-    deleted=[]
+                    atoms.set_distance(total_atoms+l, total_atoms+box[0], 1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-9, 1.4480, fix=1, mask=mask)
+                mask[-2] = 0
+                for k in range(10):
+                    atoms.set_angle(total_atoms+box[0], total_atoms+l,\
+                                    total_atoms+l+1, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-9, total_atoms+l,\
+                                    total_atoms+l+1, 109.5, mask=mask)
+                atoms.set_distance(total_atoms+l+1, total_atoms+l, 1.0100, fix=1, mask=mask)
+            elif j + 2 == 5:
+                atoms.set_distance(total_atoms+l, total_atoms+box[1], 0, fix=1, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, i, 1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-9, 1.4480, fix=1, mask=mask)
+                mask[-2] = 0
+                for k in range(10):
+                    atoms.set_angle(i, total_atoms+l, total_atoms+l+1, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-9, total_atoms+l,\
+                                    total_atoms+l+1, 109.5, mask=mask)
+                atoms.set_distance(total_atoms+l+1, total_atoms+l, 1.0100, fix=1, mask=mask)
+            elif j + 2 == 2:
+                atoms.set_distance(total_atoms+l, total_atoms+box[0], 0, fix=1, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms-10, 1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, i, 1.4480, fix=1, mask=mask)
+                mask[-2] = 0
+                for k in range(10):
+                    atoms.set_angle(i, total_atoms+l, total_atoms+l+1, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-10, total_atoms+l,\
+                                    total_atoms+l+1, 109.5, mask=mask)
+                atoms.set_distance(total_atoms+l+1, total_atoms+l, 1.0100, fix=1, mask=mask)
+            mask[-1] = 0
+            l = l + 2
+    deleted = []
     for j in range(5):
         try:
-            ring_element=strict[j+2]
+            ring_element = strict[j+2]
         except: 
             continue
-        if j+2==4:
+        if j + 2 == 4:
             deleted.append(total_atoms-1)
             deleted.append(total_atoms-2)
             deleted.append(total_atoms-9)
-        if j+2==3:
+        if j + 2 == 3:
             deleted.append(total_atoms-3)
             deleted.append(total_atoms-4)
             deleted.append(total_atoms-10)
-        if j+2==5:
+        if j + 2 == 5:
             deleted.append(total_atoms-5)
             deleted.append(total_atoms-6)
             deleted.append(total_atoms+box[1])
-        if j+2==2:
+        if j + 2 == 2:
             deleted.append(total_atoms-7)
             deleted.append(total_atoms-8)
             deleted.append(total_atoms+box[0])
     deleted.sort(reverse=True)
     for d in deleted:
         del atoms[d]
     return atoms
 
-def ring6(atoms,i,state=1,strict={1:'X'},shuffle=0):
-    Cnear=near(i, atoms)
+def ring6(atoms, i, state=1, strict={1:'X'}, shuffle=0):
+    Cnear = near(i,  atoms)
     try:
-        if strict[1]=='N':
+        if strict[1] == 'N':
             pass
     except:
-        strict[1]='X'
-    if strict[1]=='N':
-        atoms=NH2(atoms,i,state)
+        strict[1] = 'X'
+    if strict[1] == 'N':
+        atoms = NH2(atoms, i, state)
     else:
-        atoms=CH3(atoms,i,state)
+        atoms = CH3(atoms, i, state)
     for j in range(3):
         atoms.append('C')
     for j in range(10):
         atoms.append('H')
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-13)+[1]*13
-    elements=atoms.get_chemical_symbols()
-    if shuffle==0:
-        box=[-15,-14]
-    elif shuffle==1:
-        box=[-16,-15]
-    elif shuffle==2:
-        box=[-14,-16]
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-13) + [1]*13
+    elements = atoms.get_chemical_symbols()
+    if shuffle == 0:
+        box=[-15, -14]
+    elif shuffle == 1:
+        box=[-16, -15]
+    elif shuffle == 2:
+        box=[-14, -16]
     for j in box:
-        elements[total_atoms+j]='C'
+        elements[total_atoms+j] = 'C'
         atoms.set_chemical_symbols(elements)
-        if strict[1]=='N':
-            atoms.set_distance(total_atoms+j,i,1.4480,fix=1)
+        if strict[1] == 'N':
+            atoms.set_distance(total_atoms+j, i, 1.4480, fix=1)
         else:
-            atoms.set_distance(total_atoms+j,i,1.5290,fix=1)
-    x=atoms.get_positions()
-    x[-13][0]=x[-13][0]-50
-    x[-13][1]=x[-13][1]-50
-    x[-13][2]=x[-13][2]-50
-    x[-12][0]=x[-12][0]-50
-    x[-12][1]=x[-12][1]-50
-    x[-12][2]=x[-12][2]-50
-    x[-11][0]=x[-11][0]+50
-    x[-11][1]=x[-11][1]+50
-    x[-11][2]=x[-11][2]+50
-    for j in range(-10,-5):
-        x[j][0]=x[j][0]-50
-        x[j][1]=x[j][1]-50
-        x[j][2]=x[j][2]-50
-    for j in range(-5,0):
-        x[j][0]=x[j][0]+50
-        x[j][1]=x[j][1]+50
-        x[j][2]=x[j][2]+50
+            atoms.set_distance(total_atoms+j, i, 1.5290, fix=1)
+    x = atoms.get_positions()
+    x[-13][0] = x[-13][0] - 50
+    x[-13][1] = x[-13][1] - 50
+    x[-13][2] = x[-13][2] - 50
+    x[-12][0] = x[-12][0] - 50
+    x[-12][1] = x[-12][1] - 50
+    x[-12][2] = x[-12][2] - 50
+    x[-11][0] = x[-11][0] + 50
+    x[-11][1] = x[-11][1] + 50
+    x[-11][2] = x[-11][2] + 50
+    for j in range(-10, -5):
+        x[j][0] = x[j][0] - 50
+        x[j][1] = x[j][1] - 50
+        x[j][2] = x[j][2] - 50
+    for j in range(-5, 0):
+        x[j][0] = x[j][0] + 50
+        x[j][1] = x[j][1] + 50
+        x[j][2] = x[j][2] + 50
     atoms.set_positions(x)
-    if strict[1]=='N':
-        atoms.set_angle(i,total_atoms+box[0],total_atoms-13,115.7,mask=mask)
-        atoms.set_distance(total_atoms-13,total_atoms+box[0],1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms+box[0],total_atoms-13,170,mask=mask)
-        mask[-13]=0
-        atoms.set_angle(i,total_atoms+box[1],total_atoms-12,115.7,mask=mask)
-        atoms.set_distance(total_atoms-12,total_atoms+box[1],1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms+box[1],total_atoms-12,-170,mask=mask)
-        mask[-12]=0
-        atoms.set_angle(total_atoms+box[0],total_atoms-13,total_atoms-11,113.7,mask=mask)
+    if strict[1] == 'N':
+        atoms.set_angle(i, total_atoms+box[0], total_atoms-13, 115.7, mask=mask)
+        atoms.set_distance(total_atoms-13, total_atoms+box[0],\
+                           1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms+box[0],\
+                           total_atoms-13, 170, mask=mask)
+        mask[-13] = 0
+        atoms.set_angle(i, total_atoms+box[1], total_atoms-12, 115.7, mask=mask)
+        atoms.set_distance(total_atoms-12, total_atoms+box[1],\
+                           1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms+box[1],\
+                           total_atoms-12, -170, mask=mask)
+        mask[-12] = 0
+        atoms.set_angle(total_atoms+box[0], total_atoms-13,\
+                        total_atoms-11, 113.7, mask=mask)
         for k in range(10):
-            atoms.set_distance(total_atoms-11,total_atoms-12,1.5290,fix=1,mask=mask)
-            atoms.set_distance(total_atoms-11,total_atoms-13,1.5290,fix=1,mask=mask)
-        mask[-11]=0
+            atoms.set_distance(total_atoms-11, total_atoms-12, 1.5290, fix=1, mask=mask)
+            atoms.set_distance(total_atoms-11, total_atoms-13, 1.5290, fix=1, mask=mask)
+        mask[-11] = 0
     else:
-        atoms.set_angle(i,total_atoms+box[0],total_atoms-13,107.4,mask=mask)
-        atoms.set_distance(total_atoms-13,total_atoms+box[0],1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms+box[0],total_atoms-13,170,mask=mask)
-        mask[-13]=0
-        atoms.set_angle(i,total_atoms+box[1],total_atoms-12,107.4,mask=mask)
-        atoms.set_distance(total_atoms-12,total_atoms+box[1],1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms+box[1],total_atoms-12,-170,mask=mask)
-        mask[-12]=0
-        atoms.set_angle(total_atoms+box[0],total_atoms-13,total_atoms-11,107.4,mask=mask)
-        atoms.set_distance(total_atoms-11,total_atoms-13,1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[0],total_atoms-13,total_atoms-11,55,mask=mask)
-        mask[-11]=0
-    atoms.set_angle(i,total_atoms+box[0],total_atoms-10,109.5,mask=mask)
-    atoms.set_distance(total_atoms-10,total_atoms+box[0],1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[0],total_atoms-10,-60,mask=mask)
-    mask[-10]=0
-    atoms.set_angle(i,total_atoms+box[0],total_atoms-9,109.5,mask=mask)
-    atoms.set_distance(total_atoms-9,total_atoms+box[0],1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[0],total_atoms-9,60,mask=mask)
-    mask[-9]=0
-    atoms.set_angle(i,total_atoms+box[1],total_atoms-8,109.5,mask=mask)
-    atoms.set_distance(total_atoms-8,total_atoms+box[1],1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[1],total_atoms-8,-60,mask=mask)
-    mask[-8]=0
-    atoms.set_angle(i,total_atoms+box[1],total_atoms-7,109.5,mask=mask)
-    atoms.set_distance(total_atoms-7,total_atoms+box[1],1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[1],total_atoms-7,60,mask=mask)
-    mask[-7]=0
-    if strict[1]=='N':
-        atoms.set_angle(total_atoms+box[0],total_atoms-13,total_atoms-6,109.5,mask=mask)
-        atoms.set_distance(total_atoms-6,total_atoms-13,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[0],total_atoms-13,total_atoms-6,165,mask=mask)
-        mask[-6]=0
-        atoms.set_angle(total_atoms+box[0],total_atoms-13,total_atoms-5,109.5,mask=mask)
-        atoms.set_distance(total_atoms-5,total_atoms-13,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[0],total_atoms-13,total_atoms-5,59.5,mask=mask)
-        mask[-5]=0
-        atoms.set_angle(total_atoms+box[1],total_atoms-12,total_atoms-4,109.5,mask=mask)
-        atoms.set_distance(total_atoms-4,total_atoms-12,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1],total_atoms-12,total_atoms-4,-165,mask=mask)
-        mask[-4]=0
-        atoms.set_angle(total_atoms+box[1],total_atoms-12,total_atoms-3,109.5,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms-12,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1],total_atoms-12,total_atoms-3,-59.5,mask=mask)
-        mask[-3]=0
+        atoms.set_angle(i, total_atoms+box[0], total_atoms-13, 107.4, mask=mask)
+        atoms.set_distance(total_atoms-13, total_atoms+box[0],\
+                           1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms+box[0],\
+                           total_atoms-13, 170, mask=mask)
+        mask[-13] = 0
+        atoms.set_angle(i, total_atoms+box[1], total_atoms-12, 107.4, mask=mask)
+        atoms.set_distance(total_atoms-12, total_atoms+box[1],\
+                           1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms+box[1],\
+                           total_atoms-12, -170, mask=mask)
+        mask[-12] = 0
+        atoms.set_angle(total_atoms+box[0], total_atoms-13,\
+                        total_atoms-11, 107.4, mask=mask)
+        atoms.set_distance(total_atoms-11, total_atoms-13, 1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[0], total_atoms-13,\
+                           total_atoms-11, 55, mask=mask)
+        mask[-11] = 0
+    atoms.set_angle(i, total_atoms+box[0], total_atoms-10, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-10, total_atoms+box[0],\
+                       1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[0],\
+                       total_atoms-10, -60, mask=mask)
+    mask[-10] = 0
+    atoms.set_angle(i, total_atoms+box[0], total_atoms-9, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-9, total_atoms+box[0], 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[0], total_atoms-9, 60, mask=mask)
+    mask[-9] = 0
+    atoms.set_angle(i, total_atoms+box[1], total_atoms-8, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-8, total_atoms+box[1], 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[1], total_atoms-8, -60, mask=mask)
+    mask[-8] = 0
+    atoms.set_angle(i, total_atoms+box[1], total_atoms-7, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-7, total_atoms+box[1], 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[1], total_atoms-7, 60, mask=mask)
+    mask[-7] = 0
+    if strict[1] == 'N':
+        atoms.set_angle(total_atoms+box[0], total_atoms-13,\
+                        total_atoms-6, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-6, total_atoms-13, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[0], total_atoms-13,\
+                           total_atoms-6, 165, mask=mask)
+        mask[-6] = 0
+        atoms.set_angle(total_atoms+box[0], total_atoms-13,\
+                        total_atoms-5, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-5, total_atoms-13, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[0], total_atoms-13,\
+                           total_atoms-5, 59.5, mask=mask)
+        mask[-5] = 0
+        atoms.set_angle(total_atoms+box[1], total_atoms-12,\
+                        total_atoms-4, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-4, total_atoms-12, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1], total_atoms-12,\
+                           total_atoms-4, -165, mask=mask)
+        mask[-4] = 0
+        atoms.set_angle(total_atoms+box[1], total_atoms-12,\
+                        total_atoms-3, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms-12, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1], total_atoms-12,\
+                           total_atoms-3, -59.5, mask=mask)
+        mask[-3] = 0
     else:
-        atoms.set_angle(total_atoms+box[0],total_atoms-13,total_atoms-6,109.5,mask=mask)
-        atoms.set_distance(total_atoms-6,total_atoms-13,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[0],total_atoms-13,total_atoms-6,-75,mask=mask)
-        mask[-6]=0
-        atoms.set_angle(total_atoms+box[0],total_atoms-13,total_atoms-5,109.5,mask=mask)
-        atoms.set_distance(total_atoms-5,total_atoms-13,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[0],total_atoms-13,total_atoms-5,179.5,mask=mask)
-        mask[-5]=0
-        atoms.set_angle(total_atoms+box[1],total_atoms-12,total_atoms-4,109.5,mask=mask)
-        atoms.set_distance(total_atoms-4,total_atoms-12,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1],total_atoms-12,total_atoms-4,75,mask=mask)
-        mask[-4]=0
-        atoms.set_angle(total_atoms+box[1],total_atoms-12,total_atoms-3,109.5,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms-12,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1],total_atoms-12,total_atoms-3,-179.5,mask=mask)
-        mask[-3]=0
-    atoms.set_angle(total_atoms-13,total_atoms-11,total_atoms-2,109.5,mask=mask)
-    atoms.set_distance(total_atoms-2,total_atoms-11,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms+box[0],total_atoms-13,total_atoms-11,total_atoms-2,-179.5,mask=mask)
-    mask[-2]=0
-    atoms.set_angle(total_atoms-13,total_atoms-11,total_atoms-1,109.5,mask=mask)
-    atoms.set_distance(total_atoms-1,total_atoms-11,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms+box[0],total_atoms-12,total_atoms-11,total_atoms-1,300,mask=mask)
-    mask[-1]=0
-    l=0
+        atoms.set_angle(total_atoms+box[0], total_atoms-13,\
+                        total_atoms-6, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-6, total_atoms-13, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[0], total_atoms-13,\
+                           total_atoms-6, -75, mask=mask)
+        mask[-6] = 0
+        atoms.set_angle(total_atoms+box[0], total_atoms-13,\
+                        total_atoms-5, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-5, total_atoms-13, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[0], total_atoms-13,\
+                           total_atoms-5, 179.5, mask=mask)
+        mask[-5] = 0
+        atoms.set_angle(total_atoms+box[1], total_atoms-12,\
+                        total_atoms-4, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-4, total_atoms-12, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1], total_atoms-12,\
+                           total_atoms-4, 75, mask=mask)
+        mask[-4] = 0
+        atoms.set_angle(total_atoms+box[1], total_atoms-12,\
+                        total_atoms-3, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms-12, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1], total_atoms-12,\
+                           total_atoms-3, -179.5, mask=mask)
+        mask[-3] = 0
+    atoms.set_angle(total_atoms-13, total_atoms-11,\
+                    total_atoms-2, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-2, total_atoms-11, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms+box[0], total_atoms-13,\
+                       total_atoms-11, total_atoms-2, -179.5, mask=mask)
+    mask[-2] = 0
+    atoms.set_angle(total_atoms-13, total_atoms-11,\
+                    total_atoms-1, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-1, total_atoms-11, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms+box[0], total_atoms-12,\
+                       total_atoms-11, total_atoms-1, 300, mask=mask)
+    mask[-1] = 0
+    l = 0
     for j in range(5):
         try:
-            ring_element=strict[j+2]
+            ring_element = strict[j+2]
         except: 
             continue
-        if ring_element=='O':
+        if ring_element == 'O':
             mask.append(1)
             atoms.append(ring_element)
-            if j+2==4:
-                atoms.set_distance(total_atoms+l,total_atoms-11,0.1,fix=1,mask=mask)
-                atoms.set_angle(total_atoms+box[0],total_atoms-13,total_atoms+l,100,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms-13,1.4100,fix=1,mask=mask)
-                atoms.set_dihedral(i,total_atoms+box[0],total_atoms-13,total_atoms+l,47.9,mask=mask)
-            elif j+2==3:
-                atoms.set_distance(total_atoms+l,total_atoms-13,0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms+box[1],5,mask=mask)
+            if j + 2 == 4:
+                atoms.set_distance(total_atoms+l, total_atoms-11, 0.1, fix=1, mask=mask)
+                atoms.set_angle(total_atoms+box[0], total_atoms-13,\
+                                total_atoms+l, 100, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms-13, 1.4100, fix=1, mask=mask)
+                atoms.set_dihedral(i, total_atoms+box[0], total_atoms-13,\
+                                   total_atoms+l, 47.9, mask=mask)
+            elif j + 2 == 3:
+                atoms.set_distance(total_atoms+l, total_atoms-13, 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms+box[1], 5, mask=mask)
                 # Pseudo-Optimization
                 for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[0],1.4100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-11,1.4100,fix=1,mask=mask)
-            elif j+2==5:
-                atoms.set_distance(total_atoms+l,total_atoms-12,0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms+box[0],5,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[1],1.4100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-11,1.4100,fix=1,mask=mask)
-            elif j+2==2:
-                atoms.set_distance(total_atoms+l,total_atoms+box[0],0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms-12,5,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms-13,1.4100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,i,1.4100,fix=1,mask=mask)
-            elif j+2==6:
-                atoms.set_distance(total_atoms+l,total_atoms+box[1],0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms-13,5,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms-12,1.4100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,i,1.4100,fix=1,mask=mask)
-            l=l+1
-        elif ring_element=='S':
+                    atoms.set_distance(total_atoms+l, total_atoms+box[0], 1.4100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-11, 1.4100, fix=1, mask=mask)
+            elif j + 2 == 5:
+                atoms.set_distance(total_atoms+l, total_atoms-12, 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms+box[0], 5, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms+box[1], 1.4100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-11, 1.4100, fix=1, mask=mask)
+            elif j + 2 == 2:
+                atoms.set_distance(total_atoms+l, total_atoms+box[0], 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms-12, 5, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms-13, 1.4100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, i, 1.4100, fix=1, mask=mask)
+            elif j + 2 == 6:
+                atoms.set_distance(total_atoms+l, total_atoms+box[1], 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms-13, 5, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms-12, 1.4100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, i, 1.4100, fix=1, mask=mask)
+            l = l + 1
+        elif ring_element == 'S':
             mask.append(1)
             atoms.append(ring_element)
-            if j+2==4:
-                atoms.set_distance(total_atoms+l,total_atoms-11,0.1,fix=1,mask=mask)
-                atoms.set_angle(total_atoms+box[0],total_atoms-13,total_atoms+l,127.35,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms-13,1.8100,fix=1,mask=mask)
-                atoms.set_dihedral(i,total_atoms+box[0],total_atoms-13,total_atoms+l,47.9,mask=mask)
-            elif j+2==3:
-                atoms.set_distance(total_atoms+l,total_atoms-13,0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms+box[1],5,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[0],1.8100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-11,1.8100,fix=1,mask=mask)
-            elif j+2==5:
-                atoms.set_distance(total_atoms+l,total_atoms-12,0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms+box[0],5,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[1],1.8100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-11,1.8100,fix=1,mask=mask)
-            elif j+2==2:
-                atoms.set_distance(total_atoms+l,total_atoms+box[0],0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms-12,5,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms-13,1.8100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,i,1.8100,fix=1,mask=mask)
-            elif j+2==6:
-                atoms.set_distance(total_atoms+l,total_atoms+box[1],0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms-13,5,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms-12,1.8100,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,i,1.8100,fix=1,mask=mask)
-            l=l+1
-        elif ring_element=='N':
+            if j + 2 == 4:
+                atoms.set_distance(total_atoms+l, total_atoms-11, 0.1, fix=1, mask=mask)
+                atoms.set_angle(total_atoms+box[0], total_atoms-13,\
+                                total_atoms+l, 127.35, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms-13, 1.8100, fix=1, mask=mask)
+                atoms.set_dihedral(i, total_atoms+box[0], total_atoms-13,\
+                                   total_atoms+l, 47.9, mask=mask)
+            elif j + 2 == 3:
+                atoms.set_distance(total_atoms+l, total_atoms-13, 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms+box[1], 5, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms+box[0], 1.8100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-11, 1.8100, fix=1, mask=mask)
+            elif j + 2 == 5:
+                atoms.set_distance(total_atoms+l, total_atoms-12, 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms+box[0], 5, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms+box[1], 1.8100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-11, 1.8100, fix=1, mask=mask)
+            elif j + 2 == 2:
+                atoms.set_distance(total_atoms+l, total_atoms+box[0], 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms-12, 5, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms-13, 1.8100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, i, 1.8100, fix=1, mask=mask)
+            elif j + 2 == 6:
+                atoms.set_distance(total_atoms+l, total_atoms+box[1], 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms-13, 5, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms-12, 1.8100, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, i, 1.8100, fix=1, mask=mask)
+            l = l + 1
+        elif ring_element == 'N':
             mask.append(1)
             mask.append(1)
             atoms.append(ring_element)
             atoms.append('H')
-            x=atoms.get_positions()
-            x[-1][0]=x[-1][0]-50
-            x[-1][1]=x[-1][1]-50
-            x[-1][2]=x[-1][2]-50
+            x = atoms.get_positions()
+            x[-1][0] = x[-1][0] - 50
+            x[-1][1] = x[-1][1] - 50
+            x[-1][2] = x[-1][2] - 50
             atoms.set_positions(x)
-            if j+2==4:
-                atoms.set_distance(total_atoms+l,total_atoms-11,0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,i,5,mask=mask)
+            if j + 2 == 4:
+                atoms.set_distance(total_atoms+l, total_atoms-11, 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, i, 5, mask=mask)
                 # Pseudo-Optimization
                 for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms-13,1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-12,1.4480,fix=1,mask=mask)
-                mask[-2]=0
-                atoms.set_angle(total_atoms-13,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                atoms.set_distance(total_atoms+l+1,total_atoms+l,1.0100,fix=1,mask=mask)
-                atoms.set_dihedral(total_atoms+l+1,total_atoms+l,total_atoms-13,total_atoms+box[0],-150,mask=mask)
-            elif j+2==3:
-                atoms.set_distance(total_atoms+l,total_atoms-13,0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms-14,5,mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-13, 1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-12, 1.4480, fix=1, mask=mask)
+                mask[-2] = 0
+                atoms.set_angle(total_atoms-13, total_atoms+l, total_atoms+l+1, 109.5, mask=mask)
+                atoms.set_distance(total_atoms+l+1, total_atoms+l, 1.0100, fix=1, mask=mask)
+                atoms.set_dihedral(total_atoms+l+1, total_atoms+l,\
+                                   total_atoms-13, total_atoms+box[0], -150, mask=mask)
+            elif j + 2 == 3:
+                atoms.set_distance(total_atoms+l, total_atoms-13, 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms-14, 5, mask=mask)
                 # Pseudo-Optimization
                 for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[0],1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-11,1.4480,fix=1,mask=mask)
-                mask[-2]=0
-                for k in range(10):
-                    atoms.set_angle(total_atoms+box[0],total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-11,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                atoms.set_distance(total_atoms+l+1,total_atoms+l,1.0100,fix=1,mask=mask)
-            elif j+2==5:
-                atoms.set_distance(total_atoms+l,total_atoms-12,0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms+box[0],5,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms+box[1],1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,total_atoms-11,1.4480,fix=1,mask=mask)
-                mask[-2]=0
-                for k in range(10):
-                    atoms.set_angle(total_atoms+box[0],total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-11,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                atoms.set_distance(total_atoms+l+1,total_atoms+l,1.0100,fix=1,mask=mask)
-            elif j+2==2:
-                atoms.set_distance(total_atoms+l,total_atoms+box[0],0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms-12,5,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms-13,1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,i,1.4480,fix=1,mask=mask)
-                mask[-2]=0
-                for k in range(10):
-                    atoms.set_angle(i,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-13,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                atoms.set_distance(total_atoms+l+1,total_atoms+l,1.0100,fix=1,mask=mask)
-            elif j+2==6:
-                atoms.set_distance(total_atoms+l,total_atoms+box[1],0,fix=1,mask=mask)
-                atoms.set_distance(total_atoms+l,total_atoms-13,5,mask=mask)
-                for k in range(10):
-                    atoms.set_distance(total_atoms+l,total_atoms-12,1.4480,fix=1,mask=mask)
-                    atoms.set_distance(total_atoms+l,i,1.4480,fix=1,mask=mask)
-                mask[-2]=0
-                for k in range(10):
-                    atoms.set_angle(i,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                    atoms.set_angle(total_atoms-12,total_atoms+l,total_atoms+l+1,109.5,mask=mask)
-                atoms.set_distance(total_atoms+l+1,total_atoms+l,1.0100,fix=1,mask=mask)
-            l=l+2
-        mask[-1]=0
+                    atoms.set_distance(total_atoms+l, total_atoms+box[0], 1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-11, 1.4480, fix=1, mask=mask)
+                mask[-2] = 0
+                for k in range(10):
+                    atoms.set_angle(total_atoms+box[0], total_atoms+l,\
+                                    total_atoms+l+1, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-11, total_atoms+l, total_atoms+l+1, 109.5, mask=mask)
+                atoms.set_distance(total_atoms+l+1, total_atoms+l, 1.0100, fix=1, mask=mask)
+            elif j + 2 == 5:
+                atoms.set_distance(total_atoms+l, total_atoms-12, 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms+box[0], 5, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms+box[1], 1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, total_atoms-11, 1.4480, fix=1, mask=mask)
+                mask[-2] = 0
+                for k in range(10):
+                    atoms.set_angle(total_atoms+box[0], total_atoms+l,\
+                                    total_atoms+l+1, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-11, total_atoms+l, total_atoms+l+1, 109.5, mask=mask)
+                atoms.set_distance(total_atoms+l+1, total_atoms+l, 1.0100, fix=1, mask=mask)
+            elif j + 2 == 2:
+                atoms.set_distance(total_atoms+l, total_atoms+box[0], 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms-12, 5, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms-13, 1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, i, 1.4480, fix=1, mask=mask)
+                mask[-2] = 0
+                for k in range(10):
+                    atoms.set_angle(i, total_atoms+l, total_atoms+l+1, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-13, total_atoms+l,\
+                                    total_atoms+l+1, 109.5, mask=mask)
+                atoms.set_distance(total_atoms+l+1, total_atoms+l, 1.0100, fix=1, mask=mask)
+            elif j + 2 == 6:
+                atoms.set_distance(total_atoms+l, total_atoms+box[1], 0, fix=1, mask=mask)
+                atoms.set_distance(total_atoms+l, total_atoms-13, 5, mask=mask)
+                for k in range(10):
+                    atoms.set_distance(total_atoms+l, total_atoms-12, 1.4480, fix=1, mask=mask)
+                    atoms.set_distance(total_atoms+l, i, 1.4480, fix=1, mask=mask)
+                mask[-2] = 0
+                for k in range(10):
+                    atoms.set_angle(i, total_atoms+l, total_atoms+l+1, 109.5, mask=mask)
+                    atoms.set_angle(total_atoms-12, total_atoms+l,\
+                                    total_atoms+l+1, 109.5, mask=mask)
+                atoms.set_distance(total_atoms+l+1, total_atoms+l, 1.0100, fix=1, mask=mask)
+            l = l + 2
+        mask[-1] = 0
     deleted=[]
     for j in range(5):
         try:
-            ring_element=strict[j+2]
+            ring_element = strict[j+2]
         except: 
             continue
-        if j+2==4:
+        if j + 2 == 4:
             deleted.append(total_atoms-1)
             deleted.append(total_atoms-2)
             deleted.append(total_atoms-11)
-        if j+2==3:
+        if j + 2 == 3:
             deleted.append(total_atoms-5)
             deleted.append(total_atoms-6)
             deleted.append(total_atoms-13)
-        if j+2==5:
+        if j + 2 == 5:
             deleted.append(total_atoms-3)
             deleted.append(total_atoms-4)
             deleted.append(total_atoms-12)
-        if j+2==2:
+        if j + 2 == 2:
             deleted.append(total_atoms-9)
             deleted.append(total_atoms-10)
             deleted.append(total_atoms+box[0])
-        if j+2==6:
+        if j + 2 == 6:
             deleted.append(total_atoms-7)
             deleted.append(total_atoms-8)
             deleted.append(total_atoms+box[1])
     deleted.sort(reverse=True)
     for d in deleted:
         del atoms[d]
     return atoms
     
-def SOMe(atoms,i,state=1):
+def SOMe(atoms, i, state=1):
     atoms.append('O')
     atoms.append('H')
-    total_atoms=len(atoms)
-    elements=atoms.get_chemical_symbols()
-    elements[i]='S'
+    total_atoms = len(atoms)
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'S'
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    mask=[0]*(total_atoms-2)+[1]*2
-    x=atoms.get_positions()
-    x[-1][0]=x[-1][0]-50
-    x[-1][1]=x[-1][1]-50
-    x[-1][2]=x[-1][2]-50
-    if state==1:
-        atoms.set_distance(i,Cnear,1.7900,fix=1)
-    elif state==2 or state==6:
-        atoms.set_distance(i,Cnear,1.7700,fix=1)
-    atoms.set_distance(total_atoms-2,i,1.5300,fix=1,mask=mask)
-    atoms.set_angle(Cnear,i,total_atoms-2,107.0,mask=mask)
-    atoms.set_dihedral(CnearC,Cnear,i,total_atoms-2,65,mask=mask)
-    mask[-2]=0
-    atoms.set_angle(total_atoms-2,i,total_atoms-1,107.0,mask=mask)
-    atoms.set_angle(Cnear,i,total_atoms-1,96.0,mask=mask)
-    atoms.set_distance(total_atoms-1,i,1.7900,fix=1,mask=mask)
-    atoms.set_dihedral(CnearC,Cnear,i,total_atoms-1,175,mask=mask)
-    atoms=CH3(atoms,total_atoms-1,state=162)
+    Cnear = near(i,  atoms)
+    mask = [0]*(total_atoms-2) + [1]*2
+    x = atoms.get_positions()
+    x[-1][0] = x[-1][0] - 50
+    x[-1][1] = x[-1][1] - 50
+    x[-1][2] = x[-1][2] - 50
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.7900, fix=1)
+    elif state == 2 or state == 6:
+        atoms.set_distance(i, Cnear, 1.7700, fix=1)
+    atoms.set_distance(total_atoms-2, i, 1.5300, fix=1, mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-2, 107.0, mask=mask)
+    atoms.set_dihedral(CnearC, Cnear, i, total_atoms-2, 65, mask=mask)
+    mask[-2] = 0
+    atoms.set_angle(total_atoms-2, i, total_atoms-1, 107.0, mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-1, 96.0, mask=mask)
+    atoms.set_distance(total_atoms-1, i, 1.7900, fix=1, mask=mask)
+    atoms.set_dihedral(CnearC, Cnear, i, total_atoms-1, 175, mask=mask)
+    atoms = CH3(atoms, total_atoms-1, state=162)
     return atoms
 
-def SO2_(addition,atoms,i,state=1):
+def SO2_(addition, atoms, i, state=1):
     atoms.append('O')
     atoms.append('O')
     atoms.append('H')
-    total_atoms=len(atoms)
-    elements=atoms.get_chemical_symbols()
-    elements[i]='S'
+    total_atoms = len(atoms)
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'S'
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    CnearC=near(Cnear,atoms,'C')
-    mask=[0]*(total_atoms-3)+[1]*3
-    x=atoms.get_positions()
-    x[-3][0]=x[-3][0]-50
-    x[-3][1]=x[-3][1]-50
-    x[-3][2]=x[-3][2]-50
-    x[-2][0]=x[-2][0]+50
-    x[-2][1]=x[-2][1]+50
-    x[-2][2]=x[-2][2]+50
-    x[-1][0]=x[-1][0]-50
-    x[-1][1]=x[-1][1]-50
-    x[-1][2]=x[-1][2]-50
-    if state==1:
-        atoms.set_distance(i,Cnear,1.7700,fix=1)
-    elif state==2 or state==6:
-        atoms.set_distance(i,Cnear,1.7600,fix=1)
-    atoms.set_distance(total_atoms-3,i,1.5300,fix=1,mask=mask)
-    atoms.set_angle(Cnear,i,total_atoms-3,108.9,mask=mask)
-    atoms.set_dihedral(CnearC,Cnear,i,total_atoms-2,65,mask=mask)
-    mask[-3]=0
-    atoms.set_distance(total_atoms-2,i,1.5300,fix=1,mask=mask)
-    atoms.set_angle(Cnear,i,total_atoms-2,108.9,mask=mask)
-    atoms.set_dihedral(CnearC,Cnear,i,total_atoms-2,-70,mask=mask)
-    mask[-2]=0
-    atoms.set_angle(total_atoms-2,i,total_atoms-1,108.9,mask=mask)
-    atoms.set_angle(Cnear,i,total_atoms-1,97.67,mask=mask)
-    atoms.set_distance(total_atoms-1,i,1.7700,fix=1,mask=mask)
-    atoms.set_dihedral(CnearC,Cnear,i,total_atoms-1,175,mask=mask)
-    if addition=='CH3' or addition=='Me':
-        atoms=CH3(atoms,total_atoms-1,state=164)
-    if addition=='OH':
-        atoms=OH(atoms,total_atoms-1,state=164)
+    Cnear = near(i,  atoms)
+    CnearC = near(Cnear, atoms, 'C')
+    mask = [0]*(total_atoms-3) + [1]*3
+    x = atoms.get_positions()
+    x[-3][0] = x[-3][0] - 50
+    x[-3][1] = x[-3][1] - 50
+    x[-3][2] = x[-3][2] - 50
+    x[-2][0] = x[-2][0] + 50
+    x[-2][1] = x[-2][1] + 50
+    x[-2][2] = x[-2][2] + 50
+    x[-1][0] = x[-1][0] - 50
+    x[-1][1] = x[-1][1] - 50
+    x[-1][2] = x[-1][2] - 50
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.7700, fix=1)
+    elif state == 2 or state == 6:
+        atoms.set_distance(i, Cnear, 1.7600, fix=1)
+    atoms.set_distance(total_atoms-3, i, 1.5300, fix=1, mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-3, 108.9, mask=mask)
+    atoms.set_dihedral(CnearC, Cnear, i, total_atoms-2, 65, mask=mask)
+    mask[-3] = 0
+    atoms.set_distance(total_atoms-2, i, 1.5300, fix=1, mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-2, 108.9, mask=mask)
+    atoms.set_dihedral(CnearC, Cnear, i, total_atoms-2, -70, mask=mask)
+    mask[-2] = 0
+    atoms.set_angle(total_atoms-2, i, total_atoms-1, 108.9, mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-1, 97.67, mask=mask)
+    atoms.set_distance(total_atoms-1, i, 1.7700, fix=1, mask=mask)
+    atoms.set_dihedral(CnearC, Cnear, i, total_atoms-1, 175, mask=mask)
+    if addition == 'CH3' or addition == 'Me':
+        atoms = CH3(atoms, total_atoms-1, state=164)
+    if addition == 'OH':
+        atoms = OH(atoms, total_atoms-1, state=164)
     #print(atoms.get_positions())
     return atoms
 
-def D(member,atoms,i,state=1,shuffle=0):
-    Cnear=near(i, atoms)
-    atoms=CH3(atoms,i,state)
+def D(member, atoms, i, state=1, shuffle=0):
+    Cnear = near(i,  atoms)
+    atoms = CH3(atoms, i, state)
     for j in range(3):
         atoms.append('C')
     for j in range(8):
         atoms.append('H')
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-11)+[1]*11
-    elements=atoms.get_chemical_symbols()
-    if shuffle==0:
-        box=[-13,-12]
-    elif shuffle==1:
-        box=[-14,-13]
-    elif shuffle==2:
-        box=[-12,-14]
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-11) + [1]*11
+    elements = atoms.get_chemical_symbols()
+    if shuffle == 0:
+        box = [-13, -12]
+    elif shuffle == 1:
+        box = [-14, -13]
+    elif shuffle == 2:
+        box = [-12, -14]
     for j in box:
-        mask[j]=1
-        elements[total_atoms+j]='C'
+        mask[j] = 1
+        elements[total_atoms+j] = 'C'
         atoms.set_chemical_symbols(elements)
-        atoms.set_distance(total_atoms+j,i,1.5290,fix=1)
-        atoms.set_angle(Cnear,i,total_atoms+j,113,mask=mask)
-        mask[j]=0
-    x=atoms.get_positions()
-    x[-11][0]=x[-11][0]-50
-    x[-11][1]=x[-11][1]-50
-    x[-11][2]=x[-11][2]-50
-    x[-10][0]=x[-10][0]+50
-    x[-10][1]=x[-10][1]+50
-    x[-10][2]=x[-10][2]+50
-    x[-9][0]=x[-9][0]-50
-    x[-9][1]=x[-9][1]-50
-    x[-9][2]=x[-9][2]-50
-    for j in range(-8,-4):
-        x[j][0]=x[j][0]-50
-        x[j][1]=x[j][1]-50
-        x[j][2]=x[j][2]-50
-    for j in range(-4,0):
-        x[j][0]=x[j][0]+50
-        x[j][1]=x[j][1]+50
-        x[j][2]=x[j][2]+50
+        atoms.set_distance(total_atoms+j, i, 1.5290, fix=1)
+        atoms.set_angle(Cnear, i, total_atoms+j, 113, mask=mask)
+        mask[j] = 0
+    x = atoms.get_positions()
+    x[-11][0] = x[-11][0] - 50
+    x[-11][1] = x[-11][1] - 50
+    x[-11][2] = x[-11][2] - 50
+    x[-10][0] = x[-10][0] + 50
+    x[-10][1] = x[-10][1] + 50
+    x[-10][2] = x[-10][2] + 50
+    x[-9][0] = x[-9][0] - 50
+    x[-9][1] = x[-9][1] - 50
+    x[-9][2] = x[-9][2] - 50
+    for j in range(-8, -4):
+        x[j][0] = x[j][0] - 50
+        x[j][1] = x[j][1] - 50
+        x[j][2] = x[j][2] - 50
+    for j in range(-4, 0):
+        x[j][0] = x[j][0] + 50
+        x[j][1] = x[j][1] + 50
+        x[j][2] = x[j][2] + 50
     atoms.set_positions(x)
-    atoms.set_angle(i,total_atoms+box[0],total_atoms-11,102.3,mask=mask)
-    atoms.set_distance(total_atoms-11,total_atoms+box[0],1.5290,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[0],total_atoms-11,235,mask=mask)
-    mask[-11]=0
-    atoms.set_angle(i,total_atoms+box[1],total_atoms-10,115.5,mask=mask)
-    atoms.set_distance(total_atoms-10,total_atoms+box[1],1.5290,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[1],total_atoms-10,165,mask=mask)
-    mask[-10]=0
-    atoms.set_angle(total_atoms+box[0],total_atoms-11,total_atoms-9,110.5,mask=mask)
-    atoms.set_dihedral(i,total_atoms+box[0],total_atoms-11,total_atoms-9,290,mask=mask)
+    atoms.set_angle(i, total_atoms+box[0], total_atoms-11, 102.3, mask=mask)
+    atoms.set_distance(total_atoms-11, total_atoms+box[0],\
+                       1.5290, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[0],\
+                       total_atoms-11, 235, mask=mask)
+    mask[-11] = 0
+    atoms.set_angle(i, total_atoms+box[1], total_atoms-10, 115.5, mask=mask)
+    atoms.set_distance(total_atoms-10, total_atoms+box[1],\
+                       1.5290, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[1],\
+                       total_atoms-10, 165, mask=mask)
+    mask[-10] = 0
+    atoms.set_angle(total_atoms+box[0], total_atoms-11,\
+                    total_atoms-9, 110.5, mask=mask)
+    atoms.set_dihedral(i, total_atoms+box[0], total_atoms-11,\
+                       total_atoms-9, 290, mask=mask)
     for k in range(10):
-        atoms.set_distance(total_atoms-9,total_atoms-11,1.5290,fix=1,mask=mask)
-        atoms.set_distance(total_atoms-9,total_atoms-10,1.5290,fix=1,mask=mask)
-    mask[-9]=0
-    atoms.set_angle(i,total_atoms+box[0],total_atoms-8,109.5,mask=mask)
-    atoms.set_distance(total_atoms-8,total_atoms+box[0],1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[0],total_atoms-8,-60,mask=mask)
-    mask[-8]=0
-    atoms.set_angle(i,total_atoms+box[0],total_atoms-7,109.5,mask=mask)
-    atoms.set_distance(total_atoms-7,total_atoms+box[0],1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[0],total_atoms-7,60,mask=mask)
-    mask[-7]=0
-    atoms.set_angle(i,total_atoms+box[1],total_atoms-6,109.5,mask=mask)
-    atoms.set_distance(total_atoms-6,total_atoms+box[1],1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms+box[1],total_atoms-6,-60,mask=mask)
-    mask[-6]=0
-    atoms.set_angle(total_atoms+box[0],total_atoms-11,total_atoms-5,109.5,mask=mask)
-    atoms.set_distance(total_atoms-5,total_atoms-11,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(i,total_atoms+box[0],total_atoms-11,total_atoms-5,179.5,mask=mask)
-    mask[-5]=0
-    atoms.set_angle(total_atoms+box[1],total_atoms-10,total_atoms-4,109.5,mask=mask)
-    atoms.set_distance(total_atoms-4,total_atoms-10,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(i,total_atoms+box[1],total_atoms-10,total_atoms-4,75,mask=mask)
-    mask[-4]=0
-    atoms.set_angle(total_atoms+box[1],total_atoms-10,total_atoms-3,109.5,mask=mask)
-    atoms.set_distance(total_atoms-3,total_atoms-10,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(i,total_atoms+box[1],total_atoms-10,total_atoms-3,-179.5,mask=mask)
-    mask[-3]=0
-    atoms.set_angle(total_atoms-11,total_atoms-9,total_atoms-2,109.5,mask=mask)
-    atoms.set_distance(total_atoms-2,total_atoms-9,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms+box[0],total_atoms-11,total_atoms-9,total_atoms-2,-179.5,mask=mask)
-    mask[-2]=0
-    atoms.set_angle(total_atoms-11,total_atoms-9,total_atoms-1,109.5,mask=mask)
-    atoms.set_distance(total_atoms-1,total_atoms-9,1.0900,fix=1,mask=mask)
-    atoms.set_dihedral(total_atoms+box[0],total_atoms-11,total_atoms-9,total_atoms-1,300,mask=mask)
-    mask[-1]=0
-    if member==5:
+        atoms.set_distance(total_atoms-9, total_atoms-11, 1.5290, fix=1, mask=mask)
+        atoms.set_distance(total_atoms-9, total_atoms-10, 1.5290, fix=1, mask=mask)
+    mask[-9] = 0
+    atoms.set_angle(i, total_atoms+box[0], total_atoms-8, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-8, total_atoms+box[0],\
+                       1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[0],\
+                       total_atoms-8, -60, mask=mask)
+    mask[-8] = 0
+    atoms.set_angle(i, total_atoms+box[0], total_atoms-7, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-7, total_atoms+box[0],\
+                       1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[0], total_atoms-7, 60, mask=mask)
+    mask[-7] = 0
+    atoms.set_angle(i, total_atoms+box[1], total_atoms-6, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-6, total_atoms+box[1],\
+                       1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms+box[1],\
+                       total_atoms-6, -60, mask=mask)
+    mask[-6] = 0
+    atoms.set_angle(total_atoms+box[0], total_atoms-11,\
+                    total_atoms-5, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-5, total_atoms-11, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(i, total_atoms+box[0], total_atoms-11,\
+                       total_atoms-5, 179.5, mask=mask)
+    mask[-5] = 0
+    atoms.set_angle(total_atoms+box[1], total_atoms-10,\
+                    total_atoms-4, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-4, total_atoms-10, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(i, total_atoms+box[1], total_atoms-10,\
+                       total_atoms-4, 75, mask=mask)
+    mask[-4] = 0
+    atoms.set_angle(total_atoms+box[1], total_atoms-10,\
+                    total_atoms-3, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-3, total_atoms-10, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(i, total_atoms+box[1], total_atoms-10,\
+                       total_atoms-3, -179.5, mask=mask)
+    mask[-3] = 0
+    atoms.set_angle(total_atoms-11, total_atoms-9,\
+                    total_atoms-2, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-2, total_atoms-9, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms+box[0], total_atoms-11,\
+                       total_atoms-9, total_atoms-2, -179.5, mask=mask)
+    mask[-2] = 0
+    atoms.set_angle(total_atoms-11, total_atoms-9,\
+                    total_atoms-1, 109.5, mask=mask)
+    atoms.set_distance(total_atoms-1, total_atoms-9, 1.0900, fix=1, mask=mask)
+    atoms.set_dihedral(total_atoms+box[0], total_atoms-11,\
+                       total_atoms-9, total_atoms-1, 300, mask=mask)
+    mask[-1] = 0
+    if member == 5:
         for j in range(1):
             atoms.append('C')
         for j in range(2):
             atoms.append('H')
-        total_atoms=len(atoms)
-        mask=[0]*(total_atoms-3)+[1]*3
-        atoms.set_angle(i,total_atoms+box[1]-3,total_atoms-3,109.5,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms+box[1]-3,1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms+box[1]-3,total_atoms-3,60,mask=mask)
+        total_atoms = len(atoms)
+        mask = [0]*(total_atoms-3) + [1]*3
+        atoms.set_angle(i, total_atoms+box[1]-3, total_atoms-3, 109.5, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms+box[1]-3,\
+                           1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms+box[1]-3,\
+                           total_atoms-3, 60, mask=mask)
         for k in range(10):
-            atoms.set_distance(total_atoms-3,total_atoms+box[1]-3,1.5290,fix=1,mask=mask)
-            atoms.set_distance(total_atoms-3,total_atoms-14,1.5290,fix=1,mask=mask)
-        mask[-3]=0
-        atoms.set_angle(total_atoms+box[1]-3,total_atoms-3,total_atoms-2,113.2,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-3,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1]-3,total_atoms-3,total_atoms-2,185,mask=mask)
-        mask[-2]=0
-        atoms.set_angle(total_atoms+box[1]-3,total_atoms-3,total_atoms-1,113.2,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-3,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1]-3,total_atoms-3,total_atoms-1,300,mask=mask)
-    elif member==6:
+            atoms.set_distance(total_atoms-3, total_atoms+box[1]-3,\
+                               1.5290, fix=1, mask=mask)
+            atoms.set_distance(total_atoms-3, total_atoms-14, 1.5290, fix=1, mask=mask)
+        mask[-3] = 0
+        atoms.set_angle(total_atoms+box[1]-3, total_atoms-3, total_atoms-2,\
+                        113.2, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-3, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1]-3, total_atoms-3,\
+                           total_atoms-2, 185, mask=mask)
+        mask[-2] = 0
+        atoms.set_angle(total_atoms+box[1]-3, total_atoms-3,\
+                        total_atoms-1, 113.2, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-3, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1]-3, total_atoms-3,\
+                           total_atoms-1, 300, mask=mask)
+    elif member == 6:
         for j in range(2):
             atoms.append('C')
         for j in range(4):
             atoms.append('H')
-        total_atoms=len(atoms)
-        mask=[0]*(total_atoms-6)+[1]*6
-        atoms.set_angle(i,total_atoms+box[1]-6,total_atoms-6,110.5,mask=mask)
-        atoms.set_distance(total_atoms-6,total_atoms+box[1]-6,1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(Cnear,i,total_atoms+box[1]-6,total_atoms-6,67.5,mask=mask)
-        mask[-6]=0
-        atoms.set_angle(total_atoms+box[0]-6,total_atoms-17,total_atoms-5,110.5,mask=mask)
-        atoms.set_distance(total_atoms-5,total_atoms-17,1.5290,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[0]-6,total_atoms-17,total_atoms-5,67.5,mask=mask)
+        total_atoms = len(atoms)
+        mask = [0]*(total_atoms-6) + [1]*6
+        atoms.set_angle(i, total_atoms+box[1]-6, total_atoms-6, 110.5, mask=mask)
+        atoms.set_distance(total_atoms-6, total_atoms+box[1]-6,\
+                           1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(Cnear, i, total_atoms+box[1]-6,\
+                           total_atoms-6, 67.5, mask=mask)
+        mask[-6] = 0
+        atoms.set_angle(total_atoms+box[0]-6, total_atoms-17,\
+                        total_atoms-5, 110.5, mask=mask)
+        atoms.set_distance(total_atoms-5, total_atoms-17, 1.5290, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[0]-6, total_atoms-17,\
+                           total_atoms-5, 67.5, mask=mask)
         for k in range(10):
-            atoms.set_distance(total_atoms-5,total_atoms-6,1.5290,fix=1,mask=mask)
-            atoms.set_distance(total_atoms-5,total_atoms-17,1.5290,fix=1,mask=mask)
-        mask[-5]=0
-        atoms.set_angle(total_atoms+box[1]-6,total_atoms-6,total_atoms-4,110.2,mask=mask)
-        atoms.set_distance(total_atoms-4,total_atoms-6,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1]-6,total_atoms-6,total_atoms-4,185,mask=mask)
-        mask[-4]=0
-        atoms.set_angle(total_atoms+box[1]-6,total_atoms-6,total_atoms-3,110.2,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms-6,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(i,total_atoms+box[1]-6,total_atoms-6,total_atoms-3,300,mask=mask)
-        mask[-3]=0
-        atoms.set_angle(total_atoms-17,total_atoms-5,total_atoms-2,110.2,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-5,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms+box[0]-6,total_atoms-17,total_atoms-5,total_atoms-2,185,mask=mask)
-        mask[-2]=0
-        atoms.set_angle(total_atoms-17,total_atoms-5,total_atoms-1,110.2,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-5,1.0900,fix=1,mask=mask)
-        atoms.set_dihedral(total_atoms+box[0]-6,total_atoms-17,total_atoms-5,total_atoms-1,60,mask=mask)
+            atoms.set_distance(total_atoms-5, total_atoms-6, 1.5290, fix=1, mask=mask)
+            atoms.set_distance(total_atoms-5, total_atoms-17, 1.5290, fix=1, mask=mask)
+        mask[-5] = 0
+        atoms.set_angle(total_atoms+box[1]-6, total_atoms-6,\
+                        total_atoms-4, 110.2, mask=mask)
+        atoms.set_distance(total_atoms-4, total_atoms-6, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1]-6,\
+                           total_atoms-6, total_atoms-4, 185, mask=mask)
+        mask[-4] = 0
+        atoms.set_angle(total_atoms+box[1]-6, total_atoms-6,\
+                        total_atoms-3, 110.2, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms-6, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(i, total_atoms+box[1]-6,\
+                           total_atoms-6, total_atoms-3, 300, mask=mask)
+        mask[-3] = 0
+        atoms.set_angle(total_atoms-17, total_atoms-5, total_atoms-2, 110.2, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-5, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms+box[0]-6, total_atoms-17,\
+                           total_atoms-5, total_atoms-2, 185, mask=mask)
+        mask[-2] = 0
+        atoms.set_angle(total_atoms-17, total_atoms-5, total_atoms-1, 110.2, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-5, 1.0900, fix=1, mask=mask)
+        atoms.set_dihedral(total_atoms+box[0]-6, total_atoms-17,\
+                           total_atoms-5, total_atoms-1, 60, mask=mask)
     return atoms
     
-def Bpin(atoms,i,state=1,shuffle=0):
+def Bpin(atoms, i, state=1, shuffle=0):
     atoms.append('O')
     atoms.append('O')
-    total_atoms=len(atoms)
-    elements=atoms.get_chemical_symbols()
-    elements[i]='B'
+    total_atoms = len(atoms)
+    elements = atoms.get_chemical_symbols()
+    elements[i] = 'B'
     atoms.set_chemical_symbols(elements)
-    Cnear=near(i, atoms)
-    mask=[0]*(total_atoms-2)+[1]*2
-    CnearH=near(Cnear,atoms,'H')
-    x=atoms.get_positions()
-    x[-2][0]=x[-2][0]+50
-    x[-2][1]=x[-2][1]+50
-    x[-2][2]=x[-2][2]+50
-    x[-1][0]=x[-1][0]-50
-    x[-1][1]=x[-1][1]-50
-    x[-1][2]=x[-1][2]-50
-    if state==1:
-        atoms.set_distance(i,Cnear,1.5950,fix=1)
-    atoms.set_distance(total_atoms-2,i,1.4700,fix=1,mask=mask)
-    atoms.set_angle(Cnear,i,total_atoms-2,120.0,mask=mask)
-    if shuffle==0:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-2,20,mask=mask)
-    elif shuffle==1:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-2,-20,mask=mask)
-    elif shuffle==5:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-2,0.5,mask=mask)
-    mask[-2]=0
-    atoms.set_distance(total_atoms-1,i,1.4700,fix=1,mask=mask)
-    atoms.set_angle(Cnear,i,total_atoms-1,120.0,mask=mask)
-    if shuffle==0:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-1,200,mask=mask)
-    elif shuffle==1:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-1,160,mask=mask)
-    elif shuffle==5:
-        atoms.set_dihedral(CnearH,Cnear,i,total_atoms-1,180.5,mask=mask)
+    Cnear = near(i,  atoms)
+    mask = [0]*(total_atoms-2) + [1]*2
+    CnearH = near(Cnear, atoms, 'H')
+    x = atoms.get_positions()
+    x[-2][0] = x[-2][0] + 50
+    x[-2][1] = x[-2][1] + 50
+    x[-2][2] = x[-2][2] + 50
+    x[-1][0] = x[-1][0] - 50
+    x[-1][1] = x[-1][1] - 50
+    x[-1][2] = x[-1][2] - 50
+    if state == 1:
+        atoms.set_distance(i, Cnear, 1.5950, fix=1)
+    atoms.set_distance(total_atoms-2, i, 1.4700, fix=1, mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-2, 120.0, mask=mask)
+    if shuffle == 0:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-2, 20, mask=mask)
+    elif shuffle == 1:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-2, -20, mask=mask)
+    elif shuffle == 5:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-2, 0.5, mask=mask)
+    mask[-2] = 0
+    atoms.set_distance(total_atoms-1, i, 1.4700, fix=1, mask=mask)
+    atoms.set_angle(Cnear, i, total_atoms-1, 120.0, mask=mask)
+    if shuffle == 0:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-1, 200, mask=mask)
+    elif shuffle == 1:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-1, 160, mask=mask)
+    elif shuffle == 5:
+        atoms.set_dihedral(CnearH, Cnear, i, total_atoms-1, 180.5, mask=mask)
     atoms.append('C')
     atoms.append('C')
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-2)+[1]*2
-    x=atoms.get_positions()
-    x[-2][0]=x[-2][0]+50
-    x[-2][1]=x[-2][1]+50
-    x[-2][2]=x[-2][2]+50
-    x[-1][0]=x[-1][0]-50
-    x[-1][1]=x[-1][1]-50
-    x[-1][2]=x[-1][2]-50
-    atoms.set_distance(total_atoms-2,total_atoms-4,1.4100,fix=1,mask=mask)
-    atoms.set_angle(i,total_atoms-4,total_atoms-2,95.0,mask=mask)
-    atoms.set_dihedral(Cnear,i,total_atoms-4,total_atoms-2,125,mask=mask)
-    mask[-2]=0
-    atoms.set_dihedral(Cnear,i,total_atoms-3,total_atoms-1,235,mask=mask)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-2) + [1]*2
+    x = atoms.get_positions()
+    x[-2][0] = x[-2][0] + 50
+    x[-2][1] = x[-2][1] + 50
+    x[-2][2] = x[-2][2] + 50
+    x[-1][0] = x[-1][0] - 50
+    x[-1][1] = x[-1][1] - 50
+    x[-1][2] = x[-1][2] - 50
+    atoms.set_distance(total_atoms-2, total_atoms-4, 1.4100, fix=1, mask=mask)
+    atoms.set_angle(i, total_atoms-4, total_atoms-2, 95.0, mask=mask)
+    atoms.set_dihedral(Cnear, i, total_atoms-4, total_atoms-2, 125, mask=mask)
+    mask[-2] = 0
+    atoms.set_dihedral(Cnear, i, total_atoms-3, total_atoms-1, 235, mask=mask)
     for k in range(10):
-        atoms.set_distance(total_atoms-1,total_atoms-3,1.4100,fix=1,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-2,1.5290,fix=1,mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-3, 1.4100, fix=1, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-2, 1.5290, fix=1, mask=mask)
     for i in range(4):
         atoms.append('H')
-    total_atoms=len(atoms)
-    mask=[0]*(total_atoms-4)+[1]*4
-    x=atoms.get_positions()
-    x[-4][0]=x[-4][0]-50
-    x[-4][1]=x[-4][1]-50
-    x[-4][2]=x[-4][2]-50
-    x[-3][0]=x[-3][0]+50
-    x[-3][1]=x[-3][1]+50
-    x[-3][2]=x[-3][2]+50
-    x[-2][0]=x[-2][0]-50
-    x[-2][1]=x[-2][1]-50
-    x[-2][2]=x[-2][2]-50
-    x[-1][0]=x[-1][0]+50
-    x[-1][1]=x[-1][1]+50
-    x[-1][2]=x[-1][2]+50
-    atoms.set_dihedral(i,total_atoms-8,total_atoms-6,total_atoms-4,120,mask=mask)
-    atoms.set_angle(total_atoms-8,total_atoms-6,total_atoms-4,111.5,mask=mask)
-    atoms.set_distance(total_atoms-4,total_atoms-6,1.0900,fix=1)
-    mask[-4]=0
-    atoms.set_dihedral(i,total_atoms-8,total_atoms-6,total_atoms-3,240,mask=mask)
-    atoms.set_angle(total_atoms-8,total_atoms-6,total_atoms-3,111.5,mask=mask)
-    atoms.set_distance(total_atoms-3,total_atoms-6,1.0900,fix=1)
-    mask[-3]=0
-    atoms.set_dihedral(i,total_atoms-7,total_atoms-5,total_atoms-2,120,mask=mask)
-    atoms.set_angle(total_atoms-7,total_atoms-5,total_atoms-2,111.5,mask=mask)
-    atoms.set_distance(total_atoms-2,total_atoms-5,1.0900,fix=1)
-    mask[-2]=0
-    atoms.set_dihedral(i,total_atoms-7,total_atoms-5,total_atoms-1,240,mask=mask)
-    atoms.set_angle(total_atoms-7,total_atoms-5,total_atoms-1,111.5,mask=mask)
-    atoms.set_distance(total_atoms-1,total_atoms-5,1.0900,fix=1)
-    if atoms.get_distance(total_atoms-4,total_atoms-5)<=1.3 or atoms.get_distance(total_atoms-3,total_atoms-5)<=1.3 or atoms.get_distance(total_atoms-2,total_atoms-6)<=1.3 or atoms.get_distance(total_atoms-1,total_atoms-6)<=1.3:
-        mask=[0]*(total_atoms-4)+[1]*4
-        x=atoms.get_positions()
-        x[-4][0]=x[-4][0]-50
-        x[-4][1]=x[-4][1]-50
-        x[-4][2]=x[-4][2]-50
-        x[-3][0]=x[-3][0]+50
-        x[-3][1]=x[-3][1]+50
-        x[-3][2]=x[-3][2]+50
-        x[-2][0]=x[-2][0]-50
-        x[-2][1]=x[-2][1]-50
-        x[-2][2]=x[-2][2]-50
-        x[-1][0]=x[-1][0]+50
-        x[-1][1]=x[-1][1]+50
-        x[-1][2]=x[-1][2]+50
-        atoms.set_dihedral(i,total_atoms-8,total_atoms-6,total_atoms-4,300,mask=mask)
-        atoms.set_angle(total_atoms-8,total_atoms-6,total_atoms-4,111.5,mask=mask)
-        atoms.set_distance(total_atoms-4,total_atoms-6,1.0900,fix=1)
-        mask[-4]=0
-        atoms.set_dihedral(i,total_atoms-8,total_atoms-6,total_atoms-3,179.5,mask=mask)
-        atoms.set_angle(total_atoms-8,total_atoms-6,total_atoms-3,111.5,mask=mask)
-        atoms.set_distance(total_atoms-3,total_atoms-6,1.0900,fix=1)
-        mask[-3]=0
-        atoms.set_dihedral(i,total_atoms-7,total_atoms-5,total_atoms-2,60,mask=mask)
-        atoms.set_angle(total_atoms-7,total_atoms-5,total_atoms-2,111.5,mask=mask)
-        atoms.set_distance(total_atoms-2,total_atoms-5,1.0900,fix=1)
-        mask[-2]=0
-        atoms.set_dihedral(i,total_atoms-7,total_atoms-5,total_atoms-1,179.5,mask=mask)
-        atoms.set_angle(total_atoms-7,total_atoms-5,total_atoms-1,111.5,mask=mask)
-        atoms.set_distance(total_atoms-1,total_atoms-5,1.0900,fix=1)
+    total_atoms = len(atoms)
+    mask = [0]*(total_atoms-4) + [1]*4
+    x = atoms.get_positions()
+    x[-4][0] = x[-4][0] - 50
+    x[-4][1] = x[-4][1] - 50
+    x[-4][2] = x[-4][2] - 50
+    x[-3][0] = x[-3][0] + 50
+    x[-3][1] = x[-3][1] + 50
+    x[-3][2] = x[-3][2] + 50
+    x[-2][0] = x[-2][0] - 50
+    x[-2][1] = x[-2][1] - 50
+    x[-2][2] = x[-2][2] - 50
+    x[-1][0] = x[-1][0] + 50
+    x[-1][1] = x[-1][1] + 50
+    x[-1][2] = x[-1][2] + 50
+    atoms.set_dihedral(i, total_atoms-8, total_atoms-6,\
+                       total_atoms-4, 120, mask=mask)
+    atoms.set_angle(total_atoms-8, total_atoms-6, total_atoms-4, 111.5, mask=mask)
+    atoms.set_distance(total_atoms-4, total_atoms-6, 1.0900, fix=1)
+    mask[-4] = 0
+    atoms.set_dihedral(i, total_atoms-8, total_atoms-6,\
+                       total_atoms-3, 240, mask=mask)
+    atoms.set_angle(total_atoms-8, total_atoms-6, total_atoms-3, 111.5, mask=mask)
+    atoms.set_distance(total_atoms-3, total_atoms-6, 1.0900, fix=1)
+    mask[-3] = 0
+    atoms.set_dihedral(i, total_atoms-7, total_atoms-5,\
+                       total_atoms-2, 120, mask=mask)
+    atoms.set_angle(total_atoms-7, total_atoms-5, total_atoms-2, 111.5, mask=mask)
+    atoms.set_distance(total_atoms-2, total_atoms-5, 1.0900, fix=1)
+    mask[-2] = 0
+    atoms.set_dihedral(i, total_atoms-7, total_atoms-5,\
+                       total_atoms-1, 240, mask=mask)
+    atoms.set_angle(total_atoms-7, total_atoms-5, total_atoms-1, 111.5, mask=mask)
+    atoms.set_distance(total_atoms-1, total_atoms-5, 1.0900, fix=1)
+    if (atoms.get_distance(total_atoms-4, total_atoms-5) <= 1.3 or
+        atoms.get_distance(total_atoms-3, total_atoms-5) <= 1.3 or 
+        atoms.get_distance(total_atoms-2, total_atoms-6) <= 1.3 or
+        atoms.get_distance(total_atoms-1, total_atoms-6)<=1.3):
+        mask = [0]*(total_atoms-4) + [1]*4
+        x = atoms.get_positions()
+        x[-4][0] = x[-4][0] - 50
+        x[-4][1] = x[-4][1] - 50
+        x[-4][2] = x[-4][2] - 50
+        x[-3][0] = x[-3][0] + 50
+        x[-3][1] = x[-3][1] + 50
+        x[-3][2] = x[-3][2] + 50
+        x[-2][0] = x[-2][0] - 50
+        x[-2][1] = x[-2][1] - 50
+        x[-2][2] = x[-2][2] - 50
+        x[-1][0] = x[-1][0] + 50
+        x[-1][1] = x[-1][1] + 50
+        x[-1][2] = x[-1][2] + 50
+        atoms.set_dihedral(i, total_atoms-8, total_atoms-6,\
+                           total_atoms-4, 300, mask=mask)
+        atoms.set_angle(total_atoms-8, total_atoms-6, total_atoms-4, 111.5, mask=mask)
+        atoms.set_distance(total_atoms-4, total_atoms-6, 1.0900, fix=1)
+        mask[-4] = 0
+        atoms.set_dihedral(i, total_atoms-8, total_atoms-6,\
+                           total_atoms-3, 179.5, mask=mask)
+        atoms.set_angle(total_atoms-8, total_atoms-6, total_atoms-3, 111.5, mask=mask)
+        atoms.set_distance(total_atoms-3, total_atoms-6, 1.0900, fix=1)
+        mask[-3] = 0
+        atoms.set_dihedral(i, total_atoms-7, total_atoms-5,\
+                           total_atoms-2, 60, mask=mask)
+        atoms.set_angle(total_atoms-7, total_atoms-5, total_atoms-2, 111.5, mask=mask)
+        atoms.set_distance(total_atoms-2, total_atoms-5, 1.0900, fix=1)
+        mask[-2] = 0
+        atoms.set_dihedral(i, total_atoms-7, total_atoms-5,\
+                           total_atoms-1, 179.5, mask=mask)
+        atoms.set_angle(total_atoms-7, total_atoms-5, total_atoms-1, 111.5, mask=mask)
+        atoms.set_distance(total_atoms-1, total_atoms-5, 1.0900, fix=1)
     return atoms
     
-def near(i,atoms,target='ALL',ignore=[],limit=True,reverse=False):
-    elements=atoms.get_chemical_symbols()
-    total_atoms=len(atoms)
-    j=0
+def near(i, atoms, target='ALL', ignore=[], limit=True, reverse=False):
+    elements = atoms.get_chemical_symbols()
+    total_atoms = len(atoms)
+    j = 0
     targeted_distances=[]
     for element in elements:
         if j in ignore:
-            j=j+1
+            j = j + 1
             continue
-        if element==target:
-            d=atoms.get_distances(i,j)
-            if limit==True:
-                if d[0]>=0.5:
+        if element == target:
+            d = atoms.get_distances(i, j)
+            if limit == True:
+                if d[0] >= 0.5:
                     targeted_distances.append(d[0])
             else:
                 targeted_distances.append(d[0])
-        if target=='Not H' or target=='notH' or target=='not H':
-            if element!='H':
-                d=atoms.get_distances(i,j)
-                if limit==True:
-                    if d[0]>=0.5:
+        if target == 'Not H' or target == 'notH' or target == 'not H':
+            if element != 'H':
+                d = atoms.get_distances(i, j)
+                if limit == True:
+                    if d[0] >= 0.5:
                         targeted_distances.append(d[0])
                 else:
                     targeted_distances.append(d[0])
-        j=j+1
-    if reverse==True:
-        _near=-1
+        j = j + 1
+    if reverse == True:
+        _near = -1
     else:
-        _near=0
-    if target=='all' or target=='All' or target=='ALL':
-        targeted_distances=atoms.get_distances(i,range(len(atoms)))
-        targeted_distances=np.delete(targeted_distances,np.where(targeted_distances==0.0))
-    distances=atoms.get_distances(i,range(len(atoms)))
-    #print(distances,targeted_distances)
+        _near = 0
+    if target == 'all' or target == 'All' or target == 'ALL':
+        targeted_distances = atoms.get_distances(i, range(len(atoms)))
+        targeted_distances = np.delete(targeted_distances,\
+                                       np.where(targeted_distances == 0.0))
+    distances = atoms.get_distances(i, range(len(atoms)))
+    #print(distances, targeted_distances)
     for distance in distances:
-        if total_atoms+_near in ignore:
+        if total_atoms + _near in ignore:
             continue
-        if reverse==True:
-            if total_atoms+_near in ignore:
-                _near=_near-1
+        if reverse == True:
+            if total_atoms + _near in ignore:
+                _near = _near - 1
                 continue
-            if abs(min(targeted_distances)-atoms.get_distances(i,total_atoms+_near))<=0.001:
-                #print(_near,atoms.get_distances(i,_near))
-                return total_atoms+_near
-            _near=_near-1
+            if abs(min(targeted_distances) - atoms.get_distances(i, total_atoms+_near)) <= 0.001:
+                #print(_near, atoms.get_distances(i, _near))
+                return total_atoms + _near
+            _near = _near - 1
         else:
             if _near in ignore:
-                _near=_near+1
+                _near = _near + 1
                 continue
-            if abs(min(targeted_distances)-atoms.get_distances(i,_near))<=0.001:
-                #print(_near,atoms.get_distances(i,_near))
+            if abs(min(targeted_distances) - atoms.get_distances(i, _near)) <= 0.001:
+                #print(_near, atoms.get_distances(i, _near))
                 return _near
-            #print(min(targeted_distances),atoms.get_distances(i,_near))
-            _near=_near+1
+            #print(min(targeted_distances), atoms.get_distances(i, _near))
+            _near = _near + 1
```

### Comparing `MCPoly-0.5.1.3/MCPoly/orcaset/XYZtoINP.py` & `MCPoly-0.6b1/MCPoly/orcaset/XyzToInp.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,15 +1,20 @@
 import os
-from ase.io import read
 import warnings
+from ase.io import read
 
-def XYZtoINP(file,inpname='',fileloc='./',saveloc='./',method='B3LYP',basis_set='def2-SVP',opt=False,freq=False,scan=False,external_force=False,ts=False,aim=[0,0],stretch=-1,scanstep=10,strain=-1,maxiter=-1,maxcore=-1,corenum=1,electron=0,state=1,MD=False,md_timestep=1.0,initvel=300, tsNHC=300, timecon=10.0, dumpcon=10,runstep=100,dumpname=''):
+def XyzToInp(file, inpname='', fileloc='./', saveloc='./', method='B3LYP',\
+             basis_set='def2-SVP', opt=False, freq=False, scan=False,\
+             external_force=False, ts=False, aim=[0, 0], stretch=-1, scanstep=10,\
+             strain=-1, maxiter=-1, maxcore=-1, corenum=1, electron=0, state=1,\
+             MD=False, md_timestep=1.0, initvel=300, tsNHC=300, timecon=10.0,\
+             dumpcon=10, runstep=100, dumpname=''):
     """
     The method to convert .xyz file into .inp file.
-    XYZtoINP(file,inpname='',loc='./',method='B3LYP',basis_set='def2-SVP',opt=False,freq=False,scan=False,external_force=False,ts=False,aim=[0,0],stretch=1,scanstep=10,strain=-1,maxiter=-1,maxcore=-1,corenum=1,electron=0,state=1)
+    XyzToInp(file, inpname='', loc='./', method='B3LYP', basis_set='def2-SVP', opt=False, freq=False, scan=False, external_force=False, ts=False, aim=[0, 0], stretch=1, scanstep=10, strain=-1, maxiter=-1, maxcore=-1, corenum=1, electron=0, state=1)
     file: Your .xyz file name.
     inpname: The name of your saved .inp file.
     fileloc: File Location. The default is your current location.
     saveloc: Input File Save Location. The default is your current location.
     method: Your semiempirical/ab initio/DFT calculation methods. The default is B3LYP.
     basis_set: Your basis set. The default is def2-SVP.
     opt: To show if you want to optimise your molecule. The default is False.
@@ -26,15 +31,15 @@
             https://www.orcasoftware.de/tutorials_orca/first_steps/trouble_install.html#path-variable
             https://www.orcasoftware.de/tutorials_orca/first_steps/parallel.html
     electron: The charge of your system. It might be positive(>0), negative(<0) or neutral(=0). The default is neutral.
     state: The state of your system (singlet:1, doublet:2, triplet:3 ...). The default is singlet.
     Example 1:
         Input:
             from MCPoly.orcaset import XYZtoINP
-            XYZtoINP('Atom1')
+            XyzToInp('Atom1')
         Output in Atom1.inp:
             #Powered by MCPoly
 
             ! B3LYP def2-SVP 
 
             *xyz 0 1
             C         -7.11449        1.33604       -0.03969
@@ -45,16 +50,16 @@
                 ...
             *
             
             
     Example 2:
         Input:
             from MCPoly.orcaset import XYZtoINP
-            XYZtoINP('Atom1',method='B3LYP D3BJ',basis_set='def2-TZVP',freq=True,\
-                     external_force=True,aim=[0,3],strain=1.5,maxcore=4096,corenum=8)
+            XyzToInp('Atom1', method='B3LYP D3BJ', basis_set='def2-TZVP', freq=True, \
+                     external_force=True, aim=[0, 3], strain=1.5, maxcore=4096, corenum=8)
         Output in Atom1.inp:
             #Powered by MCPoly
             
             ! B3LYP D3BJ def2-TZVP OPT FREQ
             %maxcore 4096
             %PAL NPROCS 8 END
             %geom
@@ -72,16 +77,16 @@
                 ...
             *
     
     
     Example 3:
         Input:
             from MCPoly.orcaset import XYZtoINP
-            XYZtoINP('Atom1',method='B3LYP D3BJ',basis_set='def2-TZVP',scan=True,\
-                     aim=[0,3],stretch=0.8,scanstep=8,maxcore=4096,corenum=8)
+            XyzToInp('Atom1', method='B3LYP D3BJ', basis_set='def2-TZVP', scan=True, \
+                     aim=[0, 3], stretch=0.8, scanstep=8, maxcore=4096, corenum=8)
         Output in Atom1.inp:
             #Powered by MCPoly
             
             ! B3LYP D3BJ def2-TZVP 
             %maxcore 4096
             %PAL NPROCS 8 END
             %geom Scan
@@ -97,16 +102,16 @@
             F         -7.23198        2.03119        1.11508
                 ...
             *
     
     Example 4:
         Input:
             from MCPoly.orcaset import XYZtoINP
-            XYZtoINP('Atom1',method='B3LYP D3BJ',basis_set='def2-TZVP',MD=True,\
-                     MD=True,freq=True,md_timestep=1.0,initvel=350,tsNHC=350,dumpcon=25,runstep=2500,maxcore=4096,corenum=8)
+            XyzToInp('Atom1', method='B3LYP D3BJ', basis_set='def2-TZVP', MD=True, \
+                     MD=True, freq=True, md_timestep=1.0, initvel=350, tsNHC=350, dumpcon=25, runstep=2500, maxcore=4096, corenum=8)
         Output in Atom1.inp:
             #Powered by MCPoly
             
             ! MD B3LYP D3BJ def2-TZVP 
             %md
             Timestep 1.0_fs
             Initvel 350_K
@@ -122,119 +127,134 @@
             C         -5.87285        0.46952       -0.06689
             C         -4.65267        1.33725        0.06683
             C         -3.41103        0.47072        0.03973
             F         -7.23198        2.03119        1.11508
                 ...
             *
     """
-    f=open(fileloc+file+'.xyz','r')
-    if inpname=='':
+    f = open(fileloc+file+'.xyz', 'r')
+    if inpname == '':
         try:
-            w=open(saveloc+file+'.inp','x')
+            w = open(saveloc+file+'.inp', 'x')
         except:
-            w=open(saveloc+file+'.inp','w')
+            w = open(saveloc+file+'.inp', 'w')
     else:
         try:
-            w=open(saveloc+inpname+'.inp','x')
+            w = open(saveloc+inpname+'.inp', 'x')
         except:
-            w=open(saveloc+inpname+'.inp','w')
+            w = open(saveloc+inpname+'.inp', 'w')
     w.write('#Powered by MCPoly\n\n')
     w.write('! ')
-    if MD==True:
+    if MD == True:
         w.write('MD ')
-        sacn=False
-        opt=False
-        freq=False
-        external_force=False
+        sacn = False
+        opt = False
+        freq = False
+        external_force = False
     
-    w.write('{0} {1} '.format(method,basis_set))
+    w.write('{0} {1} '.format(method, basis_set))
         
-    if MD==True:
+    if MD == True:
         w.write('\n')
-        if initvel<0:
-            raise ValueError("Key word 'initvel' must be positive, for the unit is Kelvin.")
-        if tsNHC<0:
-            raise ValueError("Key word 'tsNHC' must be positive, for the unit is Kelvin.")
+        if initvel < 0:
+            raise ValueError("Key word 'initvel' must be positive,\
+                for the unit is Kelvin.")
+        if tsNHC < 0:
+            raise ValueError("Key word 'tsNHC' must be positive,\
+                for the unit is Kelvin.")
         w.write('%md\n')
         w.write('Timestep {0}_fs\n'.format(md_timestep))
         w.write('Initvel {0}_K\n'.format(initvel))
-        w.write('Thermostat NHC {0}_K Timecon {1}_fs\n'.format(tsNHC,timecon))
-        if dumpname=='':
-            w.write('Dump Position Stride {0} Filename "{1}_dump.xyz"\n'.format(dumpcon,file))
+        w.write('Thermostat NHC {0}_K Timecon {1}_fs\n'.format(tsNHC, timecon))
+        if dumpname == '':
+            w.write('Dump Position Stride {0} '.format(dumpcon)
+                    + 'Filename "{0}_dump.xyz"\n'.format(file))
         else:
-            w.write('Dump Position Stride {0} Filename "{1}_dump.xyz"\n'.format(dumpcon,dumpname))
+            w.write('Dump Position Stride {0}'.format(dumpcon)
+                    + 'Filename "{0}_dump.xyz"\n'.format(dumpname))
         w.write('Run {0}\n'.format(runstep))
         w.write('end\n')
         
-    if opt==True:
-        if scan==True:
+    if opt == True:
+        if scan == True:
             pass
-        if ts==True:
+        if ts == True:
             w.write('OPTTS ')
         else:
             w.write('OPT ')
-    if external_force==True and opt==False:
+    if external_force == True and opt == False:
         w.write('OPT ')
-    if freq==True:
-        if opt==False:
-            warnings.warn('Your set the frequency calculation without geometry optimisation.')
+    if freq == True:
+        if opt == False:
+            warnings.warn('Your set the frequency calculation'
+                          + ' without geometry optimisation.')
         w.write('FREQ')
     w.write('\n')
     
-    if maxiter!=-1:
-        if maxiter<=0 or type(maxiter)==float:
+    if maxiter != -1:
+        if maxiter <= 0 or type(maxiter) == float:
             raise ValueError("Key word 'maxiter' must be a positive integar.")
         w.write('%geom\n    MAXITER {0}\nend\n'.format(maxiter))
     
-    if maxcore!=-1:
+    if maxcore != -1:
         w.write('%maxcore {0}\n'.format(maxcore))
-        if maxcore<=2048:
-            warnings.warn('Your max core space is only {0:.3f} . You might delete this key words to get the same calculation speed, or try bigger one.'.format(maxcore))
+        if maxcore <= 2048:
+            warnings.warn('Your max core space is only {0:.3f} .'.format(maxcore)
+                + 'You might delete this key words to get the same calculation speed,'
+                + 'or try bigger one.')
 
-    if corenum!=1:
+    if corenum != 1:
         w.write('%PAL NPROCS {0} END\n'.format(corenum))
     
-    if scan==True:
-        if aim==[0,0]:
+    if scan == True:
+        if aim == [0, 0]:
             raise ValueError("You haven't set the site of two atoms you scan.")
-        elif aim[0]<0 or aim[1]<0 or type(aim[0])==float or type(aim[1])==float:
+        elif (aim[0] < 0 or aim[1] < 0 or 
+              type(aim[0]) == float or type(aim[1]) == float):
             raise ValueError("The site of two atoms must be not negative integar.")
-        elif aim[0]==aim[1]:
+        elif aim[0] == aim[1]:
             raise ValueError("You can't scan on the same two atoms.")
-        if scanstep<0 or type(scanstep)==float:
+        if scanstep < 0 or type(scanstep) == float:
             raise ValueError("The scan steps must be positive integar.")
-        if ts==True:
-            raise AssertionError("You can't set scan and transition state at the same time.")
-        if freq==True:
-            raise AssertionError("You can't set scan and frequency calculation at the same time.")
-        atoms=read(fileloc+file+'.xyz')
-        distance=atoms.get_distance(aim[0],aim[1])
-        if distance+stretch<0:
-            raise ValueError("You can't set the final distance of atoms less than 0.")
-        elif distance+stretch<=0.8:
-            warnings.warn('Your final distance of two atoms is only {0:.3f} .'.format(distance+stretch))
+        if ts == True:
+            raise AssertionError("You can't set scan and"
+                                 + "transition state at the same time.")
+        if freq == True:
+            raise AssertionError("You can't set scan and"
+                                 + "frequency calculation at the same time.")
+        atoms = read(fileloc+file+'.xyz')
+        distance = atoms.get_distance(aim[0], aim[1])
+        if distance + stretch < 0:
+            raise ValueError("You can't set the final distance"
+                             + "of atoms less than 0.")
+        elif distance + stretch <= 0.8:
+            warnings.warn('Your final distance of two atoms'
+                          + 'is only {0:.3f} .'.format(distance+stretch))
         w.write('%geom Scan\n')
-        w.write('B {0} {1} = {2:.3f}, {3:.3f}, {4}\nend\nend\n'.format(*aim, distance, distance+stretch,scanstep))
+        w.write('B {0} {1} = {2:.3f},  {3:.3f},  {4}\nend\nend\n'.format(*aim,\
+                                                                       distance, distance+stretch, scanstep))
 
-    if external_force==True:
-        if aim==[0,0]:
+    if external_force == True:
+        if aim == [0, 0]:
             raise ValueError("You haven't set the site of two atoms you scan.")
-        elif aim[0]<0 or aim[1]<0 or type(aim[0])==float or type(aim[1])==float:
+        elif (aim[0] < 0 or aim[1] < 0 or
+              type(aim[0]) == float or type(aim[1]) == float):
             raise ValueError("The site of two atoms must be not negative integar.")
-        elif aim[0]==aim[1]:
+        elif aim[0] == aim[1]:
             raise ValueError("You can't scan on the same two atoms.")
-        if scan==True:
+        if scan == True:
             raise AssertionError("You can't set scan and external force at the same time.")
-        if ts==True:
-            raise AssertionError("You can't set external force and transition state at the same time.")
+        if ts == True:
+            raise AssertionError("You can't set external force"
+                                 + "and transition state at the same time.")
         w.write('%geom\nPOTENTIALS\n')
-        w.write('{C '+'{0} {1} {2:.3f}'.format(*aim, strain)+'}\nend\nend\n')
+        w.write('{C ' + '{0} {1} {2:.3f}'.format(*aim, strain) + '}\nend\nend\n')
 
-    w.write('\n*xyz {0} {1}\n'.format(electron,state))
-    i=0
+    w.write('\n*xyz {0} {1}\n'.format(electron, state))
+    i = 0
     for line in f:
-        i=i+1
-        if i>=3:
+        i = i + 1
+        if i >= 3:
             w.write(line)
     w.write('*\n')
     f.close()
     w.close()
```

### Comparing `MCPoly-0.5.1.3/MCPoly/orcaset/mgui.py` & `MCPoly-0.6b1/MCPoly/orcaset/mgui.py`

 * *Files 19% similar despite different names*

```diff
@@ -1,17 +1,18 @@
-import ipywidgets as widgets
 import os
 import re
 import sys
 import time as t
+import ipywidgets as widgets
+from IPython.display import display
 
 mydir = os.path.dirname( __file__ )
 orcadir = os.path.join(mydir, '..', 'orcaset')
 sys.path.append(orcadir)
-from XYZtoINP import XYZtoINP
+from XyzToInp import XyzToInp
 from orca import orca
 
 mydir = os.path.dirname( __file__ )
 statusdir = os.path.join(mydir, '..', 'status')
 sys.path.append(statusdir)
 from status import status
 
@@ -21,127 +22,158 @@
 from view3d import view3d
 
 def mgui():
     """
         The method to use GUI to set ORCA input files and calculate multiple files consecutively by ORCA.
         You will know how to do as long as you get into the GUI platform.
 
-        TIPS: 1. To see the status of your optimisation, you can set another window and use status.figuretraj .
-              2. This visualisation will greatly restrict the flexibility of the task, to make you programme more flexible, please directly use the code.
+        TIPS: 1. To see the status of your optimisation,  you can set another window and use status.figuretraj .
+              2. This visualisation will greatly restrict the flexibility of the task,  to make you programme more flexible,  please directly use the code.
     """
 
     print('TIPS: Multiple values can be selected with Shift and/or Ctrl (or Command) pressed and mouse clicks or arrow keys.')
     
-    output=widgets.Output()
-    output2=widgets.Output()
-    scanoutput=widgets.Output()
-    forceoutput=widgets.Output()
-    eoutput=widgets.Output()
-    geooutput=widgets.Output()
-    case=widgets.Output()
+    output = widgets.Output()
+    output2 = widgets.Output()
+    scanoutput = widgets.Output()
+    forceoutput = widgets.Output()
+    eoutput = widgets.Output()
+    geooutput = widgets.Output()
+    case = widgets.Output()
     
-    def geoshow(files,loc,method,bs):
+    def geoshow(files, loc, method, bs):
         output.clear_output()
         with output:
-            if files==[]:
+            if files == []:
                 print('Please input the file to show the geometry structure on this screen.')
             for file in files:
                 try:
                     print('File: {0}.xyz'.format(file))
-                    view3d(file,loc,width=450,height=400)
+                    view3d(file, loc, width=450, height=400)
                 except:
                     print("'{0}.xyz' is not found.".format(file))
-            if method!='' and bs!='':
-                display(widgets.HBox([widgets.Label('ORCA Location:'),orcaloc]),startorca)
+            if method != '' and bs != '':
+                display(widgets.HBox([widgets.Label('ORCA Location:'),\
+                                      orcaloc]), startorca)
     
     def intro_status3d(button):
-        ii=0
+        ii = 0
         for file in files.value:
-            ii=ii+1
-            if roomox.value==False and coreox.value==False:
-                XYZtoINP(file,fileloc=loc.value,method=method.value,basis_set=bs.value,opt=opt.value,freq=freq.value,\
-                     maxiter=maxiter.value,maxcore=room.value*1024,corenum=corenum.value,electron=e.value,state=state.value)
-            elif roomox.value==False and coreox.value==True:
-                XYZtoINP(file,fileloc=loc.value,method=method.value,basis_set=bs.value,opt=opt.value,freq=freq.value,\
-                     maxiter=maxiter.value,maxcore=room.value*1024,electron=e.value,state=state.value)
-            elif roomox.value==True and coreox.value==False:
-                XYZtoINP(file,fileloc=loc.value,method=method.value,basis_set=bs.value,opt=opt.value,freq=freq.value,\
-                     maxiter=maxiter.value,corenum=corenum.value,electron=e.value,state=state.value)
-            elif roomox.value==True and coreox.value==True:
-                XYZtoINP(file,fileloc=loc.value,method=method.value,basis_set=bs.value,opt=opt.value,freq=freq.value,\
-                     maxiter=maxiter.value,electron=e.value,state=state.value)
+            ii = ii + 1
+            if roomox.value == False and coreox.value == False:
+                XyzToInp(file, fileloc=loc.value, method=method.value,\
+                         basis_set=bs.value, opt=opt.value, freq=freq.value,\
+                         maxiter=maxiter.value, maxcore=room.value*1024,\
+                         corenum=corenum.value, electron=e.value, state=state.value)
+            elif roomox.value == False and coreox.value == True:
+                XyzToInp(file, fileloc=loc.value, method=method.value,\
+                         basis_set=bs.value, opt=opt.value, freq=freq.value,\
+                         maxiter=maxiter.value, maxcore=room.value*1024,\
+                         electron=e.value, state=state.value)
+            elif roomox.value == True and coreox.value == False:
+                XyzToInp(file, fileloc=loc.value, method=method.value,\
+                         basis_set=bs.value, opt=opt.value, freq=freq.value,\
+                         maxiter=maxiter.value, corenum=corenum.value,\
+                         electron=e.value, state=state.value)
+            elif roomox.value == True and coreox.value == True:
+                XyzToInp(file, fileloc=loc.value, method=method.value,\
+                         basis_set=bs.value, opt=opt.value, freq=freq.value,\
+                         maxiter=maxiter.value, electron=e.value, state=state.value)
             with case:
-                display(widgets.HBox([widgets.Label(file), widgets.Label('  Processing...'), widgets.Label('[{0}]'.format(t.ctime(t.time())))]))
-            orca(file,orcaloc.value,loc.value,loc.value)
-            s=status(file,loc.value).status(statusonly=True)
-            if s==4:
+                display(widgets.HBox([widgets.Label(file), widgets.Label('  Processing...'),\
+                                      widgets.Label('[{0}]'.format(t.ctime(t.time())))]))
+            orca(file, orcaloc.value, loc.value, loc.value)
+            s = status(file, loc.value).status(statusonly=True)
+            if s == 4:
                 case.clear_output()
                 with case:
-                    display(widgets.Valid(description='     '+file,value=False,\
-                        readout='Retrying...'), widgets.Label('[{0}]'.format(t.ctime(t.time()))))
-                orca(file,orcaloc.value,loc.value,loc.value)
-                s=status(file,loc.value).status(statusonly=True)
-                if s==4:
+                    display(widgets.Valid(description = '     ' + file, value=False, \
+                            readout = 'Retrying...'),\
+                            widgets.Label('[{0}]'.format(t.ctime(t.time()))))
+                orca(file, orcaloc.value, loc.value, loc.value)
+                s = status(file, loc.value).status(statusonly=True)
+                if s == 4:
                     case.clear_output()
                     with output2:
-                        display(widgets.Valid(description='     '+file,value=False,\
-                                readout='Error!'), widgets.Label('[{0}]'.format(t.ctime(t.time()))))
-            elif s==2:
+                        display(widgets.Valid(description = '     ' + file, value=False, \
+                                readout = 'Error!'),\
+                                widgets.Label('[{0}]'.format(t.ctime(t.time()))))
+            elif s == 2:
                 case.clear_output()
                 with output2:
-                    display(widgets.HBox([widgets.Valid(description='     '+file,value=True),\
-                            widgets.Label('Completed.'), widgets.Label('[{0}]'.format(t.ctime(t.time())))]))
-            if ii==1:
+                    display(widgets.HBox([widgets.Valid(description = '     ' + file,\
+                                                        value=True),\
+                                          widgets.Label('Completed.'),\
+                                          widgets.Label('[{0}]'.format(t.ctime(t.time())))]))
+            if ii == 1:
                 output.clear_output()
             with output:
-                print('File: {0}.xyz    Energy: {1:.6f} Hartree'.format(file,status(file,loc.value).status(figureonly=True)[-1]))
-                view3d(file,loc.value,width=450,height=400)
+                print('File: {0}.xyz    Energy: {1:.6f} Hartree'.format(file,\
+                                                                        status(file, loc.value).status(figureonly = True)[-1]))
+                view3d(file, loc.value, width=450, height=400)
     
-    options=[]
-    loc=widgets.Text(description='Location:',value='./')
+    options = []
+    loc = widgets.Text(description = 'Location:', value='./')
     for path in os.listdir(loc.value):
-        if os.path.isfile(os.path.join(loc.value, path)):
-            a=re.search('.xyz', path)
+        if os.path.isfile(os.path.join(loc.value,  path)):
+            a = re.search('.xyz', path)
             if a:
-                b=re.search('_trj', path)
+                b = re.search('_trj', path)
                 if b:
                     pass
                 else:
                     options.append(path[:-4])
     options.sort()
-    files=widgets.SelectMultiple(options=options,description='xyz Files:')
-    method=widgets.Text(description='Method:')
-    bs=widgets.Text(description='Basis Set:')
-    opt=widgets.ToggleButton(value=False,description='Optimisation',layout=widgets.Layout(width='50%'))
-    freq=widgets.ToggleButton(value=False,description='Frequency',layout=widgets.Layout(width='50%'))
-    room=widgets.IntText(description='Space(GB):',value=4,min=1,layout=widgets.Layout(width='50%'))
-    roomox=widgets.ToggleButton(value=False,description='Default Space')
-    corenum=widgets.IntText(description='Core:',value=4,min=1,layout=widgets.Layout(width='50%'))
-    coreox=widgets.ToggleButton(value=False,description='Default CoreNumber')
-    e=widgets.IntText(description='Charge:',value=0,layout=widgets.Layout(width='50%'))
-    state=widgets.IntText(description='State:',value=1,layout=widgets.Layout(width='47.5%'))
-    geoox=widgets.ToggleButton(value=False,description='Structure Status',style=dict(font_weight='bold'),layout=widgets.Layout(width='98.5%'))
-    startorca=widgets.Button(description='Start ORCA Calculation',layout=widgets.Layout(width='99%'),style=dict(font_weight='bold',text_decoration='underline'))
-    geoout=widgets.interactive_output(geoshow, {'files': files, 'loc': loc, 'method': method, 'bs': bs})
-    orcaloc=widgets.Text(value='./')
-    maxiter=widgets.IntText(description='MaxIteration:',value=200,layout=widgets.Layout(width='98.5%'))
-    
-    title1=widgets.Label('File Details',style=dict(font_weight='bold'))
-    title2=widgets.Label('Calculation Methods',style=dict(font_weight='bold'))
-    
-    box_layout1 = widgets.Layout(display='flex', flew_flow='column', overflow='scroll hidden',\
-                    align_items='stretch', border='solid', height='650px', width='31%')
-    box_layout2 = widgets.Layout(display='flex', flew_flow='column', overflow='scroll hidden',\
-                    align_items='stretch', border='solid', height='650px', width='33%')
-    widgets.jslink((roomox,'value'),(room,'disabled'))
-    widgets.jslink((coreox,'value'),(corenum,'disabled'))
-    #introstatus=widgets.Button(description='See Current Calculation Status',style=dict(font_weight='bold',text_decoration='underline'),
-    #                  layout=widgets.Layout(width='98.5%'))
-
-    frame1=widgets.VBox([title1,loc,files,title2,widgets.HBox([opt,freq]),method,bs,widgets.HBox([corenum,coreox]),\
-                     widgets.HBox([room,roomox]),maxiter,widgets.HBox([e,state])],layout=box_layout1)
-    frame3=widgets.VBox([output2,case])
-    output.layout=box_layout2
-    frame3.layout=box_layout2
+    files = widgets.SelectMultiple(options=options, description = 'xyz Files:')
+    method = widgets.Text(description = 'Method:')
+    bs = widgets.Text(description = 'Basis Set:')
+    opt = widgets.ToggleButton(value=False, description = 'Optimisation',\
+                               layout = widgets.Layout(width='50%'))
+    freq = widgets.ToggleButton(value=False, description = 'Frequency',\
+                                layout = widgets.Layout(width='50%'))
+    room = widgets.IntText(description = 'Space(GB):', value=4, min=1,\
+                           layout = widgets.Layout(width='50%'))
+    roomox = widgets.ToggleButton(value=False, description = 'Default Space')
+    corenum = widgets.IntText(description = 'Core:', value=4, min=1,\
+                              layout = widgets.Layout(width='50%'))
+    coreox = widgets.ToggleButton(value=False, description = 'Default CoreNumber')
+    e = widgets.IntText(description = 'Charge:', value=0,\
+                        layout = widgets.Layout(width='50%'))
+    state = widgets.IntText(description = 'State:', value=1,\
+                            layout = widgets.Layout(width='47.5%'))
+    geoox = widgets.ToggleButton(value=False, description = 'Structure Status',\
+                                 style = dict(font_weight='bold'), layout = widgets.Layout(width='98.5%'))
+    startorca = widgets.Button(description = 'Start ORCA Calculation',\
+                               layout = widgets.Layout(width='99%'),\
+                               style = dict(font_weight = 'bold', text_decoration = 'underline'))
+    geoout = widgets.interactive_output(geoshow, {'files': files, 'loc': loc,\
+                                                  'method': method, 'bs': bs})
+    orcaloc = widgets.Text(value = './')
+    maxiter = widgets.IntText(description = 'MaxIteration:', value=200,\
+                              layout = widgets.Layout(width='98.5%'))
+    
+    title1 = widgets.Label('File Details', style = dict(font_weight='bold'))
+    title2 = widgets.Label('Calculation Methods',\
+                           style = dict(font_weight='bold'))
+    
+    box_layout1  =  widgets.Layout(display='flex', flew_flow='column',\
+                                   overflow = 'scroll hidden', align_items = 'stretch',\
+                                   border='solid',  height='650px',  width='31%')
+    box_layout2  =  widgets.Layout(display='flex',  flew_flow='column',\
+                                   overflow = 'scroll hidden', align_items = 'stretch',\
+                                   border='solid',  height='650px',  width='33%')
+    widgets.jslink((roomox, 'value'), (room, 'disabled'))
+    widgets.jslink((coreox, 'value'), (corenum, 'disabled'))
+    #introstatus = widgets.Button(description = 'See Current Calculation Status',\
+    #                             style = dict(font_weight = 'bold', text_decoration = 'underline'), 
+    #                  layout = widgets.Layout(width='98.5%'))
+
+    frame1 = widgets.VBox([title1, loc, files, title2, widgets.HBox([opt, freq]),\
+                           method, bs, widgets.HBox([corenum, coreox]), \
+                           widgets.HBox([room, roomox]), maxiter, widgets.HBox([e, state])],\
+                          layout = box_layout1)
+    frame3 = widgets.VBox([output2, case])
+    output.layout = box_layout2
+    frame3.layout = box_layout2
     startorca.on_click(intro_status3d)
 
-    display(widgets.HBox([frame1,output,frame3]))
+    display(widgets.HBox([frame1, output, frame3]))
```

### Comparing `MCPoly-0.5.1.3/MCPoly/orcaset/multiorca.py` & `MCPoly-0.6b1/MCPoly/orcaset/multiorca.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,29 +1,32 @@
-from .XYZtoINP import XYZtoINP
-from .orca import orca
 import time as t
+from .XyzToInp import XyzToInp
+from .orca import orca
 
 class multiorca:
     """
     The method to calculate several .inp files in one document consecutively by ORCA.
-    multiorca([file1,file2,file3,...],loc)
+    multiorca([file1, file2, file3, ...], loc)
     file: Your .xyz file name.
     loc: File Location. The default is your current location.
     You can get the further information by .run.
     """
-    def __init__(self,files=[],loc='./'):
+    def __init__(self, files=[], loc='./'):
         self.loc=loc
         self.files=files
         
-    def run(self,orcaloc='./',method='B3LYP',basis_set='def2-SVP',opt=False,freq=False,scan=False,external_force=False,ts=False,aim=[0,0],stretch=-1,scanstep=10,strain=-1,maxiter=-1,maxcore=-1,corenum=1,electron=0,state=1):
+    def run(self, orcaloc='./', method='B3LYP', basis_set='def2-SVP', opt=False,\
+            freq=False, scan=False, external_force=False, ts=False,\
+            aim=[0, 0], stretch=-1, scanstep=10, strain=-1, maxiter=-1,\
+            maxcore=-1, corenum=1, electron=0, state=1):
         """
     The method to calculate several .inp files by ORCA and save file at the same location with .inp files.
-    run(self,orcaloc='./',method='B3LYP',basis_set='def2-SVP',opt=False,freq=False,scan=False,external_force=False,ts=False,aim=[0,0],stretch=-1,scanstep=10,strain=-1,maxiter=-1,maxcore=-1,corenum=1,electron=0,state=1)
+    run(self, orcaloc='./', method='B3LYP', basis_set='def2-SVP', opt=False, freq=False, scan=False, external_force=False, ts=False, aim=[0, 0], stretch=-1, scanstep=10, strain=-1, maxiter=-1, maxcore=-1, corenum=1, electron=0, state=1)
     orcaloc: Your location of ORCA.
-             If you have set ORCA from https://www.orcasoftware.de/tutorials_orca/first_steps/trouble_install.html#path-variable,
+             If you have set ORCA from https://www.orcasoftware.de/tutorials_orca/first_steps/trouble_install.html#path-variable, 
              you can skip this key word.
     method: Your semiempirical/ab initio/DFT calculation methods. The default is B3LYP.
     basis_set: Your basis sets. The default is def2-SVP.
     opt: To show if you want to optimise your molecule. The default is False.
     freq: To show if you want to calculate the frequency of intermolecule system and thermodynamic data. The default is False.
     scan: To show if you want to scan the system. You must use key word 'aim', 'stretch' and 'scanstep' to express the site of external force, or it will cause 'ValueError'. 
         Herein, 'aim' is the site of external force, 'stretch' is the length you need to stretch (>0) or shrink(<0). (Unit: ), and 'scanstep' is the number of your scan steps.
@@ -44,27 +47,30 @@
              There will be a warning: sh: orca: 'command not found'.
           3. If you have set key word 'maxcore' and 'corenum', you must input 'orcaloc'.
              See in https://www.orcasoftware.de/tutorials_orca/first_steps/parallel.html
           4. You can see the error of ORCA directly from the output.
     Example:
         Input:
             from MCPoly.orcaset import multiorca
-            files=multiorca(['Atom1','Atom2'])
+            files=multiorca(['Atom1', 'Atom2'])
             orcaloc='./MCPoly/orca/'
-            files.run(orcaloc=orcaloc,method='B3LYP',basis_set='def2-TZVP',opt=True,freq=True,\
-                        maxcore=4096,corenum=8)
+            files.run(orcaloc=orcaloc, method='B3LYP', basis_set='def2-TZVP', opt=True, freq=True,\
+                        maxcore=4096, corenum=8)
         Output:
             1. Atom1.xyz [Tue Apr 25 15:26:50 2023]
             <<COMMAND LINES>>
             Program Completed.[Tue Apr 25 15:47:35 2023]
             
             2. Atom2.xyz [Tue Apr 25 15:47:36 2023]
             <<COMMAND LINES>>
             Program Completed.[Tue Apr 25 16:21:55 2023]
         """
-        i=1
+        i = 1
         for file in self.files:
             print('{0}. '.format(i)+file+'.xyz '+'[{0}]'.format(t.ctime(t.time())))
-            XYZtoINP(file,fileloc=self.loc,saveloc=self.loc,method=method,basis_set=basis_set,opt=opt,freq=freq,scan=scan,external_force=external_force,ts=ts,aim=aim,stretch=stretch,
-                     scanstep=scanstep,strain=strain,maxiter=maxiter,maxcore=maxcore,corenum=corenum,electron=electron,state=state)
-            orca(file,orcaloc,self.loc,self.loc)
-            i=i+1
+            XyzToInp(file, fileloc=self.loc, saveloc=self.loc, method=method,\
+                     basis_set=basis_set, opt=opt, freq=freq, scan=scan,\
+                     external_force=external_force, ts=ts, aim=aim, stretch=stretch,\
+                     scanstep=scanstep, strain=strain, maxiter=maxiter, maxcore=maxcore,\
+                     corenum=corenum, electron=electron, state=state)
+            orca(file, orcaloc, self.loc, self.loc)
+            i = i + 1
```

### Comparing `MCPoly-0.5.1.3/MCPoly/orcaset/orca.py` & `MCPoly-0.6b1/MCPoly/orcaset/orca.py`

 * *Files 27% similar despite different names*

```diff
@@ -1,52 +1,57 @@
 import os
 import re
 import time as t
 
-def orca(file,orcaloc='./',fileloc='./',saveloc='./'):
+def orca(file, orcaloc='./', fileloc='./', saveloc='./'):
     """
     The method to calculate .inp file by ORCA.
-    orca(file,orcaloc='./',fileloc='./',saveloc='./')
+    orca(file, orcaloc='./', fileloc='./', saveloc='./')
     file: Your .inp file name.
     orcaloc: Your location of ORCA.
-             If you have set ORCA from https://www.orcasoftware.de/tutorials_orca/first_steps/trouble_install.html#path-variable,
+             If you have set ORCA from https://www.orcasoftware.de/tutorials_orca/first_steps/trouble_install.html#path-variable, 
              you can skip this key word.
     fileloc: Your location of .inp file. The default is your current location.
     saveloc: Your location of .inp file. The default is your current location.
     Example:
         Input:
             from MCPoly.orcaset import XYZtoINP
             from MCPoly.orcaset import orca
             
-            XYZtoINP('Atom2',method='B3LYP',basis_set='def2-TZVP',opt=True,freq=True,\
-                        maxcore=4096,corenum=8)
-            orca('Atom2',orcaloc='./MCPoly/orca/')
+            XYZtoINP('Atom2', method='B3LYP', basis_set='def2-TZVP', opt=True, freq=True, \
+                        maxcore=4096, corenum=8)
+            orca('Atom2', orcaloc='./MCPoly/orca/')
         Output:
             <<COMMAND LINES>>
             Program Completed.[Mon Apr 17 14:25:12 2023] -> See the current location to check files.
             
-    TIPS: 1. Don't put the .inp to your ORCA installment file, it may disturb your work. 
-          2. If you don't input key word 'orcaloc' while you don't set ORCA, you will only get an empty .out file in the document.
+    TIPS: 1. Don't put the .inp to your ORCA installment file,  it may disturb your work. 
+          2. If you don't input key word 'orcaloc' while you don't set ORCA,  you will only get an empty .out file in the document.
              There will be a warning: sh: orca: 'command not found'.
-          3. If you have set key word 'maxcore' and 'corenum', you must input 'orcaloc'.
+          3. If you have set key word 'maxcore' and 'corenum',  you must input 'orcaloc'.
              See in https://www.orcasoftware.de/tutorials_orca/first_steps/parallel.html
           4. You can see the error of ORCA directly from the output.
     """
 
-    if orcaloc=='./':
-        os.system('orca {0}{1}.inp > {2}{1}.out'.format(fileloc,file,saveloc))
+    if orcaloc == './':
+        os.system('orca {0}{1}.inp > {2}{1}.out'.format(fileloc, file, saveloc))
     else:
         path = os.getcwd() + '/'
         os.chdir(orcaloc)
-        if fileloc=='./':
-            fileloc=path
-        if saveloc=='./':
-            saveloc=path
-        os.system('./orca {0}{1}.inp > {2}{1}.out'.format(fileloc,file,saveloc))
+        print(os.getcwd())
+        if fileloc == './':
+            fileloc = path
+        if saveloc == './':
+            saveloc = path
+        os.system('./orca {0}{1}.inp > {2}{1}.out'.format(fileloc, file, saveloc))
         print('Program Completed.[{0}]\n'.format(t.ctime(t.time())))
         os.chdir(path[:-1])
-    f=open(file+'.inp','r')
+    
+    path = os.getcwd() + '/'
+    os.chdir(fileloc)
+    f = open(file+'.inp', 'r')
     for line in f:
-        md=re.search('%md',line)
+        md = re.search('%md', line)
         if md:
-            os.system('cp {0}{1}_dump.xyz {1}_dump.xyz'.format(orcaloc,file))
-            os.system('rm {0}{1}_dump.xyz'.format(orcaloc,file))
+            os.system('cp {0}{1}_dump.xyz {1}_dump.xyz'.format(orcaloc, file))
+            os.system('rm {0}{1}_dump.xyz'.format(orcaloc, file))
+    os.chdir(path)
```

### Comparing `MCPoly-0.5.1.3/MCPoly/orcaset/ssorca.py` & `MCPoly-0.6b1/MCPoly/orcaset/ssorca.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,48 +1,50 @@
 import os
 import re
 import sys
-from .XYZtoINP import XYZtoINP
+from .XyzToInp import XyzToInp
 from .orca import orca
 from ase.io import read
 import time as t
 
 mydir = os.path.dirname( __file__ )
 statusdir = os.path.join(mydir, '..', 'status')
 sys.path.append(statusdir)
 from status import status
 
 def checkbroken(distance, force):
-    long1=abs(distance[-2]-distance[-1])
-    long2=abs(distance[-3]-distance[-2])
-    mul1=abs(force[-2]-force[-1])
-    mul2=abs(force[-3]-force[-2])
-    if long1/long2>=10*mul1/mul2:
+    long1 = abs(distance[-2] - distance[-1])
+    long2 = abs(distance[-3] - distance[-2])
+    mul1 = abs(force[-2] - force[-1])
+    mul2 = abs(force[-3] - force[-2])
+    if long1 / long2 >= 10 * mul1 / mul2:
         return 1
     else:
         return 0
 
 class ssorca:
     """
     The method to calculate .inp file with growing external force in one document consecutively by ORCA.
-    ssorca(file,loc)
+    ssorca(file, loc)
     file: Your .xyz file name.
     loc: File Location. The default is your current location.
     You can get the further information by .run.
     """
-    def __init__(self,file,loc='./'):
+    def __init__(self, file, loc='./'):
         self.loc=loc
         self.file=file
         
-    def run(self,orcaloc='./',method='B3LYP',basis_set='def2-SVP',freq=False,aim=[0,0],strain=0,forcestep={0:1},maxiter=-1,maxcore=-1,corenum=1,electron=0,state=1):
+    def run(self, orcaloc='./', method='B3LYP', basis_set='def2-SVP', freq=False,\
+            aim=[0, 0], strain=0, forcestep={0:1}, maxiter=-1,\
+            maxcore=-1, corenum=1, electron=0, state=1):
         """
     The method to calculate .inp file with growing external force by ORCA and save file at the same location with .inp files, powered by ase.
-    run(self,orcaloc='./',method='B3LYP',basis_set='def2-SVP',freq=False,external_force=False,aim=[0,0],strain=0,maxiter=-1,maxcore=-1,corenum=1,electron=0,state=1)
+    run(self, orcaloc='./', method='B3LYP', basis_set='def2-SVP', freq=False, external_force=False, aim=[0, 0], strain=0, maxiter=-1, maxcore=-1, corenum=1, electron=0, state=1)
     orcaloc: Your location of ORCA.
-             If you have set ORCA from https://www.orcasoftware.de/tutorials_orca/first_steps/trouble_install.html#path-variable,
+             If you have set ORCA from https://www.orcasoftware.de/tutorials_orca/first_steps/trouble_install.html#path-variable, 
              you can skip this key word.
     method: Your semiempirical/ab initio/DFT calculation methods. The default is B3LYP.
     basis_set: Your basis sets. The default is def2-SVP.
     opt: To show if you want to optimise your molecule. The default is False.
     freq: To show if you want to calculate the frequency of intermolecule system and thermodynamic data. The default is False.
     aim: To express two sites of external force.
     strain: To express the beginning force energy (Unit: nN). The default is no external force.
@@ -64,18 +66,18 @@
              There will be a warning: sh: orca: 'command not found'.
           3. If you have set key word 'maxcore' and 'corenum', you must input 'orcaloc'.
              See in https://www.orcasoftware.de/tutorials_orca/first_steps/parallel.html
           4. You can see the error of ORCA directly from the output.
     Example 1:
         Input:
             from MCPoly.orcaset import ssorca
-            polymer=ssorca('Atom1')
-            orcaloc='./MCPoly/orca/'
-            polymer.run(orcaloc=orcaloc,method='B3LYP',basis_set='def2-TZVP',freq=True,aim=[2,3],forcestep={0:0.5},\
-                        maxcore=4096,corenum=8)
+            polymer = ssorca('Atom1')
+            orcaloc = './MCPoly/orca/'
+            polymer.run(orcaloc=orcaloc, method='B3LYP', basis_set='def2-TZVP', freq=True, aim=[2, 3], forcestep={0:0.5},\
+                        maxcore=4096, corenum=8)
         Output:
             File: Atom1.xyz
             Current External Force: 0.000 nN [Tue Apr 25 15:23:49 2023]
             <<COMMAND LINES>>
             Program Completed.[Tue Apr 25 15:43:58 2023]
             
             Current External Force: 0.500 nN [Tue Apr 25 15:43:59 2023]
@@ -92,18 +94,18 @@
             
             The polymer is broken. Programme Completed.[Tue Apr 25 16:39:47 2023]
             [file orca_main/run.cpp, line 32327]: ORCA finished with error return - aborting the run     -> COMMAND LINES
 
     Example 2:
         Input:
             from MCPoly.orcaset import ssorca
-            polymer=ssorca('Atom2')
-            orcaloc='./MCPoly/orca/'
-            polymer.run(orcaloc=orcaloc,method='B3LYP',basis_set='def2-TZVP',freq=True,aim=[2,3],forcestep={0:1,5:0.5},\
-                        maxcore=4096,corenum=8)
+            polymer = ssorca('Atom2')
+            orcaloc = './MCPoly/orca/'
+            polymer.run(orcaloc=orcaloc, method='B3LYP', basis_set='def2-TZVP', freq=True, aim=[2, 3], forcestep={0:1, 5:0.5},\
+                        maxcore=4096, corenum=8)
         Output:
             File: Atom2.xyz
             Current External Force: 0.000 nN [Tue Apr 25 15:23:49 2023]
             <<COMMAND LINES>>
             Program Completed.[Tue Apr 25 15:43:52 2023]
             
             Current External Force: 1.000 nN [Tue Apr 25 15:43:52 2023]
@@ -123,51 +125,61 @@
             Current External Force: 6.000 nN [Tue Apr 25 17:24:40 2023]
             <<COMMAND LINES>>
             Program Completed.[Tue Apr 25 17:51:31 2023]
             
             The polymer is broken. Programme Completed.[Tue Apr 25 17:51:31 2023]
             [file orca_main/run.cpp, line 73453]: ORCA finished with error return - aborting the run     -> COMMAND LINES
         """
-        distances=[]
-        force=[]
+        distances = []
+        force = []
         print('File: {0}.xyz'.format(self.file))
-        XYZtoINP(self.file,fileloc=self.loc,method=method,basis_set=basis_set,opt=True,freq=freq,\
-                 external_force=True,aim=aim,strain=strain,maxiter=maxiter,maxcore=maxcore,corenum=corenum,\
-                 electron=electron,state=state)
+        XyzToInp(self.file, fileloc=self.loc, method=method,\
+                 basis_set=basis_set, opt=True, freq=freq, \
+                 external_force=True, aim=aim, strain=strain,\
+                 maxiter=maxiter, maxcore=maxcore, corenum=corenum, \
+                 electron=electron, state=state)
         os.system('cp {0}.inp {0}_0.000.inp'.format(self.file))
-        keys=[]
+        keys = []
         for key in forcestep:
             keys.append(key)
         keys.reverse()
-        key=keys[0]
+        key = keys[0]
         while 1:
-            print('Current External Force: {0:.3f} nN [{1}]'.format(strain,t.ctime(t.time())))
-            orca(self.file+'_{0:.3f}'.format(strain),orcaloc,self.loc,self.loc)
-            s=status(self.file+'_{0:.3f}'.format(strain),self.loc).status(statusonly=True)
-            atoms=read(file+'_{0:.3f}.xyz'.format(strain))
-            d=atoms.get_distance(aim[0],aim[1])
-            if s==4:
+            print('Current External Force: {0:.3f} nN [{1}]'.format(strain,\
+                                                                    t.ctime(t.time())))
+            orca(self.file+'_{0:.3f}'.format(strain), orcaloc, self.loc, self.loc)
+            s = status(self.file+'_{0:.3f}'.format(strain),\
+                       self.loc).status(statusonly=True)
+            atoms = read(file+'_{0:.3f}.xyz'.format(strain))
+            d = atoms.get_distance(aim[0], aim[1])
+            if s == 4:
                 distances.append(d)
                 force.append(strain)
-                xoy=checkbroken(distances,force)
-                if xoy==1:
-                    print('The polymer is broken. Programme Completed. [{0}]'.format(t.ctime(t.time())))
+                xoy = checkbroken(distances, force)
+                if xoy == 1:
+                    print('The polymer is broken.\
+                        Programme Completed. [{0}]'.format(t.ctime(t.time())))
                     break
-                print('This calculation has some errors.\nThe programme will recalculate this system again. [{0}]\n'.format(t.ctime(t.time())))
-                orca(self.file+'_{0:.3f}'.format(strain),orcaloc,self.loc,self.loc)
-                s=status(self.file,self.loc).status(statusonly=True)
-                if s==4:
-                    print('This calculation still has some errors.\n Please check your .inp and try again. [{0}]\n'.format(t.ctime(t.time())))
-                    distances[-1]=None
+                print('This calculation has some errors.\nThe programme\
+                    will recalculate this system again. [{0}]\n'.format(t.ctime(t.time())))
+                orca(self.file+'_{0:.3f}'.format(strain), orcaloc, self.loc, self.loc)
+                s = status(self.file, self.loc).status(statusonly=True)
+                if s == 4:
+                    print('This calculation still has some errors.\n\
+                        Please check\
+                        your .inp and try again. [{0}]\n'.format(t.ctime(t.time())))
+                    distances[-1] = None
                 else:
-                    distances[-1]=d
+                    distances[-1] = d
             else:
                 distances.append(d)
                 force.append(strain)
             for key in keys:
-                if strain>=key:
-                    XYZtoINP(self.file+'_{0:.3f}'.format(strain),inpname=self.file+'_{0:.3f}'.format(strain+forcestep[key]),\
-                             method=method,basis_set=basis_set,opt=True,freq=freq,\
-                             external_force=True,aim=aim,strain=strain+forcestep[key],maxiter=maxiter,maxcore=maxcore,\
-                             corenum=corenum,electron=electron,state=state)
-                    strain=strain+forcestep[key]
+                if strain >= key:
+                    XyzToInp(self.file+'_{0:.3f}'.format(strain),\
+                             inpname=self.file+'_{0:.3f}'.format(strain+forcestep[key]), \
+                             method=method, basis_set=basis_set, opt=True, freq=freq, \
+                             external_force=True, aim=aim, strain = strain + forcestep[key],\
+                             maxiter=maxiter, maxcore=maxcore,\
+                             corenum=corenum, electron=electron, state=state)
+                    strain = strain + forcestep[key]
                     break
```

### Comparing `MCPoly-0.5.1.3/MCPoly/orcaset/view3dchoose.py` & `MCPoly-0.6b1/MCPoly/orcaset/view3dchoose.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,62 +1,63 @@
 import os
+import py3Dmol
 from itertools import product
 from rdkit import Chem
 from rdkit.Chem import Draw
 from rdkit.Chem.Draw import IPythonConsole
 from rdkit.Chem.Draw import MolToFile
-import py3Dmol
 from rdkit.Chem import rdDetermineBonds
 
 def cleanup_qm9_xyz(fname):
     ind = open(fname).readlines()
     nAts = int(ind[0])
     # There are two smiles in the data: the one from GDB and the one assigned from the
     # 3D coordinates in the QM9 paper using OpenBabel (I think).
-    gdb_smi,relax_smi = ind[-2].split()[:2]
+    gdb_smi, relax_smi = ind[-2].split()[:2]
     ind[1] = '\n'
     ind = ind[:nAts+2]
-    for i in range(2,nAts+2):
+    for i in range(2, nAts+2):
         l = ind[i]
         l = l.split('\t')
         l.pop(-1)
         ind[i] = '\t'.join(l)+'\n'
     ind = ''.join(ind)
-    return ind,gdb_smi,relax_smi
+    return ind, gdb_smi, relax_smi
 
-def draw_with_spheres_choose(mol,choose,width,height):
-    v = py3Dmol.view(width=width,height=height)
-    IPythonConsole.addMolToView(mol,v)
+def draw_with_spheres_choose(mol, choose, width, height):
+    v = py3Dmol.view(width=width, height=height)
+    IPythonConsole.addMolToView(mol, v)
     v.zoomTo()
-    v.setStyle({'sphere':{'radius':0.3},'stick':{'radius':0.1}})
+    v.setStyle({'sphere':{'radius':0.3}, 'stick':{'radius':0.1}})
     for i in choose:
-        v.setStyle({'model': -1, 'serial': i},{'sphere':{'radius':0.5,'color':'Blue'},'stick':{'radius':0.1}})
+        v.setStyle({'model': -1, 'serial': i},\
+                   {'sphere':{'radius':0.5, 'color':'Blue'}, 'stick':{'radius':0.1}})
     v.show()
 
-def view3dchoose(filename,loc='./',choose=[],width=400,height=550):
+def view3dchoose(filename, loc='./', choose=[], width=400, height=550):
     """
     A method to see the geometry structure of the ORCA optimisation, powered by py3Dmol and rdkit. Not original.
     TIPS: Make sure your .xyz file is in the document, or there will be NoFileFoundError!!!
     
     view3d(file, loc='./', width=300, height=300)
     file: File Name.
     loc: File Location. The default is your current location.
     num: The step of your convergence.
     width, height: The size of your 3D geometry molecule strcuture. Default: 300x300.
     """
     path = os.getcwd()
     os.chdir(loc)
-    ind = open('{0}.xyz'.format(filename),'r+')
+    ind = open('{0}.xyz'.format(filename), 'r+')
     mains = ind.readlines()
-    main=''
-    for i,line in enumerate(mains):
-        if i==1:
-            main=main+'\n'
+    main = ''
+    for i, line in enumerate(mains):
+        if i == 1:
+            main = main + '\n'
         else:
-            main=main+mains[i]
+            main = main + mains[i]
     #print(main)
     raw_mol = Chem.MolFromXYZBlock(main)
     conn_mol = Chem.Mol(raw_mol)
     rdDetermineBonds.DetermineConnectivity(conn_mol)
-    v=draw_with_spheres_choose(conn_mol,choose,width,height)
+    v = draw_with_spheres_choose(conn_mol, choose, width, height)
     os.chdir(path)
     return v
```

### Comparing `MCPoly-0.5.1.3/MCPoly/sscurve/YModulus.py` & `MCPoly-0.6b1/MCPoly/sscurve/YModulus.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,35 +1,37 @@
-from sklearn.linear_model import LinearRegression
-from sklearn.metrics import r2_score
-import numpy as np
 import re
+import numpy as np
 import pandas as pd
+from sklearn.metrics import r2_score
+from sklearn.linear_model import LinearRegression
 
 def YModulus(file):
     '''
     Try to calculate the Young's Modulus based on LinearRegression.
     YModulus(file)
     file: File Name
     Unit: nN
     Use the calculated .txt file from sscurve.single or sscurve.multiple to get Young's Modulus.
     '''
-    datum=pd.read_csv(file)
-    b=re.search(r'[A-Z]+[a-z]*[A-Z]*[a-z]*[0-9]*\-?[A-Z]*[0-9]*_', file)
+    datum = pd.read_csv(file)
+    b = re.search(r'[A-Z]+[a-z]*[A-Z]*[a-z]*[0-9]*\-?[A-Z]*[0-9]*_', file)
     #print(b.group(0)[:-1])
-    datum=datum.rename(columns={'Strain Length(%)':'Strain Length ({0})'.format(b.group(0)[:-1])})
-    data=datum['Strain Length ({0})'.format(b.group(0)[:-1])].to_numpy().reshape(-1, 1)
-    target=datum['Stress Force(nN)'].to_numpy().reshape(-1, 1)
-    j=3
+    datum = datum.rename(columns = {
+        'Strain Length(%)':'Strain Length ({0})'.format(b.group(0)[:-1])})
+    data = datum['Strain Length ({0})'.format(
+        b.group(0)[:-1])].to_numpy().reshape(-1, 1)
+    target = datum['Stress Force(nN)'].to_numpy().reshape(-1, 1)
+    j = 3
     while 1:
-        data2=data[1:j]
-        target2=target[1:j]
-        model=LinearRegression()
-        model.fit(data2,target2)
-        y=model.coef_[0][0]*data2+model.intercept_
-        test_score=r2_score(target2,y)
-        #print(model.coef_[0][0],model.intercept_[0],test_score)
-        if test_score<0.99:
+        data2 = data[1:j]
+        target2 = target[1:j]
+        model = LinearRegression()
+        model.fit(data2, target2)
+        y = model.coef_[0][0]*data2 + model.intercept_
+        test_score = r2_score(target2, y)
+        #print(model.coef_[0][0], model.intercept_[0], test_score)
+        if test_score < 0.99:
             break
-        k=model.coef_[0][0]
-        b=model.intercept_[0]
-        j=j+1
+        k = model.coef_[0][0]
+        b = model.intercept_[0]
+        j = j + 1
     return k
```

### Comparing `MCPoly-0.5.1.3/MCPoly/sscurve/gui.py` & `MCPoly-0.6b1/MCPoly/sscurve/gui2.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,297 +1,325 @@
-import ipywidgets as widgets
 import os
 import re
+import warnings
+import sys
 import time as t
 import pandas as pd
 import seaborn as sns
+import ipywidgets as widgets
 import matplotlib.pyplot as plt
+from IPython.display import display
 from .YModulus import YModulus
 from .single import single
-import warnings
-import sys
 
 mydir = os.path.dirname( __file__ )
 viewdir = os.path.join(mydir, '..', 'orcaset')
 sys.path.append(viewdir)
 from view3dchoose import view3dchoose
 
 mydir = os.path.dirname( __file__ )
 viewdir = os.path.join(mydir, '..', 'orcaset')
 sys.path.append(viewdir)
-from XYZtoINP import XYZtoINP
+from XyzToInp import XyzToInp
 
 mydir = os.path.dirname( __file__ )
 statusdir = os.path.join(mydir, '..', 'status')
 sys.path.append(statusdir)
 from status import status
 
-def gui():
+def gui2():
     """
         The method to use GUI to assemble mechanical datas and get the multiple stress-strain curve on a chart in handy!
         You will know how to do as long as you get into the GUI platform.
 
         TIPS: 1. Make sure all your created .xyz files from orcaset.ssorca or orcaset.ssgui is on the direct folder, or the programme will get error.
               2. You'd better have relevant .inp or .out file on the direct folder to automatically set the site of external force. Though GUI has manual auxiliary, it will cost you much more time.
               3. The visualisation will also risk the flexibility of the task, to make you programme more flexible, please directly use the code.
     """
-    def multiple_gui(polymers,loc='./',savedata=False, savefig=False, pngname='', csvname=''):
-        opath=os.getcwd()
+    def multiple_gui(polymers, loc = './', savedata = False, savefig=False, pngname = '', csvname = ''):
+        opath = os.getcwd()
         os.chdir(loc)
         try:
-            f=open('ot.txt','x')
+            f = open('ot.txt', 'x')
         except:
-            f=open('ot.txt','w')
+            f = open('ot.txt', 'w')
         
-        name=[]
-        i=0
+        name = []
+        i = 0
         
-        site=[]
+        site = []
         
         for polymer in polymers:
-            polymer=polymer+'_Result.txt'
+            polymer = polymer + '_Result.txt'
             try:
-                datum=pd.read_csv(polymer)
+                datum = pd.read_csv(polymer)
             except:
                 warnings.warn("'{0}' is not found.".format(polymer))
                 continue
-            datum=datum[:].sort_values(by=['Strain Length(%)'])
-            for num in datum['Stress Force(nN)'][:-1]:
+            datum = datum[:].sort_values(by=['Distance(A)'])
+            for num in datum['Force(nN)'][:-1]:
                 if num not in site:
                     site.append(num)
         site.sort()
-        f.write('Stress Force(nN)\n')
+        f.write('Force(nN)\n')
         for num in site:
             f.write('{0:.3f}\n'.format(num))
         f.close()
-        ot=pd.read_csv('ot.txt')
+        ot = pd.read_csv('ot.txt')
         for polymer in polymers:
-            polymer=polymer+'_Result.txt'
+            polymer = polymer + '_Result.txt'
             try:
-                datum=pd.read_csv(polymer)
+                datum = pd.read_csv(polymer)
             except:
+                warnings.warn('{0} is not the file aboue stress-strain curve.'.format(polymer))
                 continue
-            try:
-                datum=datum[:].sort_values(by=['Strain Length(%)'])
-            except:
-                continue
-            ax=plt.plot(datum['Strain Length(%)'][:-1],datum['Stress Force(nN)'][:-1],'*-')
-            datum=datum.rename(columns={'Strain Length(%)':'Strain Length ({0})'.format(polymer[:-11])})
-            ot=pd.merge_ordered(ot, datum[:-1], fill_method="ffill" , left_by="Stress Force(nN)")
+            datum = datum[:].sort_values(by = ['Distance(A)'])
+            ax = plt.plot(datum['Force(nN)'][:-1], datum['Distance(A)'][:-1], '*-')
+            datum = datum.rename(
+                columns = {'Distance(A)':'Distance(A)({0})'.format(polymer[:-11])})
+            ot = pd.merge_ordered(ot, datum[:-1], fill_method = "ffill",\
+                                  left_by = "Force(nN)")
             name.append(polymer[:-11])
-            i=i+1
+            i = i + 1
     
-        ot=ot.set_index('Stress Force(nN)')
-        if savedata==True or savefig==True:
-            if savedata==True:
+        ot = ot.set_index('Force(nN)')
+        if savedata == True or savefig == True:
+            if savedata == True:
                 ot.to_csv('{0}.csv'.format(csvname))
         else:
             output3.clear_output()
             with output3:
                 display(ot)
-                display(widgets.HBox([widgets.Label('CSV File Name:'),name2]))
+                display(widgets.HBox([widgets.Label('CSV File Name:'), name2]))
                 display(save2)
         
-        plt.xlabel('Strain Length(%)')
-        plt.ylabel('Stress Force(nN)')
-        plt.legend(name,bbox_to_anchor=[1.1,0.9])
-        _ = plt.title('Stress-Strain Curve')
-        if savedata==True or savefig==True:
-            if savefig==True:
-                plt.savefig('{0}.png'.format(pngname),bbox_inches='tight')
+        plt.xlabel('Force(nN)')
+        plt.ylabel('Distance(A)')
+        plt.legend(name, bbox_to_anchor = [1.1, 0.9])
+        _ = plt.title('Distance Relationship')
+        if savedata == True or savefig == True:
+            if savefig == True:
+                plt.savefig('{0}.png'.format(pngname), bbox_inches = 'tight')
         else:
             with output2:
                 plt.show()
-                display(widgets.HBox([widgets.Label('PNG File Name:'),name1]))
+                display(widgets.HBox([widgets.Label('PNG File Name:'), name1]))
                 display(save1)
     
         os.system('rm ot.txt')
         os.chdir(opath)
     
-    print('TIPS: Multiple values can be selected with Shift and/or Ctrl (or Command) pressed and mouse clicks or arrow keys.')
-    
-    output2=widgets.Output()
-    output3=widgets.Output()
-    judgeoutput=widgets.Output()
+    print('TIPS: Multiple values can be selected with\
+        Shift and/or Ctrl (or Command) pressed\
+        and mouse clicks or arrow keys.')
+    
+    output2 = widgets.Output()
+    output3 = widgets.Output()
+    judgeoutput = widgets.Output()
     
-    def geoshow(aim1,aim2,geoi,files):
+    def geoshow(aim1, aim2, geoi, files):
         output2.clear_output()
         with output2:
             try:
                 print("'{0}.xyz' Geometry Structure:".format(files[geoi]))
             except:
                 return None
-            aim=[aim1,aim2]
-            print('Atom1: {0}      Atom2: {1}'.format(aim1,aim2))
+            aim = [aim1, aim2]
+            print('Atom1: {0}      Atom2: {1}'.format(aim1, aim2))
             try:
-                view3dchoose(files[geoi]+'_0.000',loc.value,choose=aim,width=450,height=400)
+                view3dchoose(files[geoi]+'_0.000', loc.value,\
+                             choose=aim, width=450, height=400)
             except:
-                view3dchoose(files[geoi]+'_0',loc.value,choose=aim,width=450,height=400)
+                view3dchoose(files[geoi]+'_0', loc.value, choose=aim, width=450, height=400)
     
-    def filejudge(files,loc):
+    def filejudge(files, loc):
         judgeoutput.clear_output()
         output2.clear_output()
         output3.clear_output()
-        opath=os.getcwd()
+        opath = os.getcwd()
         os.chdir(loc)
-        #geoi=widgets.IntText(value=0)
-        t0=0
+        #geoi = widgets.IntText(value=0)
+        t0 = 0
         try:
-            geoi.value=0
+            geoi.value = 0
             for file in files:
-                t0=0
+                t0 = 0
                 for path in os.listdir(loc):
                     if os.path.isfile(os.path.join(loc, path)):
-                        a=re.match('{0}_Result.txt'.format(file), path)
+                        a = re.match('{0}_Result.txt'.format(file), path)
                         if a:
                             output2.clear_output()
-                            geoi.value=geoi.value+1
-                            t0=1
+                            geoi.value = geoi.value + 1
+                            t0 = 1
                             break
-                if t0==0:
+                if t0 == 0:
                     output2.clear_output()
-                    single(file,loc=loc).autocurve(savefig=False)
-                    geoi.value=geoi.value+1
-                #single(file,loc=loc).autocurve(savefig=False)
-                #geoi.value=geoi.value+1
+                    single(file, loc = loc).autocurve2(savefig=False)
+                    geoi.value = geoi.value + 1
+                #single(file, loc = loc).autocurve(savefig=False)
+                #geoi.value = geoi.value + 1
         except:
-            xtitle=widgets.Label('Extra Information about {0}:'.format(files[geoi.value]),style=dict(font_weight='bold'))
-            #aim1=widgets.BoundedIntText(description='Atom 1:',value=0,min=0,layout=widgets.Layout(width='48%'))
-            #aim2=widgets.BoundedIntText(description='Atom 2:',value=0,min=0,layout=widgets.Layout(width='48%'))
-            aim1.value=0
-            aim2.value=0
-            OK=widgets.Button(description='OK')
+            xtitle = widgets.Label(
+                'Extra Information about {0}:'.format(files[geoi.value]),\
+                style = dict(font_weight = 'bold'))
+            #aim1 = widgets.BoundedIntText(description = 'Atom 1:',\
+            #                              value=0, min=0, layout = widgets.Layout(width='48%'))
+            #aim2 = widgets.BoundedIntText(description = 'Atom 2:',\
+            #                              value=0, min=0, layout = widgets.Layout(width='48%'))
+            aim1.value = 0
+            aim2.value = 0
+            OK = widgets.Button(description = 'OK')
             with judgeoutput:
-                display(widgets.VBox([xtitle,widgets.HBox([aim1,aim2]),OK]))
+                display(widgets.VBox([xtitle, widgets.HBox([aim1, aim2]), OK]))
             with output2:
                 #print("'{0}' Geometry Structure:".format(file))
-                #geoout=widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2, 'geoi': geoi})
+                #geoout = widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2, 'geoi': geoi})
                 OK.on_click(OKss)
         os.chdir(opath)
     
     def OKss(button):
-        opath=os.getcwd()
+        opath = os.getcwd()
         os.chdir(loc.value)
         #with output3:
-        #    print(geoi.value,aim1.value,aim2.value)
-        single(files.value[geoi.value],loc=loc.value).curve(aim1.value,aim2.value,savefig=False)
+        #    print(geoi.value, aim1.value, aim2.value)
+        single(files.value[geoi.value],\
+               loc = loc.value).curve(aim1.value, aim2.value, savefig=False)
         judgeoutput.clear_output()
         output2.clear_output()
-        geoi.value=geoi.value+1
+        geoi.value = geoi.value + 1
         try:
-            if geoi.value>=len(files.value):
+            if geoi.value >= len(files.value):
                 return None
-            for i in range(geoi.value,len(files.value)):
+            for i in range(geoi.value, len(files.value)):
                 for path in os.listdir(loc.value):
                     if os.path.isfile(os.path.join(loc.value, path)):
-                        a=re.match(files.value[geoi.value]+'_Result.rxt', path)
+                        a = re.match(files.value[geoi.value]+'_Result.rxt', path)
                         if a:
-                            geoi.value=geoi.value+1
+                            geoi.value = geoi.value + 1
                             return None
-                single(files.value[i],loc=loc.value).autocurve(savefig=False)
-                geoi.value=geoi.value+1
+                single(files.value[i], loc=loc.value).autocurve2(savefig=False)
+                geoi.value = geoi.value + 1
         except:
-            xtitle=widgets.Label('Extra Information about {0}:'.format(files.value[geoi.value]),style=dict(font_weight='bold'))
-            #aim1=widgets.BoundedIntText(description='Atom 1:',value=0,min=0,layout=widgets.Layout(width='48%'))
-            #aim2=widgets.BoundedIntText(description='Atom 2:',value=0,min=0,layout=widgets.Layout(width='48%'))
-            OK=widgets.Button(description='OK')
+            xtitle = widgets.Label(
+                'Extra Information about {0}:'.format(files.value[geoi.value]),\
+                style = dict(font_weight = 'bold'))
+            #aim1 = widgets.BoundedIntText(description = 'Atom 1:',\
+            #                              value=0, min=0, layout = widgets.Layout(width='48%'))
+            #aim2 = widgets.BoundedIntText(description = 'Atom 2:',\
+            #                              value=0, min=0, layout = widgets.Layout(width='48%'))
+            OK = widgets.Button(description = 'OK')
             with judgeoutput:
-                display(widgets.VBox([xtitle,widgets.HBox([aim1,aim2]),OK]))
+                display(widgets.VBox([xtitle, widgets.HBox([aim1, aim2]), OK]))
             with output2:
                 #print("'{0}.xyz' Geometry Structure:".format(files.value[geoi.value]))
-                #geoout=widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2, 'geoi': geoi})
+                #geoout = widgets.interactive_output(geoshow,\
+                #                                    {'aim1': aim1, 'aim2': aim2, 'geoi': geoi})
                 #display(geoout)
                 OK.on_click(OKss)
         os.chdir(opath)
     
     def intro_result(button):
         for file in files.value:
-            t0=0
+            t0 = 0
             try:
-                t0=0
+                t0 = 0
                 for path in os.listdir(loc.value):
                     if os.path.isfile(os.path.join(loc.value, path)):
-                        a=re.match(file+'_Result.rxt', path)
+                        a = re.match(file+'_Result.rxt', path)
                         if a:
-                            t0=1
+                            t0 = 1
                             break
-                if t0==0:
-                    single(file,loc=loc.value).autocurve(savefig=False)
+                if t0 == 0:
+                    single(file, loc=loc.value).autocurve2(savefig=False)
             except:
                 pass
-    #            xtitle=widgets.Label('Extra Information about {0}:'.format(file),style=dict(font_weight='bold'))
-    #            aim1=widgets.BoundedIntText(description='Atom 1:',value=0,min=0,layout=widgets.Layout(width='48%'))
-    #            aim2=widgets.BoundedIntText(description='Atom 2:',value=0,min=0,layout=widgets.Layout(width='48%'))
-    #            OK=widgets.Button(description='OK')
+    #            xtitle = widgets.Label('Extra Information about {0}:'.format(file),\
+    #                                   style = dict(font_weight = 'bold'))
+    #            aim1 = widgets.BoundedIntText(description = 'Atom 1:', value=0,\
+    #                                          min=0, layout = widgets.Layout(width='48%'))
+    #            aim2 = widgets.BoundedIntText(description = 'Atom 2:', value=0,\
+    #                                          min=0, layout = widgets.Layout(width='48%'))
+    #            OK = widgets.Button(description = 'OK')
     #            with output:
-    #                display(widgets.VBox[xtitle,widgets.HBox([aim1,aim2]),OK])
-    #            geoout=widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2})
+    #                display(widgets.VBox[xtitle, widgets.HBox([aim1, aim2]), OK])
+    #            geoout = widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2})
     #            with outout2:
     #                display(geoout)
     #            OK.on_click(OKss)
     #            t.sleep(15)
-        multiple_gui(files.value,loc=loc.value)
+        multiple_gui(files.value, loc=loc.value)
         
     def pngsave(button):
-        multiple_gui(files.value,loc=loc.value,savefig=True,pngname=name1.value)
+        multiple_gui(files.value, loc=loc.value, savefig=True, pngname=name1.value)
     
     def csvsave(button):
-        multiple_gui(files.value,loc=loc.value,savedata=True,csvname=name1.value)
+        multiple_gui(files.value, loc=loc.value, savedata=True, csvname=name1.value)
     
-    options=[]
-    chooses=[]
-    title1=widgets.Label('File Settings:',style=dict(font_weight='bold'))
-    loc=widgets.Text(description='Location:',value='./')
+    options = []
+    chooses = []
+    title1 = widgets.Label('File Settings:', style = dict(font_weight = 'bold'))
+    loc = widgets.Text(description = 'Location:', value='./')
     for path in os.listdir(loc.value):
         if os.path.isfile(os.path.join(loc.value, path)):
-            a=re.search('.xyz', path)
+            a = re.search('.xyz', path)
             if a:
-                b=re.search('_', path)
+                b = re.search('_', path)
                 if b:
-                    c=re.search('.', path[:-4])
+                    c = re.search('.', path[:-4])
                     if c:
-                        fragment=re.split('_',path)
+                        fragment = re.split('_', path)
                         if fragment[0] not in options:
                             options.append(fragment[0])
                         if fragment[1][:-4] not in chooses:
                             chooses.append(fragment[1][:-4])
     options.sort()
-    files=widgets.SelectMultiple(options=options,description='Files Series:')
-    #ym=widgets.Button(description="Young's Modulus",layout=widgets.Layout(width='100%'))
-    resultshow=widgets.Button(description='Show Chart and table',layout=widgets.Layout(width='100%'),\
-                          style=dict(font_weight='bold',text_decoration='underline'))
-    save1=widgets.Button(description='Save',layout=widgets.Layout(width='100%'))
-    save2=widgets.Button(description='Save',layout=widgets.Layout(width='100%'))
-    name1=widgets.Text(value='Result',layout=widgets.Layout(width='60%'))
-    name2=widgets.Text(value='Result',layout=widgets.Layout(width='60%'))
-    aim1=widgets.BoundedIntText(description='Atom 1:',value=0,min=0,layout=widgets.Layout(width='48%'))
-    aim2=widgets.BoundedIntText(description='Atom 2:',value=0,min=0,layout=widgets.Layout(width='48%'))
-    OK=widgets.Button(description='OK')
-    geoi=widgets.IntText(value=0)
+    files = widgets.SelectMultiple(options=options, description = 'Files Series:')
+    #ym = widgets.Button(description = "Young's Modulus",\
+    #                    layout = widgets.Layout(width='100%'))
+    resultshow = widgets.Button(description = 'Show Chart and table',\
+                                layout = widgets.Layout(width='100%'),\
+                                style = dict(font_weight = 'bold', text_decoration = 'underline'))
+    save1 = widgets.Button(description = 'Save',\
+                           layout = widgets.Layout(width='100%'))
+    save2 = widgets.Button(description = 'Save',\
+                           layout = widgets.Layout(width='100%'))
+    name1 = widgets.Text(value = 'Result', layout = widgets.Layout(width='60%'))
+    name2 = widgets.Text(value = 'Result', layout = widgets.Layout(width='60%'))
+    aim1 = widgets.BoundedIntText(description = 'Atom 1:', value=0, min=0,\
+                                  layout = widgets.Layout(width='48%'))
+    aim2 = widgets.BoundedIntText(description = 'Atom 2:', value=0, min=0,\
+                                  layout = widgets.Layout(width='48%'))
+    OK = widgets.Button(description = 'OK')
+    geoi = widgets.IntText(value = 0)
     
-    output=widgets.VBox([title1,loc,files,resultshow])
+    output = widgets.VBox([title1, loc, files, resultshow])
     
     resultshow.on_click(intro_result)
     save1.on_click(pngsave)
     save2.on_click(csvsave)
     
-    box_layout1 = widgets.Layout(display='flex', flew_flow='column', overflow='scroll hidden',\
-                align_items='stretch', border='solid', height='650px', width='26%')
-    box_layout2 = widgets.Layout(display='flex', flew_flow='column', overflow='scroll hidden',\
-                align_items='stretch', border='solid', height='650px', width='37%')
-    judgeoutput.layout=widgets.Layout(display='flex', flew_flow='column', overflow='scroll hidden',\
-                align_items='stretch',height='325px', width='100%')
-    
-    filejudgeout=widgets.interactive_output(filejudge, {'files': files, 'loc': loc})
-    geoout=widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2, 'geoi': geoi, 'files': files})
-    
-    output=widgets.VBox([title1,loc,files,resultshow])
-    output2.layout=box_layout2
-    output3.layout=box_layout2
-    frame1=widgets.VBox([output,judgeoutput])
-    frame1.layout=box_layout1
+    box_layout1 = widgets.Layout(display='flex', flew_flow='column',\
+                                 overflow='scroll hidden', align_items='stretch',\
+                                 border='solid', height='550px', width='26%')
+    box_layout2 = widgets.Layout(display='flex', flew_flow='column',\
+                                 overflow='scroll hidden', align_items='stretch',\
+                                 border='solid', height='550px', width='37%')
+    judgeoutput.layout = widgets.Layout(display='flex', flew_flow='column',\
+                                        overflow='scroll hidden', align_items='stretch',\
+                                        height='325px', width='100%')
+    
+    filejudgeout = widgets.interactive_output(filejudge,\
+                                              {'files': files, 'loc': loc})
+    geoout = widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2,\
+                                                  'geoi': geoi, 'files': files})
+    
+    output = widgets.VBox([title1, loc, files, resultshow])
+    output2.layout = box_layout2
+    output3.layout = box_layout2
+    frame1 = widgets.VBox([output, judgeoutput])
+    frame1.layout = box_layout1
     
     resultshow.on_click(intro_result)
     save1.on_click(pngsave)
     save2.on_click(csvsave)
     
-    display(widgets.HBox([frame1,output2,output3]))
+    display(widgets.HBox([frame1, output2, output3]))
```

### Comparing `MCPoly-0.5.1.3/MCPoly/sscurve/gui2.py` & `MCPoly-0.6b1/MCPoly/sscurve/gui.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,295 +1,319 @@
-import ipywidgets as widgets
 import os
 import re
+import warnings
+import sys
 import time as t
 import pandas as pd
 import seaborn as sns
+import ipywidgets as widgets
 import matplotlib.pyplot as plt
+from IPython.display import display
 from .YModulus import YModulus
 from .single import single
-import warnings
-import sys
 
 mydir = os.path.dirname( __file__ )
 viewdir = os.path.join(mydir, '..', 'orcaset')
 sys.path.append(viewdir)
 from view3dchoose import view3dchoose
 
 mydir = os.path.dirname( __file__ )
 viewdir = os.path.join(mydir, '..', 'orcaset')
 sys.path.append(viewdir)
-from XYZtoINP import XYZtoINP
+from XyzToInp import XyzToInp
 
 mydir = os.path.dirname( __file__ )
 statusdir = os.path.join(mydir, '..', 'status')
 sys.path.append(statusdir)
 from status import status
 
-def gui2():
+def gui():
     """
         The method to use GUI to assemble mechanical datas and get the multiple stress-strain curve on a chart in handy!
         You will know how to do as long as you get into the GUI platform.
 
         TIPS: 1. Make sure all your created .xyz files from orcaset.ssorca or orcaset.ssgui is on the direct folder, or the programme will get error.
               2. You'd better have relevant .inp or .out file on the direct folder to automatically set the site of external force. Though GUI has manual auxiliary, it will cost you much more time.
               3. The visualisation will also risk the flexibility of the task, to make you programme more flexible, please directly use the code.
     """
-    def multiple_gui(polymers,loc='./',savedata=False, savefig=False, pngname='', csvname=''):
+    def multiple_gui(polymers, loc='./', savedata=False,\
+                     savefig=False, pngname='', csvname=''):
         opath=os.getcwd()
         os.chdir(loc)
         try:
-            f=open('ot.txt','x')
+            f = open('ot.txt', 'x')
         except:
-            f=open('ot.txt','w')
+            f = open('ot.txt', 'w')
         
-        name=[]
-        i=0
+        name = []
+        i = 0
         
-        site=[]
+        site = []
         
         for polymer in polymers:
-            polymer=polymer+'_Result.txt'
+            polymer = polymer + '_Result.txt'
             try:
-                datum=pd.read_csv(polymer)
+                datum = pd.read_csv(polymer)
             except:
                 warnings.warn("'{0}' is not found.".format(polymer))
                 continue
-            datum=datum[:].sort_values(by=['Distance(A)'])
-            for num in datum['Force(nN)'][:-1]:
+            datum = datum[:].sort_values(by=['Strain Length(%)'])
+            for num in datum['Stress Force(nN)'][:-1]:
                 if num not in site:
                     site.append(num)
         site.sort()
-        f.write('Force(nN)\n')
+        f.write('Stress Force(nN)\n')
         for num in site:
             f.write('{0:.3f}\n'.format(num))
         f.close()
-        ot=pd.read_csv('ot.txt')
+        ot = pd.read_csv('ot.txt')
         for polymer in polymers:
-            polymer=polymer+'_Result.txt'
+            polymer = polymer + '_Result.txt'
             try:
-                datum=pd.read_csv(polymer)
+                datum = pd.read_csv(polymer)
             except:
-                warnings.warn('{0} is not the file aboue stress-strain curve.'.format(polymer))
                 continue
-            datum=datum[:].sort_values(by=['Distance(A)'])
-            ax=plt.plot(datum['Force(nN)'][:-1],datum['Distance(A)'][:-1],'*-')
-            datum=datum.rename(columns={'Distance(A)':'Distance(A)({0})'.format(polymer[:-11])})
-            ot=pd.merge_ordered(ot, datum[:-1], fill_method="ffill" , left_by="Force(nN)")
+            try:
+                datum = datum[:].sort_values(by=['Strain Length(%)'])
+            except:
+                continue
+            ax = plt.plot(datum['Strain Length(%)'][:-1],\
+                          datum['Stress Force(nN)'][:-1], '*-')
+            datum = datum.rename(
+                columns={'Strain Length(%)':'Strain Length ({0})'.format(polymer[:-11])})
+            ot = pd.merge_ordered(ot, datum[:-1], fill_method="ffill",\
+                                  left_by="Stress Force(nN)")
             name.append(polymer[:-11])
-            i=i+1
+            i = i + 1
     
-        ot=ot.set_index('Force(nN)')
-        if savedata==True or savefig==True:
-            if savedata==True:
+        ot = ot.set_index('Stress Force(nN)')
+        if savedata == True or savefig == True:
+            if savedata == True:
                 ot.to_csv('{0}.csv'.format(csvname))
         else:
             output3.clear_output()
             with output3:
                 display(ot)
-                display(widgets.HBox([widgets.Label('CSV File Name:'),name2]))
+                display(widgets.HBox([widgets.Label('CSV File Name:'), name2]))
                 display(save2)
         
-        plt.xlabel('Force(nN)')
-        plt.ylabel('Distance(A)')
-        plt.legend(name,bbox_to_anchor=[1.1,0.9])
-        _ = plt.title('Distance Relationship')
-        if savedata==True or savefig==True:
-            if savefig==True:
-                plt.savefig('{0}.png'.format(pngname),bbox_inches='tight')
+        plt.xlabel('Strain Length(%)')
+        plt.ylabel('Stress Force(nN)')
+        plt.legend(name, bbox_to_anchor=[1.1, 0.9])
+        _ = plt.title('Stress-Strain Curve')
+        if savedata == True or savefig == True:
+            if savefig == True:
+                plt.savefig('{0}.png'.format(pngname), bbox_inches='tight')
         else:
             with output2:
                 plt.show()
-                display(widgets.HBox([widgets.Label('PNG File Name:'),name1]))
+                display(widgets.HBox([widgets.Label('PNG File Name:'), name1]))
                 display(save1)
     
         os.system('rm ot.txt')
         os.chdir(opath)
     
-    print('TIPS: Multiple values can be selected with Shift and/or Ctrl (or Command) pressed and mouse clicks or arrow keys.')
+    print('TIPS: Multiple values can be selected with\
+        Shift and/or Ctrl (or Command) pressed and mouse clicks or arrow keys.')
     
-    output2=widgets.Output()
-    output3=widgets.Output()
-    judgeoutput=widgets.Output()
+    output2 = widgets.Output()
+    output3 = widgets.Output()
+    judgeoutput = widgets.Output()
     
-    def geoshow(aim1,aim2,geoi,files):
+    def geoshow(aim1, aim2, geoi, files):
         output2.clear_output()
         with output2:
             try:
                 print("'{0}.xyz' Geometry Structure:".format(files[geoi]))
             except:
                 return None
-            aim=[aim1,aim2]
-            print('Atom1: {0}      Atom2: {1}'.format(aim1,aim2))
+            aim = [aim1, aim2]
+            print('Atom1: {0}      Atom2: {1}'.format(aim1, aim2))
             try:
-                view3dchoose(files[geoi]+'_0.000',loc.value,choose=aim,width=450,height=400)
+                view3dchoose(files[geoi]+'_0.000', loc.value,\
+                             choose=aim, width=450, height=400)
             except:
-                view3dchoose(files[geoi]+'_0',loc.value,choose=aim,width=450,height=400)
+                view3dchoose(files[geoi]+'_0', loc.value, choose=aim, width=450, height=400)
     
-    def filejudge(files,loc):
+    def filejudge(files, loc):
         judgeoutput.clear_output()
         output2.clear_output()
         output3.clear_output()
-        opath=os.getcwd()
+        opath = os.getcwd()
         os.chdir(loc)
-        #geoi=widgets.IntText(value=0)
-        t0=0
+        #geoi = widgets.IntText(value=0)
+        t0 = 0
         try:
-            geoi.value=0
+            geoi.value = 0
             for file in files:
-                t0=0
+                t0 = 0
                 for path in os.listdir(loc):
                     if os.path.isfile(os.path.join(loc, path)):
-                        a=re.match('{0}_Result.txt'.format(file), path)
+                        a = re.match('{0}_Result.txt'.format(file), path)
                         if a:
                             output2.clear_output()
-                            geoi.value=geoi.value+1
-                            t0=1
+                            geoi.value = geoi.value + 1
+                            t0 = 1
                             break
-                if t0==0:
+                if t0 == 0:
                     output2.clear_output()
-                    single(file,loc=loc).autocurve2(savefig=False)
-                    geoi.value=geoi.value+1
-                #single(file,loc=loc).autocurve(savefig=False)
-                #geoi.value=geoi.value+1
+                    single(file, loc=loc).autocurve(savefig=False)
+                    geoi.value = geoi.value + 1
+                #single(file, loc=loc).autocurve(savefig=False)
+                #geoi.value = geoi.value + 1
         except:
-            xtitle=widgets.Label('Extra Information about {0}:'.format(files[geoi.value]),style=dict(font_weight='bold'))
-            #aim1=widgets.BoundedIntText(description='Atom 1:',value=0,min=0,layout=widgets.Layout(width='48%'))
-            #aim2=widgets.BoundedIntText(description='Atom 2:',value=0,min=0,layout=widgets.Layout(width='48%'))
-            aim1.value=0
-            aim2.value=0
-            OK=widgets.Button(description='OK')
+            xtitle = widgets.Label('Extra Information about {0}:'.format(
+                files[geoi.value]), style=dict(font_weight='bold'))
+            #aim1 = widgets.BoundedIntText(description='Atom 1:', value=0, min=0, layout=widgets.Layout(width='48%'))
+            #aim2 = widgets.BoundedIntText(description='Atom 2:', value=0, min=0, layout=widgets.Layout(width='48%'))
+            aim1.value = 0
+            aim2.value = 0
+            OK = widgets.Button(description='OK')
             with judgeoutput:
-                display(widgets.VBox([xtitle,widgets.HBox([aim1,aim2]),OK]))
+                display(widgets.VBox([xtitle, widgets.HBox([aim1, aim2]), OK]))
             with output2:
                 #print("'{0}' Geometry Structure:".format(file))
-                #geoout=widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2, 'geoi': geoi})
+                #geoout = widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2, 'geoi': geoi})
                 OK.on_click(OKss)
         os.chdir(opath)
     
     def OKss(button):
-        opath=os.getcwd()
+        opath = os.getcwd()
         os.chdir(loc.value)
         #with output3:
-        #    print(geoi.value,aim1.value,aim2.value)
-        single(files.value[geoi.value],loc=loc.value).curve(aim1.value,aim2.value,savefig=False)
+        #    print(geoi.value, aim1.value, aim2.value)
+        single(files.value[geoi.value], loc=loc.value).curve(
+            aim1.value, aim2.value, savefig=False)
         judgeoutput.clear_output()
         output2.clear_output()
-        geoi.value=geoi.value+1
+        geoi.value = geoi.value + 1
         try:
-            if geoi.value>=len(files.value):
+            if geoi.value >= len(files.value):
                 return None
-            for i in range(geoi.value,len(files.value)):
+            for i in range(geoi.value, len(files.value)):
                 for path in os.listdir(loc.value):
                     if os.path.isfile(os.path.join(loc.value, path)):
-                        a=re.match(files.value[geoi.value]+'_Result.rxt', path)
+                        a = re.match(files.value[geoi.value]+'_Result.rxt', path)
                         if a:
-                            geoi.value=geoi.value+1
+                            geoi.value = geoi.value + 1
                             return None
-                single(files.value[i],loc=loc.value).autocurve2(savefig=False)
-                geoi.value=geoi.value+1
+                single(files.value[i], loc=loc.value).autocurve(savefig=False)
+                geoi.value = geoi.value + 1
         except:
-            xtitle=widgets.Label('Extra Information about {0}:'.format(files.value[geoi.value]),style=dict(font_weight='bold'))
-            #aim1=widgets.BoundedIntText(description='Atom 1:',value=0,min=0,layout=widgets.Layout(width='48%'))
-            #aim2=widgets.BoundedIntText(description='Atom 2:',value=0,min=0,layout=widgets.Layout(width='48%'))
-            OK=widgets.Button(description='OK')
+            xtitle = widgets.Label(
+                'Extra Information about {0}:'.format(files.value[geoi.value]),\
+                style=dict(font_weight='bold'))
+            #aim1 = widgets.BoundedIntText(description='Atom 1:',\
+            #                              value=0, min=0, layout=widgets.Layout(width='48%'))
+            #aim2 = widgets.BoundedIntText(description='Atom 2:',\
+            #                              value=0, min=0, layout=widgets.Layout(width='48%'))
+            OK = widgets.Button(description='OK')
             with judgeoutput:
-                display(widgets.VBox([xtitle,widgets.HBox([aim1,aim2]),OK]))
+                display(widgets.VBox([xtitle, widgets.HBox([aim1, aim2]), OK]))
             with output2:
                 #print("'{0}.xyz' Geometry Structure:".format(files.value[geoi.value]))
-                #geoout=widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2, 'geoi': geoi})
+                #geoout = widgets.interactive_output(geoshow,\
+                #                                    {'aim1': aim1, 'aim2': aim2, 'geoi': geoi})
                 #display(geoout)
                 OK.on_click(OKss)
         os.chdir(opath)
     
     def intro_result(button):
         for file in files.value:
-            t0=0
+            t0 = 0
             try:
-                t0=0
+                t0 = 0
                 for path in os.listdir(loc.value):
                     if os.path.isfile(os.path.join(loc.value, path)):
-                        a=re.match(file+'_Result.rxt', path)
+                        a = re.match(file+'_Result.rxt', path)
                         if a:
-                            t0=1
+                            t0 = 1
                             break
-                if t0==0:
-                    single(file,loc=loc.value).autocurve2(savefig=False)
+                if t0 == 0:
+                    single(file, loc=loc.value).autocurve(savefig=False)
             except:
                 pass
-    #            xtitle=widgets.Label('Extra Information about {0}:'.format(file),style=dict(font_weight='bold'))
-    #            aim1=widgets.BoundedIntText(description='Atom 1:',value=0,min=0,layout=widgets.Layout(width='48%'))
-    #            aim2=widgets.BoundedIntText(description='Atom 2:',value=0,min=0,layout=widgets.Layout(width='48%'))
-    #            OK=widgets.Button(description='OK')
+    #            xtitle = widgets.Label('Extra Information about {0}:'.format(file), style=dict(font_weight='bold'))
+    #            aim1 = widgets.BoundedIntText(description='Atom 1:', value=0, min=0, layout=widgets.Layout(width='48%'))
+    #            aim2 = widgets.BoundedIntText(description='Atom 2:', value=0, min=0, layout=widgets.Layout(width='48%'))
+    #            OK = widgets.Button(description='OK')
     #            with output:
-    #                display(widgets.VBox[xtitle,widgets.HBox([aim1,aim2]),OK])
-    #            geoout=widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2})
+    #                display(widgets.VBox[xtitle, widgets.HBox([aim1, aim2]), OK])
+    #            geoout = widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2})
     #            with outout2:
     #                display(geoout)
     #            OK.on_click(OKss)
     #            t.sleep(15)
-        multiple_gui(files.value,loc=loc.value)
+        multiple_gui(files.value, loc=loc.value)
         
     def pngsave(button):
-        multiple_gui(files.value,loc=loc.value,savefig=True,pngname=name1.value)
+        multiple_gui(files.value, loc=loc.value, savefig=True, pngname=name1.value)
     
     def csvsave(button):
-        multiple_gui(files.value,loc=loc.value,savedata=True,csvname=name1.value)
+        multiple_gui(files.value, loc=loc.value, savedata=True, csvname=name1.value)
     
-    options=[]
-    chooses=[]
-    title1=widgets.Label('File Settings:',style=dict(font_weight='bold'))
-    loc=widgets.Text(description='Location:',value='./')
+    options = []
+    chooses = []
+    title1 = widgets.Label('File Settings:', style=dict(font_weight='bold'))
+    loc = widgets.Text(description='Location:', value='./')
     for path in os.listdir(loc.value):
         if os.path.isfile(os.path.join(loc.value, path)):
-            a=re.search('.xyz', path)
+            a = re.search('.xyz', path)
             if a:
-                b=re.search('_', path)
+                b = re.search('_', path)
                 if b:
-                    c=re.search('.', path[:-4])
+                    c = re.search('.', path[:-4])
                     if c:
-                        fragment=re.split('_',path)
+                        fragment = re.split('_', path)
                         if fragment[0] not in options:
                             options.append(fragment[0])
                         if fragment[1][:-4] not in chooses:
                             chooses.append(fragment[1][:-4])
     options.sort()
-    files=widgets.SelectMultiple(options=options,description='Files Series:')
-    #ym=widgets.Button(description="Young's Modulus",layout=widgets.Layout(width='100%'))
-    resultshow=widgets.Button(description='Show Chart and table',layout=widgets.Layout(width='100%'),\
-                          style=dict(font_weight='bold',text_decoration='underline'))
-    save1=widgets.Button(description='Save',layout=widgets.Layout(width='100%'))
-    save2=widgets.Button(description='Save',layout=widgets.Layout(width='100%'))
-    name1=widgets.Text(value='Result',layout=widgets.Layout(width='60%'))
-    name2=widgets.Text(value='Result',layout=widgets.Layout(width='60%'))
-    aim1=widgets.BoundedIntText(description='Atom 1:',value=0,min=0,layout=widgets.Layout(width='48%'))
-    aim2=widgets.BoundedIntText(description='Atom 2:',value=0,min=0,layout=widgets.Layout(width='48%'))
-    OK=widgets.Button(description='OK')
-    geoi=widgets.IntText(value=0)
+    files = widgets.SelectMultiple(options=options, description='Files Series:')
+    #ym = widgets.Button(description="Young's Modulus", layout=widgets.Layout(width='100%'))
+    resultshow = widgets.Button(description='Show Chart and table',\
+                                layout=widgets.Layout(width='100%'),\
+                                style=dict(font_weight='bold', text_decoration='underline'))
+    save1 = widgets.Button(description='Save', layout=widgets.Layout(width='100%'))
+    save2 = widgets.Button(description='Save', layout=widgets.Layout(width='100%'))
+    name1 = widgets.Text(value='Result', layout=widgets.Layout(width='60%'))
+    name2 = widgets.Text(value='Result', layout=widgets.Layout(width='60%'))
+    aim1 = widgets.BoundedIntText(description='Atom 1:', value=0,\
+                                  min=0, layout=widgets.Layout(width='48%'))
+    aim2 = widgets.BoundedIntText(description='Atom 2:', value=0,\
+                                  min=0, layout=widgets.Layout(width='48%'))
+    OK = widgets.Button(description='OK')
+    geoi = widgets.IntText(value=0)
     
-    output=widgets.VBox([title1,loc,files,resultshow])
+    output = widgets.VBox([title1, loc, files, resultshow])
     
     resultshow.on_click(intro_result)
     save1.on_click(pngsave)
     save2.on_click(csvsave)
     
-    box_layout1 = widgets.Layout(display='flex', flew_flow='column', overflow='scroll hidden',\
-                align_items='stretch', border='solid', height='550px', width='26%')
-    box_layout2 = widgets.Layout(display='flex', flew_flow='column', overflow='scroll hidden',\
-                align_items='stretch', border='solid', height='550px', width='37%')
-    judgeoutput.layout=widgets.Layout(display='flex', flew_flow='column', overflow='scroll hidden',\
-                align_items='stretch',height='325px', width='100%')
-    
-    filejudgeout=widgets.interactive_output(filejudge, {'files': files, 'loc': loc})
-    geoout=widgets.interactive_output(geoshow, {'aim1': aim1, 'aim2': aim2, 'geoi': geoi, 'files': files})
-    
-    output=widgets.VBox([title1,loc,files,resultshow])
-    output2.layout=box_layout2
-    output3.layout=box_layout2
-    frame1=widgets.VBox([output,judgeoutput])
+    box_layout1 = widgets.Layout(display='flex', flew_flow='column',\
+                                 overflow='scroll hidden', align_items='stretch',\
+                                 border='solid', height='650px', width='26%')
+    box_layout2 = widgets.Layout(display='flex', flew_flow='column',\
+                                 overflow='scroll hidden', align_items='stretch',\
+                                 border='solid', height='650px', width='37%')
+    judgeoutput.layout = widgets.Layout(display='flex', flew_flow='column',\
+                                        overflow='scroll hidden', align_items='stretch',\
+                                        height='325px', width='100%')
+    
+    filejudgeout = widgets.interactive_output(filejudge, {'files': files,\
+                                                          'loc': loc})
+    geoout = widgets.interactive_output(geoshow, {'aim1': aim1,\
+                                                  'aim2': aim2, 'geoi': geoi, 'files': files})
+    
+    output = widgets.VBox([title1, loc, files, resultshow])
+    output2.layout = box_layout2
+    output3.layout = box_layout2
+    frame1 = widgets.VBox([output, judgeoutput])
     frame1.layout=box_layout1
     
     resultshow.on_click(intro_result)
     save1.on_click(pngsave)
     save2.on_click(csvsave)
     
-    display(widgets.HBox([frame1,output2,output3]))
+    display(widgets.HBox([frame1, output2, output3]))
```

### Comparing `MCPoly-0.5.1.3/MCPoly/sscurve/multiple.py` & `MCPoly-0.6b1/MCPoly/sscurve/multiple.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,20 +1,21 @@
 import os
 import re
+import warnings
 import pandas as pd
 import seaborn as sns
 import matplotlib.pyplot as plt
 from .YModulus import YModulus
-import warnings
 
-def multiple(allname='Result',polymers=[],loc='./',savefig=True,savedata=True,needYM=True,xx=False):
+def multiple(allname='Result', polymers=[], loc='./', savefig=True,\
+             savedata=True, needYM=True, xx=False):
     """
     The method to create a Stress-Strain Curve chart and .csv relevant data file of all polymers you choose.
     multiple(allname='Results', polymers=[file1, file2, file3, ...], loc='./', savefig=True, savedata=True, needYM=True))
-    allname: The name of your saved stress-strain curve chart and data file.
+    allname: The name of your saved Stress-Strain curve chart and data file.
     polymers: Your selected polymer names on your file. The default is all polymers which has _Results.txt file in the location. 
     loc: File Location. The default is your current location.
     savefig, savedata: To show if you want to save the chart and .csv curve. The default is True.
     neddYM: To calculate Young's modulus of each polymers and display it in the data file.
     You can get the further information by .curve and .autocurve.
     Example:
         Input:
@@ -44,96 +45,100 @@
             8.5                              NaN                  NaN   
             9.0                              NaN                  NaN   
             9.5                              NaN                  NaN   
             10.0                             NaN                  NaN   
             NaN                        29.516401             23.478160  NaN-> Young's Modulus
     TIPS: This function only depends on _Results.txt file, not .mol, .inp, .out, .xyz files.
     """
-    opath=os.getcwd()
-    if polymers==[]:
+    opath = os.getcwd()
+    if polymers == []:
         for path in os.listdir(loc):
             if os.path.isfile(os.path.join(loc, path)):
-                a=re.search('_Result.txt', path)
+                a = re.search('_Result.txt', path)
                 if a:
                     polymers.append(path[:-11])            
     print(polymers)
     
     os.chdir(loc)
     try:
-        f=open('ot.txt','x')
+        f = open('ot.txt','x')
     except:
-        f=open('ot.txt','w')
+        f = open('ot.txt','w')
     
-    ym=[None]
-    name=[]
-    i=0
+    ym = [None]
+    name = []
+    i = 0
     
-    site=[]
+    site = []
 
     for polymer in polymers:
-        polymer=polymer+'_Result.txt'
+        polymer = polymer + '_Result.txt'
         try:
-            datum=pd.read_csv(polymer)
+            datum = pd.read_csv(polymer)
         except:
             warnings.warn("'{0}' is not found.".format(polymer))
             continue
         try:
-            datum=datum[:].sort_values(by=['Strain Length(%)'])
+            datum = datum[:].sort_values(by=['Strain Length(%)'])
         except:
-            warnings.warn('{0} is not the file aboue stress-strain curve.'.format(polymer))
+            warnings.warn('{0} is not the file about'.format(polymer)
+                          + 'stress-strain curve.')
             continue
         for num in datum['Stress Force(nN)'][:-1]:
             if num not in site:
                 site.append(num)
     site.sort()
     f.write('Stress Force(nN)\n')
     for num in site:
         f.write('{0:.3f}\n'.format(num))
     f.close()
     
-    ot=pd.read_csv('ot.txt')
+    ot = pd.read_csv('ot.txt')
     for polymer in polymers:
-        polymer=polymer+'_Result.txt'
+        polymer = polymer + '_Result.txt'
         try:
-            datum=pd.read_csv(polymer)
+            datum = pd.read_csv(polymer)
         except:
             warnings.warn("'{0}' is not found.".format(polymer))
             continue
-        datum=datum[:].sort_values(by=['Strain Length(%)'])
-        if xx==False:
-            ax=plt.plot(datum['Strain Length(%)'][:-1],datum['Stress Force(nN)'][:-1],'*-')
-        if needYM==True:
+        datum = datum[:].sort_values(by=['Strain Length(%)'])
+        if xx == False:
+            ax = plt.plot(datum['Strain Length(%)'][:-1],\
+                          datum['Stress Force(nN)'][:-1],'*-')
+        if needYM == True:
             ym.append(YModulus(polymer))
-        datum=datum.rename(columns={'Strain Length(%)':'Strain Length ({0})'.format(polymer[:-11])})
-        ot=pd.merge_ordered(ot, datum[:-1], fill_method="ffill" , left_by="Stress Force(nN)")
+        datum = datum.rename(columns={
+            'Strain Length(%)':'Strain Length ({0})'.format(polymer[:-11])})
+        ot = pd.merge_ordered(ot, datum[:-1], fill_method="ffill",\
+                              left_by="Stress Force(nN)")
         name.append(polymer[:-11])
-        i=i+1
+        i = i + 1
     
-    if needYM==True:
-        al=pd.DataFrame(data=ym, index=ot.columns, columns=["Young's Modulus"])
-        al=al.T
-    #print(al)
-        ot=pd.concat([ot,al])
-    ot=ot.set_index('Stress Force(nN)')
+    if needYM == True:
+        al = pd.DataFrame(data=ym, index=ot.columns, columns=["Young's Modulus"])
+        al = al.T
+        #print(al)
+        ot = pd.concat([ot,al])
+    ot = ot.set_index('Stress Force(nN)')
     display(ot)
-    if savedata==True:
+    if savedata == True:
         ot.to_csv('{0}.csv'.format(allname))
     
-    if xx==False:
+    if xx == False:
         #ax = sns.scatterplot(data=ot, alpha=0.8)
-        #ax.set_ylabels='Strain Length(%)'
+        #ax.set_ylabels = 'Strain Length(%)'
         #_ = plt.title('Stress-Strain Curve')
         #bx = sns.relplot(data=ot, kind="line", alpha=0.5)
-        #bx.set_ylabels='Strain Length(%)'
+        #bx.set_ylabels = 'Strain Length(%)'
         #ax.legend(bbox_to_anchor=[1.1,0.9])
         plt.xlabel('Strain Length(%)')
         plt.ylabel('Stress Force(nN)')
         plt.legend(name,bbox_to_anchor=[1.1,0.9])
         _ = plt.title('Stress-Strain Curve')
         
-    if savefig==True:
-        plt.savefig('{0}.png'.format(allname),bbox_inches='tight')
-    if xx==False:
+    if savefig == True:
+        plt.savefig('{0}.png'.format(allname), bbox_inches='tight')
+    if xx == False:
         plt.show()
     
     os.system('rm ot.txt')
     os.chdir(opath)
```

### Comparing `MCPoly-0.5.1.3/MCPoly/sscurve/multiple2.py` & `MCPoly-0.6b1/MCPoly/sscurve/multiple2.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,33 +1,34 @@
 import os
 import re
 import pandas as pd
 import seaborn as sns
+import warnings
 import matplotlib.pyplot as plt
 from .YModulus import YModulus
-import warnings
 
-def multiple2(allname='Result',polymers=[],loc='./',savefig=True,savedata=True):
+def multiple2(allname='Result', polymers=[], loc='./', savefig=True,\
+              savedata=True, xx=False):
     """
-    The method to create a Stress-Strain Curve chart and .csv relevant data file of all polymers you choose.
-    multiple(allname='Results', polymers=[file1, file2, file3, ...], loc='./', savefig=True, savedata=True, needYM=True))
-    allname: The name of your saved stress-strain curve chart and data file.
+    The method to create a Distance-Force chart and .csv relevant data file of all polymers you choose.
+    multiple2(allname='Results', polymers=[file1, file2, file3, ...], loc='./', savefig=True, savedata=True, needYM=True))
+    allname: The name of your saved Distance-Force curve chart and data file.
     polymers: Your selected polymer names on your file. The default is all polymers which has _Results.txt file in the location. 
     loc: File Location. The default is your current location.
     savefig, savedata: To show if you want to save the chart and .csv curve. The default is True.
     neddYM: To calculate Young's modulus of each polymers and display it in the data file.
     You can get the further information by .curve and .autocurve.
     Example:
         Input:
             from MCPoly.sscurve import multiple
-            multiple2(polymers=['P1','P2'])
+            multiple2(polymers=['P1', 'P2'])
         Output:
-            ['P1','P2']
-                               Strain Length (P1)  Strain Length (P2)  \
-            Stress Force(nN)                                            
+            ['P1', 'P2']
+                               Distance (P1)         Distance (P2)  \
+            Force(nN)                                            
             0.0                         1.000000             1.000000   
             0.5                         1.012022                  NaN   
             1.0                         1.024666             1.028089   
             1.5                              NaN                  NaN   
             2.0                         1.053014             1.058092   
             2.5                              NaN                  NaN   
             3.0                         1.086888             1.093080   
@@ -44,77 +45,86 @@
             8.5                              NaN                  NaN   
             9.0                              NaN                  NaN   
             9.5                              NaN                  NaN   
             10.0                             NaN                  NaN   
             NaN                        29.516401             23.478160  NaN-> Young's Modulus
     TIPS: This function only depends on _Results.txt file, not .mol, .inp, .out, .xyz files.
     """
-    opath=os.getcwd()
-    if polymers==[]:
+    opath = os.getcwd()
+    if polymers == []:
         for path in os.listdir(loc):
             if os.path.isfile(os.path.join(loc, path)):
-                a=re.search('_Result.txt', path)
+                a = re.search('_Result.txt', path)
                 if a:
                     polymers.append(path[:-11])            
     print(polymers)
     
+    os.chdir(loc)
     try:
-        f=open('ot.txt','x')
+        f = open('ot.txt', 'x')
     except:
-        f=open('ot.txt','w')
+        f = open('ot.txt', 'w')
     
-    name=[]
-    i=0
+    name = []
+    i = 0
     
-    site=[]
+    site = []
 
     for polymer in polymers:
-        polymer=polymer+'_Result.txt'
+        polymer = polymer + '_Result.txt'
         try:
-            datum=pd.read_csv(polymer)
+            datum = pd.read_csv(polymer)
         except:
             warnings.warn("'{0}' is not found.".format(polymer))
             continue
-        datum=datum[:].sort_values(by=['Force(nN)'])
+        datum = datum[:].sort_values(by=['Force(nN)'])
         for num in datum['Force(nN)'][:-1]:
             if num not in site:
                 site.append(num)
     site.sort()
     f.write('Force(nN)\n')
     for num in site:
         f.write('{0:.3f}\n'.format(num))
     f.close()
-    ot=pd.read_csv('ot.txt')
+    ot = pd.read_csv('ot.txt')
     for polymer in polymers:
-        polymer=polymer+'_Result.txt'
+        polymer = polymer + '_Result.txt'
         try:
-            datum=pd.read_csv(polymer)
+            datum = pd.read_csv(polymer)
         except:
             continue
-        datum=datum[:].sort_values(by=['Distance(A)'])
-        ax=plt.plot(datum['Force(nN)'][:-1],datum['Distance(A)'][:-1],'*-')
-        datum=datum.rename(columns={'Distance(A)':'Distance(A)({0})'.format(polymer[:-11])})
-        ot=pd.merge_ordered(ot, datum[:-1], fill_method="ffill" , left_by="Force(nN)")
+        datum = datum[:].sort_values(by=['Distance()'])
+        if xx == False:
+            ax = plt.plot(datum['Force(nN)'][:-1],\
+                          datum['Distance()'][:-1], '*-')
+        datum = datum.rename(
+            columns={'Distance()':'Distance()({0})'.format(
+                polymer[:-11])})
+        ot = pd.merge_ordered(ot, datum[:-1], fill_method="ffill",\
+                              left_by="Force(nN)")
         name.append(polymer[:-11])
-        i=i+1
+        i = i + 1
     
-    ot=ot.set_index('Force(nN)')
+    ot = ot.set_index('Force(nN)')
     display(ot)
-    if savedata==True:
+    if savedata == True:
         ot.to_csv('{0}.csv'.format(allname))
     
-    #ax = sns.scatterplot(data=ot, alpha=0.8)
-    #ax.set_ylabels='Strain Length(%)'
-    #_ = plt.title('Stress-Strain Curve')
-    #bx = sns.relplot(data=ot, kind="line", alpha=0.5)
-    #bx.set_ylabels='Strain Length(%)'
-    #ax.legend(bbox_to_anchor=[1.1,0.9])
-    plt.xlabel('Force(nN)')
-    plt.ylabel('Distance(A)')
-    plt.legend(name,bbox_to_anchor=[1.1,0.9])
-    
-    _ = plt.title('Distance Relationship')
-    if savefig==True:
-        plt.savefig('{0}.png'.format(allname),bbox_inches='tight')
+    if xx == False:
+        #ax = sns.scatterplot(data=ot, alpha=0.8)
+        #ax.set_ylabels='Distance()'
+        #_ = plt.title('Distance-Force Relationship')
+        #bx = sns.relplot(data=ot, kind="line", alpha=0.5)
+        #bx.set_ylabels='Distance()'
+        #ax.legend(bbox_to_anchor=[1.1, 0.9])
+        plt.xlabel('Force(nN)')
+        plt.ylabel('Distance()')
+        plt.legend(name, bbox_to_anchor=[1.1, 0.9])
+        _ = plt.title('Distance-Force Relationship')
+    
+    if savefig == True:
+        plt.savefig('{0}.png'.format(allname), bbox_inches='tight')
+    if xx == False:
+        plt.show()
     
     os.system('rm ot.txt')
     os.chdir(opath)
```

#### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

### Comparing `MCPoly-0.5.1.3/MCPoly/sscurve/single.py` & `MCPoly-0.6b1/MCPoly/sscurve/single.py`

 * *Files 15% similar despite different names*

```diff
@@ -1,173 +1,180 @@
-from ase.io import read
 import os
 import re
 import pandas as pd
 import seaborn as sns
 import matplotlib.pyplot as plt
+from ase.io import read
 
-def curvef(loc,polymer,start,end,savefig,savedata):
-    opath=os.getcwd()
+def curvef(loc, polymer, start, end, savefig, savedata, saveloc='./', xx=False):
     try:
-        f=open('{0}_Result.txt'.format(polymer),'x')
+        f = open(saveloc+'{0}_Result.txt'.format(polymer), 'x')
     except:
-        f=open('{0}_Result.txt'.format(polymer),'w')
+        f = open(saveloc+'{0}_Result.txt'.format(polymer), 'w')
     
     f.write('Strain Length(%),Stress Force(nN)\n')
 
     res = []
     for path in os.listdir(loc):
         if os.path.isfile(os.path.join(loc, path)):
-            a=re.match(polymer+'_', path)
+            a = re.match(polymer+'_', path)
             if a:
-                b=re.search('.xyz',path)
+                b = re.search('.xyz', path)
                 if b:
-                    c=re.search('trj',path)
+                    c = re.search('trj', path)
                     if c:
                         continue
                     res.append(path)
     print(res)
     res.sort()
     
     try:
-        atoms=read(loc+'{0}_0.000.xyz'.format(polymer))
+        atoms = read(loc+'{0}_0.000.xyz'.format(polymer))
     except:
-        atoms=read(loc+'{0}_0.xyz'.format(polymer))
-    x=atoms.get_distance(start,end)
+        atoms = read(loc+'{0}_0.xyz'.format(polymer))
+    x = atoms.get_distance(start, end)
     
     for data in res:
-        atoms=read(loc+data)
-        strain=re.search(r'_[0-9]+\.*[0-9]*',data)
+        atoms = read(loc+data)
+        strain = re.search(r'_[0-9]+\.*[0-9]*', data)
         try:
-            f.write('{0:.5f},{1}\n'.format(atoms.get_distance(start,end)/x,strain.group(0)[1:]))
+            f.write('{0:.5f},{1}\n'.format(atoms.get_distance(start, end)/x,\
+                                            strain.group(0)[1:]))
         except:
             continue
-        y=atoms.get_distance(start,end)
+        y = atoms.get_distance(start, end)
     f.close()
 
-    datum=pd.read_csv('{0}_Result.txt'.format(polymer))
-    datum=datum[:].sort_values(by=['Strain Length(%)']) #Sort document
-    datum=datum[:-1]
+    datum = pd.read_csv(saveloc+'{0}_Result.txt'.format(polymer))
+    datum = datum[:].sort_values(by = ['Strain Length(%)']) #Sort document
+    datum = datum[:-1]
     print(datum)
-    a=sns.scatterplot(data=datum, x=datum['Strain Length(%)'],y=datum['Stress Force(nN)'],color='black',alpha=0.5)
-    a.plot(datum['Strain Length(%)'],datum['Stress Force(nN)'])
-    plt.xlabel('Strain Length(%)')
-    plt.ylabel('Stress Force(nN)')
-    _=plt.title('Strain-Stress Curve')
-    if savefig==True:
-        plt.savefig('{0}.png'.format(polymer),bbox_inches='tight')
-    plt.show()
-    if savedata==False:
-        os.system('rm {0}_Result.txt'.format(polymer))
-    os.chdir(opath)
+    if xx == False:
+        a = sns.scatterplot(data=datum, x=datum['Strain Length(%)'],\
+                            y=datum['Stress Force(nN)'], color='black', alpha=0.5)
+        a.plot(datum['Strain Length(%)'], datum['Stress Force(nN)'])
+        plt.xlabel('Strain Length(%)')
+        plt.ylabel('Stress Force(nN)')
+        _ = plt.title('Strain-Stress Curve')
+    if savefig == True:
+        plt.savefig(saveloc+'{0}.png'.format(polymer), bbox_inches = 'tight')
+    if xx == False:
+        plt.show()
+    if savedata == False:
+        os.system('rm {1}{0}_Result.txt'.format(polymer, saveloc))
 
-def curvef2(loc,polymer,start,end,savefig,savedata):
-    opath=os.getcwd()
+def curvef2(loc, polymer, start, end, savefig, savedata, saveloc='./', xx=False):
+    opath = os.getcwd()
     try:
-        f=open('{0}_Result.txt'.format(polymer),'x')
+        f = open(saveloc+'{0}_Result.txt'.format(polymer), 'x')
     except:
-        f=open('{0}_Result.txt'.format(polymer),'w')
+        f = open(saveloc+'{0}_Result.txt'.format(polymer), 'w')
     
-    f.write('Force(nN),Distance(A)\n')
+    f.write('Force(nN),Distance()\n')
 
     res = []
     for path in os.listdir(loc):
         if os.path.isfile(os.path.join(loc, path)):
-            a=re.match(polymer+'_', path)
+            a = re.match(polymer+'_', path)
             if a:
-                b=re.search('.xyz',path)
+                b = re.search('.xyz', path)
                 if b:
-                    c=re.search('trj',path)
+                    c = re.search('trj', path)
                     if c:
                         continue
                     res.append(path)
     print(res)
     res.sort()
     
     try:
-        atoms=read(loc+'{0}_0.000.xyz'.format(polymer))
+        atoms = read(loc+'{0}_0.000.xyz'.format(polymer))
     except:
-        atoms=read(loc+'{0}_0.xyz'.format(polymer))
-    x=atoms.get_distance(start,end)
+        atoms = read(loc+'{0}_0.xyz'.format(polymer))
+    x = atoms.get_distance(start, end)
     
     for data in res:
-        atoms=read(loc+data)
-        strain=re.search(r'_[0-9]+\.*[0-9]*',data)
+        atoms = read(loc+data)
+        strain = re.search(r'_[0-9]+\.*[0-9]*', data)
         try:
-            f.write('{0},{1:.5f}\n'.format(strain.group(0)[1:],atoms.get_distance(start,end)-x))
+            f.write('{0},{1:.5f}\n'.format(strain.group(0)[1:],\
+                                            atoms.get_distance(start, end)-x))
         except:
             continue
-        y=atoms.get_distance(start,end)
+        y = atoms.get_distance(start, end)
     f.close()
 
-    datum=pd.read_csv('{0}_Result.txt'.format(polymer))
-    datum=datum[:].sort_values(by=['Force(nN)']) #Sort document
-    datum=datum[:-1]
+    datum = pd.read_csv(saveloc+'{0}_Result.txt'.format(polymer))
+    datum = datum[:].sort_values(by=['Force(nN)']) #Sort document
+    datum = datum[:-1]
     print(datum)
-    a=sns.scatterplot(data=datum, x=datum['Force(nN)'], y=datum['Distance(A)'], color='black',alpha=0.5)
-    a.plot(datum['Force(nN)'],datum['Distance(A)'])
-    plt.xlabel('Force(nN)')
-    plt.ylabel('Distance(A)')
-    _=plt.title('Distance Relationship')
-    if savefig==True:
-        plt.savefig('{0}.png'.format(polymer),bbox_inches='tight')
-    plt.show()
-    if savedata==False:
-        os.system('rm {0}_Result.txt'.format(polymer))
-    os.chdir(opath)
+    if xx == False:
+        a = sns.scatterplot(data=datum, x=datum['Force(nN)'],\
+                            y=datum['Distance()'], color='black', alpha=0.5)
+        a.plot(datum['Force(nN)'], datum['Distance()'])
+        plt.xlabel('Force(nN)')
+        plt.ylabel('Distance()')
+        _ = plt.title('Distance-Force Relationship')
+    if savefig == True:
+        plt.savefig(saveloc+'{0}.png'.format(polymer), bbox_inches='tight')
+    if xx == False:
+        plt.show()
+    if savedata == False:
+        os.system('rm {1}{0}_Result.txt'.format(polymer, saveloc))
     
 class single:
     """
     The definition of polymer.
     single(polymer, loc='./')
     polymer: Your polymer name on your file.
     loc: File Location. The default is your current location.
     You can get the further information by .curve and .autocurve.
     """
     def __init__(self, polymer, loc='./'):
-        self.loc=loc
-        self.polymer=polymer
+        self.loc = loc
+        self.polymer = polymer
 
-    def curve(self,start,end,savefig=True,savedata=True):
+    def curve(self, start, end, savefig=True, savedata=True, saveloc='./', xx=False):
         """
     The method to create a single polymer chart of Stress-Strain Curve and .txt relevant data file of stress and strain.
-    curve(start, end, savefig=True, savedata=True)
+    curve(start, end, savefig=True, savedata=True, saveloc='./')
     start, end: the beginning and end side of the polymer, mostly two sides imposing external force.
     savefig, savedata: To show if you want to save the chart and .txt curve. The default is True.
+    saveloc: The location of your saved file. The default is your current location.
     The output of this file is a Stress-Strain Curve chart and relevant data.
     Example:
         Input:
             from MCPoly.sscurve import single
-                poly1=single('Polymer1')
-                poly1.curve(0,6)
+                poly1 = single('Polymer1')
+                poly1.curve(0, 6)
         Output:
             ['Polymer1_2.0.xyz', 'Polymer1_0.0.xyz', 'Polymer1_0.5.xyz', 'Polymer1_2.5.xyz', 
              'Polymer1_1.0.xyz', 'Polymer1_3.0.xyz', 'Polymer1_1.5.xyz'] -> All your files
                   Strain Length(%)  Stress Force(nN)
                 0           1.00000               0.0
                 1           1.06778               0.5
                 2           1.13094               1.0
                 3           1.19338               1.5
                 4           1.24726               2.0
                 5           1.31094               2.5
             <matplotlib chart>
     TIPS: Make sure all your .xyz file is in the current location, or the chart may have some mistakes.
         """
-        return curvef(self.loc,self.polymer,start,end,savefig,savedata)
+        return curvef(self.loc, self.polymer, start, end, savefig, savedata, saveloc, xx)
     
-    def autocurve(self,savefig=True,savedata=True):
+    def autocurve(self, savefig=True, savedata=True, saveloc='./', xx=False):
         """
     The method to create a single polymer chart of Stress-Strain Curve and .txt relevant data file of stress and strain the same as function curve. but it can be more handy if there are some .out or .inp files. 
-    autocurve(savefig=True, savedata=True)
+    autocurve(savefig=True, savedata=True, saveloc='./')
     savefig, savedata: To show if you want to save the chart and .txt curve. The default is True.
+    saveloc: The location of your saved file. The default is your current location.
     The output of this file is a Stress-Strain Curve chart and relevant data.
     Example:
         Input:
             from MCPoly.sscurve import single
-                poly1=single('Polymer1')
+                poly1 = single('Polymer1')
                 poly1.autocurve()
         Output:
             ['Polymer1_2.0.xyz', 'Polymer1_0.0.xyz', 'Polymer1_0.5.xyz', 'Polymer1_2.5.xyz', 
              'Polymer1_1.0.xyz', 'Polymer1_3.0.xyz', 'Polymer1_1.5.xyz']
                   Strain Length(%)  Stress Force(nN)
                 0           1.00000               0.0
                 1           1.06778               0.5
@@ -175,148 +182,151 @@
                 3           1.19338               1.5
                 4           1.24726               2.0
                 5           1.31094               2.5
             <matplotlib chart>
     TIPS: Make sure all your .xyz file is in the current location, or the chart may have some mistakes.
           Make sure there is at least one .out or .inp file of relevant polymer here, or it will show FileNotFoundError.
         """
-        t=0
+        t = 0
         for path in os.listdir(self.loc):
             if os.path.isfile(os.path.join(self.loc, path)):
-                a=re.match(self.polymer+'_', path)
+                a = re.match(self.polymer+'_', path)
                 if a:
-                    b=re.search('.inp',path)
+                    b = re.search('.inp', path)
                     if b:
-                        t=1
+                        t = 1
                         break
-                    c=re.search('.out',path)
+                    c = re.search('.out', path)
                     if c:
-                        t=2
+                        t = 2
                         break
-        if t==0:
-            raise FileNotFoundError('relevant .inp and .out file is not found. Try to find out the file and put it in this document.')
+        if t == 0:
+            raise FileNotFoundError('relevant .inp and .out file is not found.\
+                Try to find out the file and put it in this document.')
         else:
-            opath=os.getcwd()
+            opath = os.getcwd()
             os.chdir(self.loc)
-            f=open(path,'r')
-            i=0
-            start=-1
-            end=-1
-            if t==1:
+            f = open(path, 'r')
+            i = 0
+            start = -1
+            end = -1
+            if t == 1:
                 for line in f:
-                    if i==1:
-                        num=re.findall(r'[0-9]+',line)
-                        start=eval(num[0])
-                        end=eval(num[1])
+                    if i == 1:
+                        num = re.findall(r'[0-9]+', line)
+                        start = eval(num[0])
+                        end = eval(num[1])
                         break
-                    a=re.search('POTENTIALS',line)
+                    a = re.search('POTENTIALS', line)
                     if a:
-                        i=i+1
-            if t==2:
+                        i = i + 1
+            if t == 2:
                 for line in f:
-                    if i==1:
-                        num=re.findall(r'[0-9]+',line)
-                        start=eval(num[1])
-                        end=eval(num[2])
+                    if i == 1:
+                        num = re.findall(r'[0-9]+', line)
+                        start = eval(num[1])
+                        end = eval(num[2])
                         break
-                    a=re.search('> POTENTIALS',line)
+                    a = re.search('> POTENTIALS', line)
                     if a:
-                        i=i+1
+                        i = i + 1
             os.chdir(opath)
-        return curvef(self.loc,self.polymer,start,end,savefig,savedata)
+        return curvef(self.loc, self.polymer, start, end, savefig, savedata, saveloc, xx)
 
-    def curve2(self,start,end,savefig=True,savedata=True):
+    def curve2(self, start, end, savefig=True, savedata=True, saveloc='./', xx=False):
         """
-    The method to create a single polymer chart of Stress-Strain Curve and .txt relevant data file of stress and strain.
-    curve(start, end, savefig=True, savedata=True)
+    The method to create a single polymer chart of Distance-Force Curve and .txt relevant data file of stress and strain.
+    curve(start, end, savefig = True, savedata = True, saveloc='./')
     start, end: the beginning and end side of the polymer, mostly two sides imposing external force.
     savefig, savedata: To show if you want to save the chart and .txt curve. The default is True.
-    The output of this file is a Stress-Strain Curve chart and relevant data.
+    saveloc: The location of your saved file. The default is your current location.
+    The output of this file is a Distance-Force Curve chart and relevant data.
     Example:
         Input:
             from MCPoly.sscurve import single
-                poly1=single('Polymer1')
-                poly1.curve(0,6)
+                poly1 = single('Polymer1')
+                poly1.curve2(0, 6)
         Output:
             ['Polymer1_2.0.xyz', 'Polymer1_0.0.xyz', 'Polymer1_0.5.xyz', 'Polymer1_2.5.xyz', 
              'Polymer1_1.0.xyz', 'Polymer1_3.0.xyz', 'Polymer1_1.5.xyz'] -> All your files
-                  Strain Length(%)  Stress Force(nN)
+                  Distance()       Force(nN)
                 0           1.00000               0.0
                 1           1.06778               0.5
                 2           1.13094               1.0
                 3           1.19338               1.5
                 4           1.24726               2.0
                 5           1.31094               2.5
             <matplotlib chart>
     TIPS: Make sure all your .xyz file is in the current location, or the chart may have some mistakes.
         """
-        return curvef2(self.loc,self.polymer,start,end,savefig,savedata)
+        return curvef2(self.loc, self.polymer, start, end, savefig, savedata, saveloc, xx)
     
-    def autocurve2(self,savefig=True,savedata=True):
+    def autocurve2(self, savefig=True, savedata=True, saveloc='./', xx=False):
         """
-    The method to create a single polymer chart of Stress-Strain Curve and .txt relevant data file of stress and strain the same as function curve. but it can be more handy if there are some .out or .inp files. 
-    autocurve(savefig=True, savedata=True)
+    The method to create a single polymer chart of Distance-Force Curve and .txt relevant data file of stress and strain the same as function curve. but it can be more handy if there are some .out or .inp files. 
+    autocurve(savefig=True, savedata=True, saveloc='./')
     savefig, savedata: To show if you want to save the chart and .txt curve. The default is True.
-    The output of this file is a Stress-Strain Curve chart and relevant data.
+    saveloc: The location of your saved file. The default is your current location.
+    The output of this file is a Distance-Force Curve chart and relevant data.
     Example:
         Input:
             from MCPoly.sscurve import single
-                poly1=single('Polymer1')
-                poly1.autocurve()
+                poly1 = single('Polymer1')
+                poly1.autocurve2()
         Output:
             ['Polymer1_2.0.xyz', 'Polymer1_0.0.xyz', 'Polymer1_0.5.xyz', 'Polymer1_2.5.xyz', 
              'Polymer1_1.0.xyz', 'Polymer1_3.0.xyz', 'Polymer1_1.5.xyz']
-                  Strain Length(%)  Stress Force(nN)
+                  Distance()       Force(nN)
                 0           1.00000               0.0
                 1           1.06778               0.5
                 2           1.13094               1.0
                 3           1.19338               1.5
                 4           1.24726               2.0
                 5           1.31094               2.5
             <matplotlib chart>
     TIPS: Make sure all your .xyz file is in the current location, or the chart may have some mistakes.
           Make sure there is at least one .out or .inp file of relevant polymer here, or it will show FileNotFoundError.
         """
-        t=0
+        t = 0
         for path in os.listdir(self.loc):
             if os.path.isfile(os.path.join(self.loc, path)):
-                a=re.match(self.polymer+'_', path)
+                a = re.match(self.polymer+'_', path)
                 if a:
-                    b=re.search('.inp',path)
+                    b = re.search('.inp', path)
                     if b:
-                        t=1
+                        t = 1
                         break
-                    c=re.search('.out',path)
+                    c = re.search('.out', path)
                     if c:
-                        t=2
+                        t = 2
                         break
-        if t==0:
+        if t == 0:
             raise FileNotFoundError('relevant .inp and .out file is not found. Try to find out the file and put it in this document.')
         else:
-            opath=os.getcwd()
+            opath = os.getcwd()
             os.chdir(self.loc)
-            f=open(path,'r')
-            i=0
-            start=-1
-            end=-1
-            if t==1:
+            f = open(path, 'r')
+            i = 0
+            start = -1
+            end = -1
+            if t == 1:
                 for line in f:
-                    if i==1:
-                        num=re.findall(r'[0-9]+',line)
-                        start=eval(num[0])
-                        end=eval(num[1])
+                    if i == 1:
+                        num = re.findall(r'[0-9]+', line)
+                        start = eval(num[0])
+                        end = eval(num[1])
                         break
-                    a=re.search('POTENTIALS',line)
+                    a = re.search('POTENTIALS', line)
                     if a:
-                        i=i+1
-            if t==2:
+                        i = i + 1
+            if t == 2:
                 for line in f:
-                    if i==1:
-                        num=re.findall(r'[0-9]+',line)
-                        start=eval(num[1])
-                        end=eval(num[2])
+                    if i == 1:
+                        num = re.findall(r'[0-9]+', line)
+                        start = eval(num[1])
+                        end = eval(num[2])
                         break
-                    a=re.search('> POTENTIALS',line)
+                    a = re.search('> POTENTIALS', line)
                     if a:
-                        i=i+1
+                        i = i + 1
             os.chdir(opath)
-        return curvef2(self.loc,self.polymer,start,end,savefig,savedata)
+        return curvef2(self.loc, self.polymer, start, end, savefig, savedata, saveloc, xx)
```

#### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

### Comparing `MCPoly-0.5.1.3/MCPoly/status/echart.py` & `MCPoly-0.6b1/MCPoly/status/echart.py`

 * *Files 12% similar despite different names*

```diff
@@ -6,18 +6,20 @@
 import seaborn as sns
 
 mydir = os.path.dirname( __file__ )
 statusdir = os.path.join(mydir, '..', 'status')
 sys.path.append(statusdir)
 from status import status
 
-def echart(files=[],loc='./',energy_pattern='Energy',hartree=False,absolute=False,fig_pattern='line',figdata=True,savefig=True,figname='Result',savedata=True,dataname='Result',xx=False):
+def echart(files=[], loc='./', energy_pattern='Energy', hartree=False,\
+           absolute=False, fig_pattern='line', figdata=True, savefig=True,\
+           figname='Result', savedata=True, dataname='Result', xx=False):
     """
         A method to make a chart with calculated Electronic Energy datas or Gibbs Free Energy data.
-        echart(files=[],loc='./',energy_pattern='Energy',hartree=False,absolute=False,figname='Result',fig_pattern='line',savefig=False,dataname='Result',savedata=True)
+        echart(files=[], loc='./', energy_pattern='Energy', hartree=False, absolute=False, figname='Result', fig_pattern='line', savefig=False, dataname='Result', savedata=True)
         files: The name of ORCA output files already calculated.
         loc: File Location. The default is your current location.
         energy_pattern: Energy you need. There are 2 options, 'Energy' for normal Electronic Energy and 'Gibbs' for Gibbs Free Energy. If you want to use 'Gibbs', please make sure your output file including frequency and thermodynamics calculation.
         hartree: Energy unit is normally kcal/mol, if you need unit 'Hartree', please input 'hartree=True'
                  TIPS: 1 Hartree  627.509 kcal/mol
         absolute: Normally we'll automatical use Relative Energy to show energy change, if you want Absolute Energy, please input 'absolute=True'
         fig_pattern: Pattern of the figure. There are 2 options, 'line' means Line Chart and 'bar' means Bar Chart.
@@ -25,122 +27,123 @@
         savefig / savedata: To show if you want to save the chart and .txt result. The default is True.
         figname / savename: To set the name of the chart and .txt result. The default is 'Result'. 
         TIPS: If you use it to collect Gibbs Free Energy, please make sure you have frequency calculation. If the programme can't find out thermodynamics calculation, it will return None(NaN).
         
         Example:
             Input:
                 from MCPoly.status import echart
-                a=echart(files['Molecule1','Molecule2','Molecule3','Molecule4','Molecule5','Molecule6'],fig_pattern='line',\
+                a = echart(files['Molecule1', 'Molecule2', 'Molecule3', 'Molecule4', 'Molecule5', 'Molecule6'], fig_pattern='line', \
                     figdata=True)
                 print(a)
             Output:
                 <<matplotlib.plot>>
                 [ 0.          0.79379889  3.3396029   8.29064891 16.99670877 33.95325697]
             In Result.csv:
-                Step,File,E(kcal/mol)
-                0,Molecule1,0.0
-                1,Molecule2,0.7937988850646964
-                2,Molecule3,3.3396028980577155
-                3,Molecule4,8.290648908041941
-                4,Molecule5,16.996708774033824
-                5,Molecule6,33.95325697202637
+                Step, File, E(kcal/mol)
+                0, Molecule1, 0.0
+                1, Molecule2, 0.7937988850646964
+                2, Molecule3, 3.3396028980577155
+                3, Molecule4, 8.290648908041941
+                4, Molecule5, 16.996708774033824
+                5, Molecule6, 33.95325697202637
         
         TIPS: For some limitation, the chart created on this function might not very good.
     """
-    datas=[]
-    opath=os.getcwd()
-    if files==[]:
+    datas = []
+    opath = os.getcwd()
+    if files == []:
         for path in os.listdir(loc):
             if os.path.isfile(os.path.join(loc, path)):
-                a=re.search('_Result.txt', path)
+                a = re.search('_Result.txt', path)
                 if a:
                     files.append(path[:-11])
         files.sort()
     #print(files)
-    if energy_pattern=='Energy':
+    if energy_pattern == 'Energy':
         for file in files:
             #try:
-            data=status(file,loc).converged_energy()
+            #print(os.getcwd())
+            data = status(file, loc).converged_energy()
             datas.append(data)
             #except:
             #    datas.append(None)
-    elif energy_pattern=='Gibbs':
+    elif energy_pattern == 'Gibbs':
         for file in files:
             #try:
-            data=status(file,loc).gibbs()
+            data = status(file, loc).gibbs()
             datas.append(data)
             #except:
             #    datas.append(None)
     os.chdir(opath)
     os.chdir(loc)
-    Ebar=np.array(datas)
-    if absolute==False:
-        Ebar=Ebar-datas[0]
-    if hartree==False:
-        Ebar=Ebar*627.509
+    Ebar = np.array(datas)
+    if absolute == False:
+        Ebar = Ebar - datas[0]
+    if hartree == False:
+        Ebar = Ebar * 627.509
     Ebar.tolist()
-    Emax=-99999
+    Emax = -99999
     for E in Ebar:
         try:
-            if E>Emax:
-                Emax=E
+            if E > Emax:
+                Emax = E
         except:
             pass
-    Emin=min(Ebar)
-    gap=Emax-Emin
-    if xx==False:
-        if figdata==True:
-            if fig_pattern=='line':
+    Emin = min(Ebar)
+    gap = Emax - Emin
+    if xx == False:
+        if figdata == True:
+            if fig_pattern == 'line':
                 for i in range(len(Ebar)):
-                    if files[i]=='':
+                    if files[i] == '':
                         continue
-                    if Emax-Ebar[i]<=5.0:
-                        plt.text(i-0.5, Ebar[i]-0.05*gap, '{0:.1f}'.format(Ebar[i]))
-                    elif Emax-Ebar[i]>5.0:
-                        plt.text(i-0.2, Ebar[i]+0.02*gap, '{0:.1f}'.format(Ebar[i]))
-            elif fig_pattern=='bar':
+                    if Emax - Ebar[i] <= 5.0:
+                        plt.text(i-0.5, Ebar[i] - 0.05*gap, '{0:.1f}'.format(Ebar[i]))
+                    elif Emax - Ebar[i] > 5.0:
+                        plt.text(i-0.2, Ebar[i] + 0.02*gap, '{0:.1f}'.format(Ebar[i]))
+            elif fig_pattern == 'bar':
                 for i in range(len(Ebar)):
                     plt.text(i, Ebar[i], '{0:.1f}'.format(Ebar[i]))
-        if fig_pattern=='line':
-            ax=plt.plot(files,Ebar,'*-')
-            if energy_pattern=='Energy' and hartree==True:
+        if fig_pattern == 'line':
+            ax = plt.plot(files, Ebar, '*-')
+            if energy_pattern == 'Energy' and hartree == True:
                 plt.ylabel('E(Eh)')
-            elif energy_pattern=='Energy' and hartree==False:
+            elif energy_pattern == 'Energy' and hartree == False:
                 plt.ylabel('E(kcal/mol)')
-            elif energy_pattern=='Gibbs' and hartree==True:
+            elif energy_pattern == 'Gibbs' and hartree == True:
                 plt.ylabel('G(Eh)')
-            elif energy_pattern=='Gibbs' and hartree==False:
+            elif energy_pattern == 'Gibbs' and hartree == False:
                 plt.ylabel('G(kcal/mol)')
-        elif fig_pattern=='bar':
-            ax=plt.bar(files,Ebar)
-            if energy_pattern=='Energy' and hartree==True:
+        elif fig_pattern == 'bar':
+            ax=plt.bar(files, Ebar)
+            if energy_pattern == 'Energy' and hartree == True:
                 plt.ylabel('E(Eh)')
-            elif energy_pattern=='Energy' and hartree==False:
+            elif energy_pattern == 'Energy' and hartree == False:
                 plt.ylabel('E(kcal/mol)')
-            elif energy_pattern=='Gibbs' and hartree==True:
+            elif energy_pattern == 'Gibbs' and hartree == True:
                 plt.ylabel('G(Eh)')
-            elif energy_pattern=='Gibbs' and hartree==False:
+            elif energy_pattern == 'Gibbs' and hartree == False:
                 plt.ylabel('G(kcal/mol)')
-    if savefig==True:
+    if savefig == True:
         plt.savefig('{0}.png'.format(figname))
-    if xx==False:
+    if xx == False:
         plt.show()
-    if savedata==True:
+    if savedata == True:
         try:
-            f=open('{0}.csv'.format(dataname),'x')
+            f = open('{0}.csv'.format(dataname), 'x')
         except:
-            f=open('{0}.csv'.format(dataname),'w')
+            f = open('{0}.csv'.format(dataname), 'w')
         f.write('Step,File,')
-        if energy_pattern=='Energy':
+        if energy_pattern == 'Energy':
             f.write('E')
-        elif energy_pattern=='Gibbs':
+        elif energy_pattern == 'Gibbs':
             f.write('G')
-        if hartree==True:
+        if hartree == True:
             f.write('(Eh)')
         else:
             f.write('(kcal/mol)')
         f.write('\n')
         for i in range(len(files)):
-            f.write('{0},{1},{2}\n'.format(i,files[i],Ebar[i]))
+            f.write('{0},{1},{2}\n'.format(i, files[i], Ebar[i]))
         f.close()
     os.chdir(opath)
     return Ebar.tolist()
```

### Comparing `MCPoly-0.5.1.3/MCPoly/status/gui.py` & `MCPoly-0.6b1/MCPoly/status/gui.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,17 +1,17 @@
-import ipywidgets as widgets
 import os
 import re
+import sys
+import warnings
 import time as t
 import numpy as np
 import pandas as pd
 import seaborn as sns
+import ipywidgets as widgets
 import matplotlib.pyplot as plt
-import warnings
-import sys
 
 mydir = os.path.dirname( __file__ )
 statusdir = os.path.join(mydir, '..', 'status')
 sys.path.append(statusdir)
 from status import status
 
 def gui():
@@ -23,364 +23,395 @@
               2. You can skip the a file name if you need.
               3. For some limitation, the chart created on this function might not very good.
               4. The 'Result Combination' can only create line chart.
               5. The visualisation will also risk the flexibility of the task, to make you programme more flexible, please directly use the code.
     """
     
     def fig(button):
-        opath=os.getcwd()
+        opath = os.getcwd()
         os.chdir(loc.value)
-        os.system('cp {0}.png {1}.png'.format(figoldname.value,figname.value))
+        os.system('cp {0}.png {1}.png'.format(figoldname.value, figname.value))
         os.system('rm {0}.png'.format(figoldname.value))
         os.system('rm ot.png'.format(csv6.value))
-        if delete.value==True:
+        if delete.value == True:
             os.system('rm {0}.png'.format(csv1.value))
             os.system('rm {0}.png'.format(csv2.value))
             os.system('rm {0}.png'.format(csv3.value))
             os.system('rm {0}.png'.format(csv4.value))
             os.system('rm {0}.png'.format(csv5.value))
             os.system('rm {0}.png'.format(csv6.value))
         os.chdir(opath)
         output2.clear_output()
         controloutput1.clear_output()
-        file1.value=''
-        file2.value=''
-        file3.value=''
-        file4.value=''
-        file5.value=''
-        file6.value=''
-        file7.value=''
-        file8.value=''
-        file9.value=''
-        file10.value=''
-        csv1.value=''
-        csv2.value=''
-        csv3.value=''
-        csv4.value=''
-        csv5.value=''
-        csv6.value=''
-        figname.value='Untitled'
+        file1.value = ''
+        file2.value = ''
+        file3.value = ''
+        file4.value = ''
+        file5.value = ''
+        file6.value = ''
+        file7.value = ''
+        file8.value = ''
+        file9.value = ''
+        file10.value = ''
+        csv1.value = ''
+        csv2.value = ''
+        csv3.value = ''
+        csv4.value = ''
+        csv5.value = ''
+        csv6.value = ''
+        figname.value = 'Untitled'
     
     def data(button):
-        opath=os.getcwd()
+        opath = os.getcwd()
         os.chdir(loc.value)
-        os.system('cp {0}.csv {1}.csv'.format(dataoldname.value,dataname.value))
+        os.system('cp {0}.csv {1}.csv'.format(dataoldname.value, dataname.value))
         os.system('rm {0}.csv'.format(dataoldname.value))
         os.system('rm ot.csv'.format(dataoldname.value))
-        if delete.value==True:
+        if delete.value == True:
             os.system('rm {0}.csv'.format(csv1.value))
             os.system('rm {0}.csv'.format(csv2.value))
             os.system('rm {0}.csv'.format(csv3.value))
             os.system('rm {0}.csv'.format(csv4.value))
             os.system('rm {0}.csv'.format(csv5.value))
             os.system('rm {0}.csv'.format(csv6.value))
         os.chdir(opath)
         output3.clear_output()
-        file1.value=''
-        file2.value=''
-        file3.value=''
-        file4.value=''
-        file5.value=''
-        file6.value=''
-        file7.value=''
-        file8.value=''
-        file9.value=''
-        file10.value=''
-        csv1.value=''
-        csv2.value=''
-        csv3.value=''
-        csv4.value=''
-        csv5.value=''
-        csv6.value=''
-        dataname.value='Untitled'
+        file1.value = ''
+        file2.value = ''
+        file3.value = ''
+        file4.value = ''
+        file5.value = ''
+        file6.value = ''
+        file7.value = ''
+        file8.value = ''
+        file9.value = ''
+        file10.value = ''
+        csv1.value = ''
+        csv2.value = ''
+        csv3.value = ''
+        csv4.value = ''
+        csv5.value = ''
+        csv6.value = ''
+        dataname.value = 'Untitled'
     
-    def pattern1(fig_pattern,datatype):
+    def pattern1(fig_pattern, datatype):
         output2.clear_output()
         output3.clear_output()
-        opath=os.getcwd()
+        opath = os.getcwd()
         os.chdir(loc.value)
-        sonbox=[]
-        files=[file1.value,file2.value,file3.value,file4.value,file5.value,file6.value,file7.value,file8.value,file9.value,file10.value]
-        if files==['','','','','','','','','','']:
+        sonbox = []
+        files = [file1.value, file2.value, file3.value, file4.value, file5.value,\
+                 file6.value, file7.value, file8.value, file9.value, file10.value]
+        if files == ['', '', '', '', '', '', '', '', '', '']:
             return None
         for file in files:
             try:
-                if datatype=='Energy':
-                    data2=status(file).converged_energy()
-                elif datatype=='Gibbs':
-                    data2=status(file).gibbs()
+                if datatype == 'Energy':
+                    data2 = status(file).converged_energy()
+                elif datatype == 'Gibbs':
+                    data2 = status(file).gibbs()
                 sonbox.append(data2)
             except:
                 sonbox.append(49999)
-        num=[1,2,3,4,5,6,7,8,9,10]
-        Ebar=np.array(sonbox)
-        Ebar=Ebar-sonbox[0]
-        Ebar=Ebar*627.509
+        num = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
+        Ebar = np.array(sonbox)
+        Ebar = Ebar - sonbox[0]
+        Ebar = Ebar * 627.509
         Ebar.tolist()
         for i in range(len(Ebar)):
-            if Ebar[i]>=40000:
-                Ebar[i]=None
-        Emax=-99999
+            if Ebar[i] >= 40000:
+                Ebar[i] = None
+        Emax = -99999
         for E in Ebar:
             try:
-                if E>Emax:
-                    Emax=E
+                if E > Emax:
+                    Emax = E
             except:
                 pass
-        Emin=min(Ebar)
-        gap=Emax-Emin
-        if fig_pattern=='line':
-            ax=plt.plot(num,Ebar,'*-')
-        elif fig_pattern=='bar':
-            ax=plt.bar(num,Ebar)
+        Emin = min(Ebar)
+        gap = Emax - Emin
+        if fig_pattern == 'line':
+            ax = plt.plot(num, Ebar, '*-')
+        elif fig_pattern == 'bar':
+            ax = plt.bar(num, Ebar)
         plt.xlabel('Step')
-        if datatype=='Energy':
+        if datatype == 'Energy':
             plt.ylabel('E(kcal/mol)')
-        elif datatype=='Gibbs':
+        elif datatype == 'Gibbs':
             plt.ylabel('G(kcal/mol)')
         for i in range(len(Ebar)):
-            if files[i]=='':
+            if files[i] == '':
                 continue
-            if Emax-Ebar[i]<=5.0:
-                plt.text(num[i]-0.5, Ebar[i]-0.05*gap, '{0}\n{1:.1f}'.format(files[i],Ebar[i]))
-            elif Emax-Ebar[i]>5.0:
-                plt.text(num[i]-0.2, Ebar[i]+0.02*gap, '{0}\n{1:.1f}'.format(files[i],Ebar[i]))
-        #plt.ylim(min(Ebar)-4,max(EBar)+4)
-        plt.savefig('{0}.png'.format(figname.value),bbox_inches='tight')
+            if Emax - Ebar[i] <= 5.0:
+                plt.text(num[i]-0.5, Ebar[i] - 0.05*gap,\
+                         '{0}\n{1:.1f}'.format(files[i], Ebar[i]))
+            elif Emax - Ebar[i] > 5.0:
+                plt.text(num[i]-0.2, Ebar[i] + 0.02*gap,\
+                         '{0}\n{1:.1f}'.format(files[i], Ebar[i]))
+        #plt.ylim(min(Ebar)-4, max(EBar)+4)
+        plt.savefig('{0}.png'.format(figname.value), bbox_inches = 'tight')
         with output2:
             plt.show()
         #with controloutput1:
-            #display(widgets.HBox([widgets.Label('Figure Pattern: '),fig_pattern]))
-            #display(widgets.VBox([widgets.HBox([widgets.Label('Curve Name: '),figname]),savefig]))
+            #display(widgets.HBox([widgets.Label('Figure Pattern: '), fig_pattern]))
+            #display(widgets.VBox([widgets.HBox(
+            #    [widgets.Label('Curve Name: '), figname]), savefig]))
         try:
-            f=open('{0}.csv'.format(dataname.value),'x')
+            f = open('{0}.csv'.format(dataname.value), 'x')
         except:
-            f=open('{0}.csv'.format(dataname.value),'w')
-        f.write('Step,')
-        f.write('File,')
-        if datatype=='Energy':
+            f = open('{0}.csv'.format(dataname.value), 'w')
+        f.write('Step, ')
+        f.write('File, ')
+        if datatype == 'Energy':
             f.write('E')
-        elif datatype=='Gibbs':
+        elif datatype == 'Gibbs':
             f.write('G')
-        #if hartree==True:
+        #if hartree == True:
         #    f.write('(Hartree)')
         #else:
         f.write('(kcal/mol)\n')
         for i in range(len(num)):
-            if Ebar[i]==None:
-                f.write('{0},,\n'.format(num[i]))
+            if Ebar[i] == None:
+                f.write('{0}, , \n'.format(num[i]))
             else:
-                f.write('{0},{1},{2}\n'.format(num[i],files[i],Ebar[i]))
+                f.write('{0}, {1}, {2}\n'.format(num[i], files[i], Ebar[i]))
         f.close()
         with output3:
-            csv=pd.read_csv('{0}.csv'.format(dataname.value))
+            csv = pd.read_csv('{0}.csv'.format(dataname.value))
             display(csv)
         with output3:
-            display(widgets.VBox([widgets.HBox([widgets.Label('CSV Table Name'),dataname]),savedata]))
-        dataoldname.value=dataname.value
-        figoldname.value=figname.value
+            display(widgets.VBox([widgets.HBox([widgets.Label('CSV Table Name'),\
+                                                dataname]), savedata]))
+        dataoldname.value = dataname.value
+        figoldname.value = figname.value
         os.chdir(opath)
         
     def shows(button):
         controloutput1.clear_output()
         output2.clear_output()
         output3.clear_output()
-        opath=os.getcwd()
+        opath = os.getcwd()
         os.chdir(loc.value)
         with controloutput1:
-            display(widgets.HBox([widgets.Label('Figure Pattern: '),fig_pattern]))
-            display(widgets.VBox([widgets.HBox([widgets.Label('Curve Name'),figname]),savefig]))
-        dataoldname.value=dataname.value
-        figoldname.value=figname.value
-        dataout=widgets.interactive_output(pattern1,{'fig_pattern': fig_pattern,'datatype': datatype})
+            display(widgets.HBox([widgets.Label('Figure Pattern: '), fig_pattern]))
+            display(widgets.VBox([widgets.HBox([widgets.Label('Curve Name'),\
+                                                figname]), savefig]))
+        dataoldname.value = dataname.value
+        figoldname.value = figname.value
+        dataout = widgets.interactive_output(pattern1,\
+                                             {'fig_pattern': fig_pattern, 'datatype': datatype})
         os.chdir(opath)
     
     def shows2(button):
         controloutput1.clear_output()
         output2.clear_output()
         output3.clear_output()
-        opath=os.getcwd()
+        opath = os.getcwd()
         os.chdir(loc.value)
-        sonbox2=[]
-        csvs=[csv1.value,csv2.value,csv3.value,csv4.value,csv5.value,csv6.value]
-        allcsv=[]
-        site=[]
-        name=[]
+        sonbox2 = []
+        csvs = [csv1.value, csv2.value, csv3.value,\
+                csv4.value, csv5.value, csv6.value]
+        allcsv = []
+        site = []
+        name = []
         try:
-            f=open('ot.csv','x')
+            f = open('ot.csv', 'x')
         except:
-            f=open('ot.csv','w')
+            f = open('ot.csv', 'w')
         
         for csv in csvs:
-            csv=csv+'.csv'
+            csv = csv + '.csv'
             try:
-                datum=pd.read_csv(csv)
+                datum = pd.read_csv(csv)
             except:
                 warnings.warn("'{0}' is not found.".format(csv))
                 continue
             try:
-                datum=datum[:].sort_values(by=['Step'])
+                datum = datum[:].sort_values(by = ['Step'])
             except:
                 warnings.warn("'{0}' is not the file aboue stress-strain curve.".format(csv))
                 continue
             for num in datum['Step']:
                 if num not in site:
                     site.append(num)
         site.sort()
         f.write('Step\n')
         for num in site:
             f.write('{0:.3f}\n'.format(num))
         f.close()
         
-        figoldname.value='ot'
-        dataoldname.value='ot'
+        figoldname.value = 'ot'
+        dataoldname.value = 'ot'
         
-        ot=pd.read_csv('ot.csv')
+        ot = pd.read_csv('ot.csv')
         for csv in csvs:
-            csv=csv+'.csv'
-            xo=0
+            csv = csv + '.csv'
+            xo = 0
             try:
-                r=open(csv,'r')
+                r = open(csv, 'r')
             except:
                 continue
             for line in r:
                 print(line)
-                z=re.search('G',line)
+                z = re.search('G', line)
                 if z:
-                    xo=1
+                    xo = 1
                     break
             r.close()
             try:
-                datum=pd.read_csv(csv)
+                datum = pd.read_csv(csv)
             except:
                 continue
-            datum=datum[:].sort_values(by=['Step'])
-            if xo==0:
-                ax=plt.plot(datum['Step'],datum['E(kcal/mol)'],'*-')
-                #elif fig_pattern=='bar':
+            datum = datum[:].sort_values(by = ['Step'])
+            if xo == 0:
+                ax = plt.plot(datum['Step'], datum['E(kcal/mol)'], '*-')
+                #elif fig_pattern == 'bar':
                 #    
-                datum=datum.rename(columns={'E(kcal/mol)':'E_{0}(kcal/mol)'.format(csv[:-4])})
-            elif xo==1:
-                ax=plt.plot(datum['Step'],datum['G(kcal/mol)'],'*-')
-                datum=datum.rename(columns={'G(kcal/mol)':'G_{0}(kcal/mol)'.format(csv[:-4])})
-            datum=datum.rename(columns={'File':'File_{0}'.format(csv[:-4])})
-            #if hartree==True:
-            ot=pd.merge_ordered(ot, datum, fill_method="ffill" , left_by="Step")
+                datum = datum.rename(
+                    columns = {'E(kcal/mol)':'E_{0}(kcal/mol)'.format(csv[:-4])})
+            elif xo == 1:
+                ax = plt.plot(datum['Step'], datum['G(kcal/mol)'], '*-')
+                datum = datum.rename(
+                    columns = {'G(kcal/mol)':'G_{0}(kcal/mol)'.format(csv[:-4])})
+            datum = datum.rename(columns = {'File':'File_{0}'.format(csv[:-4])})
+            #if hartree == True:
+            ot = pd.merge_ordered(ot, datum, fill_method = "ffill" , left_by = "Step")
             name.append(csv[:-4])
         
         with output3:
-            ot=ot.set_index('Step')
+            ot = ot.set_index('Step')
             display(ot)
             ot.to_csv('ot.csv')
-            display(widgets.VBox([widgets.HBox([widgets.Label('CSV Table Name'),dataname]),savedata,widgets.HBox([widgets.Label('Delete all combined files'),delete])]))
+            display(widgets.VBox([widgets.HBox([widgets.Label('CSV Table Name'),\
+                                                dataname]), savedata,\
+                                  widgets.HBox([widgets.Label('Delete all combined files'), delete])]))
         
         plt.xlabel('Steps')
         plt.ylabel('Energy(kcal/mol)')
-        plt.legend(name,bbox_to_anchor=[1.1,0.9])
+        plt.legend(name, bbox_to_anchor = [1.1, 0.9])
         with output2:
-            plt.savefig('ot.png',bbox_inches='tight')
+            plt.savefig('ot.png', bbox_inches = 'tight')
             plt.show()
         with controloutput1:
-            #display(widgets.HBox([widgets.Label('Figure Pattern: '),fig_pattern]))
-            display(widgets.VBox([widgets.HBox([widgets.Label('Curve Name'),figname]),savefig,widgets.HBox([widgets.Label('Delete all combined files'),delete])]))
+            #display(widgets.HBox([widgets.Label('Figure Pattern: '), fig_pattern]))
+            display(widgets.VBox([widgets.HBox([widgets.Label('Curve Name'), figname]),\
+                                  savefig, widgets.HBox([widgets.Label('Delete all combined files'),\
+                                                         delete])]))
             
-    output=widgets.Output()
-    output2=widgets.Output()
-    output3=widgets.Output()
-    output4=widgets.Output()
-    controloutput1=widgets.Output()
-    
-    loc=widgets.Text(description='Location:',value='./')
-    options=[]
-    title1=widgets.Label('File Settings:',style=dict(font_weight='bold'))
-    loc=widgets.Text(description='Location:',value='./')
+    output = widgets.Output()
+    output2 = widgets.Output()
+    output3 = widgets.Output()
+    output4 = widgets.Output()
+    controloutput1 = widgets.Output()
+    
+    loc = widgets.Text(description = 'Location:', value='./')
+    options = []
+    title1 = widgets.Label('File Settings:', style = dict(font_weight='bold'))
+    loc = widgets.Text(description = 'Location:', value='./')
     for path in os.listdir(loc.value):
         if os.path.isfile(os.path.join(loc.value, path)):
-            a=re.search('.out', path)
+            a = re.search('.out', path)
             if a:
                 options.append(path[:-4])
     options.sort()
     
-    file1=widgets.Combobox(placeholder='Input the file name',options=options,
-             description='ORCA File 1',layout=widgets.Layout(width='98.5%'))
-    file2=widgets.Combobox(placeholder='Input the file name',options=options,
-             description='ORCA File 2',layout=widgets.Layout(width='98.5%'))
-    file3=widgets.Combobox(placeholder='Input the file name',options=options,
-             description='ORCA File 3',layout=widgets.Layout(width='98.5%'))
-    file4=widgets.Combobox(placeholder='Input the file name',options=options,
-             description='ORCA File 4',layout=widgets.Layout(width='98.5%'))
-    file5=widgets.Combobox(placeholder='Input the file name',options=options,
-             description='ORCA File 5',layout=widgets.Layout(width='98.5%'))
-    file6=widgets.Combobox(placeholder='Input the file name',options=options,
-             description='ORCA File 6',layout=widgets.Layout(width='98.5%'))
-    file7=widgets.Combobox(placeholder='Input the file name',options=options,
-             description='ORCA File 7',layout=widgets.Layout(width='98.5%'))
-    file8=widgets.Combobox(placeholder='Input the file name',options=options,
-             description='ORCA File 8',layout=widgets.Layout(width='98.5%'))
-    file9=widgets.Combobox(placeholder='Input the file name',options=options,
-             description='ORCA File 9',layout=widgets.Layout(width='98.5%'))
-    file10=widgets.Combobox(placeholder='Input the file name',options=options,
-             description='ORCA File 10',layout=widgets.Layout(width='98.5%'))
-    
-    options2=[]
-    title2=widgets.Label('Combination Settings:',style=dict(font_weight='bold'))
-    loc=widgets.Text(description='Location:',value='./')
+    file1 = widgets.Combobox(placeholder = 'Input the file name', options=options,\
+                             description = 'ORCA File 1', layout = widgets.Layout(width='98.5%'))
+    file2 = widgets.Combobox(placeholder = 'Input the file name', options=options,\
+                             description = 'ORCA File 2', layout = widgets.Layout(width='98.5%'))
+    file3 = widgets.Combobox(placeholder = 'Input the file name', options=options,\
+                             description = 'ORCA File 3', layout = widgets.Layout(width='98.5%'))
+    file4 = widgets.Combobox(placeholder = 'Input the file name', options=options,\
+                             description = 'ORCA File 4', layout = widgets.Layout(width='98.5%'))
+    file5 = widgets.Combobox(placeholder = 'Input the file name', options=options,\
+                             description = 'ORCA File 5', layout = widgets.Layout(width='98.5%'))
+    file6 = widgets.Combobox(placeholder = 'Input the file name', options=options,\
+                             description = 'ORCA File 6', layout = widgets.Layout(width='98.5%'))
+    file7 = widgets.Combobox(placeholder = 'Input the file name', options=options,\
+                             description = 'ORCA File 7', layout = widgets.Layout(width='98.5%'))
+    file8 = widgets.Combobox(placeholder = 'Input the file name', options=options,\
+                             description = 'ORCA File 8', layout = widgets.Layout(width='98.5%'))
+    file9 = widgets.Combobox(placeholder = 'Input the file name', options=options,\
+                             description = 'ORCA File 9', layout = widgets.Layout(width='98.5%'))
+    file10 = widgets.Combobox(placeholder = 'Input the file name',\
+                              options=options,\
+             description = 'ORCA File 10', layout = widgets.Layout(width='98.5%'))
+    
+    options2 = []
+    title2 = widgets.Label('Combination Settings:',\
+                           style = dict(font_weight='bold'))
+    loc = widgets.Text(description='Location:', value='./')
     for path in os.listdir(loc.value):
         if os.path.isfile(os.path.join(loc.value, path)):
-            a=re.search('.csv', path)
+            a = re.search('.csv', path)
             if a:
                 options2.append(path[:-4])
     options2.sort()
-    csv1=widgets.Combobox(placeholder='Input the file name',options=options2,
-             description='CSV File 1',layout=widgets.Layout(width='98.5%'))
-    csv2=widgets.Combobox(placeholder='Input the file name',options=options2,
-             description='CSV File 2',layout=widgets.Layout(width='98.5%'))
-    csv3=widgets.Combobox(placeholder='Input the file name',options=options2,
-             description='CSV File 3',layout=widgets.Layout(width='98.5%'))
-    csv4=widgets.Combobox(placeholder='Input the file name',options=options2,
-             description='CSV File 4',layout=widgets.Layout(width='98.5%'))
-    csv5=widgets.Combobox(placeholder='Input the file name',options=options2,
-             description='CSV File 5',layout=widgets.Layout(width='98.5%'))
-    csv6=widgets.Combobox(placeholder='Input the file name',options=options2,
-             description='CSV File 6',layout=widgets.Layout(width='98.5%'))
-    
-    showcurve=widgets.Button(description='Create Curve and Table',layout=widgets.Layout(width='98.5%'),style=dict(font_weight='bold',text_decoration='underline'))
-    showcurve2=widgets.Button(description='Create Curve and Table',layout=widgets.Layout(width='98.5%'),style=dict(font_weight='bold',text_decoration='underline'))
-    datatype=widgets.Dropdown(description='Data Need:',options=['Energy','Gibbs'],value='Energy',layout=widgets.Layout(width='98.5%'))
-    fig_pattern=widgets.Dropdown(options=['line','bar'],value='line',layout=widgets.Layout(width='80%'))
-    dataname=widgets.Text(value='Untitled')
-    dataoldname=widgets.Text()
-    savedata=widgets.Button(description='Save CSV Table',layout=widgets.Layout(width='98.5%'))
-    figname=widgets.Text(value='Untitled')
-    figoldname=widgets.Text()
-    savefig=widgets.Button(description='Save Curve',layout=widgets.Layout(width='98.5%'))
-    delete=widgets.Checkbox()
+    csv1 = widgets.Combobox(placeholder = 'Input the file name', options=options2,\
+             description = 'CSV File 1', layout = widgets.Layout(width='98.5%'))
+    csv2 = widgets.Combobox(placeholder = 'Input the file name', options=options2,\
+             description = 'CSV File 2', layout = widgets.Layout(width='98.5%'))
+    csv3 = widgets.Combobox(placeholder = 'Input the file name', options=options2,\
+             description = 'CSV File 3', layout = widgets.Layout(width='98.5%'))
+    csv4 = widgets.Combobox(placeholder = 'Input the file name', options=options2,\
+             description = 'CSV File 4', layout = widgets.Layout(width='98.5%'))
+    csv5 = widgets.Combobox(placeholder = 'Input the file name', options=options2,\
+             description = 'CSV File 5', layout = widgets.Layout(width='98.5%'))
+    csv6 = widgets.Combobox(placeholder = 'Input the file name', options=options2,\
+             description = 'CSV File 6', layout = widgets.Layout(width='98.5%'))
+    
+    showcurve = widgets.Button(description = 'Create Curve and Table',\
+                               layout = widgets.Layout(width='98.5%'),\
+                               style = dict(font_weight='bold', text_decoration='underline'))
+    showcurve2 = widgets.Button(description = 'Create Curve and Table',\
+                                layout = widgets.Layout(width='98.5%'),\
+                                style = dict(font_weight='bold', text_decoration='underline'))
+    datatype = widgets.Dropdown(description = 'Data Need:',\
+                                options = ['Energy', 'Gibbs'], value='Energy',\
+                                layout = widgets.Layout(width='98.5%'))
+    fig_pattern = widgets.Dropdown(options = ['line', 'bar'], value='line',\
+                                   layout = widgets.Layout(width='80%'))
+    dataname = widgets.Text(value='Untitled')
+    dataoldname = widgets.Text()
+    savedata = widgets.Button(description = 'Save CSV Table',\
+                              layout = widgets.Layout(width='98.5%'))
+    figname = widgets.Text(value='Untitled')
+    figoldname = widgets.Text()
+    savefig = widgets.Button(description = 'Save Curve',\
+                             layout = widgets.Layout(width='98.5%'))
+    delete = widgets.Checkbox()
     
     showcurve.on_click(shows)
     showcurve2.on_click(shows2)
     savedata.on_click(data)
     savefig.on_click(fig)
     
     with output:
-        display(widgets.VBox([loc,title1,file1,file2,file3,file4,file5,file6,file7,file8,file9,file10,datatype,showcurve]))
+        display(widgets.VBox([loc, title1, file1, file2, file3, file4,\
+                              file5, file6, file7, file8, file9, file10, datatype, showcurve]))
     
     with output4:
-        display(widgets.VBox([loc,title2,csv1,csv2,csv3,csv4,csv5,csv6,showcurve2]))
+        display(widgets.VBox([loc, title2, csv1, csv2, csv3, csv4, csv5,\
+                              csv6, showcurve2]))
     
-    box_layout1 = widgets.Layout(display='flex', flew_flow='column', overflow='scroll hidden',\
-            align_items='stretch', border='solid', height='550px', width='26%')
-    box_layout2 = widgets.Layout(display='flex', flew_flow='column', overflow='scroll hidden',\
-            align_items='stretch', border='solid', height='550px', width='37%')
-    frame1=widgets.Output()
-    #frame1=widgets.VBox([output1,output4])
-    frame2=widgets.VBox([output2,controloutput1])
-    frame1.layout=box_layout1
-    frame2.layout=box_layout2
-    output3.layout=box_layout2
+    box_layout1 = widgets.Layout(display='flex', flew_flow='column',\
+                                 overflow = 'scroll hidden', align_items='stretch',\
+                                 border='solid', height='550px', width='26%')
+    box_layout2 = widgets.Layout(display='flex', flew_flow='column',\
+                                 overflow = 'scroll hidden', align_items='stretch',\
+                                 border='solid', height='550px', width='37%')
+    frame1 = widgets.Output()
+    #frame1 = widgets.VBox([output1, output4])
+    frame2 = widgets.VBox([output2, controloutput1])
+    frame1.layout = box_layout1
+    frame2.layout = box_layout2
+    output3.layout = box_layout2
 
     l = widgets.jslink((dataname, 'value'), (figname, 'value'))
     
-    accordion = widgets.Accordion(children=[output, output4], titles=('Create Result', 'Result Combination'),layout=widgets.Layout(width='98.5%'))
+    accordion = widgets.Accordion(children = [output, output4],\
+                                  titles = ('Create Result', 'Result Combination'),\
+                                  layout = widgets.Layout(width='98.5%'))
     with frame1:
         display(accordion)
 
-    display(widgets.HBox([frame1,frame2,output3]))
+    display(widgets.HBox([frame1, frame2, output3]))
```

### Comparing `MCPoly-0.5.1.3/MCPoly/status/status.py` & `MCPoly-0.6b1/MCPoly/status/status.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,673 +1,731 @@
 import re
 import os
 import sys
+import py3Dmol
 import matplotlib.pyplot as plt
 from ipywidgets import interact
 import ipywidgets as iw
-import py3Dmol
 from rdkit import Chem
 from rdkit.Chem.Draw import IPythonConsole
 from rdkit.Chem import rdDetermineBonds
 
-def status_judge(s1,s2,converge):
-    if s1==0 or s1==4 or s1==41:
-        if s1==0:
+def status_judge(s1, s2, converge):
+    if s1 == 0 or s1 == 4 or s1 == 41:
+        if s1 == 0:
             print('The Optimization is processing.')
-        elif s1==4 and s2==0:
+        elif s1 == 4 and s2 == 0:
             print('The Optimization is aborted.')
-        elif s1==41:
-            print('The Optimization is aborted.\n The structure includes 180 or 0 degrees angles.')
+        elif s1 == 41:
+            print('The Optimization is aborted.\n\
+                The structure includes 180 or 0 degrees angles.')
         print('Last time:')
         print('Energy change: {0}'.format(converge[-5]))
-        print('RMS gradient: {0}             MAX gradient: {0}'.format(converge[-4],converge[-3]))
-        print('RMS step: {0}                 MAX step: {0}'.format(converge[-2],converge[-1]))
-    if s1!=0 and s2<0:
+        print('RMS gradient: {0}             MAX gradient: {0}'.format(
+            converge[-4], converge[-3]))
+        print('RMS step: {0}                 MAX step: {0}'.format(
+            converge[-2], converge[-1]))
+    if s1 != 0 and s2<0:
         print('The Optimization was finished.')
-        if s1==4 or s1>=40:
+        if s1 == 4 or s1 >= 40:
             print('The frequency calculation is aborted.')
-            if s1==41:
-                print('There are some 0 or 180 degrees angles.\n Try to rebuild the system.')
+            if s1 == 41:
+                print('There are some 0 or 180 degrees angles.\n\
+                Try to rebuild the system.')
             return None
-        if s2==-1:
+        if s2 == -1:
             print('The CP-SCF equations are forming.')
-        elif s2==-2:
+        elif s2 == -2:
             print('The CP-SCF equations are solving.')
-        elif s2==-3:
+        elif s2 == -3:
             print('The Thermodynamics Calculation was processing.')
-    if s2==1:
+    if s2 == 1:
         print('The Thermodynamics Calculation was finished.')
-    if s2==9 and s1==6:
-        print('The Thermodynamics Calculation was finished, but the optimization did not converge but reached the maximum number of optimization cycles.')
+    if s2 == 9 and s1 == 6:
+        print('The Thermodynamics Calculation was finished, but\
+            the optimization did not converge and only\
+            reached the maximum number of optimization cycles.')
         
-def statusfig(energy,choose,num=-1):
-    t=range(len(energy))
-    if choose==0:
-        plt.plot(t,energy,'x-')
+def statusfig(energy, choose, num=-1):
+    t = range(len(energy))
+    if choose == 0:
+        plt.plot(t, energy, 'x-')
     else:
-        plt.plot(t[-choose:],energy[-choose:],'x-')
-    if num>=0:
-        #plt.plot(num,energy[num],'r',markersize=12)
-        plt.scatter(num,energy[num],s=40,c='r')
+        plt.plot(t[-choose:], energy[-choose:], 'x-')
+    if num >= 0:
+        #plt.plot(num, energy[num], 'r', markersize=12)
+        plt.scatter(num, energy[num], s=40, c='r')
     plt.show()
 
-def higeo(file,num):
-    energy=status(file,figureonly=True)
-    statusfig(energy,0,num)
+def higeo(file, num):
+    energy = status(file, figureonly=True)
+    statusfig(energy, 0, num)
     
 def cleanup_qm9_xyz(fname):
     ind = open(fname).readlines()
     nAts = int(ind[0])
     # There are two smiles in the data: the one from GDB and the one assigned from the
     # 3D coordinates in the QM9 paper using OpenBabel (I think).
-    gdb_smi,relax_smi = ind[-2].split()[:2]
+    gdb_smi, relax_smi = ind[-2].split()[:2]
     ind[1] = '\n'
     ind = ind[:nAts+2]
-    for i in range(2,nAts+2):
+    for i in range(2, nAts+2):
         l = ind[i]
         l = l.split('\t')
         l.pop(-1)
         ind[i] = '\t'.join(l)+'\n'
     ind = ''.join(ind)
-    return ind,gdb_smi,relax_smi
+    return ind, gdb_smi, relax_smi
 
-def draw_with_spheres(mol,width,height):
-    v = py3Dmol.view(width=width,height=height)
-    IPythonConsole.addMolToView(mol,v)
+def draw_with_spheres(mol, width, height):
+    v = py3Dmol.view(width=width, height=height)
+    IPythonConsole.addMolToView(mol, v)
     v.zoomTo()
-    v.setStyle({'sphere':{'radius':0.4},'stick':{'radius':0.1}});
+    v.setStyle({'sphere':{'radius':0.4}, 'stick':{'radius':0.1}});
     v.show()
     return v
 
-def multicreatemol(filename,turn,width,height,MD=False):
-    if MD==True:
+def multicreatemol(filename, turn, width, height, MD=False):
+    if MD == True:
         try:
-            ind = open('{0}_dump.xyz'.format(filename),'r+')
+            ind = open('{0}_dump.xyz'.format(filename), 'r+')
         except:
-            raise FileNotFoundError('Perhaps your _dump.xyz file has some errors. Please check the location of your _dump.xyz file and then modify your file.')
+            raise FileNotFoundError('Perhaps your _dump.xyz file has some errors.\
+            Please check the location of\
+            your _dump.xyz file and then modify your file.')
     else:
         try:
-            ind = open('{0}_trj.xyz'.format(filename),'r+')
+            ind = open('{0}_trj.xyz'.format(filename), 'r+')
         except:
-            raise FileNotFoundError('Perhaps your _trj.xyz file has some errors. Please check the location of your _trj.xyz file and then modify your file.')
+            raise FileNotFoundError('Perhaps your _trj.xyz file has some errors.\
+            Please check the location of\
+            your _trj.xyz file and then modify your file.')
     mains = ind.readlines()
-    num=eval(mains[0][:-1])
-    term=len(mains)/(num+2)
-    main=''
-    partmain=mains[turn*(num+2):(turn+1)*(num+2)]
-    for i,line in enumerate(partmain):
-        if i==1:
-            main=main+'\n'
+    num = eval(mains[0][:-1])
+    term = len(mains)/(num+2)
+    main = ''
+    partmain = mains[turn*(num+2):(turn+1)*(num+2)]
+    for i, line in enumerate(partmain):
+        if i == 1:
+            main = main + '\n'
         else:
-            main=main+partmain[i]
+            main = main + partmain[i]
     #print(main)
     raw_mol = Chem.MolFromXYZBlock(main)
     conn_mol = Chem.Mol(raw_mol)
     rdDetermineBonds.DetermineConnectivity(conn_mol)
-    v=draw_with_spheres(conn_mol,width,height)
+    v = draw_with_spheres(conn_mol, width, height)
     return v
 
-def normalstatus(loc,file,choose=0,figureonly=False,statusonly=False,MD=False):
+def normalstatus(loc, file, choose=0, figureonly=False,\
+                 statusonly=False, MD=False):
     path = os.getcwd()
     os.chdir(loc)
-    file=file+'.out'
-    if figureonly==False and statusonly==False:
+    file = file + '.out'
+    if figureonly == False and statusonly == False:
         print(file)
-    s1=0
-    s2=0
-    term=0
-    f=open(file,'r')
-    x=0
-    energy=[]
-    converge=[]
-    if MD==False:
+    s1 = 0
+    s2 = 0
+    term = 0
+    f = open(file, 'r')
+    x = 0
+    energy = []
+    converge = []
+    if MD == False:
         for line in f:
-            a=re.search('FINAL SINGLE POINT ENERGY',line)
+            a = re.search('FINAL SINGLE POINT ENERGY', line)
             if a:
-                a2=re.search(r'-[0-9]+\.[0-9]+',line)
+                a2 = re.search(r'-[0-9]+\.[0-9]+', line)
                 energy.append(eval(a2.group(0)))
-            x1=re.search('OPTIMIZATION RUN DONE',line)
+            x1 = re.search('OPTIMIZATION RUN DONE', line)
             if x1:
-                s1=1
-            if s1==1:
-                in1=re.search('Forming right-hand sides of CP-SCF equations',line)
+                s1 = 1
+            if s1 == 1:
+                in1 = re.search('Forming right-hand sides of CP-SCF equations', line)
                 if in1:
-                    s2=-1
-                in2=re.search('Solving the CP-SCF equations',line)
+                    s2 = -1
+                in2 = re.search('Solving the CP-SCF equations', line)
                 if in2:
-                    s2=-2
-                in3=re.search('VIBRATIONAL FREQUENCIES',line)
+                    s2 = -2
+                in3 = re.search('VIBRATIONAL FREQUENCIES', line)
                 if in3:
-                    s2=-3
-            x2=re.search('ORCA TERMINATED NORMALLY',line)
+                    s2 = -3
+            x2 = re.search('ORCA TERMINATED NORMALLY', line)
             if x2:
-                if s1!=6:
-                    s2=9
+                if s1 == 6:
+                    s2 = 9
                 else:
-                    s2=0
-            t=re.search('GEOMETRY OPTIMIZATION CYCLE',line)
+                    s2 = 0
+            t = re.search('GEOMETRY OPTIMIZATION CYCLE', line)
             if t:
-                t2=re.search(r'[0-9]+',line)
-                term=t2.group(0)
-            c=re.search('-|Geometry convergence|-',line)
+                t2 = re.search(r'[0-9]+', line)
+                term = t2.group(0)
+            c = re.search('-|Geometry convergence|-', line)
             if c:
-                x=1
-            if x==2:
-                yes=re.search('YES',line)
-                no=re.search('NO',line)
+                x = 1
+            if x == 2:
+                yes = re.search('YES', line)
+                no = re.search('NO', line)
                 if yes:
                     converge.append('YES')
                 if no:
                     converge.append('NO')
-                u=re.search('-------------------------',line)
+                u = re.search('-------------------------', line)
                 if u:
-                    x=0
-            if x==1:
-                u=re.search('-------------------------',line)
+                    x = 0
+            if x == 1:
+                u = re.search('-------------------------', line)
                 if u:
-                    x=2
-            x3=re.search('aborting the run',line)
+                    x = 2
+            x3 = re.search('aborting the run', line)
             if x3:
-                s1=4
-            x3=re.search('ANGLE IS APPROACHING 180',line)
+                s1 = 4
+            x3 = re.search('ANGLE IS APPROACHING 180', line)
             if x3:
-                s1=41
+                s1 = 41
                 break
-            x4=re.search('did not converge but reached',line)
+            x4 = re.search('did not converge but reached', line)
             if x4:
-                s1=6
+                s1 = 6
     else:
-        s2=1
-        ii=0
-        gap=0
+        s1 = 0
+        s2 = 0
+        ii = 0
+        gap = 0
         for line in f:
-            x0=re.search('Dump Position Stride [0-9]+',line)
+            x2 = re.search('ERROR', line)
+            if x2:
+                s1 = 4
+                break
+            x3 = re.search('ORCA TERMINATED NORMALLY', line)
+            if x3:
+                s1 = 1
+        for line in f:
+            x0 = re.search('Dump Position Stride [0-9]+', line)
             if x0:
-                y0=re.search(r'[0-9]+',x0.group(0))
-                gap=eval(y0.group(0))
-            x1=re.findall('\-\|',line)
-            if len(x1)>3:
-                if ii==0:
-                    ii=1
+                y0 = re.search(r'[0-9]+', x0.group(0))
+                gap = eval(y0.group(0))
+            x1 = re.findall('\-\|', line)
+            if len(x1) > 3:
+                if ii == 0:
+                    ii = 1
                 else:
                     break
-            elif ii==1:
-                alls=re.findall(r'\-*[0-9]+\.*[0-9]*',line)
-                if alls[0]=='0':
+            elif ii == 1:
+                alls = re.findall(r'\-*[0-9]+\.*[0-9]*', line)
+                if alls[0] == '0':
                     energy.append(eval(alls[-1]))
                 else:
-                    if eval(alls[0])%gap==0:
+                    if eval(alls[0]) % gap == 0:
                         energy.append(eval(alls[-3]))
+            
     f.close()
-    if statusonly==True:
-        if s1==1:
+    if statusonly == True:
+        if s1 == 1 and s2 == 0:
+            os.chdir(path)
             return 2
         else:
+            os.chdir(path)
             return s1
-    if figureonly==False and MD==False:
+    if figureonly == False and MD == False:
         print('{0} turns have been calculated.'.format(term))
-        status_judge(s1,s2,converge)
-        statusfig(energy,choose)
-    elif figureonly==False and MD==True:
+        status_judge(s1, s2, converge)
+        statusfig(energy, choose)
+    elif figureonly == False and MD == True:
         print('{0} turns have been calculated.'.format(len(energy)))
-        statusfig(energy,choose)
+        statusfig(energy, choose)
     os.chdir(path)
     return energy
 
 def thermo(loc, file, keyword):
-    f=open(file+'.out','r')
+    path = os.getcwd()
+    os.chdir(loc)
+    f = open(file+'.out', 'r')
     for line in f:
-        if keyword=='Gibbs':
-            a=re.search('Final Gibbs free energy', line)
+        if keyword == 'Gibbs':
+            a = re.search('Final Gibbs free energy', line)
             if a:
-                b=re.search(r'-[0-9]+\.[0-9]+', line)
+                b = re.search(r'-[0-9]+\.[0-9]+', line)
+                os.chdir(path)
                 return '{0:.6f}'.format(eval(b.group(0)))
-        if keyword=='Enthalpy':
-            a=re.search('Total enthalpy', line)
+        if keyword == 'Enthalpy':
+            a = re.search('Total enthalpy', line)
             if a:
-                b=re.search(r'-[0-9]+\.[0-9]+', line)
+                b = re.search(r'-[0-9]+\.[0-9]+', line)
+                os.chdir(path)
                 return '{0:.6f}'.format(eval(b.group(0)))
-        if keyword=='Entropy':
-            a=re.search('Total entropy correction', line)
+        if keyword == 'Entropy':
+            a = re.search('Total entropy correction', line)
             if a:
-                b=re.findall(r'-[0-9]+\.[0-9]+', line)
+                b = re.findall(r'-[0-9]+\.[0-9]+', line)
+                os.chdir(path)
                 return '{0:.6f}'.format(eval(b[0]))
-    raise Exception("'{0}.out' may not have keyword freq, or it's aborted. Please check your input file and recalculate it.".format(file))
+    os.chdir(path)
+    raise Exception("'{0}.out' may not have keyword freq, or it's aborted.\
+        Please check your input file and recalculate it.".format(file))
 
 def charge(loc, file, num, keyword):
-    f=open(file+'.out','r')
-    i=0
-    ac=[None]*200
+    f = open(loc+file+'.out', 'r')
+    i = 0
+    ac = [None] * 200
     for line in f:
-        if keyword=='Mulliken':
-            d=re.search('Sum of atomic charges',line)
+        if keyword == 'Mulliken':
+            d = re.search('Sum of atomic charges', line)
             if d:
-                i=0
-            a=re.search('MULLIKEN ATOMIC CHARGES',line)
+                i = 0
+            a = re.search('MULLIKEN ATOMIC CHARGES', line)
             if a:
-                i=1
-            if i==1:
-                b=re.search(r'-?[0-9]+\.[0-9]+', line)
+                i = 1
+            if i == 1:
+                b = re.search(r'-?[0-9]+\.[0-9]+', line)
                 if b:
-                    n=re.findall(r'[0-9]+', line)
-                    ac[eval(n[0])]=eval(b.group(0))
-        elif keyword=='Loewdin':
-            a=re.search('LOEWDIN ATOMIC CHARGES',line)
+                    n = re.findall(r'[0-9]+', line)
+                    ac[eval(n[0])] = eval(b.group(0))
+        elif keyword == 'Loewdin':
+            a = re.search('LOEWDIN ATOMIC CHARGES', line)
             if a:
-                i=1
-            if i==1:
-                b=re.search(r'-?[0-9]+\.[0-9]+', line)
+                i = 1
+            if i == 1:
+                b = re.search(r'-?[0-9]+\.[0-9]+', line)
                 if b:
-                    n=re.findall(r'[0-9]+', line)
-                    ac[eval(n[0])]=eval(b.group(0))
-            d=re.search('LOEWDIN REDUCED ORBITAL CHARGES',line)
+                    n = re.findall(r'[0-9]+', line)
+                    ac[eval(n[0])] = eval(b.group(0))
+            d = re.search('LOEWDIN REDUCED ORBITAL CHARGES', line)
             if d:
-                i=0
+                i = 0
     return ac[num]
 
-def atoms_all(loc, file):
-    f=open(file+'.out','r')
-    i=0
-    n=0
-    atoms=[['NOT','99999','99999','99999']]*200
-    elements=['NOT']*200
-    xyzs=[['99999','99999','99999']]*200
+def AtomsAll(loc, file):
+    path = os.getcwd()
+    os.chdir(loc)
+    f = open(file+'.out', 'r')
+    i = 0
+    n = 0
+    atoms = [['NOT', '99999', '99999', '99999']] * 200
+    elements = ['NOT'] * 200
+    xyzs = [['99999', '99999', '99999']] * 200
     for line in f:
-        d=re.search('CARTESIAN COORDINATES \(A\.U\.\)',line)
+        d = re.search('CARTESIAN COORDINATES \(A\.U\.\)', line)
         if d:
-            i=0
-            n=0
-        if i==1:
-            b=re.search(r'[A-Z][a-z]*', line)
+            i = 0
+            n = 0
+        if i == 1:
+            b = re.search(r'[A-Z][a-z]*', line)
             if b:
-                xyz=re.findall(r'-?[0-9]+\.[0-9]+', line)
+                xyz = re.findall(r'-?[0-9]+\.[0-9]+', line)
                 try:
-                    elements[n]=b.group(0)
+                    elements[n] = b.group(0)
                 except:
                     elements.append(b.group(0))
                 try:
-                    xyzs[n]=xyz
+                    xyzs[n] = xyz
                 except:
                     xyzs.append(xyz)
                 try:
-                    atoms[n]=[b.group(0),eval(xyz[0]),eval(xyz[1]),eval(xyz[2])]
+                    atoms[n] = [b.group(0), eval(xyz[0]), eval(xyz[1]), eval(xyz[2])]
                 except:
-                    atoms.append([b.group(0),eval(xyz[0]),eval(xyz[1]),eval(xyz[2])])
-                n=n+1
-        a=re.search('CARTESIAN COORDINATES \(ANGSTROEM\)',line)
+                    atoms.append([b.group(0), eval(xyz[0]), eval(xyz[1]), eval(xyz[2])])
+                n = n + 1
+        a = re.search('CARTESIAN COORDINATES \(ANGSTROEM\)', line)
         if a:
-            i=1
+            i = 1
     while 1:
         try:
-            atoms.remove(['NOT','99999','99999','99999'])
+            atoms.remove(['NOT', '99999', '99999', '99999'])
             elements.remove('NOT')
-            xyzs.remove(['99999','99999','99999'])
+            xyzs.remove(['99999', '99999', '99999'])
         except:
             break
     f.close()
+    os.chdir(path)
     return atoms
 
-def atoms_all_xyz(loc, file):
-    f=open(file+'.xyz','r')
-    atoms=[['NOT','99999','99999','99999']]*200
-    elements=['NOT']*200
-    xyzs=[['99999','99999','99999']]*200
-    i=0
+def AtomsAllXyz(loc, file, error_from_no_out = False):
+    if error_from_no_out == False:
+        path = os.getcwd()
+        os.chdir(loc)
+    else:
+        pass
+    print(os.getcwd())
+    f = open(file+'.xyz', 'r')
+    atoms = [['NOT', '99999', '99999', '99999']] * 200
+    elements = ['NOT'] * 200
+    xyzs = [['99999', '99999', '99999']] * 200
+    i = 0
     for line in f:
-        b=re.findall(r'-?[0-9]+\.[0-9]+', line)
-        if len(b)==3:
-            ele=re.search(r'[A-Z][a-z]?', line)
+        b = re.findall(r'-?[0-9]+\.[0-9]+', line)
+        if len(b) == 3:
+            ele = re.search(r'[A-Z][a-z]?', line)
             try:
-                atoms[i]=[ele.group(0),eval(b[0]),eval(b[1]),eval(b[2])]
+                atoms[i] = [ele.group(0), eval(b[0]), eval(b[1]), eval(b[2])]
             except:
-                atoms.append([ele.group(0),eval(b[0]),eval(b[1]),eval(b[2])])
-        i=i+1
+                atoms.append([ele.group(0), eval(b[0]), eval(b[1]), eval(b[2])])
+        i = i + 1
     while 1:
         try:
-            atoms.remove(['NOT','99999','99999','99999'])
+            atoms.remove(['NOT', '99999', '99999', '99999'])
             elements.remove('NOT')
-            xyzs.remove(['99999','99999','99999'])
+            xyzs.remove(['99999', '99999', '99999'])
         except:
             break
     f.close()
+    if error_from_no_out == False:
+        os.chdir(path)
+    else:
+        pass
     return atoms
 
 class status:
     """
     A method to see the current process of the ORCA optimisation, including convergence situation and relevant energy chart.
     status(file, loc='./')
     file: File Name.
     loc: File Location. The default is your current location.
     You can get the further information by .status and .figures.
     """
 
-    def __init__(self,file,loc='./'):
-        self.file=file
-        self.loc=loc
+    def __init__(self, file, loc='./'):
+        self.file = file
+        self.loc = loc
     
-    def status(self,choose=0,figureonly=False,statusonly=False):
+    def status(self, choose=0, figureonly=False, statusonly=False, MD=False):
         """
     A method to see the current process of the ORCA optimisation, including convergence situation and relevant energy chart.
-    status(choose=0, figureonly=False, statusonly=False,last=-1)
+    status(choose=0, figureonly=False, statusonly=False, last=-1)
     choose: See the latest energy process. e.g. When choose=5, it will show the last five energy data on the chart.
     figureonly: If 'figureonly' is True, the code will show no status information. The default is False.
     statusonly: If 'statusonly' is True, the code will output the current process status only, not energy. 
                 in output s, 0 means the system is optimising, 1 means the system completes the optimisation and starts frequency calculation, 2 means the process is completed, 4 means the process is aborted.
                 The default is False.
                 TIPS: Kill ORCA process with problems other than ORCA will get the output of 0.
     Normally, the output of this function is the energy change in optimisation, unless statusonly=True.
     Example 1:
         Input:
             from MCPoly import status
-            a=status('Et','/Molecule').status()
+            a = status('Et', '/Molecule').status()
         
         Output:
             Et.out
             8 turns have been calculated.
             The Thermodynamics Calculation was finished.
             <chart from matplotlib>
             
     Example 2:
         Input:
             from MCPoly import status
-            a=status('Molecule 1','/Molecule').status(figureonly=True)
+            a = status('Molecule 1', '/Molecule').status(figureonly=True)
             print(a)
         
         Output:
             [-1729.508137253801, -1729.505855679262, -1729.501743481437, -1729.499301095603, -1729.499960765849, 
              -1729.499875258488, -1729.500097690162, -1729.500368245231, -1729.500825118936, -1729.501319993802, 
              -1729.503640287060, -1729.505369082598, -1729.507234351098, -1729.508676755388, ...]
     
     Example 3:
         Input:
             from MCPoly import status
-            a=status('SI5_0.5','../Sulphur').status(figureonly=True,statusonly=True)
+            a = status('SI5_0.5', '../Sulphur').status(figureonly=True, statusonly=True)
             print(a)
         
         Output:
             2
         """
 
-        return normalstatus(self.loc,self.file,choose,figureonly,statusonly)
+        return normalstatus(self.loc, self.file, choose, figureonly, statusonly, MD)
     
     def energy(self):
         """
     A method to see the final(or latest) Energy of a system.
     energy()
         """
-        E=normalstatus(self.loc,self.file,figureonly=True)
+        E = normalstatus(self.loc, self.file, figureonly=True)
         return eval('{0:.6f}'.format(E[-1]))
 
-    def converged_energy(self,unit='Eh'):
+    def converged_energy(self, unit='Eh'):
         """
     A method to see the Converged Energy of a system.
     converged_energy(unit)
     unit: Energy unit, including 'Eh' and 'kcal/mol'. The default is 'Eh' (Hartree).
         """
-        E=normalstatus(self.loc,self.file,figureonly=True)
-        state=normalstatus(self.loc,self.file,figureonly=True,statusonly=True)
-        if state!=2:
+        E = normalstatus(self.loc, self.file, figureonly=True)
+        state = normalstatus(self.loc, self.file, figureonly=True, statusonly=True)
+        if state != 2:
             raise Exception("This optimisation of '{0}.out' is failed. No converged energy.".format(self.file))
         else:
-            x=eval('{0:.6f}'.format(E[-1]))
-            if unit=='Eh':
+            x = eval('{0:.6f}'.format(E[-1]))
+            if unit == 'Eh':
                 return x
-            elif unit=='kcal/mol':
-                return x*627.509
+            elif unit == 'kcal/mol':
+                return x * 627.509
     
-    def gibbs(self,unit='Eh'):
+    def gibbs(self, unit='Eh'):
         """
     A method to see the Gibbs Free Energy of a system.
     gibbs(unit)
     unit: Energy unit, including 'Eh' and 'kcal/mol'. The default is 'Eh' (Hartree).
     TIPS: Make sure the optimisation includes key word 'freq', which means frequency calculation.
         """
-        x=eval(thermo(self.loc,self.file,keyword='Gibbs'))
-        if unit=='Eh':
+        x = eval(thermo(self.loc, self.file, keyword='Gibbs'))
+        if unit == 'Eh':
             return x
-        elif unit=='kcal/mol':
-            return x*627.509
+        elif unit == 'kcal/mol':
+            return x * 627.509
     
-    def enthalpy(self,unit='Eh'):
+    def enthalpy(self, unit='Eh'):
         """
     A method to see the total enthalpy of a system.
     enthalpy(unit)
     unit: Energy unit, including 'Eh' and 'kcal/mol'. The default is 'Eh' (Hartree).
     TIPS: Make sure the optimisation includes key word 'freq', which means frequency calculation.
         """
-        x=eval(thermo(self.loc,self.file,keyword='Enthalpy'))
-        if unit=='Eh':
+        x = eval(thermo(self.loc, self.file, keyword='Enthalpy'))
+        if unit == 'Eh':
             return x
-        elif unit=='kcal/mol':
-            return x*627.509
+        elif unit == 'kcal/mol':
+            return x * 627.509
     
-    def entropy_correction(self,unit='Eh'):
+    def entropy_correction(self, unit='Eh'):
         """
     A method to see the total entropy correction of a system.
     enthalpy(unit)
     unit: Energy unit, including 'Eh' and 'kcal/mol'. The default is 'Eh' (Hartree).
     TIPS: Make sure the optimisation includes key word 'freq', which means frequency calculation.
         """
-        x=eval(thermo(self.loc,self.file,keyword='Entropy'))
-        if unit=='Eh':
+        x = eval(thermo(self.loc, self.file, keyword='Entropy'))
+        if unit == 'Eh':
             return x
-        elif unit=='kcal/mol':
-            return x*627.509
+        elif unit == 'kcal/mol':
+            return x * 627.509
     
-    def mulliken_charge(self,num):
+    def mulliken_charge(self, num):
         """
     A method to see the Mulliken Charge of an atom.
     mulliken_charge(num)
     num: Atom number.
     TIPS: The atom starts from 0. Don't surpass the maximum, or it will cause error.
         """
-        x=charge(self.loc,self.file,num,keyword='Mulliken')
+        x = charge(self.loc, self.file, num, keyword='Mulliken')
         return x
     
-    def loewdin_charge(self,num):
+    def loewdin_charge(self, num):
         """
     A method to see the Loewdin Charge of an atom.
     loewdin_charge(num)
     num: Atom number.
     TIPS: The atom starts from 0. Don't surpass the maximum, or it will cause error.
         """
-        x=charge(self.loc,self.file,num,keyword='Loewdin')
+        x=charge(self.loc, self.file, num, keyword='Loewdin')
         return x
 
     def atom(self):
         """
     A method to find out the atom information of the system.
     atom()
     
     TIPS: In the following list, a piece of atom information is like that:
         ['C', 4.11199532065866, 1.93907233706568, -1.49149364116961]
-        The first one is the element type, the following three numbers are location in x,y,z-axis.
+        The first one is the element type, the following three numbers are location in x, y, z-axis.
         """
         try:
-            return atoms_all(self.loc,self.file)
+            return AtomsAll(self.loc, self.file)
         except:
-            return atoms_all_xyz(self.loc,self.file)
+            return AtomsAllXyz(self.loc, self.file, error_from_no_out = True)
     
     def mass(self):
         """
     A method to find out the mass of all particles in system.
     mass()
         """
-        M=0
+        M = 0
         try:
-            x=atoms_all(self.loc,self.file)
+            x = AtomsAll(self.loc, self.file)
         except:
-            x=atoms_all_xyz(self.loc,self.file)
+            x = AtomsAllXyz(self.loc, self.file, error_from_no_out = True)
         for i in x:
-            if i[0]=='H':
-                M=M+1.008
-            elif i[0]=='C':
-                M=M+12.011
-            elif i[0]=='O':
-                M=M+15.999
-            elif i[0]=='Li':
-                M=M+6.94
-            elif i[0]=='Be':
-                M=M+9.0122
-            elif i[0]=='B':
-                M=M+10.81
-            elif i[0]=='N':
-                M=M+14.007
-            elif i[0]=='F':
-                M=M+18.998
-            elif i[0]=='Na':
-                M=M+22.990
-            elif i[0]=='Mg':
-                M=M+24.305
-            elif i[0]=='Al':
-                M=M+26.982
-            elif i[0]=='Si':
-                M=M+28.085
-            elif i[0]=='P':
-                M=M+30.974
-            elif i[0]=='S':
-                M=M+32.06
-            elif i[0]=='Cl':
-                M=M+35.45
-            elif i[0]=='Br':
-                M=M+79.904
-            elif i[0]=='I':
-                M=M+126.90
-            elif i[0]=='K':
-                M=M+39.098
-            elif i[0]=='Ca':
-                M=M+40.078
-            elif i[0]=='Ti':
-                M=M+47.867
-            elif i[0]=='Cr':
-                M=M+51.996
-            elif i[0]=='Mn':
-                M=M+54.938
-            elif i[0]=='Fe':
-                M=M+55.845
-            elif i[0]=='Co':
-                M=M+58.933
-            elif i[0]=='Ni':
-                M=M+58.693
-            elif i[0]=='Cu':
-                M=M+63.546
-            elif i[0]=='Zn':
-                M=M+65.38
-            elif i[0]=='Ru':
-                M=M+101.07
-            elif i[0]=='Rh':
-                M=M+102.91
-            elif i[0]=='Ag':
-                M=M+107.87
-            elif i[0]=='Ir':
-                M=M+192.22
-            elif i[0]=='Pt':
-                M=M+195.08
-            elif i[0]=='Au':
-                M=M+196.97
-            elif i[0]=='Hg':
-                M=M+200.59
+            if i[0] == 'H':
+                M = M + 1.008
+            elif i[0] == 'C':
+                M = M + 12.011
+            elif i[0] == 'O':
+                M = M + 15.999
+            elif i[0] == 'Li':
+                M = M + 6.94
+            elif i[0] == 'Be':
+                M = M + 9.0122
+            elif i[0] == 'B':
+                M = M + 10.81
+            elif i[0] == 'N':
+                M = M + 14.007
+            elif i[0] == 'F':
+                M = M + 18.998
+            elif i[0] == 'Na':
+                M = M + 22.990
+            elif i[0] == 'Mg':
+                M = M + 24.305
+            elif i[0] == 'Al':
+                M = M + 26.982
+            elif i[0] == 'Si':
+                M = M + 28.085
+            elif i[0] == 'P':
+                M = M + 30.974
+            elif i[0] == 'S':
+                M = M + 32.06
+            elif i[0] == 'Cl':
+                M = M + 35.45
+            elif i[0] == 'Br':
+                M = M + 79.904
+            elif i[0] == 'I':
+                M = M + 126.90
+            elif i[0] == 'K':
+                M = M + 39.098
+            elif i[0] == 'Ca':
+                M = M + 40.078
+            elif i[0] == 'Ti':
+                M = M + 47.867
+            elif i[0] == 'Cr':
+                M = M + 51.996
+            elif i[0] == 'Mn':
+                M = M + 54.938
+            elif i[0] == 'Fe':
+                M = M + 55.845
+            elif i[0] == 'Co':
+                M = M + 58.933
+            elif i[0] == 'Ni':
+                M = M + 58.693
+            elif i[0] == 'Cu':
+                M = M + 63.546
+            elif i[0] == 'Zn':
+                M = M + 65.38
+            elif i[0] == 'Ru':
+                M = M + 101.07
+            elif i[0] == 'Rh':
+                M = M + 102.91
+            elif i[0] == 'Ag':
+                M = M + 107.87
+            elif i[0] == 'Ir':
+                M = M + 192.22
+            elif i[0] == 'Pt':
+                M = M + 195.08
+            elif i[0] == 'Au':
+                M = M + 196.97
+            elif i[0] == 'Hg':
+                M = M + 200.59
         return M
     
     def atom_num(self):
         """
     A method to find out the atom number of the system.
     atom_num()
         """
-        return len(atoms_all(self.loc,self.file))
+        return len(AtomsAll(self.loc, self.file))
+    
+    def steps(self, MD=False):
+        """
+    A method to know the total steps of the ORCA runs.
+    TIPS: Make sure your _dump.xyz file is in the document with .out file, or there will be FileNotFoundError!!!
+    
+    steps(MD=False)
+    MD: See the single status of Molecular Dynamics (MD). The default is False.
+        """
+        figure = normalstatus(self.loc, self.file, figureonly=True, MD=MD)
+        return len(figure) - 1
     
-    def figure(self,num=0,width=300,height=300,MD=False,save=''):
+    def figure(self, num=0, width=300, height=300, MD=False, save=''):
         """
     A method to see the current geometry structure of the ORCA optimisation, powered by py3Dmol and rdkit.
     TIPS: Make sure your _trj.xyz file is in the document with .out file, or there will be NoFileFoundError!!!
     
-    figure(num=0, width=300, height=300,MD=False,save='')
+    figure(num=0, width=300, height=300, MD=False, save='')
     num: The step of your convergence.
     width, height: The size of your 3D geometry molecule strcuture. Default: 300x300.
     MD: See the single status of Molecular Dynamics (MD). The default is False.
     save: The name of the single status XYZ file you want to save. The default is not saving the single status.
         """
             
-        figure=normalstatus(self.loc,self.file,figureonly=True,MD=MD)
-        file=self.file
+        figure = normalstatus(self.loc, self.file, figureonly=True, MD=MD)
+        file = self.file
         try:
             path = os.getcwd()
             os.chdir(self.loc)
             multicreatemol(file, num, width, height)
             os.chdir(path)
         except:
             raise ValueError("The index 'num' is out of range.")
         
-    def figuretraj(self,num=0,width=300,height=300):
+    def figuretraj(self, num=0, width=300, height=300):
         """
     A method to see the current geometry structure and optimization trajectory of the ORCA optimisation, powered by py3Dmol and ipywidgets package.
     TIPS: Make sure your _trj.xyz file is in the document with .out file, or there will be FileNotFoundError!!!
     
     figurestatus(num=0, width=300, height=300)
     num: The step of your convergence. The default is the origin structure.
     width, height: The size of your 3D geometry molecule strcuture. Default: 300x300.
     After forming the 3D geometry molecule strcuture, you can scroll to see other structures of relevant molecules.
         """
             
-        figure=normalstatus(self.loc,self.file,figureonly=True)
-        file=self.file
+        figure = normalstatus(self.loc, self.file, figureonly=True)
+        file = self.file
         def turn(num):
             try:
                 path = os.getcwd()
                 os.chdir(self.loc)
                 multicreatemol(file, num, width, height)
                 os.chdir(path)
             except:
-                if num==len(figure)-1:
+                if num == len(figure) - 1:
                     print("The last step hasn't been optimised yet.")
-        interact(turn,num=iw.IntSlider(min=0,max=len(figure)-1,step=1,value=num))
+        interact(turn, num=iw.IntSlider(min=0, max=len(figure)-1, step=1, value=num))
     
-    def figuremd(self,num=0,width=300,height=300):
+    def figuremd(self, num=0, width=300, height=300):
         """
     A method to see the current geometry structure and optimization trajectory of the ORCA Molecular Dynamics, powered by py3Dmol and ipywidgets package.
     TIPS: Make sure your _dump.xyz file is in the document with .out file, or there will be FileNotFoundError!!!
     
     figuremd(num=0, width=300, height=300)
     num: The step of your convergence. The default is the origin structure.
     width, height: The size of your 3D geometry molecule strcuture. Default: 300x300.
     After forming the 3D geometry molecule strcuture, you can scroll to see other structures of relevant molecules.
         """
             
-        figure=normalstatus(self.loc,self.file,figureonly=True,MD=True)
-        file=self.file
+        figure = normalstatus(self.loc, self.file, figureonly=True, MD=True)
+        file = self.file
         def turn(num):
             try:
                 path = os.getcwd()
                 os.chdir(self.loc)
                 multicreatemol(file, num, width, height, MD=True)
                 os.chdir(path)
             except:
-                if num==len(figure)-1:
+                if num == len(figure) - 1:
                     print("The last step hasn't been optimised yet.")
-        interact(turn,num=iw.IntSlider(min=0,max=len(figure),step=1,value=num))
+        interact(turn, num=iw.IntSlider(min=0, max=len(figure), step=1, value=num))
     
-    def figurecharge(self,width=300,height=300):
+    def figurecharge(self, width=300, height=300):
         """
     A method to see the Mulliken Charge of each atom base on 3D geometry structure of the system.
     TIPS: Make sure your .xyz file is in the document with .out file, or there will be FileNotFoundError!!!
     
     width, height: The size of your 3D geometry molecule strcuture. Default: 300x300.
     After forming the 3D geometry molecule strcuture, you can scroll to see the charge of the relevant atom.
         """
-        output=iw.Output()
+        output = iw.Output()
         mydir = os.path.dirname( __file__ )
         orcadir = os.path.join(mydir, '..', 'orcaset')
         sys.path.append(orcadir)
         from view3dchoose import view3dchoose
         
-        chargetype=iw.Dropdown(description='Atomic Charge Type',options=['Mulliken','Loewdin'])
-        num=iw.IntSlider(value=0,min=0,max=len(atoms_all(self.loc,self.file))-1)
+        chargetype = iw.Dropdown(description='Atomic Charge Type',\
+                                 options=['Mulliken', 'Loewdin'])
+        num = iw.IntSlider(value=0, min=0,\
+                           max=len(atoms_all(self.loc, self.file))-1)
         
         def GUI(chargetype, num):
             output.clear_output()
             with output:
-                alls=atoms_all(self.loc,self.file)
-                view3dchoose(self.file,self.loc,choose=[num],width=width,height=height)
-                print('Atom: {0}, Element: {1}, Charge: {2}'.format(num,alls[num][0],charge(self.loc,self.file,num,chargetype))) 
+                alls = atoms_all(self.loc, self.file)
+                view3dchoose(self.file, self.loc,\
+                             choose=[num], width=width, height=height)
+                print('Atom: {0}, Element: {1}, Charge: {2}'.format(num,\
+                                                                    alls[num][0], charge(self.loc, self.file, num, chargetype))) 
             
-        geoout=iw.interactive_output(GUI, {'chargetype': chargetype, 'num': num})
-        display(iw.VBox([chargetype,num,output]))
+        geoout = iw.interactive_output(GUI, {'chargetype': chargetype, 'num': num})
+        display(iw.VBox([chargetype, num, output]))
```

### Comparing `MCPoly-0.5.1.3/MCPoly/view3d/view3d.py` & `MCPoly-0.6b1/MCPoly/view3d/view3d.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,60 +1,60 @@
 import os
+import py3Dmol
 from itertools import product
 from rdkit import Chem
 from rdkit.Chem import Draw
 from rdkit.Chem.Draw import IPythonConsole
 from rdkit.Chem.Draw import MolToFile
-import py3Dmol
 from rdkit.Chem import rdDetermineBonds
 
 def cleanup_qm9_xyz(fname):
     ind = open(fname).readlines()
     nAts = int(ind[0])
     # There are two smiles in the data: the one from GDB and the one assigned from the
     # 3D coordinates in the QM9 paper using OpenBabel (I think).
-    gdb_smi,relax_smi = ind[-2].split()[:2]
+    gdb_smi, relax_smi = ind[-2].split()[:2]
     ind[1] = '\n'
     ind = ind[:nAts+2]
-    for i in range(2,nAts+2):
+    for i in range(2, nAts+2):
         l = ind[i]
         l = l.split('\t')
         l.pop(-1)
-        ind[i] = '\t'.join(l)+'\n'
+        ind[i] = '\t'.join(l) + '\n'
     ind = ''.join(ind)
-    return ind,gdb_smi,relax_smi
+    return ind, gdb_smi, relax_smi
 
-def draw_with_spheres(mol,width,height):
-    v = py3Dmol.view(width=width,height=height)
-    IPythonConsole.addMolToView(mol,v)
+def draw_with_spheres(mol, width, height):
+    v = py3Dmol.view(width=width, height=height)
+    IPythonConsole.addMolToView(mol, v)
     v.zoomTo()
-    v.setStyle({'sphere':{'radius':0.3},'stick':{'radius':0.1}});
+    v.setStyle({'sphere':{'radius':0.3}, 'stick':{'radius':0.1}});
     v.show()
 
-def view3d(filename,loc='./',width=300,height=300):
+def view3d(filename, loc = './', width=300, height=300):
     """
     A method to see the geometry structure of the ORCA optimisation, powered by py3Dmol and rdkit. Not original.
     TIPS: Make sure your .xyz file is in the document, or there will be NoFileFoundError!!!
     
-    view3d(file, loc='./', width=300, height=300)
+    view3d(file, loc = './', width=300, height=300)
     file: File Name.
     loc: File Location. The default is your current location.
     num: The step of your convergence.
     width, height: The size of your 3D geometry molecule strcuture. Default: 300x300.
     """
     path = os.getcwd()
     os.chdir(loc)
-    ind = open('{0}.xyz'.format(filename),'r+')
+    ind = open('{0}.xyz'.format(filename), 'r+')
     mains = ind.readlines()
-    main=''
-    for i,line in enumerate(mains):
-        if i==1:
-            main=main+'\n'
+    main = ''
+    for i, line in enumerate(mains):
+        if i == 1:
+            main = main + '\n'
         else:
-            main=main+mains[i]
+            main = main + mains[i]
     #print(main)
     raw_mol = Chem.MolFromXYZBlock(main)
     conn_mol = Chem.Mol(raw_mol)
     rdDetermineBonds.DetermineConnectivity(conn_mol)
-    v=draw_with_spheres(conn_mol,width,height)
+    v = draw_with_spheres(conn_mol, width, height)
     os.chdir(path)
     return v
```

### Comparing `MCPoly-0.5.1.3/MCPoly/vis/vis.py` & `MCPoly-0.6b1/MCPoly/vis/vis.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,10 +1,10 @@
-import ipywidgets as widgets
 import sys
 import os
+import ipywidgets as widgets
 
 mydir = os.path.dirname( __file__ )
 statusdir = os.path.join(mydir, '..', 'status')
 sys.path.append(statusdir)
 from status import status
 from gui import gui as gui3
 
@@ -32,21 +32,21 @@
 #from gui import gui as gui2
 
 def vis():
     """
         The method to summon all four GUI functions.
         You can see how to use by input 'MCPoly.orcaset.gui?'(Normal ORCA), 'MCPoly.orcaset.ssgui?' (Mechanical ORCA), 'MCPoly.orcaset.mgui?' (Multiple ORCA) and 'MCPoly.sscurve.gui?' (Stress-Strain Curve)
     """
-    screen1=widgets.Output()
-    screen2=widgets.Output()
-    screen3=widgets.Output()
-    screen4=widgets.Output()
-    screen5=widgets.Output()
-    screen6=widgets.Output()
-    screen7=widgets.Output()
+    screen1 = widgets.Output()
+    screen2 = widgets.Output()
+    screen3 = widgets.Output()
+    screen4 = widgets.Output()
+    screen5 = widgets.Output()
+    screen6 = widgets.Output()
+    screen7 = widgets.Output()
     
     with screen1:
         gui1()
     with screen2:
         ssgui()
     with screen3:
         mgui()
@@ -55,15 +55,16 @@
     with screen5:
         gui5()
     with screen6:
         gui3()
     with screen7:
         gui4()
     
-    tab_contents = ['Normal ORCA','Mechanical ORCA','Multiple ORCA','Stress-Strain Curve','Distance Curve','Energy Diagram','Molecule Designer']
+    tab_contents = ['Normal ORCA', 'Mechanical ORCA', 'Multiple ORCA', 'Stress-Strain Curve', 'Distance Curve', 'Energy Diagram', 'Molecule Designer']
     tab = widgets.Tab(style=dict(font_weight='bold'))
-    #children = [widgets.Label(name,style=dict(font_weight='bold')) for name in tab_contents]
-    children = [screen1,screen2,screen3,screen4,screen5,screen6,screen7]
-    tab.children=children
+    #children = [widgets.Label(name,\
+    #            style=dict(font_weight='bold')) for name in tab_contents]
+    children = [screen1, screen2, screen3, screen4, screen5, screen6, screen7]
+    tab.children = children
     tab.titles = tab_contents
     tab.layout = widgets.Layout(layout=widgets.Layout(width='50%'))
     display(tab)
```

### Comparing `MCPoly-0.5.1.3/MCPoly.egg-info/PKG-INFO` & `MCPoly-0.6b1/MCPoly.egg-info/PKG-INFO`

 * *Files 7% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: MCPoly
-Version: 0.5.1.3
+Version: 0.6b1
 Summary: Useful tools for Computational Chemistry for polymers
 Home-page: https://github.com/Omicron-Fluor/MCPoly/
 Author: Omicron Fluor
 Author-email: cxs454@student.bham.ac.uk
 License: MIT
 Keywords: ORCA,Mechanical Property,Computational Chemistry
 Description-Content-Type: text/markdown
@@ -13,42 +13,44 @@
 # MCPoly
 Some methods to deal with some manipulation of computational chemistry, mostly about mechanical properties of polymers.
 ![](./reference/function.png)
 
 ## Overview
 `MCPoly` is a Python library to make some steps of computational chemistry easier. It includes some functions of drawing molecule structures, creating proper .xyz , .inp , .mol and .data file, which specialised for using ORCA and LAMMPS, and some functions for researching the mechanical property of some polymers.
 
+## Updated in v0.6.0(03.08.23)
+1. Standardise the package to fit PEP 8 style, so 'DATAtoXYZ' is changed into 'DataToXyz', 'DATAtomolTXT' is changed into 'DataToMolTxt', 'XYZtoINP' is changed into 'XyzToInp'.
+2. Add special functions about Molecular Dynamic functions in ORCA.
+3. Fix some bugs about ORCA Calculations Settings.
+4. Fix some bugs about ORCA GUI display.
+5. Fix some bugs about judging the maximum iteration of atoms.
+6. Fix some bugs about save .xyz file in ORCA GUI.
+
 ## Updated in v0.5.1.3(29.06.23)
 1. Add 'rebuild' in 'lmpset' package. You can now use it to rebuild geometry structure of LAMMPS input data now.
 2. Add 'DATAtoXYZ' in 'lmpset' package to convert LAMMPS Data File into XYZ File
 3. Add 'DATAtomolTXT' to convert LAMMPS Data File into LAMMPS Molecule Text File.
 4. All these functions can be used by lmpset.mould().XXX() now.
-5. Fix some bugs about ORCA Calculations Settings
-6. Fix some bugs about ORCA GUI display
-7. Fix some bugs about judging the maximum iteration of atoms
+5. Fix some bugs about ORCA Calculations Settings.
+6. Fix some bugs about ORCA GUI display.
+7. Fix some bugs about judging the maximum iteration of atoms.
 
 ## Updated in v0.4.2.3(12.06.23)
 1. BIG UPDATE: Molecule Designer GUI is included in this package. You can now use it to draw molecule with 3D view at the same time.
 <img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/moldraw_gui.png">
 2. Add 'chain' in 'lmpset' package. You can now use it to convert periodic polymer structure input data now.
-3. Fix some bugs about ORCA Calculations
-4. Fix some bugs about calculating stress-strain curve
+3. Fix some bugs about ORCA Calculations.
+4. Fix some bugs about calculating stress-strain curve.
 
 ## Updated in v0.3.0 (19.05.23)
 1. BIG UPDATE: Now status package can be used to see energy and gibbs free energy by .energy and .gibbs.
 2. BIG UPDATE: The new Reaction Diagram GUI is included in this package. You can use it to merge some tables and sea the relevant reaction diagram as a reference.
 <img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/status_gui.png">
 3. Fix some bugs about availability of Stress-Strain Curve Output.
 
-## Updated in v0.2.1 (16.05.23)
-1. BIG UPDATE: Add GUI ORCA setting screens for multiple ORCA calculations and Stress-Strain Curve Output. You can use orca.mgui and sscurve.gui to learn more.
-2. BIG UPDATE: MCPoly.vis is created. Use MCPoly.vis() to directly show all four GUI screen.
-<img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/vis.png">
-3. Fix some bugs on mechanical calculations and stress-strain curve drawings.
-
 ## Functions for ORCA
 <img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/ORCA.png" width="400" height="263" >
 
 ### orcaset
 Used to create ORCA input files and run it on ORCA. It's especially handy for researching mechanical property of polymers.
 
 ### status
```

### Comparing `MCPoly-0.5.1.3/MCPoly.egg-info/SOURCES.txt` & `MCPoly-0.6b1/MCPoly.egg-info/SOURCES.txt`

 * *Files 2% similar despite different names*

```diff
@@ -5,28 +5,28 @@
 MCPoly/.DS_Store
 MCPoly/__init__.py
 MCPoly.egg-info/PKG-INFO
 MCPoly.egg-info/SOURCES.txt
 MCPoly.egg-info/dependency_links.txt
 MCPoly.egg-info/requires.txt
 MCPoly.egg-info/top_level.txt
-MCPoly/lmpset/DATAtoXYZ.py
-MCPoly/lmpset/DATAtomolTXT.py
+MCPoly/lmpset/DataToMolTxt.py
+MCPoly/lmpset/DataToXyz.py
 MCPoly/lmpset/__init__.py
 MCPoly/lmpset/chain.py
 MCPoly/lmpset/infchain.py
 MCPoly/lmpset/mould.py
 MCPoly/lmpset/rebuild.py
 MCPoly/moldraw/C_selection.py
 MCPoly/moldraw/__init__.py
 MCPoly/moldraw/bind_selection.py
 MCPoly/moldraw/gui.py
 MCPoly/moldraw/molecule.py
 MCPoly/moldraw/sub_selection.py
-MCPoly/orcaset/XYZtoINP.py
+MCPoly/orcaset/XyzToInp.py
 MCPoly/orcaset/__init__.py
 MCPoly/orcaset/gui.py
 MCPoly/orcaset/mgui.py
 MCPoly/orcaset/multiorca.py
 MCPoly/orcaset/orca.py
 MCPoly/orcaset/ssgui.py
 MCPoly/orcaset/ssorca.py
```

### Comparing `MCPoly-0.5.1.3/PKG-INFO` & `MCPoly-0.6b1/PKG-INFO`

 * *Files 7% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: MCPoly
-Version: 0.5.1.3
+Version: 0.6b1
 Summary: Useful tools for Computational Chemistry for polymers
 Home-page: https://github.com/Omicron-Fluor/MCPoly/
 Author: Omicron Fluor
 Author-email: cxs454@student.bham.ac.uk
 License: MIT
 Keywords: ORCA,Mechanical Property,Computational Chemistry
 Description-Content-Type: text/markdown
@@ -13,42 +13,44 @@
 # MCPoly
 Some methods to deal with some manipulation of computational chemistry, mostly about mechanical properties of polymers.
 ![](./reference/function.png)
 
 ## Overview
 `MCPoly` is a Python library to make some steps of computational chemistry easier. It includes some functions of drawing molecule structures, creating proper .xyz , .inp , .mol and .data file, which specialised for using ORCA and LAMMPS, and some functions for researching the mechanical property of some polymers.
 
+## Updated in v0.6.0(03.08.23)
+1. Standardise the package to fit PEP 8 style, so 'DATAtoXYZ' is changed into 'DataToXyz', 'DATAtomolTXT' is changed into 'DataToMolTxt', 'XYZtoINP' is changed into 'XyzToInp'.
+2. Add special functions about Molecular Dynamic functions in ORCA.
+3. Fix some bugs about ORCA Calculations Settings.
+4. Fix some bugs about ORCA GUI display.
+5. Fix some bugs about judging the maximum iteration of atoms.
+6. Fix some bugs about save .xyz file in ORCA GUI.
+
 ## Updated in v0.5.1.3(29.06.23)
 1. Add 'rebuild' in 'lmpset' package. You can now use it to rebuild geometry structure of LAMMPS input data now.
 2. Add 'DATAtoXYZ' in 'lmpset' package to convert LAMMPS Data File into XYZ File
 3. Add 'DATAtomolTXT' to convert LAMMPS Data File into LAMMPS Molecule Text File.
 4. All these functions can be used by lmpset.mould().XXX() now.
-5. Fix some bugs about ORCA Calculations Settings
-6. Fix some bugs about ORCA GUI display
-7. Fix some bugs about judging the maximum iteration of atoms
+5. Fix some bugs about ORCA Calculations Settings.
+6. Fix some bugs about ORCA GUI display.
+7. Fix some bugs about judging the maximum iteration of atoms.
 
 ## Updated in v0.4.2.3(12.06.23)
 1. BIG UPDATE: Molecule Designer GUI is included in this package. You can now use it to draw molecule with 3D view at the same time.
 <img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/moldraw_gui.png">
 2. Add 'chain' in 'lmpset' package. You can now use it to convert periodic polymer structure input data now.
-3. Fix some bugs about ORCA Calculations
-4. Fix some bugs about calculating stress-strain curve
+3. Fix some bugs about ORCA Calculations.
+4. Fix some bugs about calculating stress-strain curve.
 
 ## Updated in v0.3.0 (19.05.23)
 1. BIG UPDATE: Now status package can be used to see energy and gibbs free energy by .energy and .gibbs.
 2. BIG UPDATE: The new Reaction Diagram GUI is included in this package. You can use it to merge some tables and sea the relevant reaction diagram as a reference.
 <img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/status_gui.png">
 3. Fix some bugs about availability of Stress-Strain Curve Output.
 
-## Updated in v0.2.1 (16.05.23)
-1. BIG UPDATE: Add GUI ORCA setting screens for multiple ORCA calculations and Stress-Strain Curve Output. You can use orca.mgui and sscurve.gui to learn more.
-2. BIG UPDATE: MCPoly.vis is created. Use MCPoly.vis() to directly show all four GUI screen.
-<img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/vis.png">
-3. Fix some bugs on mechanical calculations and stress-strain curve drawings.
-
 ## Functions for ORCA
 <img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/ORCA.png" width="400" height="263" >
 
 ### orcaset
 Used to create ORCA input files and run it on ORCA. It's especially handy for researching mechanical property of polymers.
 
 ### status
```

### Comparing `MCPoly-0.5.1.3/README.md` & `MCPoly-0.6b1/README.md`

 * *Files 24% similar despite different names*

```diff
@@ -1,42 +1,44 @@
 # MCPoly
 Some methods to deal with some manipulation of computational chemistry, mostly about mechanical properties of polymers.
 ![](./reference/function.png)
 
 ## Overview
 `MCPoly` is a Python library to make some steps of computational chemistry easier. It includes some functions of drawing molecule structures, creating proper .xyz , .inp , .mol and .data file, which specialised for using ORCA and LAMMPS, and some functions for researching the mechanical property of some polymers.
 
+## Updated in v0.6.0(03.08.23)
+1. Standardise the package to fit PEP 8 style, so 'DATAtoXYZ' is changed into 'DataToXyz', 'DATAtomolTXT' is changed into 'DataToMolTxt', 'XYZtoINP' is changed into 'XyzToInp'.
+2. Add special functions about Molecular Dynamic functions in ORCA.
+3. Fix some bugs about ORCA Calculations Settings.
+4. Fix some bugs about ORCA GUI display.
+5. Fix some bugs about judging the maximum iteration of atoms.
+6. Fix some bugs about save .xyz file in ORCA GUI.
+
 ## Updated in v0.5.1.3(29.06.23)
 1. Add 'rebuild' in 'lmpset' package. You can now use it to rebuild geometry structure of LAMMPS input data now.
 2. Add 'DATAtoXYZ' in 'lmpset' package to convert LAMMPS Data File into XYZ File
 3. Add 'DATAtomolTXT' to convert LAMMPS Data File into LAMMPS Molecule Text File.
 4. All these functions can be used by lmpset.mould().XXX() now.
-5. Fix some bugs about ORCA Calculations Settings
-6. Fix some bugs about ORCA GUI display
-7. Fix some bugs about judging the maximum iteration of atoms
+5. Fix some bugs about ORCA Calculations Settings.
+6. Fix some bugs about ORCA GUI display.
+7. Fix some bugs about judging the maximum iteration of atoms.
 
 ## Updated in v0.4.2.3(12.06.23)
 1. BIG UPDATE: Molecule Designer GUI is included in this package. You can now use it to draw molecule with 3D view at the same time.
 <img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/moldraw_gui.png">
 2. Add 'chain' in 'lmpset' package. You can now use it to convert periodic polymer structure input data now.
-3. Fix some bugs about ORCA Calculations
-4. Fix some bugs about calculating stress-strain curve
+3. Fix some bugs about ORCA Calculations.
+4. Fix some bugs about calculating stress-strain curve.
 
 ## Updated in v0.3.0 (19.05.23)
 1. BIG UPDATE: Now status package can be used to see energy and gibbs free energy by .energy and .gibbs.
 2. BIG UPDATE: The new Reaction Diagram GUI is included in this package. You can use it to merge some tables and sea the relevant reaction diagram as a reference.
 <img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/status_gui.png">
 3. Fix some bugs about availability of Stress-Strain Curve Output.
 
-## Updated in v0.2.1 (16.05.23)
-1. BIG UPDATE: Add GUI ORCA setting screens for multiple ORCA calculations and Stress-Strain Curve Output. You can use orca.mgui and sscurve.gui to learn more.
-2. BIG UPDATE: MCPoly.vis is created. Use MCPoly.vis() to directly show all four GUI screen.
-<img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/vis.png">
-3. Fix some bugs on mechanical calculations and stress-strain curve drawings.
-
 ## Functions for ORCA
 <img src="https://github.com/Omicron-Fluor/MCPoly/blob/main/reference/ORCA.png" width="400" height="263" >
 
 ### orcaset
 Used to create ORCA input files and run it on ORCA. It's especially handy for researching mechanical property of polymers.
 
 ### status
```

### Comparing `MCPoly-0.5.1.3/setup.py` & `MCPoly-0.6b1/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,15 +1,15 @@
 from setuptools import setup
 
 with open('README.md') as readme_file:
     README = readme_file.read()
 
 setup_args = dict(
     name='MCPoly',
-    version='0.5.1.3',
+    version='0.6b1',
     description='Useful tools for Computational Chemistry for polymers',
     long_description_content_type="text/markdown",
     long_description=README,
     license="MIT",
     packages=['MCPoly','MCPoly.lmpset','MCPoly.moldraw','MCPoly.orcaset','MCPoly.sscurve','MCPoly.status','MCPoly.view3d','MCPoly.version','MCPoly.vis'],
     author='Omicron Fluor',
     author_email='cxs454@student.bham.ac.uk',
```

### Comparing `MCPoly-0.5.1.3/tests/test_moldraw.py` & `MCPoly-0.6b1/tests/test_moldraw.py`

 * *Files 8% similar despite different names*

```diff
@@ -3,28 +3,28 @@
 import os
 
 @pytest.fixture
 def object_moldraw():
     return molecule('Bu', loc='./MCPoly/tests/data_moldraw/')
 
 def test_rectify1(object_moldraw):
-    return object_moldraw.sub('Cl',6)
+    return object_moldraw.sub('Cl', 6)
 
 def test_rectify3(object_moldraw):
-    return object_moldraw.bind(6,[2,3])
+    return object_moldraw.bind(6, [2,3])
 
 def test_rectify3(object_moldraw):
-    return object_moldraw.C('CO',2)
+    return object_moldraw.C('CO', 2)
 
 #def test_geoview(object_moldraw):
 #    return object_moldraw.geoview()
 
 def test_conformer1(object_moldraw):
     return object_moldraw.conformer(must=True)
 
 def test_conformer2(object_moldraw):
-    object_moldraw.conformer(lowenergy=1.2,must=True)
-    assert object_moldraw.energy<1.2
+    object_moldraw.conformer(lowenergy=1.2, must=True)
+    assert object_moldraw.energy < 1.2
 
 def test_conformer3(object_moldraw):
-    object_moldraw.conformer(highenergy=1.2,must=True)
-    assert object_moldraw.energy>1.2
+    object_moldraw.conformer(highenergy=1.2, must=True)
+    assert object_moldraw.energy > 1.2
```

### Comparing `MCPoly-0.5.1.3/tests/test_orcaset.py` & `MCPoly-0.6b1/tests/test_orcaset.py`

 * *Files 18% similar despite different names*

```diff
@@ -1,163 +1,165 @@
-from MCPoly.orcaset import XYZtoINP
+from MCPoly.orcaset import XyzToInp
 from MCPoly.orcaset import orca
 from MCPoly.orcaset import ssorca
 from MCPoly.orcaset import multiorca
 import os
 import re
 import pytest
 
-def test_XYZtoINP2():
-    opath=os.getcwd()
+def test_XyzToInp2():
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    loc='./data_orcaset/'
-    file='Atoms1'
-    XYZtoINP(file,fileloc=loc,saveloc=loc,method='B3LYP',basis_set='def2-TZVP',freq=True,\
-            external_force=True,aim=[0,3],strain=1.5,maxcore=4096,corenum=7)
-    i1=0
-    i2=0
-    i3=0
-    i4=0
-    i5=0
-    f=open(loc+file+'.inp','r')
+    loc = './data_orcaset/'
+    file = 'Atoms1'
+    XyzToInp(file, fileloc=loc, saveloc=loc, method='B3LYP', basis_set='def2-TZVP', freq=True,\
+            external_force=True, aim=[0, 3], strain=1.5, maxcore=4096, corenum=7)
+    i1 = 0
+    i2 = 0
+    i3 = 0
+    i4 = 0
+    i5 = 0
+    f = open(loc+file+'.inp', 'r')
     for line in f:
-        a=re.search(r'B3LYP def2-TZVP OPT FREQ',line)
+        a = re.search(r'B3LYP def2-TZVP OPT FREQ', line)
         if a:
-            i1=1
-        b=re.search(r'maxcore 4096',line)
+            i1 = 1
+        b = re.search(r'maxcore 4096', line)
         if b:
-            i2=1
-        c=re.search('%PAL NPROCS 7 END',line)
+            i2 = 1
+        c = re.search('%PAL NPROCS 7 END', line)
         if c:
-            i3=1
-        d1=re.search(r'POTENTIALS',line)
+            i3 = 1
+        d1 = re.search(r'POTENTIALS', line)
         if d1:
-            i4=1
-        d2=re.search('{C 0 3 1.500}',line)
+            i4 = 1
+        d2 = re.search('{C 0 3 1.500}', line)
         if d2:
-            i5=1
+            i5 = 1
             break
     f.close()
     os.chdir(opath)
-    assert i1*i2*i3*i4*i5!=0
+    assert i1 * i2 * i3 * i4 * i5 != 0
 
-def test_XYZtoINP3():
-    opath=os.getcwd()
+def test_XyzToInp3():
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    file='Atoms1'
-    loc='./data_orcaset/'
-    XYZtoINP(file,fileloc=loc,saveloc=loc,method='B3LYP',basis_set='def2-TZVP',scan=True,\
-            aim=[0,3],stretch=0.8,scanstep=8,maxcore=4096,corenum=8)
-    i1=0
-    i2=0
-    i3=0
-    i4=0
-    i5=0
-    f=open(loc+file+'.inp','r')
+    file = 'Atoms1'
+    loc = './data_orcaset/'
+    XyzToInp(file, fileloc=loc, saveloc=loc, method='B3LYP', basis_set='def2-TZVP', scan = True, \
+            aim=[0, 3], stretch=0.8, scanstep=8, maxcore=4096, corenum=8)
+    i1 = 0
+    i2 = 0
+    i3 = 0
+    i4 = 0
+    i5 = 0
+    f = open(loc+file+'.inp', 'r')
     for line in f:
-        a=re.search(r'B3LYP def2-TZVP',line)
+        a = re.search(r'B3LYP def2-TZVP', line)
         if a:
-            i1=1
-        b=re.search(r'maxcore 4096',line)
+            i1 = 1
+        b = re.search(r'maxcore 4096', line)
         if b:
-            i2=1
-        c=re.search('%PAL NPROCS 8 END',line)
+            i2 = 1
+        c = re.search('%PAL NPROCS 8 END', line)
         if c:
-            i3=1
-        d1=re.search(r'geom Scan',line)
+            i3 = 1
+        d1 = re.search(r'geom Scan', line)
         if d1:
-            i4=1
-        d2=re.search('B 0 3 = 3.804, 4.604, 8',line)
+            i4 = 1
+        d2 = re.search('B 0 3 = 3.804,  4.604,  8', line)
         if d2:
-            i5=1
+            i5 = 1
             break
     f.close()
     os.chdir(opath)
-    assert i1*i2*i3*i4*i5!=0
+    assert i1 * i2 * i3 * i4 * i5 != 0
 
-def test_XYZtoINP4():
-    opath=os.getcwd()
+def test_XyzToInp4():
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    file='Atoms1'
-    loc='./data_orcaset/'
-    XYZtoINP(file,fileloc=loc,saveloc=loc,method='B3LYP D3BJ',basis_set='def2-TZVP',MD=True,\
-                     MD=True,freq=True,md_timestep=1.0,initvel=350,tsNHC=350,dumpcon=25,runstep=2500,maxcore=4096,corenum=8)
-    i1=0
-    i2=0
-    i3=0
-    i4=0
-    i5=0
-    i6=0
-    f=open(loc+file+'.inp','r')
+    file = 'Atoms1'
+    loc = './data_orcaset/'
+    XyzToInp(file, fileloc=loc, saveloc=loc, method='B3LYP D3BJ', basis_set='def2-TZVP',\
+                     MD=True, freq=True, md_timestep=1.0, initvel=350,\
+             tsNHC=350, dumpcon=25, runstep=2500, maxcore=4096, corenum=8)
+    i1 = 0
+    i2 = 0
+    i3 = 0
+    i4 = 0
+    i5 = 0
+    i6 = 0
+    f = open(loc+file+'.inp', 'r')
     for line in f:
-        a=re.search(r'MD B3LYP def2-TZVP',line)
+        print(line)
+        a = re.search(r'MD B3LYP D3BJ def2-TZVP', line)
         if a:
-            i1=1
-        b=re.search(r'maxcore 4096',line)
+            i1 = 1
+        b = re.search(r'maxcore 4096', line)
         if b:
-            i2=1
-        c=re.search('%PAL NPROCS 8 END',line)
+            i2 = 1
+        c = re.search('%PAL NPROCS 8 END', line)
         if c:
-            i3=1
-        d1=re.search(r'Timestep 1.0_fs',line)
+            i3 = 1
+        d1 = re.search(r'Timestep 1.0_fs', line)
         if d1:
-            i4=1
-        d2=re.search('Dump Position Stride 25 Filename "Atoms1_dump.xyz"',line)
+            i4 = 1
+        d2 = re.search('Dump Position Stride 25 Filename "Atoms1_dump.xyz"', line)
         if d2:
-            i5=1
-        d3=re.search('Run 2500',line)
+            i5 = 1
+        d3 = re.search('Run 2500', line)
         if d3:
-            i6=1
+            i6 = 1
     f.close()
     os.chdir(opath)
-    assert i1*i2*i3*i4*i5*i6!=0
+    assert i1 * i2 * i3 * i4 * i5 * i6 != 0
 
-def test_XYZtoINP1():
-    opath=os.getcwd()
+def test_XyzToInp1():
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    file='Atoms1'
-    loc='./data_orcaset/'
-    XYZtoINP(file,fileloc=loc,saveloc=loc)
-    i=0
-    j=0
-    f=open(loc+file+'.inp','r')
+    file = 'Atoms1'
+    loc = './data_orcaset/'
+    XyzToInp(file, fileloc = loc, saveloc = loc)
+    i = 0
+    j = 0
+    f = open(loc+file+'.inp', 'r')
     for line in f:
-        a=re.search(r'B3LYP def2-SVP',line)
+        a = re.search(r'B3LYP def2-SVP', line)
         if a:
-            i=1
-        b=re.search(r'xyz 0 1',line)
+            i = 1
+        b = re.search(r'xyz 0 1', line)
         if b:
-            j=1
+            j = 1
             break
     f.close()
     os.chdir(opath)
-    assert i*j!=0
+    assert i * j != 0
 
 def test_ORCA():
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    file='Atoms1'
-    loc='./data_orcaset/'
-    orca(file,fileloc=loc,saveloc=loc)
+    file = 'Atoms1'
+    loc = './data_orcaset/'
+    orca(file, fileloc=loc, saveloc=loc)
     os.chdir(opath)
     return 0
 
 @pytest.fixture
 def suite():
-    return multiorca(['Atoms1', 'Atoms2'],loc='./data_orcaset/')
+    return multiorca(['Atoms1', 'Atoms2'], loc = './data_orcaset/')
 
 def test_multiorca(suite):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
     suite.run()
     os.chdir(opath)
     return 0
 
 def object_ssorca():
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    ssorca('Atoms3',loc='./data_orcaset/')
+    ssorca('Atoms3', loc = './data_orcaset/')
     os.chdir(opath)
     return 0
 
 #def test_ssORCA(object_ssorca):
-#    return ssorca(file3,loc=loc)
+#    return ssorca(file3, loc=loc)
```

### Comparing `MCPoly-0.5.1.3/tests/test_status.py` & `MCPoly-0.6b1/tests/test_status.py`

 * *Files 17% similar despite different names*

```diff
@@ -3,207 +3,254 @@
 from MCPoly import view3d
 import pytest
 import os
 import re
 
 @pytest.fixture
 def current1():
-    return status('Atoms1',loc='./data_status/')
+    return status('Atoms1', loc='./data_status/')
 
 def test1_status_status1(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current1.status(figureonly=True)
+    num = current1.status(figureonly=True)
     os.chdir(opath)
-    assert len(num)==8
+    assert len(num) == 8
 
 def test2_status_status1(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current1.status(figureonly=True)
+    num = current1.status(figureonly=True)
     os.chdir(opath)
     for E in num:
-        assert E<=-1150.90
+        assert E <= -1150.90
         
 @pytest.fixture
 def current1():
-    return status('Atoms1',loc='./data_status/')
+    return status('Atoms1', loc='./data_status/')
 
 def test1_status_statusonly1(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current1.status(figureonly=True,statusonly=True)
+    num = current1.status(figureonly=True, statusonly=True)
     os.chdir(opath)
-    assert num==2
+    assert num == 2
     
 def test2_status_statusonly1(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current1.energy()
+    num = current1.energy()
     os.chdir(opath)
-    assert num==-1150.932617
+    assert num == -1150.932617
 
 def test3_status_statusonly1(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current1.gibbs()
+    num = current1.gibbs()
     os.chdir(opath)
-    assert num==-1150.919111
+    assert num == -1150.919111
     
 @pytest.fixture
 def current2():
-    return status('Atoms2',loc='./data_status/')
+    return status('Atoms2', loc='./data_status/')
 
 def test_status_statusonly2(current2):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current2.status(figureonly=True,statusonly=True)
+    num = current2.status(figureonly=True, statusonly=True)
     os.chdir(opath)
-    assert num==1
+    assert num == 1
 
 @pytest.fixture
 def current3():
-    return status('Atoms3',loc='./data_status/')
+    return status('Atoms3', loc='./data_status/')
 
 def test_status_statusonly3(current3):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current3.status(figureonly=True,statusonly=True)
+    num = current3.status(figureonly=True,statusonly=True)
     os.chdir(opath)
-    assert num==0
+    assert num == 0
 
 @pytest.fixture
 def current4():
-    return status('Atoms4',loc='./data_status/')
+    return status('Atoms4', loc='./data_status/')
 
 def test_status_status4(current4):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current4.status(figureonly=True)
+    num = current4.status(figureonly=True)
     os.chdir(opath)
-    assert len(num)==78
+    assert len(num) == 78
 
 @pytest.fixture
 def current4():
-    return status('Atoms4',loc='./data_status/')
+    return status('Atoms4', loc='./data_status/')
 
 def test_status_statusonly4(current4):
-    opath=os.getcwd()
+    opath = os.getcwd()
+    os.chdir('./MCPoly/tests')
+    num = current4.status(figureonly=True, statusonly=True)
+    os.chdir(opath)
+    assert num == 4
+
+@pytest.fixture
+def current6():
+    return status('Atoms6', loc='./data_status/')
+
+def test_status_statusonly5(current6):
+    opath = os.getcwd()
+    os.chdir('./MCPoly/tests')
+    num = current6.status(figureonly=True, statusonly=True)
+    os.chdir(opath)
+    assert num == 6
+
+@pytest.fixture
+def current7():
+    return status('Atoms7', loc='./data_status/')
+
+def test_status_statusonly6(current7):
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current4.status(figureonly=True,statusonly=True)
+    num = current7.status(figureonly=True, statusonly=True, MD=True)
     os.chdir(opath)
-    assert num==4
+    assert num == 2
+
+@pytest.fixture
+def current8():
+    return status('Atoms8', loc='./data_status/')
+
+def test_status_statusonly7(current8):
+    opath = os.getcwd()
+    os.chdir('./MCPoly/tests')
+    num = current8.status(figureonly=True, statusonly=True, MD=True)
+    os.chdir(opath)
+    assert num == 4
+
+@pytest.fixture
+def current9():
+    return status('Atoms9', loc='./data_status/')
+
+def test_status_statusonly8(current9):
+    opath = os.getcwd()
+    os.chdir('./MCPoly/tests')
+    num = current9.status(figureonly=True, statusonly=True, MD=True)
+    os.chdir(opath)
+    assert num == 0
 
 @pytest.fixture
 def current1():
     return status('Atoms1',loc='./data_status/')
 
 def status_figure(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
     current1.figure(7)
     os.chdir(opath)
     return 0
 
 @pytest.fixture
 def current1():
-    return status('Atoms1',loc='./data_status/')
+    return status('Atoms1', loc='./data_status/')
 
 def status_figureonly(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
     current1.figuretraj()
     os.chdir(opath)
     return 0
 
 @pytest.fixture
 def current5():
-    return ['Atoms1','Atoms5']
+    return ['Atoms1', 'Atoms5']
 
 def test1_status_echart(current5):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    data=echart(files=current5,loc='./data_status/',fig_pattern='line',hartree=True,absolute=True,figdata=True,savefig=False,xx=True)
-    assert data==[-1150.932617,-995.394366]
-    f=open('./data_status/Result.csv','r')
-    a0=0
-    a1=0
+    data = echart(files=current5, loc='./data_status/', fig_pattern='line',\
+                  hartree=True, absolute=True, figdata=True, savefig=False, xx=True)
+    assert data == [-1150.932617, -995.394366]
+    f = open('./data_status/Result.csv','r')
+    a0 = 0
+    a1 = 0
     for line in f:
-        a=re.search('Step,File,E\(Eh\)',line)
+        a = re.search('Step,File,E\(Eh\)',line)
         if a:
-            a0=1
-        b=re.search('1,Atoms5,-995.394366',line)
+            a0 = 1
+        b = re.search('1,Atoms5,-995.394366',line)
         if b:
-            a1=1
+            a1 = 1
     os.chdir(opath)
-    assert a0*a1==1
+    assert a0 * a1 == 1
 
 def test2_status_echart(current5):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    data=echart(files=current5,loc='./data_status/',energy_pattern='Gibbs',fig_pattern='bar',hartree=False,absolute=False,figdata=True,savefig=False,dataname='Result2',xx=True)
-    assert data==[0.,97752.61908948798]
-    f=open('./data_status/Result2.csv','r')
-    a0=0
-    a1=0
+    data = echart(files=current5, loc='./data_status/', energy_pattern='Gibbs',\
+                  fig_pattern='bar', hartree=False, absolute=False, figdata=True,\
+                  savefig=False, dataname='Result2', xx=True)
+    assert data == [0., 97752.61908948798]
+    f = open('./data_status/Result2.csv', 'r')
+    a0 = 0
+    a1 = 0
     for line in f:
-        a=re.search('Step,File,G\(kcal/mol\)',line)
+        a = re.search('Step,File,G\(kcal/mol\)', line)
         if a:
-            a0=1
-        b=re.search('1,Atoms5,97752.61908948798',line)
+            a0 = 1
+        b = re.search('1,Atoms5,97752.61908948798', line)
         if b:
-            a1=1
+            a1 = 1
     os.chdir(opath)
-    assert a0*a1==1
+    assert a0 * a1 == 1
 
 @pytest.fixture
 def current1():
-    return status('Atoms1',loc='./data_status/')
+    return status('Atoms1', loc='./data_status/')
 
 def test_status_enthalpy(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current1.enthalpy()
+    num = current1.enthalpy()
     os.chdir(opath)
-    assert num==-1150.866574
+    assert num == -1150.866574
 
 def test_status_entropy_correction(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current1.entropy_correction(unit='kcal/mol')
+    num = current1.entropy_correction(unit='kcal/mol')
     os.chdir(opath)
-    assert num==-0.052537*627.509
+    assert num == -0.052537*627.509
 
 def test_status_mulliken_charge(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current1.mulliken_charge(12)
+    num = current1.mulliken_charge(12)
     os.chdir(opath)
-    assert num==-0.148834
+    assert num == -0.148834
 
 def test_status_loewdin_charge(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current1.loewdin_charge(3)
+    num = current1.loewdin_charge(3)
     os.chdir(opath)
-    assert num==-0.669500
+    assert num == -0.669500
 
 def test_status_atom(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    atoms=current1.atom()
+    atoms = current1.atom()
     os.chdir(opath)
-    assert atoms[5]==['F', -8.322068, 0.541485, -0.153449]
+    assert atoms[5] == ['F', -8.322068, 0.541485, -0.153449]
 
 def test_status_atom_num(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current1.atom_num()
+    num = current1.atom_num()
     os.chdir(opath)
-    assert num==14
+    assert num == 14
 
 def test_status_mass(current1):
-    opath=os.getcwd()
+    opath = os.getcwd()
     os.chdir('./MCPoly/tests')
-    num=current1.mass()
+    num = current1.mass()
     os.chdir(opath)
-    assert num==238.024
+    assert abs(238.024 - num) < 0.001
```

